

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Flask 0.11-dev documentation</title>
  

  
  

  

  
  
    

  

  
  

  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  
    <link rel="stylesheet" href="https://cdnmedia.readthedocs.org/css/readthedocs-doc-embed.css" type="text/css" />
  

  
    <link rel="top" title="None" href="index.html#document-index"/>
 
<!-- RTD Extra Head -->



<!-- 
Read the Docs is acting as the canonical URL for your project. 
If you want to change it, more info is available in our docs:
  http://docs.readthedocs.org/en/latest/canonical.html
-->
<link rel="canonical" href="http://flask-docs-kr.readthedocs.org/ko/latest/" />

<script type="text/javascript">
  // This is included here because other places don't have access to the pagename variable.
  var READTHEDOCS_DATA = {
    project: "flask-docs-kr",
    version: "latest",
    language: "ko",
    page: "index",
    builder: "sphinx",
    theme: "sphinx_rtd_theme",
    docroot: "/docs/",
    source_suffix: ".rst",
    api_host: "https://readthedocs.org/",
    commit: "abe942178f76774da16d3f3e305790f79633cb1d"
  }
  // Old variables
  var doc_version = "latest";
  var doc_slug = "flask-docs-kr";
  var page_name = "index";
  var html_theme = "sphinx_rtd_theme";
</script>
<!-- RTD Analytics Code -->
<!-- Included in the header because you don't have a footer block. -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-17997319-1']);
  _gaq.push(['_trackPageview']);


  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
<!-- end RTD Analytics Code -->
<!-- end RTD <extrahead> -->


  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="index.html#document-index" class="icon icon-home"> Flask
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-foreword">머리말</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-foreword#micro">&#8220;마이크로(Micro)&#8221;는 무엇을 뜻하는가?</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-foreword#id2">설정과 관례</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-foreword#flask">Flask를 이용하여 성장시키기</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-advanced_foreword">경험있는 프로그래머를 위한 머릿글</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-advanced_foreword#flask">Flask에서 쓰레드 로컬</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-advanced_foreword#id2">웹개발에서 주의점</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-advanced_foreword#python3">Python3의 상태</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-installation">설치하기</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-installation#virtualenv">virtualenv</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-installation#id3">시스템 전체에 적용하여 설치</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-installation#id4">위태로운 모험 하기</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-installation#windows-pip-distribute">Windows에서의 <cite>pip</cite> 와 <cite>distribute</cite></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-quickstart">빠르게 시작하기</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-quickstart#id2">기본 애플리케이션</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-quickstart#debug-mode">디버그 모드</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-quickstart#id6">라우팅</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-quickstart#id7">변수 규칙</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-quickstart#url">URL 생성</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-quickstart#http">HTTP 메소드</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-quickstart#id10">정적 파일</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-quickstart#id11">템플릿 보여주기</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-quickstart#id14">요청 데이타 접근하기</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-quickstart#context-locals">컨텍스트 로컬</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-quickstart#id16">요청 객체</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-quickstart#id17">파일 업로드</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-quickstart#id18">쿠키</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-quickstart#id19">리다이렉션과 에러</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-quickstart#about-responses">응답에 관하여</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-quickstart#sessions">세션</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-quickstart#id22">메시지 플래싱</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-quickstart#id23">로깅</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-quickstart#wsgi">WSGI 미들웨어에서 후킹하기</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-quickstart#quickstart-deployment">웹서버에 배포하기</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-tutorial/index">튜토리얼</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-tutorial/introduction">Flaskr 소개하기</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-tutorial/folders">스텝 0: 폴더를 생성하기</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-tutorial/schema">스텝 1: 데이터베이스 스키마</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-tutorial/setup">스텝 2: 어플리케이션 셋업 코드</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-tutorial/dbinit">스텝 3: 데이터베이스 생성하기</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-tutorial/dbcon">스텝 4: 데이터베이스 커넥션 요청하기</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-tutorial/views">스텝 5: 뷰 함수들</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-tutorial/views#id2">작성된 글 보여주기</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-tutorial/views#id3">새로운 글 추가하기</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-tutorial/views#id4">로그인과 로그아웃</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-tutorial/templates">스텝 6: 템플릿</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-tutorial/templates#layout-html">layout.html</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-tutorial/templates#show-entries-html">show_entries.html</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-tutorial/templates#login-html">login.html</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-tutorial/css">스텝 7: 스타일 추가하기</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-tutorial/testing">보너스: 어플리케이션 테스트 하기</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-templating">템플릿</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-templating#jinja">Jinja 설정</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-templating#id2">표준 컨텍스트</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-templating#id3">표준 필터</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-templating#autoescaping">자동변환(Autoescaping) 제어하기</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-templating#registering-filters">필터 등록하기</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-templating#context-processor">컨텍스트 프로세서(context processor)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-testing">Flask 어플리케이션 테스트하기</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-testing#id1">어플리케이션</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-testing#skeleton">테스팅 스켈레톤(Skeleton)</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-testing#id2">첫번째 테스트</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-testing#id3">입력과 출력 로깅</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-testing#id4">메시지 추가 테스트</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-testing#id5">다른 테스팅 기법들</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-testing#id6">컨텍스트 유지시키기</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-testing#id7">세션에 접근하고 수정하기</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-errorhandling">어플리케이션 에러 로깅하기</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-errorhandling#id2">메일로 에러 발송하기</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-errorhandling#id3">파일에 로깅하기</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-errorhandling#logformat">로그 포맷 다루기</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-errorhandling#id5">이메일</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-errorhandling#id6">파일 로깅</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-errorhandling#id7">복잡한 로그 포맷</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-errorhandling#id8">다른 라이브러리들</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-errorhandling#id9">어플리케이션 에러 디버깅</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-errorhandling#id10">의심이 들때는 수동으로 실행하자</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-errorhandling#working-with-debuggers">디버거로 작업하기</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-config">설정 다루기</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-config#id2">설정 기초연습</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-config#id3">내장된 고유 설정값들</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-config#id6">파일을 통하여 설정하기</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-config#id7">설정 베스트 사례</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-config#id8">개발 / 운영(혹은 제품)</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-config#instance-folders">인스턴스 폴더</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-signals">시그널(Signals)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-signals#id2">시그널을 수신하기</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-signals#id3">시그널 생성하기</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-signals#signals-sending">시그널 보내기</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-signals#id5">시그널과 플라스크 요청 컨텍스트</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-signals#id6">시그널 수신 기반 데코레이터</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-signals#id7">핵심 시그널</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-views">플러거블 뷰(Pluggable Views)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-views#basic-principle">기본 원칙(Basic Principle)</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-views#id1">메소드 힌트</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-views#id2">메소드 기반 디스패치</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-views#id3">데코레이팅 뷰</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-views#api">메소드 뷰 API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-appcontext">어플리케이션 컨텍스트</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-appcontext#id2">어플리케이션 컨텍스트의 목적</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-appcontext#id3">어플리케이션 컨텍스트 생성하기</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-appcontext#id4">컨텍스트의 지역성</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-appcontext#id5">컨텍스트 사용</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-reqcontext">요청 컨텍스트</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-reqcontext#id2">컨텍스트 로컬로 다이빙하기</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-reqcontext#id3">컨텍스트가 작동하는 방식</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-reqcontext#callbacks-and-errors">콜백과 오류</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-reqcontext#teardown">테어다운(Teardown) 콜백</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-reqcontext#notes-on-proxies">프록시에서 주의할 점</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-reqcontext#id6">오류 시 컨텍스트 보존</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-blueprints">블루프린트를 가진 모듈화된 어플리케이션</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-blueprints#id2">왜 블루프린트인가?</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-blueprints#id3">블루프린트의 개념</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-blueprints#id4">첫번째 블루프린트</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-blueprints#id5">블루프린트 등록하기</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-blueprints#id6">블루프린트 리소스</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-blueprints#id7">블루프린트 리소스 폴더</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-blueprints#id8">정적 파일</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-blueprints#id9">템플릿</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-blueprints#url">URL 만들기</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-extensions">Flask 확장기능</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-extensions#id1">확장기능 찾아내기</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-extensions#id2">확장기능 사용하기</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-extensions#flask-0-8">Flask 0.8 이전버전의 경우</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-shell">쉘에서 작업하기</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-shell#id2">요청 컨텍스트 생성하기</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-shell#firing">요청하기 전/후에 발사하기(Firing)</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-shell#id3">쉘 경험을 더욱 향상시키기</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-patterns/index">Flask를 위한 패턴들</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-patterns/packages">더 큰 어플케이션들</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/packages#id2">간단한 패키지</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/packages#blueprints">청사진(Blueprints)으로 작업하기</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-patterns/appfactories">어플리케이션 팩토리</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/appfactories#id2">기본 팩토리</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/appfactories#application">어플리케이션(Application) 사용하기</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/appfactories#id3">팩토리 개선</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-patterns/appdispatch">어플리케이션 디스패칭</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/appdispatch#id2">이 문서를 가지고 작업하기</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/appdispatch#id3">어플리케이션 결합하기</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/appdispatch#subdomain">하위도메인(subdomain)으로 디스패치하기</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/appdispatch#id6">경로로 디스패치하기</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-patterns/urlprocessors">URL 프로세서 이용하기</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/urlprocessors#id1">국제화된 어플리케이션 URL</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/urlprocessors#id2">국제화된 청사진 URL</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-patterns/distribute">Distribute으로 전개하기</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/distribute#id1">기본 설치 스크립트</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/distribute#distributing-resources">리소스 배포하기</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/distribute#id5">의존성 선언하기</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/distribute#id6">설치하기/개발하기</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-patterns/fabric">Fabric으로 전개하기</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/fabric#fabfile">첫 번째 Fabfile 파일 생성하기</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/fabric#id1">Fabfile 실행하기</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/fabric#wsgi">WSGI 파일</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/fabric#id2">설정 파일</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/fabric#id3">첫 번째 전개</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/fabric#id4">다음 단계들</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-patterns/sqlite3">Flask에서 SQLite 3 사용하기</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/sqlite3#id1">필요할 때 연결하기</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/sqlite3#easy-querying">쉬운 질의하기</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/sqlite3#id3">초기 스키마</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-patterns/sqlalchemy">Flask에서 SQLAlchemy 사용하기</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/sqlalchemy#id1">Flask-SQLAlchemy 확장</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/sqlalchemy#declarative">선언부(Declarative)</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/sqlalchemy#id4">수동 객체 관계 매핑</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/sqlalchemy#sql">SQL 추상 계층</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-patterns/fileuploads">파일 업로드하기</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/fileuploads#id2">파일 업로드의 가벼운 소개</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/fileuploads#id5">업로드 개선하기</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/fileuploads#id6">업로드 진행 상태바</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/fileuploads#id7">더 쉬운 해결책</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-patterns/caching">캐싱(Caching)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/caching#id1">캐시 설정하기</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/caching#id2">캐시 사용하기</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-patterns/viewdecorators">뷰 데코레이터(View Decorators)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/viewdecorators#id1">로그인이 필수적인 데코레이터</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/viewdecorators#id2">캐싱 데코레이터</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/viewdecorators#id3">데코레이터를 템플화하기</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/viewdecorators#endpoint">끝점(Endpoint) 데코레이터</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-patterns/wtforms">WTForms를 가지고 폼 유효성 확인하기</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/wtforms#forms">폼(Forms)</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/wtforms#in-the-view">뷰 안에서(In the View)</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/wtforms#id5">템플릿에 있는 폼</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-patterns/templateinheritance">템플릿 상속</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/templateinheritance#id2">기본 템플릿</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/templateinheritance#id3">자식 템플릿</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-patterns/flashing">메시지 플래싱(Message Flashing)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/flashing#id1">간단한 플래싱</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/flashing#id2">카테고리를 가진 플래싱</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/flashing#id3">플래시 메시지를 필터링하기</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-patterns/jquery">jQuery로  AJAX 처리하기</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/jquery#id1">jQuery 로딩하기</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/jquery#id2">내 사이트는 어디에 있는가?</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/jquery#json">JSON 뷰 함수</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/jquery#html">HTML</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-patterns/errorpages">커스텀 오류 페이지</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/errorpages#id2">공통 오류 코드</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/errorpages#id3">오류 핸들러</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-patterns/lazyloading">지연 로딩 뷰(Lazily Loading Views)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/lazyloading#url">중앙집중식 URL 맴으로 변환하기</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/lazyloading#id1">늦은 로딩</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-patterns/mongokit">Flask에서 MongoKit 사용하기</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/mongokit#id1">선언 부분</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/mongokit#pymongo">PyMongo 호환성 계층</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-patterns/favicon">파비콘 추가하기</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/favicon#id2">추가로 볼 내용</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-patterns/streaming">컨텐트 스트리밍하기</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/streaming#id2">기본 사용법</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/streaming#id3">템플릿에서 스트리밍</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/streaming#id4">컨텍스트를 가진 스트리밍</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-patterns/deferredcallbacks">지연된(deferred) 요청 콜백</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/deferredcallbacks#id1">데코레이터</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/deferredcallbacks#id2">지연된 함수의 호출</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-patterns/deferredcallbacks#id3">실제적인 예제</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-patterns/methodoverrides">HTTP 메소드 오버라이드 추가하기</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-patterns/requestchecksum">요청한 내용에 대한 체크섬</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-deploying/index">배포 옵션</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-deploying/mod_wsgi">mod_wsgi (아파치)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-deploying/mod_wsgi#id1"><cite>mod_wsgi</cite> 설치하기</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-deploying/mod_wsgi#wsgi"><cite>.wsgi</cite> 파일 생성하기</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-deploying/mod_wsgi#id2">아파치 설정하기</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-deploying/mod_wsgi#id6">문제해결</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-deploying/mod_wsgi#id9">자동 리로딩 지원</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-deploying/mod_wsgi#id12">가상 환경에서 실행하기</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-deploying/wsgi-standalone">독립적인 WSGI 컨테이너</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-deploying/wsgi-standalone#gunicorn">Gunicorn</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-deploying/wsgi-standalone#tornado">Tornado</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-deploying/wsgi-standalone#gevent">Gevent</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-deploying/wsgi-standalone#twisted-web">Twisted Web</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-deploying/wsgi-standalone#deploying-proxy-setups">프록시 설정</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-deploying/uwsgi">uWSGI</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-deploying/uwsgi#uwsgi-app">uwsgi로 app 시작하기</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-deploying/uwsgi#nginx">nginx 설정하기</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-deploying/fastcgi">FastCGI</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-deploying/fastcgi#fcgi"><cite>.fcgi</cite> 파일 생성하기</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-deploying/fastcgi#id3">아파치 설정하기</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-deploying/fastcgi#lighttpd">lighttpd 설정하기</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-deploying/fastcgi#nginx">nginx 설정하기</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-deploying/fastcgi#id8">FastCGI 프로세스 실행하기</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-deploying/fastcgi#id10">디버깅</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-deploying/cgi">CGI</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-deploying/cgi#id1"><cite>.cgi</cite> 파일 만들기</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-deploying/cgi#id2">서버 설정</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-becomingbig">크게 만들기</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-becomingbig#id2">소스코드를 읽어라.</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-becomingbig#hook">훅(Hook)하고. 확장하라.</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-becomingbig#id4">서브클래싱하라.</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-becomingbig#id5">미들웨어로 감싸라.</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-becomingbig#id7">분기하라.</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-becomingbig#id8">프로페셔널처럼 규모를 조절하라.</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-becomingbig#id9">커뮤니티와 논의해라.</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-api">API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api#application-object">어플리케이션 객체(Application Object)</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api#blueprint-objects">블루프린트 객체(Blueprint Objects)</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api#incoming-request-data">유입되는 요청 데이터(Incoming Request Data)</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api#response-objects">응답 객체(Response Objects)</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api#sessions">세션(Sessions)</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api#session-interface">Session Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api#test-client">Test Client</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api#application-globals">Application Globals</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api#useful-functions-and-classes">Useful Functions and Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api#message-flashing">Message Flashing</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api#module-flask.json">JSON Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api#template-rendering">Template Rendering</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api#configuration">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api#extensions">Extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api#stream-helpers">Stream Helpers</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api#useful-internals">Useful Internals</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api#signals">Signals</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api#class-based-views">Class-Based Views</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api#url-route-registrations">URL Route Registrations</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api#view-function-options">View Function Options</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-design">Design Decisions in Flask</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-design#the-explicit-application-object">The Explicit Application Object</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-design#the-routing-system">The Routing System</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-design#one-template-engine">One Template Engine</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-design#micro-with-dependencies">Micro with Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-design#thread-locals">Thread Locals</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-design#what-flask-is-what-flask-is-not">What Flask is, What Flask is Not</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-htmlfaq">HTML/XHTML FAQ</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-htmlfaq#history-of-xhtml">History of XHTML</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-htmlfaq#history-of-html5">History of HTML5</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-htmlfaq#html-versus-xhtml">HTML versus XHTML</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-htmlfaq#what-does-strict-mean">What does &#8220;strict&#8221; mean?</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-htmlfaq#new-technologies-in-html5">New technologies in HTML5</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-htmlfaq#what-should-be-used">What should be used?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-security">Security Considerations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-security#cross-site-scripting-xss">Cross-Site Scripting (XSS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-security#cross-site-request-forgery-csrf">Cross-Site Request Forgery (CSRF)</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-security#json-security">JSON Security</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-unicode">Unicode in Flask</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-unicode#automatic-conversion">Automatic Conversion</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-unicode#the-golden-rule">The Golden Rule</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-unicode#encoding-and-decoding-yourself">Encoding and Decoding Yourself</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-unicode#configuring-editors">Configuring Editors</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-extensiondev">Flask Extension Development</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-extensiondev#anatomy-of-an-extension">Anatomy of an Extension</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-extensiondev#hello-flaskext">&#8220;Hello Flaskext!&#8221;</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-extensiondev#setup-py">setup.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-extensiondev#flask-sqlite3-py">flask_sqlite3.py</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-extensiondev#initializing-extensions">Initializing Extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-extensiondev#the-extension-code">The Extension Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-extensiondev#using-app-ctx-stack">Using _app_ctx_stack</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-extensiondev#teardown-behavior">Teardown Behavior</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-extensiondev#learn-from-others">Learn from Others</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-extensiondev#approved-extensions">Approved Extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-extensiondev#extension-import-transition">Extension Import Transition</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-styleguide">Pocoo Styleguide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-styleguide#general-layout">General Layout</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-styleguide#expressions-and-statements">Expressions and Statements</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-styleguide#naming-conventions">Naming Conventions</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-styleguide#docstrings">Docstrings</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-styleguide#comments">Comments</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-upgrading">Upgrading to Newer Releases</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-upgrading#version-0-10">Version 0.10</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-upgrading#version-0-9">Version 0.9</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-upgrading#version-0-8">Version 0.8</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-upgrading#version-0-7">Version 0.7</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-upgrading#bug-in-request-locals">Bug in Request Locals</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-upgrading#upgrading-to-new-teardown-handling">Upgrading to new Teardown Handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-upgrading#manual-error-handler-attaching">Manual Error Handler Attaching</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-upgrading#blueprint-support">Blueprint Support</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-upgrading#version-0-6">Version 0.6</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-upgrading#version-0-5">Version 0.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-upgrading#version-0-4">Version 0.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-upgrading#version-0-3">Version 0.3</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-upgrading#configuration-support">Configuration Support</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-upgrading#logging-integration">Logging Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-upgrading#categories-for-flash-messages">Categories for Flash Messages</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-license">License</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-license#authors">Authors</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-license#general-license-definitions">General License Definitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-license#flask-license">Flask License</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-license#flask-artwork-license">Flask Artwork License</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html#document-index">Flask</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html#document-index">Docs</a> &raquo;</li>
      
    <li>Flask 0.11-dev documentation</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="https://github.com/liks79/flask/blob/docs-korean/docs/index.rst" class="fa fa-github"> Edit on GitHub</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="flask">
<h1>Flask의 세계에 오신것을 환영합니다.<a class="headerlink" href="#flask" title="제목 주소">¶</a></h1>
<img alt="Flask: web development, one drop at a time" class="floatingflask" src="_images/logo-full1.png" />
<p>Flask 문서에 오신것을 환영합니다. 이 문서는 다양한 파트로 나누어져 있습니다.
저자는 <a class="reference internal" href="index.html#installation"><span>설치하기</span></a> 와 <a class="reference internal" href="index.html#quickstart"><span>빠르게 시작하기</span></a> 를 먼저 보실것을 추천합니다.
<a class="reference internal" href="index.html#quickstart"><span>빠르게 시작하기</span></a> 뿐만아니라, 어떻게 Flask 어플리케이션을 만들 수 있는지 좀 더 상세하게 다루는  <a class="reference internal" href="index.html#tutorial"><span>튜토리얼</span></a>  또한 볼 수 있습니다.</p>
<dl class="docutils">
<dt>만약 여러분이 오히려 Flask의 내부로 직접  뛰어 들고 싶은 경우라면,</dt>
<dd><a class="reference internal" href="index.html#api"><span>API</span></a> 문서를 확인하십시오. 일반적으로 사용되는 패턴들은</dd>
</dl>
<p><a class="reference internal" href="index.html#patterns"><span>Flask를 위한 패턴들</span></a> 섹션을 확인하면 됩니다..</p>
<p>Flask는 두개의 외부 라이브러리에 의존합니다.: 바로 <a class="reference external" href="http://jinja.pocoo.org/2/">Jinja2</a> 템플릿엔진과 <a class="reference external" href="http://werkzeug.pocoo.org/">Werkzeug</a> WSGI 툴킷입니다.  이 라이브러리들은 이 문서에서 다루지않습니다.
만약 여러분이 이 라이브러리들에 대해서 깊이 알고 싶다면 다음의 링크를 확인하십시오.</p>
<ul class="simple">
<li><a class="reference external" href="http://jinja.pocoo.org/2/documentation/">Jinja2 Documentation</a></li>
<li><a class="reference external" href="http://werkzeug.pocoo.org/documentation/">Werkzeug Documentation</a></li>
</ul>
<div class="section" id="id1">
<h2>사용자 가이드<a class="headerlink" href="#id1" title="제목 주소">¶</a></h2>
<p>이 문서의 사용자 가이드 파트에서는, Flask에 관한 일부 배경 정보들로 시작해서  지시사항을 따라하는 Flask 웹 개발을위한 단계별 지침에 초점을 맞추고 있습니다..</p>
<div class="toctree-wrapper compound">
<span id="document-foreword"></span><div class="section" id="id1">
<h3>머리말<a class="headerlink" href="#id1" title="제목 주소">¶</a></h3>
<p>Flask를 시작하기 전에 먼저 이글을 읽어주시기 바랍니다. 이 글이 여러분의 프로젝트에서 이것을 사용하여야 하거나 사용하지 말아야 할때에 해당 목적과 의도에 대한 일부 질문들에 대한 답변이 될 수 있기를 희망합니다.</p>
<div class="section" id="micro">
<h4>&#8220;마이크로(Micro)&#8221;는 무엇을 뜻하는가?<a class="headerlink" href="#micro" title="제목 주소">¶</a></h4>
<p>“마이크로”는 여러분의 웹 어플리케이션이 하나의 파이썬 파일으로 개발되야한다는 걸 말하는게 아니다.(그렇게 해석될 수 도 있겠지만…) 또한, 기능적으로 부족하다는걸 의미하지도 않는다. 마이크로 프레임워크(Microframework)에서의 “마이크로”는 핵심기능만 간결하게 유지하지만, 확장가능한 것을 목적으로 한다. Flask는 여러분을 위해 데이타베이스를 선택해주지 않는다. Flask에서 제공하는 템플릿 엔진을 변경하는것은 쉽다. 그밖에 모든것은 여러분에게 달려있고, 그래서 Flask는 여러분이 필요한 모든것일 수 있고, 필요없는것은 하나도 없을것이다.</p>
</div>
<div class="section" id="id2">
<h4>설정과 관례<a class="headerlink" href="#id2" title="제목 주소">¶</a></h4>
<p>Flask로 시작할때, 여러분은 잘 정의된 기본값이 있는 많은 설정값들과 몇가지 관례를 볼 수 있다. 템플릿과 정적파일은 어플리케이션의 파이썬 소스 디렉토리의 하위 디렉토리에 templates과 statics에 저장된다. 이 방식은 변경할 수 있지만, 처음부터 반드시 그럴 필요는 없다.</p>
</div>
<div class="section" id="flask">
<h4>Flask를 이용하여 성장시키기<a class="headerlink" href="#flask" title="제목 주소">¶</a></h4>
<blockquote>
<div>여러분이 Flask를 가지고 개발할때, 운영을 위해 여러분의 프로젝트와 통합할 여러 종류의 확장을 찾게된다. Flask 핵심 개발팀은 많은 확장을 검토했고 그것들이 앞으로의 배포판과 어긋나지 않는다는것을 보증한다.</div></blockquote>
<p>여러분의 코드의 규모가 점점 커지면서, 여러분의 프로젝트에 설계에 적합한 선택을 할 기회가 온다 Flask는 계속적으로 파이썬이 제공하는 최고의 모듈에 간결한 연결층을 제공할 것이다. 여러분은 SQLAlchemy이나 다른 디비툴 또는 알맞게 비관계형 데이타 저장소로 고급 패턴을 만들수도 있고 파이썬 웹 인터페이스인 WSGI를 위한 프레임웍에 관계없이 사용할 수 있는 툴을 이용할 수 있다.</p>
<p>Flask는 프레임웍의 기능을 변경하기 위한 많은 훅(hook)을 포함한다. 그것보다 더 많이 변경하고 싶다면 Flask class 자체를 상속하면 된다. 여러분이 subclassing에 관심이 있다면 <a class="reference internal" href="index.html#becomingbig"><span>크게 만들기</span></a> 챕터를 확인한다. 디자인 패턴이 궁금하다면 <a class="reference internal" href="index.html#design"><span>Design Decisions in Flask</span></a> 에 대한 섹션으로 넘어가라.</p>
<p>계속하기 <a class="reference internal" href="index.html#installation"><span>설치하기</span></a>,  <a class="reference internal" href="index.html#quickstart"><span>빠르게 시작하기</span></a>, 혹은 <a class="reference internal" href="index.html#advanced-foreword"><span>경험있는 프로그래머를 위한 머릿글</span></a>.</p>
</div>
</div>
<span id="document-advanced_foreword"></span><div class="section" id="advanced-foreword">
<span id="id1"></span><h3>경험있는 프로그래머를 위한 머릿글<a class="headerlink" href="#advanced-foreword" title="제목 주소">¶</a></h3>
<div class="section" id="flask">
<h4>Flask에서 쓰레드 로컬<a class="headerlink" href="#flask" title="제목 주소">¶</a></h4>
<p>Flask에 적용된 설계 원칙 중 하나는 단순한 업무는 단순해야한다는 것이다. 그런 종류의 업무들은 많은 코드를 요구하지 않아야 하지만, 여러분을 제약해서도 안된다. 그런 이유로 Flask는 몇몇 사람들을 놀라게 하거나, 정통적인 방식이 아니라고 생각할 수도 있는 몇개의 설계 원칙을 갖고 있다. 예를 들면, Flask는 내부적으로 쓰레드로컬방식을  사용해, 쓰레드-안전한 상태를 유지하기 위해 하나의 요청에서 함수들이 돌아가며 객체를 주고받을 필요가 없도록 했다. 이런 접근은 편리하지만, 의존 주입을 하거나 요청에 고정된 값을 사용하는 코드를 재사용하려할 때 유효한 요청 문맥을 요구한다. Flask 프로젝트는 쓰레드로컬에 대해 투명하고, 숨기지 않고, 심지어 사용되는 코드와 문서에서 드러내고 있다.</p>
</div>
<div class="section" id="id2">
<h4>웹개발에서 주의점<a class="headerlink" href="#id2" title="제목 주소">¶</a></h4>
<p>웹 어플리케이션을 개발할때에는 항상 보안에 대해 신경써야한다.</p>
<p>여러분이 웹 개발을 할때, 개발된 어플리케이션의 사용자들은 여러분의 서버에 사용자의 정보가 등록되고 남겨지는 것을 허용할 것이다. 사용자는 데이타에 있어서 여러분을 신뢰한다는 것이다. 만약 여러분이 직접 작성한 어플리케이션의 유일한 사용자라 할지라도, 자신의 데이타가 안전하기를 원할 것이다.</p>
<p>불행히도, 웹 어플리케이션의 보안이 타협되는 여러 가지 경우가 있다. 프라스크는 현대의 웹 어플리케이션의 가장 일반적인 보안 문제인 XSS로 부터 여러분을 보호한다. 굳이 여러분이 안전하지 않게 작성된 HTML을 안전하게 변환하지 않더라도, Flask와 그 하부의 Jinja2 템플릿 엔진이 여러분을 보호해준다. 그러나 보안문제를 유발하는 더 많은 경우가 있다.</p>
<p>이 문서는 보안에 있어 주의를 요구하는 웹 개발의 측면을 여러분에게 당부하고 있다. 이런 보안 관점의 몇몇은 일부 사람이 생각하는것 보다 훨씬 복잡하고, 우리 모두는 때때로 취약점이 이용될것이라는 가능성을 뛰어난 공격자가 우리의 어플리케이션의 취약점을 찾아낼때까지 낮게 점치곤한다. 그리고 여러분의 어플리케이션이 공격자가 칩입할 만큼 중요하지 않다고 생각하지 마라. 공격의 종류에 따라, 자동화된 bot이 여러분의 데이타베이스에 스팸을 채우기 위해 탐색하거나, 악성코드를 링크하는 방식과 같은 기회들이 있다.</p>
<p>Flask는 여러분이 반드시 주의하며 개발해야하고, 요구사항에 맞춰 개발할때 취약점을 조심해야 하는 측면은 어느 다른 프레임워크와도 같다.</p>
</div>
<div class="section" id="python3">
<h4>Python3의 상태<a class="headerlink" href="#python3" title="제목 주소">¶</a></h4>
<p>요즘 파이썬 공동체는 파이썬 프로그래밍 언어의 새로운 버전을 지원하기 위한 라이브러리의 개선 과정중이다. 상황은 대단히 개선되고 있지만, 우리들이 파이썬3로 넘어가는데 걸림돌이 되는 몇가지 이슈가 있다. 이 문제들은 부분적으로 오래동안 검토되지 않은 언어의 변화에 의해 야기됐다. 부분적으로는 우리들이 저수준API가 파이썬3에서 유니코드의 차이점에 맞춰 어떤식으로 바뀌어야 하는지 해결해내지 못했다는 점도 있다.</p>
<p>Werkzeug과 Flask는 그 변경에 대한 해결책을 찾는 순간 파이썬3로 포팅되고, 파이썬3으로 개발된 버전의 업그레이드에 대한 유용한 팁을 제공할 것이다. 그때까지, 여러분은 개발하는 동안 파이썬2.6이나 2.7을 파이썬3 경고를 활성화한 상태로 사용할 것을 권고한다. 여러분이 근래에 파이썬3로 업그레이드를 계획중이라면 <a class="reference external" href="http://lucumr.pocoo.org/2011/1/22/forwards-compatible-python/">How to write forwards compatible
Python code</a>.를 읽는것을 적극 추천한다.</p>
<p>계속해서 <a class="reference internal" href="index.html#installation"><span>설치하기</span></a> 과 <a class="reference internal" href="index.html#quickstart"><span>빠르게 시작하기</span></a> 살펴볼 수 있다.</p>
</div>
</div>
<span id="document-installation"></span><div class="section" id="installation">
<span id="id1"></span><h3>설치하기<a class="headerlink" href="#installation" title="제목 주소">¶</a></h3>
<p>Flask는 <a class="reference external" href="http://werkzeug.pocoo.org/">Werkzeug</a> 와 <a class="reference external" href="http://jinja.pocoo.org/2/">Jinja2</a>
라이브러리에 의존적이다. Werkzeug는 웹어플리케이션과 다양한 서버 사이의
개발과 배포를 위한 표준 파이썬 인터페이스인 WSGI를 구현한 툴킷이다.
Jinja2 는 HTML 템플릿을 렌더링 하는 템플릿엔진이다.</p>
<p>여러분은 어떻게 여러분의 컴퓨터에 Flask와 관련된 모든 것들을 빠르게
얻을 수 있을까? 선택할 수 있는 방법은 여러가지가 있으나 가장 강력한
방법은 virtualenv을 사용하는 것이다. 그래서 먼저 virtualenv를 살펴보려 한다.</p>
<p>Flask 설치를 시작하기 위해 파이썬 2.5 또는 상위 버전을 사용할 것이다.
그래서 최신 파이썬 2.x버전이 설치되어 있는 것을 확인해라.
이 글을 쓰는 시점에 WSGI 명세서는 아직 파이썬 3을 위해 마무리되지 않았다.
그래서 Flask는 파이썬 3.x 버전을 지원할 수 없다.</p>
<div class="section" id="virtualenv">
<span id="id2"></span><h4>virtualenv<a class="headerlink" href="#virtualenv" title="제목 주소">¶</a></h4>
<p>virtualenv는 아마도 당신이 개발 과정에서 꼭 사용해야만 하는 툴일것이다.
만약 당신이 운영서버에 쉘(shell) 환경에서 접속해야 하고 다양한 파이썬실행
환경이 필요하다면 유용하게 사용할 수 있는 툴이다.</p>
<p>virtualenv는 어떤 문제를 해결해 줄 수 있는가? 만약 당신이 나처럼 Python을
많이 사용하고 있고 Flask 기반의 웹 어플리케이션과 같이 현재 사용하고 있는
것과 다른 파이썬 환경을 사용해야 한다면 virtualenv를 사용해 볼 수 있는 좋은
기회가 될 수 있다. 게다가 당신이 진행하고 있는 더 많은 프로젝트들이 서로 다른
Python 버전에서 작동해야 한다거나 혹은 서로 다른 버전의 Python 라이브러리들
에서 작동해야 한다면 어떨까? 현실을 직시해보자! 많은 라이브러리들은 종종
하위버전 호환성들을 깨뜨린다. 그리고 어떤 심각한 응용프로그램이라 하더라도
라이브러리와 의존관계가 없을 수는 없다. 그렇다면 두개 혹은 더 많은 당신의
프로젝트들의 의존관계의 충돌을 해결하기 위해서 무엇을 할것인가?</p>
<p>Virtualenv가 당신을 구해 줄것이다. virtualenv를 이용하여 Python을 아무런 문제
없이 각각의 프로젝트 환경에 맞게 다중설치가 가능하도록 해준다. 이방법은 실제로
독립된 버전의 Python 실행 환경에 단순히 복사하는 것이 아니라 서로 다른 프로젝트
환경이 독립적으로 실행 환경을 명백하게 가져갈 수 있도록 격리 시키는 방법이다.
이제 virtualenv가 어떻게 작동하는지 알아보자!</p>
<p>만약 당신이 Mac OS X 혹은 Linux 환경이라면, 다음의 두가지 명령어로 virtualenv를
작동시킬 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre>$ sudo easy_install virtualenv
</pre></div>
</div>
<p>혹은 좀더 나은 방법으로:</p>
<div class="highlight-python"><div class="highlight"><pre>$ sudo pip install virtualenv
</pre></div>
</div>
<p>위의 방법을 사용하면 당신의 시스템에 virtualenv가 설치 될걸이다. 아마도 당신의
시스템에서 사용하는 package manager를 사용할 수 도 있다.
만약 당신이 우분투를 사용한다면</p>
<div class="highlight-python"><div class="highlight"><pre>$ sudo apt-get install python-virtualenv
</pre></div>
</div>
<p>만약 당신이 Windows 를 사용하고 있거나 <cite>easy_install</cite> 명령어를 가지고 있지 않다면,
명령어를 먼저 설치해야 한다.  <a class="reference internal" href="index.html#windows-easy-install"><span>Windows에서의 pip 와 distribute</span></a> 을 확인하여 설치 방법에 대한 자세한
정보를 확인할 수 있다. easy_install이 설치가 완료되면 위와 같은 방법으로 명령어를 실행하여
virtualenv를 설치할 수 있다. 다만, Windows 환경에서는 <cite>sudo</cite> 가 필요없다.</p>
<p>일단 virtualenv가 설치되었다면, 쉘을 실행시키고 자신만의 실행환경을 만들 수 있다.
나는 보통 프로젝트 폴더를 만들고 폴더안에서  <cite>venv</cite> 를 이용하여 다음과 같이 작업한다.</p>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre>$ mkdir myproject
$ cd myproject
$ virtualenv venv
New python executable in venv/bin/python
Installing distribute............done.
</pre></div>
</div>
</div></blockquote>
<p>이제, 당신이 해당 프로젝트에서 작업하고 싶을 때마다, 그에 해당하는
실행환경을 활성화 시킬 수 있다. OS X혹은 Linux 환경이라면 다음과 같이
실행한다.:</p>
<div class="highlight-python"><div class="highlight"><pre>$ . venv/bin/activate
</pre></div>
</div>
<p>만약 당신이 Windows 사용자라면, 다음과 같이 실행한다.:</p>
<div class="highlight-python"><div class="highlight"><pre>$ venv\scripts\activate
</pre></div>
</div>
<p>어떤 방식이든, 당신은 이제 virtualenv 를 사용할 수밖에 없을 것이다.
(virtualenv이 활성화된 상태를 보여주기 위핸 당신의 쉘 프롬프트가 어떻게 변화
되는지 주목하라).</p>
<p>이제 당신은 다음의 명령어를 입력하여 활성화된 virtualenv 를 통해 Flask를
설치할 수 있다.:</p>
<div class="highlight-python"><div class="highlight"><pre>$ pip install Flask
</pre></div>
</div>
<p>몇초동안만 기다리면 설치가 완료 된다.</p>
</div>
<div class="section" id="id3">
<h4>시스템 전체에 적용하여 설치<a class="headerlink" href="#id3" title="제목 주소">¶</a></h4>
<p>이 방법이 가능하긴 하지만, 추천하지는 않겠다.
단지 루트(root)권한을 이용하여 <cite>pip</cite> 를 실행시키면 된다.:</p>
<div class="highlight-python"><div class="highlight"><pre>$ sudo pip install Flask
</pre></div>
</div>
<p>(Windows 시스템에서는 , 위 명령어를 명령어 프롬프트에서 관리자(administrator) 권한으로
실행시키면 된다. 그리고 <cite>sudo</cite> 는 생략하자.)</p>
</div>
<div class="section" id="id4">
<h4>위태로운 모험 하기<a class="headerlink" href="#id4" title="제목 주소">¶</a></h4>
<p>만약 당신이 가장 최신버전의 Flask를 이용하여 작업을 하고 싶다면,
두가지 방법이 있다.: <cite>pip</cite> 를 이용하여 작업환경으로 Flask의 개발중 버전을  가져오거나,
git checkout을 사용할 수 있다. 어떤 방법을 사용하든, virtualenv의 사용을 추천한다.</p>
<p>새로운 virtualenv를 만들고 git checkout을 실행하여 개발모드의 Flask를 실행할 수 있다.:</p>
<div class="highlight-python"><div class="highlight"><pre>$ git clone http://github.com/mitsuhiko/flask.git
Initialized empty Git repository in ~/dev/flask/.git/
$ cd flask
$ virtualenv venv --distribute
New python executable in venv/bin/python
Installing distribute............done.
$ . venv/bin/activate
$ python setup.py develop
...
Finished processing dependencies for Flask
</pre></div>
</div>
<p>이 방법을 통해 의존관계에 있는 것들을 가져오게 되고 git에 등록된 현재버전을
virtualenv안으로 가져오게 된다. 그다음에 <code class="docutils literal"><span class="pre">git</span> <span class="pre">pull</span> <span class="pre">origin</span></code> 을 통하여 최신
버전으로 업데이트가 가능하다.</p>
<p>git을 사용하지 않고 최신 버전을 가져오는 방법은 다음과 같다.:</p>
<div class="highlight-python"><div class="highlight"><pre>$ mkdir flask
$ cd flask
$ virtualenv venv --distribute
$ . venv/bin/activate
New python executable in venv/bin/python
Installing distribute............done.
$ pip install Flask==dev
...
Finished processing dependencies for Flask==dev
</pre></div>
</div>
</div>
<div class="section" id="windows-pip-distribute">
<span id="windows-easy-install"></span><h4>Windows에서의 <cite>pip</cite> 와 <cite>distribute</cite><a class="headerlink" href="#windows-pip-distribute" title="제목 주소">¶</a></h4>
<p>Windows 환경에서는 <cite>easy_install</cite> 의 설치가 조금 복잡해 보인다. 하지만 그래도 그리
어렵지 않다. 가장 쉬운 방법은 <a class="reference external" href="http://python-distribute.org/distribute_setup.py">distribute_setup.py</a> 를 다운로드 받아서 실행하는 것이다.
다운로드 폴더를 열고 다운 받은 파일을 더블클릭한다.</p>
<p>다음으로, <cite>easy_install</cite> 명령어를 <cite>PATH</cite> 에 실행경로로 추가하고 Python 설치 디렉토리의
Scripts의 경로도 실행경로에 추가하여야 한다. 이렇게 하려면, 바탕화면이나 시작메뉴의 <cite>내컴퓨터</cite>
아이콘을 마우스 오른쪽 버튼으로 클릭하여 나오는 메뉴에서 &#8220;등록정보&#8221;를 선택하여 실행한다.
이제 해당 메뉴에서 &#8220;고급 시스템 설정&#8221;(Windows XP의 경우 &#8220;고급&#8221; 탭) 을 선택한다.
다음으로 &#8220;환경 변수&#8221;를 선택한 후 &#8220;PATH&#8221; 를 클릭하여 &#8220;시스템 변수&#8221; 항목에 Python 설치 경로와
Python의 Scripts 폴더이름을 실행경로로 등록한다. 주의할 점은 기존에 설정되어 있는 값과
세미콜론(;)으로 구분되어져야 한다는 점이다. 설치된 Python 버전이 2.7이고 기본 경로에
설치되었다면 다음과 같을 것이다.:</p>
<div class="highlight-python"><div class="highlight"><pre>;C:\Python27\Scripts
</pre></div>
</div>
<p>마침내 당신은 해냈다! 이제 제대로 동작하는지 확인해 보자, 명령어 창을 열고 프롬프트에
<code class="docutils literal"><span class="pre">easy_install</span></code>. 만약 Windows Vista 혹은 Windows7 을 사용중이고 &#8216;User Account Control&#8217;
이 활성화 되어 있다면 관리자 권한으로 진행하여야 한다.</p>
<p>이제 당신은 <code class="docutils literal"><span class="pre">easy_install</span></code> 를 손에 넣었다! <code class="docutils literal"><span class="pre">pip</span></code> 를 설치해 보자:</p>
<div class="highlight-python"><div class="highlight"><pre>&gt; easy_install pip
</pre></div>
</div>
</div>
</div>
<span id="document-quickstart"></span><div class="section" id="quickstart">
<span id="id1"></span><h3>빠르게 시작하기<a class="headerlink" href="#quickstart" title="제목 주소">¶</a></h3>
<p>Flask를 시작하기 원합니까? 이 장은 Flask에 대해 알맞은 소개를 한다. 이 장은 여러분이 이미 Flask를 설치했다고 가정할것이고, 설치가 안됐다면 <a class="reference internal" href="index.html#installation"><span>설치하기</span></a> 섹션으로 넘어가기 바란다.</p>
<div class="section" id="id2">
<h4>기본 애플리케이션<a class="headerlink" href="#id2" title="제목 주소">¶</a></h4>
<p>기본 Flask 어플리케이션은 다음과 같은 모습이다.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">hello_world</span><span class="p">():</span>
    <span class="k">return</span> <span class="s">&#39;Hello World!&#39;</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>이 내용을 <cite>hello.py</cite> (아니면 비슷한 다른 이름으로) 저장하고 파이썬 인터프리터로 실행한다. 여러분이 작성한 어플리케이션을 <a href="#id3"><span class="problematic" id="id4">`</span></a>flask.py`로 호출하지 않도록 주의해라. 왜냐하면 Flask 자체와 충돌이 나기 때문이다.</p>
<div class="highlight-python"><div class="highlight"><pre>$ python hello.py
 * Running on http://127.0.0.1:5000/
</pre></div>
</div>
<p>자, 이제 웹브라우져를 열고 <a class="reference external" href="http://127.0.0.1:5000/">http://127.0.0.1:5000/</a>, 로 이동해보자 그러면, 여러분이 작성한 hello world greeting이 화면에 나와야한다.</p>
<p>그렇다면, 위의 코드는 무슨 일은 한걸까?</p>
<ol class="arabic simple">
<li>먼저 우리는 <a class="reference internal" href="index.html#flask.Flask" title="flask.Flask"><code class="xref py py-class docutils literal"><span class="pre">Flask</span></code></a> class를 임포트했다. 이 클래스의 인스턴스가 우리의
WSGI어플리케이션이 될것이다. 첫번째 인자는 이 어플리케이션의 이름이다. 여러분이 단일 모듈을 사용한다면(위의 예제처럼),여러분은 <cite>__name__`을 사용해야한다. 왜냐하면, 어플리케이션으로 시작되는지, 혹은 모듈로 임포트되는지에 따라 이름이 달라지기 때문이다.(`</cite>&#8216;__main__&#8217;`` 대 실제로 임포트한 이름) 더 자세한 정보는 <a class="reference internal" href="index.html#flask.Flask" title="flask.Flask"><code class="xref py py-class docutils literal"><span class="pre">Flask</span></code></a> 문서를 참고해라.</li>
<li>다음은 Flask class의 인스턴스를 생성한다. 인자로 모듈이나 패키지의 이름을 넣는다.
이것은 플라스크에서 팀플릿이나 정적파일을 찾을때 필요하다.</li>
<li><a class="reference internal" href="index.html#flask.Flask.route" title="flask.Flask.route"><code class="xref py py-meth docutils literal"><span class="pre">route()</span></code></a> 데코레이터를 사용해서 Flask에게 어떤 URL이 우리가
작성한 함수를 실행시키는지 알려준다.</li>
<li>작성된 함수의 이름은 그 함수에 대한 URL을 생성하는데 사용되고(url_for 함수 참고),
그 함수는 사용자 브라우저에 보여줄 메시지를 리턴한다.</li>
<li>최종적으로 <a class="reference internal" href="index.html#flask.Flask.run" title="flask.Flask.run"><code class="xref py py-meth docutils literal"><span class="pre">run()</span></code></a> 함수를 사용해서 우리가 개발한 어플리케이션을
로컬서버로 실행한다. 소스파일을 모듈이 아닌 python 인터프리터를 이용해서 직접 실행한다면 <code class="docutils literal"><span class="pre">if</span> <span class="pre">__name__</span> <span class="pre">==</span> <span class="pre">'__main__':</span></code> 이 문장은 우리가 실행한 서버가 현재 동작되는 유일한 서버라는 것을 보장한다.</li>
</ol>
<p>실행된 서버를 중지하려면, control-C를 누른다.
.. _public-server:</p>
<div class="admonition- admonition">
<p class="first admonition-title">외부에서 접근 가능한 서버</p>
<p>위의 서버를 실행했다면, 그 서버는 네트워크상에 있는 다른 컴퓨터에서 접근이 안되고
여러분의 로컬서버에서만 접근 가능하다. 이것이 기본설정인 이유는 디버그모드상에서
어플리케이션의 사용자가 임의의 파이썬코드를 여러분의 컴퓨터에서 실행할 수 있기 때문이다.</p>
<p>여러분이 <cite>debug</cite> 모드를 해제하거나 여러분의 네트워크상에 있는 사용자들을 신뢰한다면,
다음과 같이 간단히 <a class="reference internal" href="index.html#flask.Flask.run" title="flask.Flask.run"><code class="xref py py-meth docutils literal"><span class="pre">run()</span></code></a> 메소드의 호출을 변경해서 서버의 접근을
오픈할 수 있다.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s">&#39;0.0.0.0&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p class="last">위의 변경은 여러분의 OS에게 모든 public IP를 접근가능도록 설정한다.</p>
</div>
</div>
<div class="section" id="debug-mode">
<span id="id5"></span><h4>디버그 모드<a class="headerlink" href="#debug-mode" title="제목 주소">¶</a></h4>
<p><a class="reference internal" href="index.html#flask.Flask.run" title="flask.Flask.run"><code class="xref py py-meth docutils literal"><span class="pre">run()</span></code></a> 메소드는 로컬개발서버를 실행시키기에 좋지만 코드 변경후에
수동으로 재시작해야한다. 플라스크는 그런 번거로운것을 개선한 방식을 제공한다. 여러분이
디버그모드를 지원하면, 서버는 코드변경을 감지하고 자동으로 리로드하고, 문제가 발생하면
문제를 찾을수 있도록 디버거를 제공한다.</p>
<p>디버깅을 활성화하는 두가지 방식이 있다. 한가지는 어플리케이션 객체에 플래그로 설정하는 방식이거나</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">app</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>어플리케이션을 실행할때 파라미터로 넘겨주는 방식이다.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>두 메소드는 같은 결과를 보여준다.</p>
<div class="admonition- admonition">
<p class="first admonition-title">주의</p>
<p class="last">대화식 디버거가 forking 환경에서 동작안됨에도 불구하고(운영서버에서는 거의 사용이
불가능함), 여전히 임의의 코드가 실행될 수 있다. 이런점은 주요 보안 취약점이 될 수
있으므로, <strong>운영 환경에서는 절대 사용하지 말아야한다</strong>.</p>
</div>
<p>디버거의 스크린샷:</p>
<img alt="screenshot of debugger in action" class="screenshot align-center" src="_images/debugger2.png" />
<p>디버거에 대해 좀 더 궁금하다면  <a class="reference internal" href="index.html#working-with-debuggers"><span>디버거로 작업하기</span></a> 를 참고 하기 바란다.</p>
</div>
<div class="section" id="id6">
<h4>라우팅<a class="headerlink" href="#id6" title="제목 주소">¶</a></h4>
<p>현대 웹 어플리케이션은 잘 구조화된 URL로 구성되있다. 이것으로 사람들은 URL을 쉽게 기억할
수 있고, 열악한 네트워크 연결 상황하의 기기들에서 동작하는 어플리케이션에서도 사용하기 좋다.
사용자가 인덱스 페이지를 거치지 않고 바로 원하는 페이지로 접근할 수 있다면, 사용자는 그
페이지를 좋아할 것이고 다시 방문할 가능성이 커진다.</p>
<p>위에서 본것처럼, <a class="reference internal" href="index.html#flask.Flask.route" title="flask.Flask.route"><code class="xref py py-meth docutils literal"><span class="pre">route()</span></code></a> 데코레이터는 함수와 URL을 연결해준다. 아래는 기본적인 예제들이다.</p>
<blockquote>
<div><p>&#64;app.route(&#8216;/&#8217;)
def index():</p>
<blockquote>
<div>return &#8216;Index Page&#8217;</div></blockquote>
<p>&#64;app.route(&#8216;/hello&#8217;)
def hello():</p>
<blockquote>
<div>return &#8216;Hello World&#8217;</div></blockquote>
</div></blockquote>
<p>하지만, 여기엔 더 많은것이 있다. 여러분은 URL을 동적으로 구성할 수 있고, 함수에 여러 룰을
덧붙일수있다.</p>
<div class="section" id="id7">
<h5>변수 규칙<a class="headerlink" href="#id7" title="제목 주소">¶</a></h5>
<p>URL의 변수 부분을 추가하기위해 여러분은 <code class="docutils literal"><span class="pre">&lt;variable_name&gt;``으로</span> <span class="pre">URL에</span> <span class="pre">특별한</span> <span class="pre">영역으로</span>
<span class="pre">표시해야된다.</span> <span class="pre">그</span> <span class="pre">부분은</span> <span class="pre">함수의</span> <span class="pre">키워드</span> <span class="pre">인수로써</span> <span class="pre">넘어간다.</span>&nbsp; <span class="pre">선택적으로,</span>
<span class="pre">``&lt;converter:variable_name&gt;</span></code> 으로 규칙을 표시하여 변환기를 추가할 수 있다.
여기 멋진 예제가 있다.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/user/&lt;username&gt;&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">show_user_profile</span><span class="p">(</span><span class="n">username</span><span class="p">):</span>
    <span class="c"># show the user profile for that user</span>
    <span class="k">return</span> <span class="s">&#39;User </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">username</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/post/&lt;int:post_id&gt;&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">show_post</span><span class="p">(</span><span class="n">post_id</span><span class="p">):</span>
    <span class="c"># show the post with the given id, the id is an integer</span>
    <span class="k">return</span> <span class="s">&#39;Post </span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">post_id</span>
</pre></div>
</div>
<p>다음과 같은 변환기를 제공한다. :</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><cite>int</cite></td>
<td>accepts integers</td>
</tr>
<tr class="row-even"><td><cite>float</cite></td>
<td>like <cite>int</cite> but for floating point values</td>
</tr>
<tr class="row-odd"><td><cite>path</cite></td>
<td>like the default but also accepts slashes</td>
</tr>
</tbody>
</table>
<div class="admonition-url admonition">
<p class="first admonition-title">유일한 URL과 리디렉션 동작</p>
<p>Flask의 URL 규칙은 Werkzeug의 라우팅 모듈에 기반한다. 그 라우팅 모듈의 기본 사상은 아파치나 초기 HTTP서버들에서 제공한 전례에 기반을 둔 잘 구성되고 유일한 URL을 보장하는것이다.</p>
<p>아래의 두가지 규칙을 살펴보자</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/projects/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">projects</span><span class="p">():</span>
    <span class="k">return</span> <span class="s">&#39;The project page&#39;</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/about&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">about</span><span class="p">():</span>
    <span class="k">return</span> <span class="s">&#39;The about page&#39;</span>
</pre></div>
</div>
<p>이 두 둘은 비슷해 보이지만, URL 정의에 있어서 뒷 슬래쉬(trailing slash) 사용이 다르다.
첫번째 경우는, <cite>projects</cite> 끝점에 대한 정규 URL은 뒷 슬래쉬를 포함한다.이점에서
파일시스템의 폴더와 유사하다. 뒷 슬래쉬 없이 URL에 접근하면, Flask가 뒷 슬래쉬를
가진 정규 URL로 고쳐준다.</p>
<p>그러나, 두번째 경우의 URL은 Unix계열의 파일의 경로명처럼 뒷 슬래쉬없이 정의됐다. 이
경우, 뒷 슬래쉬를 포함해서 URL에 접근하면 404”페이지를 찾지 못함” 에러를 유발한다.</p>
<p class="last">이것은 사용자가 뒷 슬래쉬를 잊어버리고 페이지에 접근했을때 상대적인 URL이 문제없이
동작하게한다. 이 방식은 아파치 및 다른 서버들이 동작하는 방식과 일치한다. 또한, URL을
유일하게 유지할 것이고, 검색엔진이 같은 페이지를 중복해서 색인하지 않도록 도와준다.</p>
</div>
</div>
<div class="section" id="url">
<span id="url-building"></span><h5>URL 생성<a class="headerlink" href="#url" title="제목 주소">¶</a></h5>
<p>플라스크가 URL을 맞춰줄수 있다면, URL을 생성할 수 있을까? 물론이다. 라우팅이 설정된 함수에
대한 URL을 얻어내기위해서 여러분은 <a class="reference internal" href="index.html#flask.url_for" title="flask.url_for"><code class="xref py py-func docutils literal"><span class="pre">url_for()</span></code></a> 함수를 사용하면 된다. 이
함수는 첫번째 인자로 함수의 이름과 URL 룰의 변수 부분에 대한 다수의 키워드를 인자로 받는다.
알수없는 인자는 쿼리 인자로 URL에 덧붙여진다. :</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">url_for</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">index</span><span class="p">():</span> <span class="k">pass</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/login&#39;</span><span class="p">)</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">login</span><span class="p">():</span> <span class="k">pass</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/user/&lt;username&gt;&#39;</span><span class="p">)</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">profile</span><span class="p">(</span><span class="n">username</span><span class="p">):</span> <span class="k">pass</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">app</span><span class="o">.</span><span class="n">test_request_context</span><span class="p">():</span>
<span class="gp">... </span> <span class="k">print</span> <span class="n">url_for</span><span class="p">(</span><span class="s">&#39;index&#39;</span><span class="p">)</span>
<span class="gp">... </span> <span class="k">print</span> <span class="n">url_for</span><span class="p">(</span><span class="s">&#39;login&#39;</span><span class="p">)</span>
<span class="gp">... </span> <span class="k">print</span> <span class="n">url_for</span><span class="p">(</span><span class="s">&#39;login&#39;</span><span class="p">,</span> <span class="nb">next</span><span class="o">=</span><span class="s">&#39;/&#39;</span><span class="p">)</span>
<span class="gp">... </span> <span class="k">print</span> <span class="n">url_for</span><span class="p">(</span><span class="s">&#39;profile&#39;</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="s">&#39;John Doe&#39;</span><span class="p">)</span>
<span class="gp">...</span>
<span class="go">/</span>
<span class="go">/login</span>
<span class="go">/login?next=/</span>
<span class="go">/user/John%20Doe</span>
</pre></div>
</div>
<p>(이 테스트에서  <a class="reference internal" href="index.html#flask.Flask.test_request_context" title="flask.Flask.test_request_context"><code class="xref py py-meth docutils literal"><span class="pre">test_request_context()</span></code></a> 를 사용한다. 이 함수는
플라스크에게 현재 파이썬 쉘에서 테스트를 하고 있음에도 지금 실제로 요청을 처리하고 있는것
처럼 상황을 제공한다. <a class="reference internal" href="#context-locals"><span>컨텍스트 로컬</span></a> 섹션에서 다시 설명이 언급된다).</p>
<p>왜 템플릿에 URL을 하드코딩하지 않고 URL을 얻어내기를 원하는가?
여기엔 세가지 적합한 이유가 있다.:</p>
<ol class="arabic">
<li><p class="first">URL역변환이 URL을 하드코딩하는것 보다 훨씬 설명적이다.
더 중요한것은, 이 방식은 전체적으로 URL이 어디있는지 기억할 필요없이
한번에 URL을 다 변경할 수 있다..</p>
</li>
<li><p class="first">URL을 얻어내는것은 특수 문자 및 유니코드 데이타를에 대한 이스케이핑을 명확하게
해주기때문에 여러분이 그것들을 처리할 필요가 없다..</p>
</li>
<li><dl class="first docutils">
<dt>여러분이 작성한 어플케이션이 URL의 최상위 바깥에 위치한다면 (예를 들면,</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">/</span></code> 대신에 <code class="docutils literal"><span class="pre">/myapplication</span></code>), <a class="reference internal" href="index.html#flask.url_for" title="flask.url_for"><code class="xref py py-func docutils literal"><span class="pre">url_for()</span></code></a> 가 그 위치를 상대적
위치로 적절하게 처리해줄것이다..</p>
</dd>
</dl>
</li>
</ol>
</div>
<div class="section" id="http">
<h5>HTTP 메소드<a class="headerlink" href="#http" title="제목 주소">¶</a></h5>
<p>HTTP(웹 어플리케이션에서 사용하는 프로토콜)는 URL 접근에 대해 몇가지 다른 방식을 제공한다.
기본적으로 <cite>GET</cite> 방식으로 제공되지만, <a class="reference internal" href="index.html#flask.Flask.route" title="flask.Flask.route"><code class="xref py py-meth docutils literal"><span class="pre">route()</span></code></a> 데코레이터에
<cite>methods</cite> 인자를 제공하면 다른  방식으로 변경할 수 있다. 아래에 몇가지 예가 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/login&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">,</span> <span class="s">&#39;POST&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">login</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s">&#39;POST&#39;</span><span class="p">:</span>
        <span class="n">do_the_login</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">show_the_login_form</span><span class="p">()</span>
</pre></div>
</div>
<p><cite>GET</cite> 방식이 나타난다면, <cite>HEAD</cite> 가 자동적으로 더해질것이다. 여러분들이 그것을 처리할
필요가 없다. <cite>HEAD</cite> 요청은 <a class="reference external" href="http://www.ietf.org/rfc/rfc2068.txt">HTTP RFC</a> (HTTP프로토콜을 설명하는 문서)의 요청으로써
처리된다는 것을 보장할 것이다. 그래서 여러분은 HTTP명세에 대한 그 부분을 완전히 신경쓰지
않아도 된다. 마찬가지로, 플라스크0.6에서는 <cite>OPTION</cite> 을 자동으로 처리한다.</p>
<p>HTTP 메소드가 뭔지 모르는가? 걱정하지 말자, 여기 짧게 요약된 HTTP 메소드에 대한 소개와
그것이 중요한 이유가 있다. :</p>
<p>HTTP 메소드 (종종 &#8220;the verb&#8221; 라고 불리우는..) 는 클라이언트가 서버에게 요청된 페이지를
통해서 무엇을 <strong>하도록</strong> 원하는지 말해준다. 다음의 메소드들은 매우 일반적인 것들이다 :</p>
<dl class="docutils">
<dt><cite>GET</cite></dt>
<dd>브라우저가 어떤 페이지에 저장된 정보를 단지 얻기 위해 서버에 요청하고 서버는 그 정보를
보낸다. 가장 일반적인 메소드다.</dd>
<dt><cite>HEAD</cite></dt>
<dd>브라우저가 어떤 페이지에 저장된 내용이 아니라 헤더라 불리는 정보를 요청한다. 어떤
어플리케이션이 GET 요청을 받은것 처럼 처리하나, 실제 내용이 전달되지 않는다. 하부에
있는 Werkzeug 라이브러리들이 그런 처리를 하기 때문에 플라스크에서는 그런
처리는 전혀 할 필요가 없다.</dd>
<dt><cite>POST</cite></dt>
<dd>브라우저는 서버에게 새로운 정보를 <a href="#id8"><span class="problematic" id="id9">*</span></a>전송*하도록 특정 URL에 요청하고 그 정보가 오직 한번
저장되는것을 보장하도록 한다. 이것이 보통 HTML폼을 통해서 서버에 데이터 전송하는
방식이다.</dd>
<dt><cite>PUT</cite></dt>
<dd><cite>POST</cite> 와 유사하지만 서버가 오래된 값들을 한번 이상 덮어쓰면서 store procedure를
여러번 실행할 수 있다. 여러분이 이것이 유용한 이유를 물을수도 있지만, 몇가지 적당한
이유가 있다. 전송시 연결을 잃어버리는 경우는 생각해보면, 브라우저와 서버사이에서 정보의
단절없이 요청을 다시 안전하게 받을 수도 있다. <cite>POST</cite> 는 단 한번 요청을 제공하기 때문에
이런 방식은 불가능하다.</dd>
<dt><cite>DELETE</cite></dt>
<dd>주어진 위치에 있는 정보를 제거한다..</dd>
<dt><cite>OPTIONS</cite></dt>
<dd>클라이언트에게 요청하는 URL이 어떤 메소드를 지원하는지 알려준다. Flask 0.6부터 이
기능은 자동 구현된다..</dd>
</dl>
<p>현재 흥미로운 부분은 HTML4와 XHTML1에서 폼이 서버로 전달하는 메소드는 <cite>GET</cite> 과 <cite>POST</cite> 다.
그러나 자바스크립와 미래의 HTML표준으로 여러분은 다른 메소드도 사용할 수 있다.
게다가,HTTP는 최근에 상당히 널리 사용되고 있고, 브라우저가 HTTP를 사용하는 유일한
클라이언트가 아니다. 예를 들면, 많은 버전관리 시스템이 HTTP를 사용한다.</p>
</div>
</div>
<div class="section" id="id10">
<h4>정적 파일<a class="headerlink" href="#id10" title="제목 주소">¶</a></h4>
<p>동적인 웹 어플리케이션은 정적 파일은 필요로한다. 그것들은 보통 자바스크립트나 CSS파일을
의미한다. 이상적으로 웹서버는 정적 파일들을 서비스하지만, 개발시에는 플라스크가 그 역할을
대신해준다. 단지 <cite>static</cite> 이라는 폴더를 여러분이 생성한 패키지 아래에 만들거나 모듈 옆에
위치시키면 개발된 어플리케이션에서 <cite>/static</cite>  위치에서 정적 파일을 제공할 것이다.</p>
<p>정적파일에 대한 URL을 얻으려면, 특별한 <code class="docutils literal"><span class="pre">'static'</span></code> 끝점 이름을 사용해야한다</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">url_for</span><span class="p">(</span><span class="s">&#39;static&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s">&#39;style.css&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>이 파일(style.css)는 파일시스템에 <code class="docutils literal"><span class="pre">static/style.css</span></code> 로 저장되어야한다.</p>
</div>
<div class="section" id="id11">
<h4>템플릿 보여주기<a class="headerlink" href="#id11" title="제목 주소">¶</a></h4>
<p>파이썬 소스코드에서 HTML을 생성하는 것은 그다지 재밌는 일은 아니다.(굉장히 번거로운 일이다)
왜냐하면 어플리케이션 보안을 위해 동적으로 변환되는 값에 대해 이스케이핑을 여러분 스스로
작성해야한다. 그런 불편함때문에 Flask는 &lt;<a class="reference external" href="http://jinja.pocoo.org/2/">http://jinja.pocoo.org/2/</a>&gt;`_ 를 템플릿엔진으로
구성하여 자동으로 HTML 이스케이핑을 한다.</p>
<p>템플릿을 뿌려주기 위해, 어려분은 <a class="reference internal" href="index.html#flask.render_template" title="flask.render_template"><code class="xref py py-func docutils literal"><span class="pre">render_template()</span></code></a> 메소드를 사용할 수 있다.
여러분이 해야하는 것은 단지 템플릿의 이름과 템플릿에 보여줄 변수를 키워드 인자로 넘겨주면
된다. 아래는 템플릿을 뿌려주는 방식의 간단한 예를 보여준다</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">render_template</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/hello/&#39;</span><span class="p">)</span>
<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/hello/&lt;name&gt;&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">hello</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">&#39;hello.html&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
<p>Flask는 <cite>templates</cite> 폴더에서 템플릿을 찾는다. 여러분이 모듈로 어플리케이션을 개발했다면
이 폴더는 그 모듈 옆에 위치하고, 패키지로 개발했다면 그 패키지 안에 위치한다 :</p>
<p><strong>Case 1</strong>: 모듈:</p>
<div class="highlight-python"><div class="highlight"><pre>/application.py
/templates
    /hello.html
</pre></div>
</div>
<p><strong>Case 2</strong>: 패키지:</p>
<div class="highlight-python"><div class="highlight"><pre>/application
    /__init__.py
    /templates
        /hello.html
</pre></div>
</div>
<p>플라스크에서는 템플릿에 있어서 Jinja2의 강력함을 사용할 수 있다. Jinja2에 대한 더 자세한
내용은 <a class="reference external" href="http://jinja.pocoo.org/2/documentation/templates">Jinja2 Template Documentation</a> 공식 문서를 참고하기 바란다.</p>
<p>여기 템플릿 예제가있다:</p>
<div class="highlight-html+jinja"><div class="highlight"><pre><span class="cp">&lt;!doctype html&gt;</span>
<span class="nt">&lt;title&gt;</span>Hello from Flask<span class="nt">&lt;/title&gt;</span>
<span class="cp">{%</span> <span class="k">if</span> <span class="nv">name</span> <span class="cp">%}</span>
  <span class="nt">&lt;h1&gt;</span>Hello <span class="cp">{{</span> <span class="nv">name</span> <span class="cp">}}</span>!<span class="nt">&lt;/h1&gt;</span>
<span class="cp">{%</span> <span class="k">else</span> <span class="cp">%}</span>
  <span class="nt">&lt;h1&gt;</span>Hello World!<span class="nt">&lt;/h1&gt;</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
</pre></div>
</div>
<p>템플릿 안에서도 여러분은 <a class="reference internal" href="index.html#flask.request" title="flask.request"><code class="xref py py-class docutils literal"><span class="pre">request</span></code></a>,:class:<cite>~flask.session</cite> 와
<a class="reference internal" href="index.html#flask.g" title="flask.g"><code class="xref py py-class docutils literal"><span class="pre">g</span></code></a> <a class="footnote-reference" href="#id13" id="id12">[1]</a> 객체에 접근할 수 있다.</p>
<p>템플릿에서 특히 상속이 유용하게 사용된다. 템플릿 상속에 대해서 자세한 내용을 보고 싶으면
<a class="reference internal" href="index.html#template-inheritance"><span>템플릿 상속</span></a> 패턴문서를 참고하기 바란다. 기본적으로 템플릿 상속은 각
페이지에서 특정 요소를 유지할수 있게 해준다.(헤더, 네비게이션과 풋터)</p>
<p>자동 이스케이핑은 켜져있고, <cite>name</cite> 이란 변수가 HTML에 포함되있다면, 그 변수값은 자동으로
이스케이핑된다. 여러분이 변수가 안전하고 그 변수를 안전한 HTML로 만든다면,
<code class="xref py py-class docutils literal"><span class="pre">Markup</span></code> 템플릿에서 <code class="docutils literal"><span class="pre">|safe</span></code> 필터를 사용해서 안전하게 만들수 있다.
템플릿에 대한 자세한 내용은 Jinja2 문서를 참고하기 바란다.</p>
<p>여기에 <code class="xref py py-class docutils literal"><span class="pre">Markup</span></code> 클래스를 사용하는 예제가 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Markup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Markup</span><span class="p">(</span><span class="s">&#39;&lt;strong&gt;Hello </span><span class="si">%s</span><span class="s">!&lt;/strong&gt;&#39;</span><span class="p">)</span> <span class="o">%</span> <span class="s">&#39;&lt;blink&gt;hacker&lt;/blink&gt;&#39;</span>
<span class="go">Markup(u&#39;&lt;strong&gt;Hello &amp;lt;blink&amp;gt;hacker&amp;lt;/blink&amp;gt;!&lt;/strong&gt;&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Markup</span><span class="o">.</span><span class="n">escape</span><span class="p">(</span><span class="s">&#39;&lt;blink&gt;hacker&lt;/blink&gt;&#39;</span><span class="p">)</span>
<span class="go">Markup(u&#39;&amp;lt;blink&amp;gt;hacker&amp;lt;/blink&amp;gt;&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Markup</span><span class="p">(</span><span class="s">&#39;&lt;em&gt;Marked up&lt;/em&gt; &amp;raquo; HTML&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">striptags</span><span class="p">()</span>
<span class="go">u&#39;Marked up \xbb HTML&#39;</span>
</pre></div>
</div>
<div class="versionchanged">
<p><span class="versionmodified">버전 0.5으로 변경: </span>Autoescaping is no longer enabled for all templates.  The following
extensions for templates trigger autoescaping: <code class="docutils literal"><span class="pre">.html</span></code>, <code class="docutils literal"><span class="pre">.htm</span></code>,
<code class="docutils literal"><span class="pre">.xml</span></code>, <code class="docutils literal"><span class="pre">.xhtml</span></code>.  Templates loaded from a string will have
autoescaping disabled.</p>
</div>
<table class="docutils footnote" frame="void" id="id13" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id12">[1]</a></td><td>Unsure what that <a class="reference internal" href="index.html#flask.g" title="flask.g"><code class="xref py py-class docutils literal"><span class="pre">g</span></code></a> object is? It&#8217;s something in which
you can store information for your own needs, check the documentation of
that object (<a class="reference internal" href="index.html#flask.g" title="flask.g"><code class="xref py py-class docutils literal"><span class="pre">g</span></code></a>) and the <a class="reference internal" href="index.html#sqlite3"><span>Flask에서 SQLite 3 사용하기</span></a> for more
information.</td></tr>
</tbody>
</table>
</div>
<div class="section" id="id14">
<h4>요청 데이타 접근하기<a class="headerlink" href="#id14" title="제목 주소">¶</a></h4>
<p>웹 어플리케이션에 있어서 클라이언트에서 서버로 보내는 데이타를 처리하는 것은 중요한 일이다.
Flask에서 이 정보는 글로벌한 <a class="reference internal" href="index.html#flask.request" title="flask.request"><code class="xref py py-class docutils literal"><span class="pre">request</span></code></a> 객체에 의해 제공된다. 여러분이
파이썬 경험이 있다면, 어떻게 그 객체가 글로벌하고 쓰레드 안전하게 처리되는지 궁금할 수 도
있다. 그 답은 컨텍스트 로컬에 있다. :</p>
<div class="section" id="context-locals">
<span id="id15"></span><h5>컨텍스트 로컬<a class="headerlink" href="#context-locals" title="제목 주소">¶</a></h5>
<p>Flask 에서 어떤 객체들은 보통 객체들이 아닌 전역 객체들이다. 이 객체들은 실제로 어떤
특정한 문맥에서 지역적인 객체들에 대한 대리자들이다. 무슨 말인지 어렵다. 하지만, 실제로는 꽤
쉽게 이해할 수 있다.</p>
<p>쓰레드를 다루는 문맥을 생각해보자. 웹에서 요청이 하나 들어오면, 웹서버는 새로운 쓰레드를
하나 생성한다 (그렇지 않다면, 다른 방식으로 기반을 이루는 객체가 쓰레드가 아닌 동시성을
제공하는 시스템을 다룰 수도 있다). 플라스크가 내부적으로 요청을 처리할때, 플라스크는 현재
처리되는 쓰레드를 활성화된 문맥이라고 간주하고, 현재 실행되는 어플리케이션과 WSGI환경을 그
문맥(쓰레드)에 연결한다. 이렇게 처리하는 것이 문맥을 지능적으로 처리하는 방식이고,
이렇게하여 한 어플리케이션이 끊어짐없이 다른 어플리케이션을 호출할 수 있다.</p>
<p>그렇다면 이것은 여러분에게 어떤 의미인가? 기본적으로 여러분이 유닛 테스트(Unit Test)와
같은 것을 하지 않는다면 이것을 완전히 무시할 수 있다. 여러분은 요청 객체에 의존하는 코드가
갑자기 깨지는것을 알게 될것인데, 왜냐하면 요청 객체가 존재하지 않기 때문이다. 해결책은 요청
객체를 생성해서 그 객체를 문맥에 연결하는 것이다. 유닛 테스트에 있어서 가장 쉬운 해결책은
<a class="reference internal" href="index.html#flask.Flask.test_request_context" title="flask.Flask.test_request_context"><code class="xref py py-meth docutils literal"><span class="pre">test_request_context()</span></code></a> 문맥 관리자(Context Manager)를 사용하는
것이다. <cite>with</cite> 절과 함께 사용해서 test_request_context() 문맥 관리자는 테스트 요청을
연결할 것이고, 그렇게해서 여러분은 그 객체와 상호 작용할 수 있다. 아래에 예가 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">request</span>

<span class="k">with</span> <span class="n">app</span><span class="o">.</span><span class="n">test_request_context</span><span class="p">(</span><span class="s">&#39;/hello&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&#39;POST&#39;</span><span class="p">):</span>
    <span class="c"># now you can do something with the request until the</span>
    <span class="c"># end of the with block, such as basic assertions:</span>
    <span class="k">assert</span> <span class="n">request</span><span class="o">.</span><span class="n">path</span> <span class="o">==</span> <span class="s">&#39;/hello&#39;</span>
    <span class="k">assert</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s">&#39;POST&#39;</span>
</pre></div>
</div>
<p>다른 방법은 WSGI 환경 변수를 <a class="reference internal" href="index.html#flask.Flask.request_context" title="flask.Flask.request_context"><code class="xref py py-meth docutils literal"><span class="pre">request_context()</span></code></a>  메소드에 인자로
넘기는 것이다.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">request</span>

<span class="k">with</span> <span class="n">app</span><span class="o">.</span><span class="n">request_context</span><span class="p">(</span><span class="n">environ</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s">&#39;POST&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="id16">
<h5>요청 객체<a class="headerlink" href="#id16" title="제목 주소">¶</a></h5>
<p>요청(requqest) 객체는 API(Application Programming Interface) 장에 설명되있으므로,
여기서는 자세히 언급하지 않을것이다(see <a class="reference internal" href="index.html#flask.request" title="flask.request"><code class="xref py py-class docutils literal"><span class="pre">request</span></code></a>). 여기서는 가장 일반적인
동작에 대해 거시적으로 살펴본다. 여러분은 먼저 <cite>Flask</cite> 모듈에서 요청 개체를
임포트해야한다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">request</span>
</pre></div>
</div>
<p>현재 요청 메소도는 <code class="xref py py-attr docutils literal"><span class="pre">method</span></code> 속성으로 사용할 수 있다. 폼 데이타(
HTTP <cite>POST</cite> 나 <cite>PUT</cite> 요청으로 전달된 데이타)에 접근하려면, <code class="xref py py-attr docutils literal"><span class="pre">form</span></code>
속성을 사용할 수 있다. 아래에 위에서 언급한 두가지 속성에 대한 완전한 예제가 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/login&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;POST&#39;</span><span class="p">,</span> <span class="s">&#39;GET&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">login</span><span class="p">():</span>
    <span class="n">error</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s">&#39;POST&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">valid_login</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s">&#39;username&#39;</span><span class="p">],</span>
                       <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s">&#39;password&#39;</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">log_the_user_in</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s">&#39;username&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">error</span> <span class="o">=</span> <span class="s">&#39;Invalid username/password&#39;</span>
    <span class="c"># 아래의 코드는 요청이 GET 이거나, 인증정보가 잘못됐을때 실행된다.</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">&#39;login.html&#39;</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span>
</pre></div>
</div>
<p>위에 <cite>폼</cite> 에 접근한 키(username이나 password)가 존재하지 않으면 어떻게 되나? KeyError가
발생한다. 여러분은 표준적인 <a class="reference external" href="http://docs.python.org/dev/library/exceptions.html#KeyError" title="(in Python v3.6)"><code class="xref py py-exc docutils literal"><span class="pre">KeyError</span></code></a> 로 이 예외를 잡을 수 있지만, 예외처리를 하지
않는다면 HTTP 400 잘못된 요청(Bad Request)에 대한 오류 페이지를 보여준다. 그렇기 때문에
대다수의 상황에서 이 문제를 여러분이 직접 처리할 필요는 없다.</p>
<p>URL로 넘겨진 파라메터 (<code class="docutils literal"><span class="pre">?key=value</span></code> 소위 말하는 질의 문자열)에 접근하려면, 여러분은
<code class="xref py py-attr docutils literal"><span class="pre">args</span></code> 속성을 사용할 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">searchword</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;key&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>우리는 args속성의 <cite>get</cite> 을 사용하거나 <cite>KeyError</cite> 예외를 처리하여 URL파라메터에 접근할
것을 추천한다. 왜냐하면 사용자가 URL을 변경할 수 있으며 사용자에게 친근하지 않은 400 잘못된
요청 페이지를 보여주기 때문이다.</p>
<p>요청 객체에 대한 메소드와 속성의 전체 목록은 <a class="reference internal" href="index.html#flask.request" title="flask.request"><code class="xref py py-class docutils literal"><span class="pre">request</span></code></a> 문서에서 살펴보라.</p>
</div>
<div class="section" id="id17">
<h5>파일 업로드<a class="headerlink" href="#id17" title="제목 주소">¶</a></h5>
<blockquote>
<div>여러분은 Flask를 사용하여 쉽게 업로드된 파일들을 다룰 수 있다. 여러분의 HTMl form에
<code class="docutils literal"><span class="pre">enctype=&quot;multipart/form-data&quot;</span></code> 가 설정하는 것만 잊지 말아라. 그렇지 않으면
브라우저는 파일을 전혀 전송하지 않을 것이다.</div></blockquote>
<p>업로드된 파일들은 메모리나 파일시스템의 임시 장소에 저장된다. 여러분이
<code class="xref py py-attr docutils literal"><span class="pre">files</span></code> 객체의 files 속성을 찾아 그 파일들에 접근할 수 있다. 업로드된 각 파일들은 그 dictionary 안에 저장되어 있다. 그것은 마치 표준 파이썬 <code class="xref py py-class docutils literal"><span class="pre">file</span></code> 객체처럼 행동한다. 그러나 서버의 파일시스템에 파일을 저장하도록 하는 <a class="reference external" href="http://werkzeug.pocoo.org/docs/datastructures/#werkzeug.datastructures.FileStorage.save" title="(in Werkzeug v0.11-dev)"><code class="xref py py-meth docutils literal"><span class="pre">save()</span></code></a> 메소드 또한 가지고 있다. 아래 save 메소드가 어떻게 실행되는지를 보여주는 간단한 예제가 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">request</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/upload&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">,</span> <span class="s">&#39;POST&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">upload_file</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s">&#39;POST&#39;</span><span class="p">:</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="s">&#39;the_file&#39;</span><span class="p">]</span>
        <span class="n">f</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s">&#39;/var/www/uploads/uploaded_file.txt&#39;</span><span class="p">)</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>만약 여러분의 어플리케이션에 파일이 업로드되기 전 클라이언트에서의 파일명을 알고 싶다면,
<a class="reference external" href="http://werkzeug.pocoo.org/docs/datastructures/#werkzeug.datastructures.FileStorage.filename" title="(in Werkzeug v0.11-dev)"><code class="xref py py-attr docutils literal"><span class="pre">filename</span></code></a> 속성에 접근할 수 있다. 그러나
이 값은 위조될 수 있으며 결코 신뢰할 수 없는 값인 것을 명심해라. 만약 서버에 저장되는
파일명을 클라이언트에서의 파일명을 그대로 사용하기를 원한다면, Werkzeug에서 제공하는
<a class="reference external" href="http://werkzeug.pocoo.org/docs/utils/#werkzeug.utils.secure_filename" title="(in Werkzeug v0.11-dev)"><code class="xref py py-func docutils literal"><span class="pre">secure_filename()</span></code></a> 함수에 그 파일명을 전달하라:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">request</span>
<span class="kn">from</span> <span class="nn">werkzeug</span> <span class="kn">import</span> <span class="n">secure_filename</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/upload&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">,</span> <span class="s">&#39;POST&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">upload_file</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s">&#39;POST&#39;</span><span class="p">:</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="s">&#39;the_file&#39;</span><span class="p">]</span>
        <span class="n">f</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s">&#39;/var/www/uploads/&#39;</span> <span class="o">+</span> <span class="n">secure_filename</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">filename</span><span class="p">))</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>더 나은 예제를 보고 싶다면 <a class="reference internal" href="index.html#uploading-files"><span>파일 업로드하기</span></a> 챕터의 패턴을 확인하라.</p>
</div>
<div class="section" id="id18">
<h5>쿠키<a class="headerlink" href="#id18" title="제목 주소">¶</a></h5>
<p>쿠키에 접근하기 위해서는 <a class="reference internal" href="index.html#flask.Request.cookies" title="flask.Request.cookies"><code class="xref py py-attr docutils literal"><span class="pre">cookies</span></code></a> 속성을 사용할 수 있다. 쿠키를
저장하기 위해서는 response 객체의 <a class="reference internal" href="index.html#flask.Response.set_cookie" title="flask.Response.set_cookie"><code class="xref py py-attr docutils literal"><span class="pre">set_cookie</span></code></a> 메소드를 사용할
수 있다. request 객체의 <a class="reference internal" href="index.html#flask.Request.cookies" title="flask.Request.cookies"><code class="xref py py-attr docutils literal"><span class="pre">cookies</span></code></a> 속성은 클라이언트가 전송하는
모든 쿠키를 가지고 있는 dictionary이다. 만약 여러분이 세션을
사용하기를 원한다면 쿠키를 직접 사용하는 대신에 쿠키 위에서 보안성을 추가한 Flask의
<a class="reference internal" href="#sessions"><span>세션</span></a> 을 사용하라.</p>
<p>Reading cookies:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">request</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="n">username</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">cookies</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;username&#39;</span><span class="p">)</span>
    <span class="c"># use cookies.get(key) instead of cookies[key] to not get a</span>
    <span class="c"># KeyError if the cookie is missing.</span>
</pre></div>
</div>
<p>Storing cookies:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">make_response</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">make_response</span><span class="p">(</span><span class="n">render_template</span><span class="p">(</span><span class="o">...</span><span class="p">))</span>
    <span class="n">resp</span><span class="o">.</span><span class="n">set_cookie</span><span class="p">(</span><span class="s">&#39;username&#39;</span><span class="p">,</span> <span class="s">&#39;the username&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">resp</span>
</pre></div>
</div>
<p>쿠키가 respone 객체에 저장되는 것을 주목하다. 여러분이 보통 뷰 함수로부터 단지 문자열을
반환하기 때문에, Flask는 그 문자열들을 여러분을 위해 response 객체로 변환할 것이다. 만약
여러분이 명시적으로 변환하기를 원한다면 여러분은 <a class="reference internal" href="index.html#flask.make_response" title="flask.make_response"><code class="xref py py-meth docutils literal"><span class="pre">make_response()</span></code></a> 함수를
사용하여 값을 변경할 수 있다.</p>
<p>때때로 여러분은 response 객체가 아직 존재하지 않는 시점에 쿠키를 저장하기를 원할 수도 있다.
<a class="reference internal" href="index.html#deferred-callbacks"><span>지연된(deferred) 요청 콜백</span></a> 패턴을 사용하면 가능하다.</p>
<p>이것을 위해 <a class="reference internal" href="#about-responses"><span>응답에 관하여</span></a> 챕터를 참조해라.</p>
</div>
</div>
<div class="section" id="id19">
<h4>리다이렉션과 에러<a class="headerlink" href="#id19" title="제목 주소">¶</a></h4>
<p>사용자가 다른 엔드포인트로 redirect하기 위해서는 <a class="reference internal" href="index.html#flask.redirect" title="flask.redirect"><code class="xref py py-func docutils literal"><span class="pre">redirect()</span></code></a> 함수를
사용하라. 에러콛를  가지고 일찍 요청을 중단하기를 원한다면 <a class="reference internal" href="index.html#flask.abort" title="flask.abort"><code class="xref py py-func docutils literal"><span class="pre">abort()</span></code></a> 함수를
사용하라:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">abort</span><span class="p">,</span> <span class="n">redirect</span><span class="p">,</span> <span class="n">url_for</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s">&#39;login&#39;</span><span class="p">))</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/login&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">login</span><span class="p">():</span>
    <span class="n">abort</span><span class="p">(</span><span class="mi">401</span><span class="p">)</span>
    <span class="n">this_is_never_executed</span><span class="p">()</span>
</pre></div>
</div>
<p>위 코드는 사용자가 인덱스 페이지에서 그들이 접근할 수 없는(401은 접근불가를 의미) 페이지로
redirect되어질 것이기 때문에 다소 무의미한 예제일 수는 있으나 어떻게 작동된다는 것을
보여주고 있다.</p>
<p>기본으로 하얀 화면에 검정 글씨의 에러 페이지가 각 에러코드를 위해 보여진다. 만약 여러분이
에러페이지를 변경하기를 원한다면 <a class="reference internal" href="index.html#flask.Flask.errorhandler" title="flask.Flask.errorhandler"><code class="xref py py-meth docutils literal"><span class="pre">errorhandler()</span></code></a> 데코레이터를 사용할
수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">render_template</span>

<span class="nd">@app.errorhandler</span><span class="p">(</span><span class="mi">404</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">page_not_found</span><span class="p">(</span><span class="n">error</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">&#39;page_not_found.html&#39;</span><span class="p">),</span> <span class="mi">404</span>
</pre></div>
</div>
<p><a class="reference internal" href="index.html#flask.render_template" title="flask.render_template"><code class="xref py py-func docutils literal"><span class="pre">render_template()</span></code></a> 호출 뒤에 있는 <code class="docutils literal"><span class="pre">404</span></code> 를 주목해하. 이것은 페이지의 상태
코드가 그 페이지를 찾을 수 없다는 404가 되어야 하는 것을 Flask에게 말해 준다. 기본으로
200이 가정되며, 그것은 모든 것이 잘 실행됐다는 것으로 해석된다.</p>
</div>
<div class="section" id="about-responses">
<span id="id20"></span><h4>응답에 관하여<a class="headerlink" href="#about-responses" title="제목 주소">¶</a></h4>
<p>view 함수로부터 반환되는 값은 자동으로 response 객체로 변환된다. 만약 반환값이
문자열이라면 response body로 문자열과 <code class="docutils literal"><span class="pre">200</span> <span class="pre">OK</span></code> 코드, <code class="docutils literal"><span class="pre">text/html</span></code> mimtype을 갖는
response객체로 변환된다. Flask에서 반환값을 response 객체로 변환하는 로직은 아래와
같다:</p>
<ol class="arabic simple">
<li>만약 정확한 유형의 response객체가 반환된다면 그 객체는 그대로 뷰로부터 반환되어 진다.</li>
<li>만약 문자열이 반환된다면, response객체는 해당 데이타와 기본 파라미터들을 갖는
reponse객체가 생성된다.</li>
<li>만약 튜플이 반환된다면 튜플 안에 있는 아이템들이 추가적인 정보를 제공할 수 있다.
그런 퓨틀들은 지정된 폼 <code class="docutils literal"><span class="pre">(response,</span> <span class="pre">status,</span> <span class="pre">headers)</span></code> 이여야 하며, 그 중 적어도
하나의 아이템이 튜플 안에 있어야 한다. <cite>status</cite> 값은 statud code를 오버라이드하면 `
headers` 는 추가적인 정보의 list, dictionary가 될 수 있다.</li>
<li>만약 위의 것들이 아무것도 적용되지 않는다면, Flask는 반환값이 유효한 WSGI
application 이라고 가정하고 WSGI application을 response객체로 변환할 것이다.</li>
</ol>
<p>만약 여러분이 뷰 안에서 결과 response 객체를 찾기를 원한다면 <a class="reference internal" href="index.html#flask.make_response" title="flask.make_response"><code class="xref py py-func docutils literal"><span class="pre">make_response()</span></code></a> 함수를 사용할 수 있다.</p>
<p>아래와 같은 뷰를 가지고 있다고 상상해 보아라:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.errorhandler</span><span class="p">(</span><span class="mi">404</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">not_found</span><span class="p">(</span><span class="n">error</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">&#39;error.html&#39;</span><span class="p">),</span> <span class="mi">404</span>
</pre></div>
</div>
<p>여러분은 단지 <a class="reference internal" href="index.html#flask.make_response" title="flask.make_response"><code class="xref py py-func docutils literal"><span class="pre">make_response()</span></code></a> 함수를 사용하여 반환되는 표현을 래핑하고,
변경을 위해 결과 객체를 얻은 다음 반환하기만 하면 된다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.errorhandler</span><span class="p">(</span><span class="mi">404</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">not_found</span><span class="p">(</span><span class="n">error</span><span class="p">):</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">make_response</span><span class="p">(</span><span class="n">render_template</span><span class="p">(</span><span class="s">&#39;error.html&#39;</span><span class="p">),</span> <span class="mi">404</span><span class="p">)</span>
    <span class="n">resp</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s">&#39;X-Something&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;A value&#39;</span>
    <span class="k">return</span> <span class="n">resp</span>
</pre></div>
</div>
</div>
<div class="section" id="sessions">
<span id="id21"></span><h4>세션<a class="headerlink" href="#sessions" title="제목 주소">¶</a></h4>
<p>Request object외에도 하나의 요청에서 다음 요청까지 사용자에 대한 구체적인 정보를 저장할
수 있는 <a class="reference internal" href="index.html#flask.session" title="flask.session"><code class="xref py py-class docutils literal"><span class="pre">session</span></code></a> 이라는 객체가 있다. 세션은 여러분을 위해 쿠키 위에서
구현되어 지고 암호화를 사용하여 그 쿠키를 서명한다. 즉, 사용자는 쿠키의 내용을 볼 수는
있지만 서명을 위해 사용된 비밀키를 알지 못한다면 쿠키의 내용을 변경할 수 없다는 것을
의미한다.</p>
<p>세션을 사용하기 위해서는 비밀키를 설정해야 한다. 아래 세션이 어떻게 사용되는지 참조해라:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">session</span><span class="p">,</span> <span class="n">redirect</span><span class="p">,</span> <span class="n">url_for</span><span class="p">,</span> <span class="n">escape</span><span class="p">,</span> <span class="n">request</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">if</span> <span class="s">&#39;username&#39;</span> <span class="ow">in</span> <span class="n">session</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">&#39;Logged in as </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">escape</span><span class="p">(</span><span class="n">session</span><span class="p">[</span><span class="s">&#39;username&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="s">&#39;You are not logged in&#39;</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/login&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">,</span> <span class="s">&#39;POST&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">login</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s">&#39;POST&#39;</span><span class="p">:</span>
        <span class="n">session</span><span class="p">[</span><span class="s">&#39;username&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s">&#39;username&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s">&#39;index&#39;</span><span class="p">))</span>
    <span class="k">return</span> <span class="s">&#39;&#39;&#39;</span>
<span class="s">        &lt;form action=&quot;&quot; method=&quot;post&quot;&gt;</span>
<span class="s">            &lt;p&gt;&lt;input type=text name=username&gt;</span>
<span class="s">            &lt;p&gt;&lt;input type=submit value=Login&gt;</span>
<span class="s">        &lt;/form&gt;</span>
<span class="s">    &#39;&#39;&#39;</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/logout&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">logout</span><span class="p">():</span>
    <span class="c"># remove the username from the session if it&#39;s there</span>
    <span class="n">session</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;username&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s">&#39;index&#39;</span><span class="p">))</span>

<span class="c"># set the secret key.  keep this really secret:</span>
<span class="n">app</span><span class="o">.</span><span class="n">secret_key</span> <span class="o">=</span> <span class="s">&#39;A0Zr98j/3yX R~XHH!jmN]LWX/,?RT&#39;</span>
</pre></div>
</div>
<p>위 예제에서 <a class="reference internal" href="index.html#flask.escape" title="flask.escape"><code class="xref py py-func docutils literal"><span class="pre">escape()</span></code></a> 는 템플릿 엔진을 사용하지 않을경우 이스케이프를 한다.</p>
<p>무작위(랜덤)로 생성하는 것의 문제는 정말 그것이 무작위(랜덤)한 것인지 판단하기 어렵다는
것이다. 비밀키는 가능한 한 무작위로 생성되어야 하다. 여러분의 OS는 키를 얻는 데 사용할 수
있는 cryptographic random generator(암호 난수 발생기) 기반의 꽤 무작위의 키를 생성하는
방법을 제공한다. :</p>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">urandom</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<span class="go">&#39;\xfd{H\xe5&lt;\x95\xf9\xe3\x96.5\xd1\x01O&lt;!\xd5\xa2\xa0\x9fR&quot;\xa1\xa8&#39;</span>
</pre></div>
</div>
<p>위 코드를 여러분의 코드에 복사하기/붙혀넣기만 하면 된다.</p>
</div></blockquote>
<p>쿠키 기반의 세션: Flask는 여러분이 값들을 세션 객체 안에 넣고 세션 객체들을 쿠키로 직렬화할
것이다. 만약 쿠키는 사용 가능하나 세션에 저장한 값들이 여러 요청에 걸쳐 지속적으로 사용할 수
없다는 것을 발견한다면, 그리고 분명한 에러 메세지를 얻지 못한다면, 웹 브라우저에 의해
지원되는 쿠키 크기와 응답 페이지 내의 쿠키 크기를 확인해라.</p>
</div>
<div class="section" id="id22">
<h4>메시지 플래싱<a class="headerlink" href="#id22" title="제목 주소">¶</a></h4>
<p>좋은 어플리케이션과 유저 인터페이스는 모두 피드백에 관한 것이다. 만약 사용자가 충분한
피드백을 받지 못한다면 사용자들은 아마 결국에는 그 어플리케이션을 싫어할 것이다. Flask는
flashing system을 사용하여 사용자에게 피드백을 주기 위한 정말 간단한 방법을 제공한다.
flashing system이란 기본적으로 요청의 끝과 바로 다음 요청에 접근할 때 메세지를 기록하는
것을 가능하게 한다. 이것은 보통 메세지를 사용자에게 노출하기 위한 레이아웃 템플릿과
조합되어 있다.</p>
<p>메세지를 flash 하기 위하여 <a class="reference internal" href="index.html#flask.flash" title="flask.flash"><code class="xref py py-func docutils literal"><span class="pre">flash()</span></code></a> 메소드를 사용하고 메세지를 가져오기
위하여 템플릿에서 사용할 수 있는 <a class="reference internal" href="index.html#flask.get_flashed_messages" title="flask.get_flashed_messages"><code class="xref py py-func docutils literal"><span class="pre">get_flashed_messages()</span></code></a> 메소드를 사용할
수 있다. 예제가 필요하면 <a class="reference internal" href="index.html#message-flashing-pattern"><span>메시지 플래싱(Message Flashing)</span></a> 챕터를 확인하기 바란다.</p>
</div>
<div class="section" id="id23">
<h4>로깅<a class="headerlink" href="#id23" title="제목 주소">¶</a></h4>
<p>때때로 여러분은 정확해야 하는 데이타를 다뤄야 하나 실제로는 그렇지 못한 상황에 처할 지도
모른다. 예를 들면 형식이 틀린 HTTP 요청을 서버로 보내는 클라이언트 사이드 코드를 가질 지도
모른다. 이런 상황은 사용자가 데이타 조작에 의해 발생할 수 있으며, 클라이언트 코드는
정상적으로 실행되지 않을 것이다. 대부분의 경우에는 이런 상황에서 <code class="docutils literal"><span class="pre">400</span> <span class="pre">Bad</span> <span class="pre">Request</span></code> 로
응답하는 것은 상관없으나 때때로 <code class="docutils literal"><span class="pre">400</span> <span class="pre">Bad</span> <span class="pre">Request</span></code> 로 응답하지 않고 코드가 정상적으로
실행되어야 하는 경우가 있다.</p>
<p>이런 경우 여러분은 여전히 수상한 어떤 일이 발생한 것을 로깅하기를 원할지도 모른다. 이런
상황에서 로걸ㄹ 사용할 수 있다. Flask 0.3부터 로거는 여러분이 사용할 수 있도록 미리
설정되어 있다.</p>
<p>아래 로그를 출력하는 예제가 있다.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">app</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;A value for debugging&#39;</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">&#39;A warning occurred (</span><span class="si">%d</span><span class="s"> apples)&#39;</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s">&#39;An error occurred&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>첨부된 <code class="xref py py-attr docutils literal"><span class="pre">Logger</span></code> 이다. 더
많은 정보를 원하면 <a class="reference external" href="http://docs.python.org/library/logging.html">logging
documentation</a> 문서를 참조해라.</p>
</div>
<div class="section" id="wsgi">
<h4>WSGI 미들웨어에서 후킹하기<a class="headerlink" href="#wsgi" title="제목 주소">¶</a></h4>
<p>만약 여러분이 여러분이 개발한 어플리케이션을 WSGI 미들웨어에 올리기를 원한다면 여러분은
내부 WSGI 어플리케이션을 래핑할 수 있다. 예를 들면 여러분이 lighttpd의 버그를 피하기 위해
Werkzeug 패키지의 미들웨어 중 하나를 사용하기를 원한다면, 여러분은 아래 코드와 같이 내부
WSGI 어플리케이션을 래핑할 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">werkzeug.contrib.fixers</span> <span class="kn">import</span> <span class="n">LighttpdCGIRootFix</span>
<span class="n">app</span><span class="o">.</span><span class="n">wsgi_app</span> <span class="o">=</span> <span class="n">LighttpdCGIRootFix</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">wsgi_app</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="quickstart-deployment">
<span id="id24"></span><h4>웹서버에 배포하기<a class="headerlink" href="#quickstart-deployment" title="제목 주소">¶</a></h4>
<p>여러분이 Flask로 개발한 어플리케이션을 배포할 준비가 되었는가? quickstart를 마무리하기
위하여 여러분은 hosted된 플랫폼에 배포할 수 있다. 모든 플랫폼들은 소규모 프로젝트를 위해
무료 서비스를 제공한다:</p>
<ul class="simple">
<li><a class="reference external" href="http://devcenter.heroku.com/articles/python">Deploying Flask on Heroku</a></li>
<li><a class="reference external" href="http://docs.dotcloud.com/services/python/">Deploying WSGI on dotCloud</a>
with <a class="reference external" href="http://flask.pocoo.org/snippets/48/">Flask-specific notes</a></li>
</ul>
<p>Flask 어플리케이션을 host할 수 있는 다른 곳도 있다:</p>
<ul class="simple">
<li><a class="reference external" href="http://flask.pocoo.org/snippets/65/">Deploying Flask on Webfaction</a></li>
<li><a class="reference external" href="https://github.com/kamalgill/flask-appengine-template">Deploying Flask on Google App Engine</a></li>
<li><a class="reference external" href="http://flask.pocoo.org/snippets/89/">Sharing your Localhost Server with Localtunnel</a></li>
</ul>
<p>만약 여러분이 자신만의 host를 관리하고 서비스하기를 원한다면, <a class="reference internal" href="index.html#deployment"><span>배포 옵션</span></a> 챕터를
참조하라.</p>
</div>
</div>
<span id="document-tutorial/index"></span><div class="section" id="tutorial">
<span id="id1"></span><h3>튜토리얼<a class="headerlink" href="#tutorial" title="제목 주소">¶</a></h3>
<p>파이썬과 Flask로 어플리케이션을 개발하기를 원하는가?
여기서 예제를 가지고 그것을 배울 기회를 가질 수 있다.
이 튜토리얼에서는 우리는 간단한 마이크로 블로그 어플리케이션을 개발할 것이다.
텍스트만 입력가능한 한 명의 사용자만 지원하며 피드백이나 커멘트를 달 수 없다.
그러나 여러분이 시작하기에 필요한 모든 내용들이 있을 것이다.
우리는 Flask와 파이썬 범위에서 벗어난 데이타베이스로 SQLite를 사용할 것이다.
그 밖에 필요한 것들은 없다.</p>
<p>만약 여러분이 미리 또는 비교를 위해 모든 소스코드를 원한다면 <a class="reference external" href="http://github.com/mitsuhiko/flask/tree/master/examples/flaskr/">example source</a> 를 확인
하길 바란다.</p>
<div class="toctree-wrapper compound">
<span id="document-tutorial/introduction"></span><div class="section" id="flaskr">
<span id="tutorial-introduction"></span><h4>Flaskr 소개하기<a class="headerlink" href="#flaskr" title="제목 주소">¶</a></h4>
<p>우리는 우리의 블로깅 어플리케이션을 flaskr 이라고 부를 것이다.
웬지 덜 웹 2.0스러운 이름을 선택해야할 것 같은 느낌에서 자유로워 진것 같다.
기본적으로 우리는 flaskr을 통해서 다음 사항들을 하기를 원한다:</p>
<dl class="docutils">
<dt>1.사용자가 지정한 자격증명 설정을 이용하여 로그인/로그아웃을 할 수 있게 한다.</dt>
<dd>사용자는 단한명만 지원한다.</dd>
<dt>2.사용자가 로그인하면 사용자는 제목과 내용을 몇몇 HTML과 텍스트로만 입력할 수 있다.</dt>
<dd>우리는 사용자를 신뢰하기 때문에 HTML에 대한 위험성 검증은 하지 않는다.</dd>
</dl>
<p>3.flaskr 페이지에서는 지금까지 등록된 모든 항목들을 시간의 역순으로 상단에 보여준다
최근것을 제일 위로)`(최근것을 제일 위로)  로그인한 사용자는 새로 글을 추가 할 수 있다.</p>
<p>이정도 규모의 어플리케이션에서 사용하기에는 SQLite3도 충분한 선택이다.
그러나 더 큰 규모의 어플리케이션을 위해서는 더 현명한 방법으로 데이타베이스 연결을
핸들링하고 다른 RDBMS를 사용이 가능한 <a class="reference external" href="http://www.sqlalchemy.org/">SQLAlchemy</a> 를 사용하는 것이 맞다.
만약 여러분의 데이타가 NoSQL에 더 적합하다면 인기있는 NoSQL 데이타베이스 중 하나를
고려하기를 원할 수도 있다.</p>
<p>아래는 최종 완성된 어플리케이션의 스크린샷이다.:</p>
<img alt="screenshot of the final application" class="screenshot align-center" src="_images/flaskr2.png" />
<p>계속해서 스텝 0 폴더 생성하기를 보자. <a class="reference internal" href="index.html#tutorial-folders"><span>스텝 0: 폴더를 생성하기</span></a>.</p>
</div>
<span id="document-tutorial/folders"></span><div class="section" id="tutorial-folders">
<span id="id1"></span><h4>스텝 0: 폴더를 생성하기<a class="headerlink" href="#tutorial-folders" title="제목 주소">¶</a></h4>
<p>어플리케이션 개발을 시작하기전에, 어플리케이션에서 사용할 폴더를 만들자</p>
<div class="highlight-python"><div class="highlight"><pre>/flaskr
    /static
    /templates
</pre></div>
</div>
<p><cite>flaskr</cite> 폴더는 Python 패키지가 아니다. 단지 우리의 파일들을 저장할 장소이다.
우리는 이 폴더 안에 데이터베이스 스키마 뿐만 아니라 다른 앞으로 소개될 다른
스텝에 나오는 주요 모듈들 넣을 곳이다. <cite>static</cite> 폴더 내 파일들은 <cite>HTTP</cite> 를
통해 어플리케이션 사용자들이 이용할 수 있다. 이 폴더는 css와 javascript
파일들이 저장되는 곳이다. Flasks는 <cite>templates</cite> 폴더에서 <a class="reference external" href="http://jinja.pocoo.org/2/">Jinja2</a> 템플릿을 찾을 것이다</p>
<p>계속해서 Step 1:데이타베이스 스키마를 보자 <a class="reference internal" href="index.html#tutorial-schema"><span>스텝 1: 데이터베이스 스키마</span></a>.</p>
</div>
<span id="document-tutorial/schema"></span><div class="section" id="tutorial-schema">
<span id="id1"></span><h4>스텝 1: 데이터베이스 스키마<a class="headerlink" href="#tutorial-schema" title="제목 주소">¶</a></h4>
<p>먼저 우리는 데이터베이스 스키마를 생성해야 한다. 우리의 어플리케이션을 위해서는
단지 하나의 테이블만 필요하며 사용이 매우 쉬운 SQLite를 지원하기를 원한다.
다음의 내용을 <cite>schema.sql</cite> 이라는 이름의 파일로 방금 생성한 <cite>flaskr</cite> 폴더에 저장한다.</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">drop</span> <span class="k">table</span> <span class="n">if</span> <span class="k">exists</span> <span class="n">entries</span><span class="p">;</span>
<span class="k">create</span> <span class="k">table</span> <span class="n">entries</span> <span class="p">(</span>
  <span class="n">id</span> <span class="nb">integer</span> <span class="k">primary</span> <span class="k">key</span> <span class="n">autoincrement</span><span class="p">,</span>
  <span class="n">title</span> <span class="n">string</span> <span class="k">not</span> <span class="k">null</span><span class="p">,</span>
  <span class="nb">text</span> <span class="n">string</span> <span class="k">not</span> <span class="k">null</span>
<span class="p">);</span>
</pre></div>
</div>
<p>이 스키마는 <cite>entries</cite> 라는 이름의 테이블로 구성되어 있으며 이 테이블의
각 row에는 <cite>id</cite>, <cite>title</cite>, <cite>text</cite> 컬럼으로 구성된다. <cite>id</cite> 는 자동으로 증가되는
정수이며 프라이머리 키(primary key) 이다. 나머지 두개의 컬럼은 null이 아닌
문자열(strings) 값을 가져야 한다.</p>
<p>계속해서 Step 2: 어플리케이션 셋업 코드를 보자.  <a class="reference internal" href="index.html#tutorial-setup"><span>스텝 2: 어플리케이션 셋업 코드</span></a>.</p>
</div>
<span id="document-tutorial/setup"></span><div class="section" id="tutorial-setup">
<span id="id1"></span><h4>스텝 2: 어플리케이션 셋업 코드<a class="headerlink" href="#tutorial-setup" title="제목 주소">¶</a></h4>
<p>이제 우리는 데이터베이스 스키마를 가지고 있고 어플리케이션 모듈을 생성할 수 있다.
우리가 만들 어플리케이션을 <cite>flaskr</cite> 폴더안에 있는 <cite>flaskr.py</cite> 라고 부르자.
시작하는 사람들을 위하여 우리는 import가 필요한 모듈 뿐만 아니라 설정 영역도 추가할 것이다.
소규모 어플리케이션을 위해서는 우리가 여기에서 할 모듈 안에 설정을 직접 추가하는 것이 가능하다.
그러나 더 깔끔한 해결책은 설정을 <cite>.ini</cite> 또는 <cite>.py</cite> 로 분리하여 생성하여 로드하거나 그 파일로부터
값들을 import하는 것이다.</p>
<p>아래는 flaskr.py 파일 내용이다:</p>
<p>In <cite>flaskr.py</cite>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># all the imports</span>
<span class="kn">import</span> <span class="nn">sqlite3</span>
<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">session</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">redirect</span><span class="p">,</span> <span class="n">url_for</span><span class="p">,</span> \
     <span class="n">abort</span><span class="p">,</span> <span class="n">render_template</span><span class="p">,</span> <span class="n">flash</span>

<span class="c"># configuration</span>
<span class="n">DATABASE</span> <span class="o">=</span> <span class="s">&#39;/tmp/flaskr.db&#39;</span>
<span class="n">DEBUG</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">&#39;development key&#39;</span>
<span class="n">USERNAME</span> <span class="o">=</span> <span class="s">&#39;admin&#39;</span>
<span class="n">PASSWORD</span> <span class="o">=</span> <span class="s">&#39;default&#39;</span>
</pre></div>
</div>
<p>다음으로 우리는 우리의 실제 어플리케이션을 생성하고 같은 파일의 설정을 가지고
어플리케이션을 초기화할 수 있다. <cite>flaskr.py</cite> 내용은</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># create our little application :)</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">from_object</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
</pre></div>
</div>
<p><a class="reference internal" href="index.html#flask.Config.from_object" title="flask.Config.from_object"><code class="xref py py-meth docutils literal"><span class="pre">from_object()</span></code></a> 는 인자로 주어진 객체를 설정값을 읽어 오기 위해 살펴 볼 것이다.
(만약 인자 값이 문자열이면 해당 객체를 임포트 할것이다.) 그리고나서 거기에 정의된 모든 대문자
변수들을 찾을 것이다. 우리의 경우, 우리가 위에서 몇 줄의 코드로 작성했던 설정이다.
여러분은 분리된 파일로도 설정값들을 이동시킬 수 있다.</p>
<p>일반적으로 설정 파일에서 설정값을 로드하는 것은 좋은 생각이다.
위에서 사용한 <a class="reference internal" href="index.html#flask.Config.from_object" title="flask.Config.from_object"><code class="xref py py-meth docutils literal"><span class="pre">from_object()</span></code></a> 대신 <a class="reference internal" href="index.html#flask.Config.from_envvar" title="flask.Config.from_envvar"><code class="xref py py-meth docutils literal"><span class="pre">from_envvar()</span></code></a>
를 사용하여 설정값을 로드할 수도 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">from_envvar</span><span class="p">(</span><span class="s">&#39;FLASKR_SETTINGS&#39;</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>위와 같은 방식으로 환경변수를 호출하여 설정값을 로드할 수도 있다.
<span class="target" id="index-0"></span><code class="xref std std-envvar docutils literal"><span class="pre">FLASKR_SETTINGS</span></code> 에 명시된 설정 파일이 로드되면 기본 설정값들은 덮어쓰기가 된다.
silent 스위치는 해당 환경변수가 존재 하지 않아도 Flask가 작동하도록 하는 것이다.</p>
<p>클라이언트에서의 세션을 안전하게 보장하기 위해서는 <cite>secret_key</cite> 가 필요하다.
secret_key는 추측이 어렵도록 가능한 복잡하게 선택하여야 한다.
디버그 플래그는 인터랙ㅌ브 디버거를 활성화 시키거나 비활성화 시키는 일을 한다.
<em>운영시스템에서는 디버그 모드를 절대로 활성화 시키지 말아야 한다.</em>
왜냐하면 디버그 모드에서는 사용자가 서버의 코드를 실행할수가 있기 때문이다.</p>
<p>우리는 또한 명세화된 데이터베이스에 쉽게 접속할 수 있는 방법을 추가할 것이다.
이방법으로 Python 인터랙티브 쉘이나 스크립트에서 요청에 의해 커넥션을
얻기위해 사용할 수 있다. 이 방법을 뒤에서 좀더 편리하게 만들어 볼 것이다.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">connect_db</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&#39;DATABASE&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>마지막으로 우리는 파일의 마지막에 단독 서버로 실행되는 애플리케이션을 위한
서버 실행 코드를 한줄 추가 하였다.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>여기까지 되어있으면 문제없이 어플리케이션을 시작할 수 있어야 한다.
다음 명령어로 실행이 가능하다:</p>
<div class="highlight-python"><div class="highlight"><pre>python flaskr.py
</pre></div>
</div>
<p>서버가 접근가능한 주소로 실행되었다고 알려주는 메시지를
접할 수 있을 것이다.</p>
<p>우리가 아직 아무런 뷰(view)를 만들지 않았기 때문에 브라우저에서는 페이지를
찾을 수 없다는 404에러를 볼 수 있을 것이다. 이부분에 대해서는 좀 더 후에
살펴 보도록 할 것이다. 먼저 살펴봐야 할 것은 데이터베이스가 작동되는지 확인하는 것이다.</p>
<div class="admonition- admonition">
<p class="first admonition-title">외부에서 접근가능한 서버</p>
<p class="last">당신의 서버를 외부에 공개하고 싶다면 다음 섹션을 참고 하라
<a class="reference internal" href="index.html#public-server"><span>externally visible server</span></a></p>
</div>
<p>Continue with <a class="reference internal" href="index.html#tutorial-dbinit"><span>스텝 3: 데이터베이스 생성하기</span></a>.</p>
</div>
<span id="document-tutorial/dbinit"></span><div class="section" id="tutorial-dbinit">
<span id="id1"></span><h4>스텝 3: 데이터베이스 생성하기<a class="headerlink" href="#tutorial-dbinit" title="제목 주소">¶</a></h4>
<p>Flaskr은 이전에 설명한 대로 데이터베이스를 사용하는 어플리케이션이고
좀더 정확하게는 관계형 데이터베이스 시스템에 의해 구동되는 어플리케이션이다.
이러한 시스템은 어떻게 데이터를 저장할지에 대한 정보를 가지고 있는 스키마가 필요하다.
그래서 처음으로 서버를 실행하기 전에 스키마를 생성하는 것이 중요하다.</p>
<p>이러한 스키마는 <cite>schema.sql</cite> 파일을 이용하여 <cite>sqlite3</cite> 명령어를 사용하여
다음과 같이 만들 수 있다.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sqlite3</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">flaskr</span><span class="o">.</span><span class="n">db</span> <span class="o">&lt;</span> <span class="n">schema</span><span class="o">.</span><span class="n">sql</span>
</pre></div>
</div>
<p>이방법에서의 단점은 sqlite3 명령어가 필요하다는 점인데, sqlite3 명령어는 모든
시스템들에서 필수적으로 설치되어 있는 것은 아니기 때문이다.
한가지 추가적인 문제는 데이터베이스 경로로 제공받은 어떤 경로들은 오류를 발생시킬 수도 있다는 것이다.
당신의 어플리케이션에 데이터베이스를 초기화 하는 함수를 추가하는 것은 좋은 생각이다.</p>
<p>만약 당신이 데이터베이스를 초기화 하는 함수를 추가하기 원한다면
먼저 contextlib 패키지에 있는 <a class="reference external" href="http://docs.python.org/dev/library/contextlib.html#contextlib.closing" title="(in Python v3.6)"><code class="xref py py-func docutils literal"><span class="pre">contextlib.closing()</span></code></a> 함수를 import 해야한다.
만약 Python 2.5를 사용하고 싶다면 먼저 <cite>with</cite> 구문을 추가적으로 사용해야 하다.
(<cite>__future__</cite> 를 반드시 제일 먼저 import 해야 한다.).
따라서, 다음의 라인들을 기존의 <cite>flaskr.py</cite> 파일에 추가한다.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">with_statement</span>
<span class="kn">from</span> <span class="nn">contextlib</span> <span class="kn">import</span> <span class="n">closing</span>
</pre></div>
</div>
<p>다음으로 우리는 데이터베이스를 초기화 시키는 <cite>init_db</cite> 함수를 만들 수 있다.
이 함수에서 우리는 앞서 정의한 <cite>connect_db</cite> 함수를 사용할 수 있다.
<cite>flaskr.py</cite> 파일의 <cite>connect_db</cite> 함수 아래에 다음의 내용을 추가 하자.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">init_db</span><span class="p">():</span>
    <span class="k">with</span> <span class="n">closing</span><span class="p">(</span><span class="n">connect_db</span><span class="p">())</span> <span class="k">as</span> <span class="n">db</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">app</span><span class="o">.</span><span class="n">open_resource</span><span class="p">(</span><span class="s">&#39;schema.sql&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">db</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span><span class="o">.</span><span class="n">executescript</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
        <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>
</div>
<p><a class="reference external" href="http://docs.python.org/dev/library/contextlib.html#contextlib.closing" title="(in Python v3.6)"><code class="xref py py-func docutils literal"><span class="pre">closing()</span></code></a> 함수는 <cite>with</cite> 블럭안에서 연결한 커넥션을 유지하도록
도와준다. <a class="reference internal" href="index.html#flask.Flask.open_resource" title="flask.Flask.open_resource"><code class="xref py py-func docutils literal"><span class="pre">open_resource()</span></code></a> 는 어플리케이션 객체의 함수이며
영역 밖에서도 기능을 지원하며 <cite>with</cite> 블럭에서 직접적으로 사용할 수 있다.
이 함수를 통해서 리소스 경로(<cite>flaskr</cite> 의 폴더)의 파일을 열고 그 값을 읽을 수 있다.
우리는 이것을 이용하여 데이터베이스에 연결하는 스크립트를 실행시킬 것이다.</p>
<p>우리가 데이터베이스에 연결할 때 우리는 커서를 제공하는 커넥션 객체를 얻는다.
(여기에서는 <cite>db</cite> 라고 부르려고 한다.) 커서에는 전체 스크립트를 실행하는 메소드를 가지고 있다.
마지막으로, 우리는 변경사항들을 커밋해야 한다. SQLite 3 이다 다른 트랜잭션 데이터베이스들은
명시적으로 커밋을 하도록 선언하지 않는 이상 진행하지 않는다.</p>
<p>이제 Python 쉘에서 다음 함수를 import 하여 실행시키면 데이터베이스 생성이 가능하다.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">flaskr</span> <span class="kn">import</span> <span class="n">init_db</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">init_db</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition-troubleshooting admonition">
<p class="first admonition-title">Troubleshooting</p>
<p class="last">만약 테이블을 찾을 수 없다는 예외사항이 발생하면 <cite>init_db</cite> 함수를
호출하였는지 확인하고 테이블 이름이 정확한지 확인하라.
(예를들면 단수형, 복수형과 같은 실수..)</p>
</div>
<p>다음 섹션에서 계속된다.  <a class="reference internal" href="index.html#tutorial-dbcon"><span>스텝 4: 데이터베이스 커넥션 요청하기</span></a></p>
</div>
<span id="document-tutorial/dbcon"></span><div class="section" id="tutorial-dbcon">
<span id="id1"></span><h4>스텝 4: 데이터베이스 커넥션 요청하기<a class="headerlink" href="#tutorial-dbcon" title="제목 주소">¶</a></h4>
<p>이제 우리는 어떻게 데이터베이스 커넥션을 생성할 수 있고 스크립트에서 어떻게 사용되는지 알고 있다.
하지만 어떻게 하면 좀더 근사하게 커넥션 요청을 할 수 있을까?
우리는 우리의 모든 함수에서 데이터베이스 커넥션을 필요로 한다.
그러므로 요청이 오기전에 커넥션을 초기화 하고 사용이 끝난 후 종료시키는 것이
합리적이다.</p>
<p>Flask에서는 <a class="reference internal" href="index.html#flask.Flask.before_request" title="flask.Flask.before_request"><code class="xref py py-meth docutils literal"><span class="pre">before_request()</span></code></a> ,
<a class="reference internal" href="index.html#flask.Flask.after_request" title="flask.Flask.after_request"><code class="xref py py-meth docutils literal"><span class="pre">after_request()</span></code></a> 그리고 <a class="reference internal" href="index.html#flask.Flask.teardown_request" title="flask.Flask.teardown_request"><code class="xref py py-meth docutils literal"><span class="pre">teardown_request()</span></code></a>
데코레이터(decorators)를 이용할 수 있다.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.before_request</span>
<span class="k">def</span> <span class="nf">before_request</span><span class="p">():</span>
    <span class="n">g</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">connect_db</span><span class="p">()</span>

<span class="nd">@app.teardown_request</span>
<span class="k">def</span> <span class="nf">teardown_request</span><span class="p">(</span><span class="n">exception</span><span class="p">):</span>
    <span class="n">g</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>파라미터가 없는 <a class="reference internal" href="index.html#flask.Flask.before_request" title="flask.Flask.before_request"><code class="xref py py-meth docutils literal"><span class="pre">before_request()</span></code></a> 함수는 리퀘스트가 실행되기 전에
호출되는 함수이다. <a class="reference internal" href="index.html#flask.Flask.after_request" title="flask.Flask.after_request"><code class="xref py py-meth docutils literal"><span class="pre">after_request()</span></code></a> 함수는 리퀘스트가 실행된 다음에
호출되는 함수이며 클라이언트에게 전송된 응답(reponse)를 파리미터로 넘겨주어야 한다.
이 함수들은 반드시 사용된 응답(response)객체 혹은 새로운 응답(respone)객체를 리턴하여야 한다.
그러나 이 함수들은 예외가 발생할 경우 반드시 실행됨을 보장하지 않는다.
이 경우 예외상황은 <a class="reference internal" href="index.html#flask.Flask.teardown_request" title="flask.Flask.teardown_request"><code class="xref py py-meth docutils literal"><span class="pre">teardown_request()</span></code></a> 으로 전달된다.
이 함수들은 응답객체가 생성된 후 호출된다. 이 ㅎ마수들은 request객체를 수정할 수 없으며,
리턴 값들은 무시된다. 만약 리퀘스트가 진행중에 예외사항이 발생 했을 경우 해당 리퀘스트는
다시 각 함수들에게로 전달되며 그렇지 않을 경우에는 <cite>None</cite> 이 전달된다.</p>
<p>우리는 현재 사용중인 데이터베이스 커넥션을 특별하게 저장한다.
Flask 는 <a class="reference internal" href="index.html#flask.g" title="flask.g"><code class="xref py py-data docutils literal"><span class="pre">g</span></code></a> 라는 특별한 객체를 우리에게 제공한다. 이 객체는
각 함수들에 대해서 오직 한번의 리퀘스트에 대해서만 유효한 정보를 저장하하고 있다.
쓰레드환경의 경우 다른 객체에서 위와 같이 사용 할경우 작동이 보장되지 않기 때문에
결코 사용해서는 안된다.</p>
<p>이 특별한 <a class="reference internal" href="index.html#flask.g" title="flask.g"><code class="xref py py-data docutils literal"><span class="pre">g</span></code></a> 객체는 보이지않는 뒷편에서 마법과 같은 어떤일을 수행하여
쓰레드환경에서도 위와같은 사용이 올바르게 작동하도록 해준다.</p>
<p>다음 섹션에서 계속 <a class="reference internal" href="index.html#tutorial-views"><span>스텝 5: 뷰 함수들</span></a>.</p>
<div class="admonition hint">
<p class="first admonition-title">힌트</p>
<p>어느 곳에 이 소스코드를 위치시켜야 하나요?</p>
<p>만얀 당신이 이 튜토리얼을 따라서 여기까지 진행했다면, 아마도 당신은
이번 스텝과 다음스텝 어디에 코드를 작성해 넣어야 하는지 궁금할 수 있습니다.
논리적인 위치는 함수들이 함께 그룹핑되는 모듈 레벨의 위치 이고,
새로 만든 <code class="docutils literal"><span class="pre">before_request</span></code> 와 <code class="docutils literal"><span class="pre">teardown_request</span></code> 함수를 기존의 <a href="#id2"><span class="problematic" id="id3">``</span></a>init_db`
함수 아래에 작성할 수 있다.
(튜토리얼을 따라 한줄씩 작성한다.)</p>
<p class="last">만약 현시점에서 각 부분들의 관계를 알고 싶다면, <a class="reference external" href="http://github.com/mitsuhiko/flask/tree/master/examples/flaskr/">예제 소스</a> 가 어떻게
구성되어 있는지 눈여겨 볼 필요가 있다. Flask에서는 하나의 Python 파일에 당신의
모든 어플리케이션 코드를 다 작성하여 넣는것도 가능하다.
물론 정말 그렇게 할 필요는 없다. 만약 당신의 어플리케이션이 <a class="reference internal" href="index.html#larger-applications"><span>grows larger</span></a>
점점 커져간다면 이것은 좋은 생각이 아니다.</p>
</div>
</div>
<span id="document-tutorial/views"></span><div class="section" id="tutorial-views">
<span id="id1"></span><h4>스텝 5: 뷰 함수들<a class="headerlink" href="#tutorial-views" title="제목 주소">¶</a></h4>
<p>이제 데이터베이스 연결이 제대로 작동하므로 우리는 이제 뷰함수 작성을
시작할 수 있다. 우리는 뷰함수중 네가지를 사용합니다.</p>
<div class="section" id="id2">
<h5>작성된 글 보여주기<a class="headerlink" href="#id2" title="제목 주소">¶</a></h5>
<p>이뷰는 데이터베이스에 저장된 모든 글들을 보여준다.
이뷰에서는 어플리케이션 루트에서 대기하고 있다가 요청이 오면 데이터베이스의
title 컬럼과 text 컬럼에서 자료를 검색하여 보여준다.
가장 큰 값을 가지고 있는 id (가장 최신 항목)를 제일 위에서 보여준다.
커서를 통해 리턴되는 row들은 select 구문에서 명시된 순서대로 정리된 튜플(tuples)이다.
여기에서 다루는 예에서 사용하는 작은 어플리케이션에게는 이정도 기능만으로도
충분하다. 하지만 튜플들을 dict타입으로 변경하고 싶을수도 있을것이다.
만약 어떻게 변경이 가능한지 흥미있다면 다음의 예제를 참고 할 수 있다.
<a class="reference internal" href="index.html#easy-querying"><span>쉬운 질의하기</span></a> 예제.</p>
<p>뷰 함수는 데이터베이스에서 검색된 항목들을 dict 타입으로 <cite>show_entries.html</cite> template 에
렌더링하여 리턴한다.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">show_entries</span><span class="p">():</span>
    <span class="n">cur</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s">&#39;select title, text from entries order by id desc&#39;</span><span class="p">)</span>
    <span class="n">entries</span> <span class="o">=</span> <span class="p">[</span><span class="nb">dict</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">text</span><span class="o">=</span><span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()]</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">&#39;show_entries.html&#39;</span><span class="p">,</span> <span class="n">entries</span><span class="o">=</span><span class="n">entries</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h5>새로운 글 추가하기<a class="headerlink" href="#id3" title="제목 주소">¶</a></h5>
<p>이뷰는 로그인한 사용자에게 새로운 글을 작성하게 해준다. 이뷰는 오직
<cite>POST</cite> 리퀘스트에만 응답하도록 하고 이와 관련된 실제 form은 <cite>show_entries</cite>
페이지에 있다. 만약 모든것이 제대로 작동하고 있다면 <a class="reference internal" href="index.html#flask.flash" title="flask.flash"><code class="xref py py-func docutils literal"><span class="pre">flash()</span></code></a>  에서
메시지로 새로작성된 글에 대한 정보를 보여주고 <cite>show_entries</cite> 페이지로 리다이렉션한다.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/add&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;POST&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">add_entry</span><span class="p">():</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;logged_in&#39;</span><span class="p">):</span>
        <span class="n">abort</span><span class="p">(</span><span class="mi">401</span><span class="p">)</span>
    <span class="n">g</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s">&#39;insert into entries (title, text) values (?, ?)&#39;</span><span class="p">,</span>
                 <span class="p">[</span><span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s">&#39;title&#39;</span><span class="p">],</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s">&#39;text&#39;</span><span class="p">]])</span>
    <span class="n">g</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
    <span class="n">flash</span><span class="p">(</span><span class="s">&#39;New entry was successfully posted&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s">&#39;show_entries&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>우리는 여기에서 사용자가 로그인되었는지 체크 할 것이라는 것을 주목하자.
(세션에서  <cite>logged_in</cite> 키가 존재하고 값이 <cite>True</cite> 인지 확인한다.)</p>
<div class="admonition-security-note admonition">
<p class="first admonition-title">Security Note</p>
<p class="last">위의 예에서 SQL 구문을 생성할때 물음표를 사용하도록 해야 한다.
그렇지 않고 SQL 구문에서 문자열 포맷팅을 사용하게 되면 당신의
어플리케이션은 SQL injection에 취약해질 것이다.
다음의 섹션을 확인해보자:ref:<cite>sqlite3</cite></p>
</div>
</div>
<div class="section" id="id4">
<h5>로그인과 로그아웃<a class="headerlink" href="#id4" title="제목 주소">¶</a></h5>
<p>이 함수들은 사용자의 로그인과 로그아웃에 사용된다. 로그인을 할때에는
입력받은 사용자이름과 패스워드를 설정에서 셋팅한 값과 비교하여
세션의 <cite>logged_in</cite> 키에 값을 설정하여 로그인상태와 로드아웃상태를 결정한다.
만약 사용자가 성공적으로 로그인 되었다면 키값에 <cite>True</cite> 를 셋팅한 후에 <cite>show_entries</cite>
페이지로 리다이렉트한다.</p>
<p>또한 사용자가 성공적으로 로그인되었는지 메시지로 정보를 보여준다.
만약 오류가 발생하였다면, 템플릿에서 오류내용에 대해 통지하고 사용자에게
다시 질문하도록 한다.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/login&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">,</span> <span class="s">&#39;POST&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">login</span><span class="p">():</span>
    <span class="n">error</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s">&#39;POST&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s">&#39;username&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&#39;USERNAME&#39;</span><span class="p">]:</span>
            <span class="n">error</span> <span class="o">=</span> <span class="s">&#39;Invalid username&#39;</span>
        <span class="k">elif</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s">&#39;password&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&#39;PASSWORD&#39;</span><span class="p">]:</span>
            <span class="n">error</span> <span class="o">=</span> <span class="s">&#39;Invalid password&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">session</span><span class="p">[</span><span class="s">&#39;logged_in&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">flash</span><span class="p">(</span><span class="s">&#39;You were logged in&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s">&#39;show_entries&#39;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">&#39;login.html&#39;</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span>
</pre></div>
</div>
<p>다른 한편으로 로그아웃 함수는 세션에서 <cite>logged_in</cite> 키값에 대하여 로그인 설정에
대한 값을 제거한다. 우리는 여기에서 정교한 트릭을 사용할 것이다 : 만약 당신이 dict객체의
<a class="reference external" href="http://docs.python.org/dev/library/stdtypes.html#dict.pop" title="(in Python v3.6)"><code class="xref py py-meth docutils literal"><span class="pre">pop()</span></code></a> 함수에 두번째 파라미터(기본값)를 전달하여 사용하면 이 함수는 만약 해당 키가
dcit객체에 존재하거나 그렇지 않은 경우 dict객체에서 해당 키를 삭제할 것이다.
이 방법은 사용자가 로그인 하였는지 아닌지 체크할 필요가 없기 때문에 유용하다.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/logout&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">logout</span><span class="p">():</span>
    <span class="n">session</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;logged_in&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="n">flash</span><span class="p">(</span><span class="s">&#39;You were logged out&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s">&#39;show_entries&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>다음 섹션에 계속된다.  <a class="reference internal" href="index.html#tutorial-templates"><span>스텝 6: 템플릿</span></a>.</p>
</div>
</div>
<span id="document-tutorial/templates"></span><div class="section" id="tutorial-templates">
<span id="id1"></span><h4>스텝 6: 템플릿<a class="headerlink" href="#tutorial-templates" title="제목 주소">¶</a></h4>
<p>이제 우리는 템플릿을 작업해야 한다. 만약 우리가 지금까지 만든 flaskr에
URL을 요청하는 경우 Flask는 템플릿(templates)을 찾을 수 없다는 예외를 발생시킬것이다.
템플릿들은 <a class="reference external" href="http://jinja.pocoo.org/2/documentation/templates">Jinja2</a> 문법을 사용하고 있고 autoescaping 가 기본으로 활성화되있다.
이 의미는 개발자가 직접 :class&#8221;<cite>~flask.Markup</cite> 이나 혹은 <code class="docutils literal"><span class="pre">|safe</span></code> 필터를 템플릿에서
직접 관리하지 않아도 된다는 뜻이다.
Jinja2는 <code class="docutils literal"><span class="pre">&lt;</span></code> 혹은 <code class="docutils literal"><span class="pre">&gt;</span></code> 와 같은 특별한 문자들에 대하여 XML에서 표기하는 동등한 표기법으로
탈피할 수 있도록 보장한다.</p>
<p>우리는 또한 가능한 모든 페이지에서 웹 사이트의 레이아웃을 재사용 할 수있도록 템플릿 상속을
할 수 있도록 하고 있다.</p>
<p>다음의 템플릿을 <cite>templates</cite> 폴더에 넣도록 하자:</p>
<div class="section" id="layout-html">
<h5>layout.html<a class="headerlink" href="#layout-html" title="제목 주소">¶</a></h5>
<p>이 템플릿은 HTML의 뼈대(skeleton)을, 헤더 및 로그인링크 (혹은 사용자가 로그인
한 경우에는 로그아웃 링크)들을 포함하고 있다. 또한 상황에 딸라 메시지를 보여주기도 한다.
부모 템플릿의 <code class="docutils literal"><span class="pre">{%</span> <span class="pre">block</span> <span class="pre">body</span> <span class="pre">%}</span></code> 블럭은 이를 상속받은 후손 템플릿에서 동일한 이름의 블럭위치에
치환된다.</p>
<p><a class="reference internal" href="index.html#flask.session" title="flask.session"><code class="xref py py-class docutils literal"><span class="pre">session</span></code></a> dict 객체도 템플릿안에서 사용 가능할 수 있으며 이를 이용해
사용자가 로그인되어 있는지 그렇지 않은지 확인 할 수 있다.</p>
<p>Jinja에서는 세션에서 키(key)가 없는 경우에도 제공된 dict 객체의 누락된 속성값이나 객체에
접근이 가능하다. 세션곅체에  <code class="docutils literal"><span class="pre">'logged_in'</span></code> 키가 없는 경우에도 가능하다.</p>
<div class="highlight-html+jinja"><div class="highlight"><pre><span class="cp">&lt;!doctype html&gt;</span>
<span class="nt">&lt;title&gt;</span>Flaskr<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">stylesheet</span> <span class="na">type=</span><span class="s">text/css</span> <span class="na">href=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">url_for</span><span class="o">(</span><span class="s1">&#39;static&#39;</span><span class="o">,</span> <span class="nv">filename</span><span class="o">=</span><span class="s1">&#39;style.css&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">page</span><span class="nt">&gt;</span>
  <span class="nt">&lt;h1&gt;</span>Flaskr<span class="nt">&lt;/h1&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">metanav</span><span class="nt">&gt;</span>
  <span class="cp">{%</span> <span class="k">if</span> <span class="k">not</span> <span class="nv">session.logged_in</span> <span class="cp">%}</span>
    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">url_for</span><span class="o">(</span><span class="s1">&#39;login&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span><span class="nt">&gt;</span>log in<span class="nt">&lt;/a&gt;</span>
  <span class="cp">{%</span> <span class="k">else</span> <span class="cp">%}</span>
    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">url_for</span><span class="o">(</span><span class="s1">&#39;logout&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span><span class="nt">&gt;</span>log out<span class="nt">&lt;/a&gt;</span>
  <span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="cp">{%</span> <span class="k">for</span> <span class="nv">message</span> <span class="k">in</span> <span class="nv">get_flashed_messages</span><span class="o">()</span> <span class="cp">%}</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">flash</span><span class="nt">&gt;</span><span class="cp">{{</span> <span class="nv">message</span> <span class="cp">}}</span><span class="nt">&lt;/div&gt;</span>
  <span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
  <span class="cp">{%</span> <span class="k">block</span> <span class="nv">body</span> <span class="cp">%}{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="show-entries-html">
<h5>show_entries.html<a class="headerlink" href="#show-entries-html" title="제목 주소">¶</a></h5>
<p>이 템플릿은 <cite>layout.html</cite> 템플릿을 상속받는 메시지를 보여주는 템플릿이다.
유의할 점은 <cite>for</cite> 루프는 우리가 <a class="reference internal" href="index.html#flask.render_template" title="flask.render_template"><code class="xref py py-func docutils literal"><span class="pre">render_template()</span></code></a> 함수에서
전달한 메시지에들 만큼 반복된다는 점이다.
우리는 또한 form이 전송될때 <cite>add_entry</cite> 함수가 <cite>HTTP`의 `POST</cite> 메소드를 통해서
전송된다는 것을 이야기 해둔다.:</p>
<div class="highlight-html+jinja"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">extends</span> <span class="s2">&quot;layout.html&quot;</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">block</span> <span class="nv">body</span> <span class="cp">%}</span>
  <span class="cp">{%</span> <span class="k">if</span> <span class="nv">session.logged_in</span> <span class="cp">%}</span>
    <span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">url_for</span><span class="o">(</span><span class="s1">&#39;add_entry&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span> <span class="na">method=</span><span class="s">post</span> <span class="na">class=</span><span class="s">add-entry</span><span class="nt">&gt;</span>
      <span class="nt">&lt;dl&gt;</span>
        <span class="nt">&lt;dt&gt;</span>Title:
        <span class="nt">&lt;dd&gt;&lt;input</span> <span class="na">type=</span><span class="s">text</span> <span class="na">size=</span><span class="s">30</span> <span class="na">name=</span><span class="s">title</span><span class="nt">&gt;</span>
        <span class="nt">&lt;dt&gt;</span>Text:
        <span class="nt">&lt;dd&gt;&lt;textarea</span> <span class="na">name=</span><span class="s">text</span> <span class="na">rows=</span><span class="s">5</span> <span class="na">cols=</span><span class="s">40</span><span class="nt">&gt;&lt;/textarea&gt;</span>
        <span class="nt">&lt;dd&gt;&lt;input</span> <span class="na">type=</span><span class="s">submit</span> <span class="na">value=</span><span class="s">Share</span><span class="nt">&gt;</span>
      <span class="nt">&lt;/dl&gt;</span>
    <span class="nt">&lt;/form&gt;</span>
  <span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
  <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">entries</span><span class="nt">&gt;</span>
  <span class="cp">{%</span> <span class="k">for</span> <span class="nv">entry</span> <span class="k">in</span> <span class="nv">entries</span> <span class="cp">%}</span>
    <span class="nt">&lt;li&gt;&lt;h2&gt;</span><span class="cp">{{</span> <span class="nv">entry.title</span> <span class="cp">}}</span><span class="nt">&lt;/h2&gt;</span><span class="cp">{{</span> <span class="nv">entry.text</span><span class="o">|</span><span class="nf">safe</span> <span class="cp">}}</span>
  <span class="cp">{%</span> <span class="k">else</span> <span class="cp">%}</span>
    <span class="nt">&lt;li&gt;&lt;em&gt;</span>Unbelievable.  No entries here so far<span class="nt">&lt;/em&gt;</span>
  <span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
  <span class="nt">&lt;/ul&gt;</span>
<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
</pre></div>
</div>
</div>
<div class="section" id="login-html">
<h5>login.html<a class="headerlink" href="#login-html" title="제목 주소">¶</a></h5>
<p>마지막으로 로그인 템플릿은 기본적으로 사용자가 로그인을 할 수 있도록 보여주는 form 이다. :</p>
<div class="highlight-html+jinja"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">extends</span> <span class="s2">&quot;layout.html&quot;</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">block</span> <span class="nv">body</span> <span class="cp">%}</span>
  <span class="nt">&lt;h2&gt;</span>Login<span class="nt">&lt;/h2&gt;</span>
  <span class="cp">{%</span> <span class="k">if</span> <span class="nv">error</span> <span class="cp">%}</span><span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">error</span><span class="nt">&gt;&lt;strong&gt;</span>Error:<span class="nt">&lt;/strong&gt;</span> <span class="cp">{{</span> <span class="nv">error</span> <span class="cp">}}{%</span> <span class="k">endif</span> <span class="cp">%}</span>
  <span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">url_for</span><span class="o">(</span><span class="s1">&#39;login&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span> <span class="na">method=</span><span class="s">post</span><span class="nt">&gt;</span>
    <span class="nt">&lt;dl&gt;</span>
      <span class="nt">&lt;dt&gt;</span>Username:
      <span class="nt">&lt;dd&gt;&lt;input</span> <span class="na">type=</span><span class="s">text</span> <span class="na">name=</span><span class="s">username</span><span class="nt">&gt;</span>
      <span class="nt">&lt;dt&gt;</span>Password:
      <span class="nt">&lt;dd&gt;&lt;input</span> <span class="na">type=</span><span class="s">password</span> <span class="na">name=</span><span class="s">password</span><span class="nt">&gt;</span>
      <span class="nt">&lt;dd&gt;&lt;input</span> <span class="na">type=</span><span class="s">submit</span> <span class="na">value=</span><span class="s">Login</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/dl&gt;</span>
  <span class="nt">&lt;/form&gt;</span>
<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
</pre></div>
</div>
<p>다음 섹션에서 계속 <a class="reference internal" href="index.html#tutorial-css"><span>스텝 7: 스타일 추가하기</span></a>.</p>
</div>
</div>
<span id="document-tutorial/css"></span><div class="section" id="tutorial-css">
<span id="id1"></span><h4>스텝 7: 스타일 추가하기<a class="headerlink" href="#tutorial-css" title="제목 주소">¶</a></h4>
<p>이제 모든것들이 작동한다. 이제 약간의 스타일을 어플리케이션에 추가해볼 시간이다.
전에 생성해 두었던 <cite>static</cite> 폴더에 <cite>style.css</cite> 이라고 불리는 스타일시트를 생성해서 추가해 보자:</p>
<div class="highlight-css"><div class="highlight"><pre><span class="nt">body</span>            <span class="p">{</span> <span class="k">font-family</span><span class="o">:</span> <span class="k">sans-serif</span><span class="p">;</span> <span class="k">background</span><span class="o">:</span> <span class="m">#eee</span><span class="p">;</span> <span class="p">}</span>
<span class="nt">a</span><span class="o">,</span> <span class="nt">h1</span><span class="o">,</span> <span class="nt">h2</span>       <span class="p">{</span> <span class="k">color</span><span class="o">:</span> <span class="m">#377BA8</span><span class="p">;</span> <span class="p">}</span>
<span class="nt">h1</span><span class="o">,</span> <span class="nt">h2</span>          <span class="p">{</span> <span class="k">font-family</span><span class="o">:</span> <span class="s1">&#39;Georgia&#39;</span><span class="o">,</span> <span class="k">serif</span><span class="p">;</span> <span class="k">margin</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span> <span class="p">}</span>
<span class="nt">h1</span>              <span class="p">{</span> <span class="k">border-bottom</span><span class="o">:</span> <span class="m">2px</span> <span class="k">solid</span> <span class="m">#eee</span><span class="p">;</span> <span class="p">}</span>
<span class="nt">h2</span>              <span class="p">{</span> <span class="k">font-size</span><span class="o">:</span> <span class="m">1.2em</span><span class="p">;</span> <span class="p">}</span>

<span class="nc">.page</span>           <span class="p">{</span> <span class="k">margin</span><span class="o">:</span> <span class="m">2em</span> <span class="k">auto</span><span class="p">;</span> <span class="k">width</span><span class="o">:</span> <span class="m">35em</span><span class="p">;</span> <span class="k">border</span><span class="o">:</span> <span class="m">5px</span> <span class="k">solid</span> <span class="m">#ccc</span><span class="p">;</span>
                  <span class="k">padding</span><span class="o">:</span> <span class="m">0.8em</span><span class="p">;</span> <span class="k">background</span><span class="o">:</span> <span class="nb">white</span><span class="p">;</span> <span class="p">}</span>
<span class="nc">.entries</span>        <span class="p">{</span> <span class="k">list-style</span><span class="o">:</span> <span class="k">none</span><span class="p">;</span> <span class="k">margin</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span> <span class="k">padding</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span> <span class="p">}</span>
<span class="nc">.entries</span> <span class="nt">li</span>     <span class="p">{</span> <span class="k">margin</span><span class="o">:</span> <span class="m">0.8em</span> <span class="m">1.2em</span><span class="p">;</span> <span class="p">}</span>
<span class="nc">.entries</span> <span class="nt">li</span> <span class="nt">h2</span>  <span class="p">{</span> <span class="k">margin-left</span><span class="o">:</span> <span class="m">-1em</span><span class="p">;</span> <span class="p">}</span>
<span class="nc">.add-entry</span>      <span class="p">{</span> <span class="k">font-size</span><span class="o">:</span> <span class="m">0.9em</span><span class="p">;</span> <span class="k">border-bottom</span><span class="o">:</span> <span class="m">1px</span> <span class="k">solid</span> <span class="m">#ccc</span><span class="p">;</span> <span class="p">}</span>
<span class="nc">.add-entry</span> <span class="nt">dl</span>   <span class="p">{</span> <span class="k">font-weight</span><span class="o">:</span> <span class="k">bold</span><span class="p">;</span> <span class="p">}</span>
<span class="nc">.metanav</span>        <span class="p">{</span> <span class="k">text-align</span><span class="o">:</span> <span class="k">right</span><span class="p">;</span> <span class="k">font-size</span><span class="o">:</span> <span class="m">0.8em</span><span class="p">;</span> <span class="k">padding</span><span class="o">:</span> <span class="m">0.3em</span><span class="p">;</span>
                  <span class="k">margin-bottom</span><span class="o">:</span> <span class="m">1em</span><span class="p">;</span> <span class="k">background</span><span class="o">:</span> <span class="m">#fafafa</span><span class="p">;</span> <span class="p">}</span>
<span class="nc">.flash</span>          <span class="p">{</span> <span class="k">background</span><span class="o">:</span> <span class="m">#CEE5F5</span><span class="p">;</span> <span class="k">padding</span><span class="o">:</span> <span class="m">0.5em</span><span class="p">;</span>
                  <span class="k">border</span><span class="o">:</span> <span class="m">1px</span> <span class="k">solid</span> <span class="m">#AACBE2</span><span class="p">;</span> <span class="p">}</span>
<span class="nc">.error</span>          <span class="p">{</span> <span class="k">background</span><span class="o">:</span> <span class="m">#F0D6D6</span><span class="p">;</span> <span class="k">padding</span><span class="o">:</span> <span class="m">0.5em</span><span class="p">;</span> <span class="p">}</span>
</pre></div>
</div>
<p>다음 섹션에서 계속 <a class="reference internal" href="index.html#tutorial-testing"><span>보너스: 어플리케이션 테스트 하기</span></a>.</p>
</div>
<span id="document-tutorial/testing"></span><div class="section" id="tutorial-testing">
<span id="id1"></span><h4>보너스: 어플리케이션 테스트 하기<a class="headerlink" href="#tutorial-testing" title="제목 주소">¶</a></h4>
<p>이제 당신은 어플리케이션 개발을 끝마쳤고 모든것들이 예상한대로 작동한다.
미래에 어플리케이션을 수정하게될 경우를 대비해 테스트를 자동화하는 것은
나쁜 생각이 아니다. 위에서 소개한 어플리케이션은 유닛테스트를 어떻게 수행하는지에
대한 기본적인 예제를 가지고 있다. 이 문서의 <a class="reference internal" href="index.html#testing"><span>Flask 어플리케이션 테스트하기</span></a> 섹션을 참고하라.
해당 문서를 살펴보고 어떻게 쉽게 Flask 어플리케이션을 테스트 할 수있는지 알아보자</p>
</div>
</div>
</div>
<span id="document-templating"></span><div class="section" id="id1">
<h3>템플릿<a class="headerlink" href="#id1" title="제목 주소">¶</a></h3>
<p>Flask는 템플릿엔진으로 Jinja2를 사용한다. 물론 다른 무료 템플릿엔진을
사용할 수 있지만, Flask를 구동하기 위해서는 Jinja2를 반드시 설치해야 한다.
Jinja2가 필요한 이유는 Flask의 풍부한 기능 확장을 위해서이다.
확장기능은 Jinja2와 의존관계에 있을 수도 있다.</p>
<p>이 섹션은 Jinja2가 Flask에 어떻게 통합되어 있는지 빠르게 소개하는 섹션이다.
만약 템플릿엔진 자체의 문법에 대한 정보를 얻기 원한다면 Jinja2 공식 문서인 <a class="reference external" href="http://jinja.pocoo.org/2/documentation/templates">Jinja2 Template
Documentation</a>  를 참고하라.</p>
<div class="section" id="jinja">
<h4>Jinja 설정<a class="headerlink" href="#jinja" title="제목 주소">¶</a></h4>
<p>사용자가 임의로 설정하지 않는이상, Jinja2는 다음과 같이 Flask에 의해 설정되어 있다.:</p>
<ul class="simple">
<li>자동변환(autoescaping) 기능은 <code class="docutils literal"><span class="pre">.html</span></code> , <code class="docutils literal"><span class="pre">.xml</span></code> 과 <code class="docutils literal"><span class="pre">.xhtml</span></code> 과 같은 모든
템플릿 파일들에 대해서 기본으로 활성화되어 있다.</li>
<li>하나의 템플릿은 in/out에 대한 자동변환(autoescape) 기능을 <code class="docutils literal"><span class="pre">{%</span> <span class="pre">autoescape</span> <span class="pre">%}</span></code> 태그를 이용하여 사용할 수 있다.</li>
<li>Flask는 기본적으로 Jinja2 컨텍스트(context)를 통해서 전역 함수들과 헬퍼함수들을 제공한다.</li>
</ul>
</div>
<div class="section" id="id2">
<h4>표준 컨텍스트<a class="headerlink" href="#id2" title="제목 주소">¶</a></h4>
<p>다음의 전역 변수들은 Jinja2에서 기본으로 사용가능하다.:</p>
<dl class="data">
<dt>
<code class="descname">config</code></dt>
<dd><p>현재 설정값을 가지고 있는 객체 (<code class="xref py py-data docutils literal"><span class="pre">flask.config</span></code>)</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.6에 추가.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">버전 0.10으로 변경: </span>This is now always available, even in imported templates.</p>
</div>
</dd></dl>

<dl class="data">
<dt>
<code class="descname">request</code></dt>
<dd><p>현재 요청된 객체 (request object)  (<a class="reference internal" href="index.html#flask.request" title="flask.request"><code class="xref py py-class docutils literal"><span class="pre">flask.request</span></code></a>). 이 변수는
템플릿이 활성화된 컨텍스트에서 요청된것이 아니라면 유효하지 않다.</p>
</dd></dl>

<dl class="data">
<dt>
<code class="descname">session</code></dt>
<dd><p>현재 가지고 있는 세션 객체 (<a class="reference internal" href="index.html#flask.session" title="flask.session"><code class="xref py py-class docutils literal"><span class="pre">flask.session</span></code></a>).  이 변수는
템플릿이 활성화된 컨텍스트에서 요청된것이 아니라면 유효하지 않다.</p>
</dd></dl>

<dl class="data">
<dt>
<code class="descname">g</code></dt>
<dd><p>요청(request)에 한정되어진 전역 변수  (<a class="reference internal" href="index.html#flask.g" title="flask.g"><code class="xref py py-data docutils literal"><span class="pre">flask.g</span></code></a>) . 이 변수는
템플릿이 활성화된 컨텍스트에서 요청된것이 아니라면 유효하지 않다.</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descname">url_for</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p><a class="reference internal" href="index.html#flask.url_for" title="flask.url_for"><code class="xref py py-func docutils literal"><span class="pre">flask.url_for()</span></code></a> 함수 참고.</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descname">get_flashed_messages</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p><a class="reference internal" href="index.html#flask.get_flashed_messages" title="flask.get_flashed_messages"><code class="xref py py-func docutils literal"><span class="pre">flask.get_flashed_messages()</span></code></a> 함수 참고.</p>
</dd></dl>

<div class="admonition-jinja admonition">
<p class="first admonition-title">Jinja 환경에서의 작동방식</p>
<p>이러한 변수들은 변수 컨텍스트에 추가되며 전역 변수가 아니다.
전역변수와의 차이점은 컨텍스트에서 불려진 템플릿에서는 기본적으로 보이지는 않는다는 것이다.
이것은 일부분은 성능을 고려하기위해서고 일부분은 명시적으로 유지하기 위해서이다.</p>
<p>이것은 무엇을 의미하는가? 만약 불러오고 싶은 매크로(macro)를 가지고 있다면,
요청 객체(request object)에 접근하는 것이 필요하며 여기에 두가지 가능성이 있다.:</p>
<ol class="arabic simple">
<li>매크로(macro)로 요청 객체를 파라미터로 명시적으로 전달하거나,
관심있는 객체에 속성값으로 가지고 있어야 한다.</li>
<li>매크로를 컨텍스트로 불러와야한다.</li>
</ol>
<p>다음과 같이 컨텍스트에서 불러온다.:</p>
<div class="last highlight-jinja"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">from</span> <span class="s1">&#39;_helpers.html&#39;</span> <span class="k">import</span> <span class="nv">my_macro</span> <span class="k">with context</span> <span class="cp">%}</span><span class="x"></span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id3">
<h4>표준 필터<a class="headerlink" href="#id3" title="제목 주소">¶</a></h4>
<p>다음 필터들은 Jinja2에서 자체적으로 추가 제공되어 이용할 수 있는 것들이다.:</p>
<dl class="function">
<dt>
<code class="descname">tojson</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>이 기능은 JSON 표기법으로 주어진 객체를 변환기켜주는 것이다.
예를들어 만약 JavaScript를 즉석에서 생성하려고 한다면 이기능은 많은 도움이 될것이다.</p>
<p><cite>script</cite> 태그안에서는 변환(escaping)이 반드시 일어나서는 안되기 때문에,
<code class="docutils literal"><span class="pre">|safe</span></code> 필터가 <cite>script</cite> 태그안에서 비활성화되도록 보장해야 한다.:</p>
<div class="highlight-html+jinja"><div class="highlight"><pre><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">text/javascript</span><span class="nt">&gt;</span>
    <span class="nx">doSomethingWith</span><span class="p">(</span><span class="cp">{{</span> <span class="nv">user.username</span><span class="o">|</span><span class="nf">tojson</span><span class="o">|</span><span class="nf">safe</span> <span class="cp">}}</span><span class="p">);</span>
<span class="nt">&lt;/script&gt;</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">|tojson</span></code> 필터는 올바르게 슬래쉬들을 변환해 준다.</p>
</dd></dl>

</div>
<div class="section" id="autoescaping">
<h4>자동변환(Autoescaping) 제어하기<a class="headerlink" href="#autoescaping" title="제목 주소">¶</a></h4>
<p>자동변환(Autoescaping)은 자동으로 특수 문자들을 변환시켜주는 개념이다.
특수문자들은 HTML (혹은 XML, 그리고 XHTML) 문서 에서 <code class="docutils literal"><span class="pre">&amp;</span></code>, <code class="docutils literal"><span class="pre">&gt;</span></code>, <code class="docutils literal"><span class="pre">&lt;</span></code>, <code class="docutils literal"><span class="pre">&quot;</span></code> , <code class="docutils literal"><span class="pre">'</span></code>
에 해당한다. 이 문자들은 해당 문서에서 특별한 의미들을 담고 있고 이 문자들을
텍스트 그대로 사용하고 싶다면 &#8220;entities&#8221; 라고 불리우는 값들로 변환하여야 한다.
이렇게 하지 않으면 본문에 해당 문자들을 사용할 수 없어 사용자에게 불만을
초래할뿐만 아니라 보안 문제도 발생할 수 있다.
(다음을 참고 <a class="reference internal" href="index.html#xss"><span>Cross-Site Scripting (XSS)</span></a>)</p>
<p>그러나 때때로 템플릿에서 이러한 자동변환을 비활성화 할 필요가 있다.
만약 명시적으로 HTML을 페이지에 삽입하려고 한다면,  예를 들어 HTML로 전환되는
마크다운(markdown)과 같은 안전한 HTML을 생성하는 특정 시스템으로부터 오는
것일 경우에는 유용하다.</p>
<p>이 경우 세가지 방법이 있다:</p>
<ul class="simple">
<li>Python 코드에서는, HTML 문자열을 <a class="reference internal" href="index.html#flask.Markup" title="flask.Markup"><code class="xref py py-class docutils literal"><span class="pre">Markup</span></code></a> 객체를 통해서
템플릿에 전달되기 전에 래핑한다. 이방법은 일반적으로 권장되는 방법이다.</li>
<li>템플릿 내부에, <code class="docutils literal"><span class="pre">|safe</span></code> 필터를 명시적으로 사용하여 문자열을 안전한 HTML이
되도록 한다. (<code class="docutils literal"><span class="pre">{{</span> <span class="pre">myvariable|safe</span> <span class="pre">}}</span></code>)</li>
<li>일시적으로 모두 자동변환(autoescape) 시스템을 해제한다.</li>
</ul>
<p>템플릿에서 자동변환(autoescape) 시스템을 비활성화 하려면, <code class="docutils literal"><span class="pre">{%autoescape</span> <span class="pre">%}</span></code>
블럭을 이용할 수 있다. :</p>
<div class="highlight-html+jinja"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">autoescape</span> <span class="kp">false</span> <span class="cp">%}</span>
    <span class="nt">&lt;p&gt;</span>autoescaping is disabled here
    <span class="nt">&lt;p&gt;</span><span class="cp">{{</span> <span class="nv">will_not_be_escaped</span> <span class="cp">}}</span>
<span class="cp">{%</span> <span class="k">endautoescape</span> <span class="cp">%}</span>
</pre></div>
</div>
<p>이 블럭이 수행될때마다, 이 블록에서 사용하는 변수애 대해 각별한 주의를 기울여야 한다.</p>
</div>
<div class="section" id="registering-filters">
<span id="id4"></span><h4>필터 등록하기<a class="headerlink" href="#registering-filters" title="제목 주소">¶</a></h4>
<p>만약 Jinja2에서 자신만의 필터를 직접 등록하기를 원한다면 두가지 방법이있다.
다음의 방법을 이용할 수 있다.
<a class="reference internal" href="index.html#flask.Flask.jinja_env" title="flask.Flask.jinja_env"><code class="xref py py-attr docutils literal"><span class="pre">jinja_env</span></code></a> Jinja 어플리케이션에서 이용하거나
<a class="reference internal" href="index.html#flask.Flask.template_filter" title="flask.Flask.template_filter"><code class="xref py py-meth docutils literal"><span class="pre">template_filter()</span></code></a> 데코레이터(decorator)를 이용가능하다.</p>
<p>다음 두개의 예제는 객체의 값을 거꾸로 만드는 같은 일을 한다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.template_filter</span><span class="p">(</span><span class="s">&#39;reverse&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">reverse_filter</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">s</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">reverse_filter</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">s</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">app</span><span class="o">.</span><span class="n">jinja_env</span><span class="o">.</span><span class="n">filters</span><span class="p">[</span><span class="s">&#39;reverse&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">reverse_filter</span>
</pre></div>
</div>
<p>만약 함수이름을 필터이름으로 사용하려면 데코레이터(decorator)의 아규먼트는 선택조건이어야한다.
한번 필터가 등록되면, Jinja2의 내장 필터를 사용하는 것과 똑같이 사용이 가능하다,
예를 들면 만약 <cite>mylist</cite> 라는 Python 리스트(list)가 컨텍스트에 있다면</p>
<div class="highlight-python"><div class="highlight"><pre>{% for x in mylist | reverse %}
{% endfor %}
</pre></div>
</div>
</div>
<div class="section" id="context-processor">
<h4>컨텍스트 프로세서(context processor)<a class="headerlink" href="#context-processor" title="제목 주소">¶</a></h4>
<p>새로운 변수들을 자동으로 템플릿의 컨텍스트에 주입시키기 위해서
Flask에는 컨텍스트 프로세서들이 존재한다.
컨텍스트 프로세서들은 새로운 값들을 템플릿 컨텍스트에 주입시키기 위해
템플릿이 렌더링되기 전에 실행되어야 한다.
템플릿 프로세서는 딕셔너리(dictionary) 객체를 리턴하는 함수이다.
이 딕셔너리의 키와 밸류들은 어플리케이션에서의 모든 템플릿들을 위해서
템플릿 컨텍스트에 통합된다.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.context_processor</span>
<span class="k">def</span> <span class="nf">inject_user</span><span class="p">():</span>
    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">user</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">user</span><span class="p">)</span>
</pre></div>
</div>
<p>위의 컨텍스트 프로세서는 <cite>user</cite> 라고 부르는 유효한 변수를 템플릿 내부에
<cite>g.user</cite> 의 값으로 만든다. 이 예제는 <cite>g</cite> 변수가 템플릿에서 유효하기 때문에
그렇게 흥미롭지는 않지만 어떻게 동작하는지에 대한 아이디어를 제공한다.</p>
<p>변수들은 값들에 제한되지 않으며, 또한 컨텍스트 프로세서는 템플릿에서
함수들을 사용할 수 있도록 해준다.
(Python이 패싱 어라운드(passing around)함수를 지원하기 때문에):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.context_processor</span>
<span class="k">def</span> <span class="nf">utility_processor</span><span class="p">():</span>
    <span class="k">def</span> <span class="nf">format_price</span><span class="p">(</span><span class="n">amount</span><span class="p">,</span> <span class="n">currency</span><span class="o">=</span><span class="s">u&#39;€&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">u&#39;{0:.2f}{1}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">amount</span><span class="p">,</span> <span class="n">currency</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">format_price</span><span class="o">=</span><span class="n">format_price</span><span class="p">)</span>
</pre></div>
</div>
<p>위의 컨텍스트 프로세서는 <cite>format_price</cite> 함수를 모든 템플릿들에서 사용가능하도록 해준다</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{{</span> <span class="n">format_price</span><span class="p">(</span><span class="mf">0.33</span><span class="p">)</span> <span class="p">}}</span>
</pre></div>
</div>
<p>또한 <cite>format_price</cite> 를 템플릿 필터로 만들 수도 있다. (다음을 참고
<a class="reference internal" href="#registering-filters"><span>필터 등록하기</span></a>), 하지만 이 예제에서는 컨텍스트 프로세서에 어떻게 함수들을
전달하는지에 대해서만 설명한다.</p>
</div>
</div>
<span id="document-testing"></span><div class="section" id="flask">
<span id="testing"></span><h3>Flask 어플리케이션 테스트하기<a class="headerlink" href="#flask" title="제목 주소">¶</a></h3>
<blockquote>
<div><strong>Something that is untested is broken.</strong></div></blockquote>
<p>이 문구의 기원을 정확하게 알수는 없지만, 이것은 진실에 가깝다.
테스트되지 않은 어플리케이션은들은 기존 코드의 개선을 어렵게 하며 프로그램
개발자들을 심한 편집증환자로 만들어 버린다. 만약 어플리케이션의 테스트들이
자동화 되어 있다면, 우리는 문제가 발생했을때 안전하며 즉각적으로 변경이 가능하다.</p>
<p>Flask는 Werkzeug 를 통해 테스트 <a class="reference external" href="http://werkzeug.pocoo.org/docs/test/#werkzeug.test.Client" title="(in Werkzeug v0.11-dev)"><code class="xref py py-class docutils literal"><span class="pre">Client</span></code></a> 를 제공하여
어플리케이션의 컨텍스트 로컬을 처리하고 테스트할 수 있는 방법을 제공한다.
그리고 당신이 가장 좋아하는 테스팅 도구를 사용 할 수 있도록 해준다.
이 문서에서 우리는 Python에서 기본으로 제공하는 <a class="reference external" href="http://docs.python.org/dev/library/unittest.html#module-unittest" title="(in Python v3.6)"><code class="xref py py-mod docutils literal"><span class="pre">unittest</span></code></a>  를
사용 할 것이다.</p>
<div class="section" id="id1">
<h4>어플리케이션<a class="headerlink" href="#id1" title="제목 주소">¶</a></h4>
<p>첫째로 우리는 테스트할 어플리케이션이 필요하다. 우리는 <a class="reference internal" href="index.html#tutorial"><span>튜토리얼</span></a> 에서
소개된 어플리케이션을 사용할 것이다. 아직 어플리케이션이 준비되지 않았다면
<a class="reference external" href="http://github.com/mitsuhiko/flask/tree/master/examples/flaskr/">the examples</a> 에서 소스코드를 준비하자.</p>
</div>
<div class="section" id="skeleton">
<h4>테스팅 스켈레톤(Skeleton)<a class="headerlink" href="#skeleton" title="제목 주소">¶</a></h4>
<p>어플리케이션을 테스트 하기 위해서, 우리는 두번째 모듈 (<cite>flaskr_tests.py</cite>) 을
추가하고 단위테스트 스켈레톤(Skeleton)을 만든다.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">flaskr</span>
<span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">import</span> <span class="nn">tempfile</span>

<span class="k">class</span> <span class="nc">FlaskrTestCase</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db_fd</span><span class="p">,</span> <span class="n">flaskr</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&#39;DATABASE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkstemp</span><span class="p">()</span>
        <span class="n">flaskr</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&#39;TESTING&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">app</span> <span class="o">=</span> <span class="n">flaskr</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">test_client</span><span class="p">()</span>
        <span class="n">flaskr</span><span class="o">.</span><span class="n">init_db</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">tearDown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_fd</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">flaskr</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&#39;DATABASE&#39;</span><span class="p">])</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<p><a class="reference external" href="http://docs.python.org/dev/library/unittest.html#unittest.TestCase.setUp" title="(in Python v3.6)"><code class="xref py py-meth docutils literal"><span class="pre">setUp()</span></code></a> 함수의 코드는 새로운 테스트 클라이어트를
생성하고 새로운 데이터베이스를 초기화 한다. 이 함수는 각각의 테스트 함수가
실행되기 전에 먼저 호출된다. 테스트후 데이터베이스를 삭제하기 위해
<a class="reference external" href="http://docs.python.org/dev/library/unittest.html#unittest.TestCase.tearDown" title="(in Python v3.6)"><code class="xref py py-meth docutils literal"><span class="pre">tearDown()</span></code></a> 함수에서 파일을 닫고 파일시스템에서
제거 할 수 있다. 또한 setup 함수가 실행되는 동안에 <code class="docutils literal"><span class="pre">TESTING</span></code> 플래그(flag)가
활성화된다. 요청을 처리하는 동안에 오류 잡기(error catch)가 비활성화되어
있는 것은 어플리케이션에대한 성능테스트에 대하여 좀 더 나은 오류 리포트를 얻기
위해서이다.</p>
<p>이 테스트 클라이언트는 어플리케이션에대한 단순한 인터페이스를 제공한다.
우리는 어플리케이션에게 테스트 요청을 실행시킬 수 있고, 테스트 클라이언트는
이를 위해 쿠키를 놓치지 않고 기록한다.</p>
<p>SQLite3는 파일시스템 기반이기 때문에 임시 데이터베이스를 생성할때 tempfile 모듈을
사용하여 초기화 할 수 있다. <a class="reference external" href="http://docs.python.org/dev/library/tempfile.html#tempfile.mkstemp" title="(in Python v3.6)"><code class="xref py py-func docutils literal"><span class="pre">mkstemp()</span></code></a>  함수는 두가지 작업을 수행한다:
이 함수는 로우-레벨 파일핸들과 임의의 파일이름을 리턴한다. 여기서 임의의 파일이름을
데이터베이스 이름으로 사용한다. 우리는 단지 <cite>db_fd</cite> 라는 파일핸들을 <a class="reference external" href="http://docs.python.org/dev/library/os.html#os.close" title="(in Python v3.6)"><code class="xref py py-func docutils literal"><span class="pre">os.close()</span></code></a> 함수를
사용하여 파일을 닫기전까지 유지하면 된다.</p>
<p>만약 지금 테스트 실행한다면, 다음과 같은 출력내용을 볼 수 있을 것이다.:</p>
<div class="highlight-python"><div class="highlight"><pre>$ python flaskr_tests.py

----------------------------------------------------------------------
Ran 0 tests in 0.000s

OK
</pre></div>
</div>
<p>비록 실제 테스트를 실행하지는 않았지만, 우리는 이미 flaskr 어플리케이션의
문법구문상으로 유효하다는 것을 벌써 알게되었다, 그렇지 않다면 어플리케이션이
종료되는 예외상황을 겪었을 것이다.</p>
</div>
<div class="section" id="id2">
<h4>첫번째 테스트<a class="headerlink" href="#id2" title="제목 주소">¶</a></h4>
<p>이제 어플리케이션의의 기능 테스트를 시작할 시간이다.
어플리케이션의 루트 (<code class="docutils literal"><span class="pre">/</span></code>)로 접근하였을때 어플리케이션이
&#8220;No entries here so far&#8221; 를 보여주는지 확인해야 한다.
이 작업을 수행하기 위해서, 우리는 새로운 테스트 메소드를
다음과 같이 클래스에 추가하여야 한다.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">FlaskrTestCase</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db_fd</span><span class="p">,</span> <span class="n">flaskr</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&#39;DATABASE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkstemp</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">app</span> <span class="o">=</span> <span class="n">flaskr</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">test_client</span><span class="p">()</span>
        <span class="n">flaskr</span><span class="o">.</span><span class="n">init_db</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">tearDown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_fd</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">flaskr</span><span class="o">.</span><span class="n">DATABASE</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_empty_db</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="s">&#39;No entries here so far&#39;</span> <span class="ow">in</span> <span class="n">rv</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
<p>우리의 테스트 함수들의 이름이 <cite>test</cite> 로 시작하고 있다는 것에 주목하자.
이점을 활용하여 <a class="reference external" href="http://docs.python.org/dev/library/unittest.html#module-unittest" title="(in Python v3.6)"><code class="xref py py-mod docutils literal"><span class="pre">unittest</span></code></a> 에서 테스트를 수행할 함수를 자동적으로 식별할 수 있다.</p>
<p><cite>self.app.get</cite> 를 사용함으로써 HTTP <cite>GET</cite> 요청을 주어진 경로에 보낼 수 있다.
리턴값은 <a class="reference internal" href="index.html#flask.Flask.response_class" title="flask.Flask.response_class"><code class="xref py py-class docutils literal"><span class="pre">response_class</span></code></a> 객체의 값이 될 것이다.
이제 <a class="reference external" href="http://werkzeug.pocoo.org/docs/wrappers/#werkzeug.wrappers.BaseResponse.data" title="(in Werkzeug v0.11-dev)"><code class="xref py py-attr docutils literal"><span class="pre">data</span></code></a> 의 속성을 사용하여 어플리케이션
으로부터 넘어온 리턴 값(문자열)을 검사 할 수 있다.
이런 경우, <code class="docutils literal"><span class="pre">'No</span> <span class="pre">entries</span> <span class="pre">here</span> <span class="pre">so</span> <span class="pre">far'</span></code> 가 출력 메시지에 포함되어 있는 것을 확인해야 한다.</p>
<p>다시 실행해 보면 하나의 테스트에 통과 한 것을 확인할 수 있을 수 있을 것이다.</p>
<div class="highlight-python"><div class="highlight"><pre>$ python flaskr_tests.py
.
----------------------------------------------------------------------
Ran 1 test in 0.034s

OK
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h4>입력과 출력 로깅<a class="headerlink" href="#id3" title="제목 주소">¶</a></h4>
<p>우리의 어플리케이션에서 대부분의 기능은 관리자만 사용이 가능하다.
그래서 우리의 테스트 클라이언트에서는 어플리케이션의 입력과 출력에대한
로그를 기록할 수 있어야 한다. 이 작업을 작동시키려면, 로그인과 로그아웃
페이지요청들에 폼 데이터(사용자이름과 암호) 를 적용해야 한다.
그리고 로그인과 로그아웃 페이지들은 리다이렉트(Redirect)되기 때문에
클라이언트에게 <cite>follow_redirects</cite> 를 설정해 주어야 한다.</p>
<p>다음의 두 함수를 <cite>FlaskrTestCase</cite> 클래스에 추가 하자</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">login</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s">&#39;/login&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span>
        <span class="n">password</span><span class="o">=</span><span class="n">password</span>
    <span class="p">),</span> <span class="n">follow_redirects</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">logout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;/logout&#39;</span><span class="p">,</span> <span class="n">follow_redirects</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>이제 로그인과 로그아웃에 대해서 잘 작동하는지, 유효하지 않은 자격증명에 대해서 실패 하는지
쉽게 테스트 하고 로깅 할 수 있다. 다음의 새로운 테스트를 클래스에 추가 하자:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">test_login_logout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="s">&#39;admin&#39;</span><span class="p">,</span> <span class="s">&#39;default&#39;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="s">&#39;You were logged in&#39;</span> <span class="ow">in</span> <span class="n">rv</span><span class="o">.</span><span class="n">data</span>
    <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">logout</span><span class="p">()</span>
    <span class="k">assert</span> <span class="s">&#39;You were logged out&#39;</span> <span class="ow">in</span> <span class="n">rv</span><span class="o">.</span><span class="n">data</span>
    <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="s">&#39;adminx&#39;</span><span class="p">,</span> <span class="s">&#39;default&#39;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="s">&#39;Invalid username&#39;</span> <span class="ow">in</span> <span class="n">rv</span><span class="o">.</span><span class="n">data</span>
    <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="s">&#39;admin&#39;</span><span class="p">,</span> <span class="s">&#39;defaultx&#39;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="s">&#39;Invalid password&#39;</span> <span class="ow">in</span> <span class="n">rv</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="section" id="id4">
<h4>메시지 추가 테스트<a class="headerlink" href="#id4" title="제목 주소">¶</a></h4>
<p>메시지를 추가 하게 되면 잘 작동하는지 확인해야만 한다.
새로운 테스트 함수를 다음과 같이 추가 하자</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">test_messages</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="s">&#39;admin&#39;</span><span class="p">,</span> <span class="s">&#39;default&#39;</span><span class="p">)</span>
    <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s">&#39;/add&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="s">&#39;&lt;Hello&gt;&#39;</span><span class="p">,</span>
        <span class="n">text</span><span class="o">=</span><span class="s">&#39;&lt;strong&gt;HTML&lt;/strong&gt; allowed here&#39;</span>
    <span class="p">),</span> <span class="n">follow_redirects</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">assert</span> <span class="s">&#39;No entries here so far&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">rv</span><span class="o">.</span><span class="n">data</span>
    <span class="k">assert</span> <span class="s">&#39;&amp;lt;Hello&amp;gt;&#39;</span> <span class="ow">in</span> <span class="n">rv</span><span class="o">.</span><span class="n">data</span>
    <span class="k">assert</span> <span class="s">&#39;&lt;strong&gt;HTML&lt;/strong&gt; allowed here&#39;</span> <span class="ow">in</span> <span class="n">rv</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
<p>여기에서 우리가 의도한 대로 제목을 제외한 부분에서 HTML이 사용가능한지 확인한다.</p>
<p>이제 실행 하면 세가지 테스트를 통과 할 것이다.:</p>
<div class="highlight-python"><div class="highlight"><pre>$ python flaskr_tests.py
...
----------------------------------------------------------------------
Ran 3 tests in 0.332s

OK
</pre></div>
</div>
<p>헤더값들과 상태코드들이 포함된 보다 복잡한 테스트를 위해서는,
<a class="reference external" href="http://github.com/mitsuhiko/flask/tree/master/examples/minitwit/">MiniTwit Example</a> 예제 소스의 좀 더 큰 어플리케이션의 테스트 수헹방법을 확인하자.</p>
</div>
<div class="section" id="id5">
<h4>다른 테스팅 기법들<a class="headerlink" href="#id5" title="제목 주소">¶</a></h4>
<p>위에서 살펴본 대로 테스트 클라이언트를 사용하는 것 이외에,
<a class="reference internal" href="index.html#flask.Flask.test_request_context" title="flask.Flask.test_request_context"><code class="xref py py-meth docutils literal"><span class="pre">test_request_context()</span></code></a>  함수를 <cite>with</cite> 구문과 조합하여
요청 컨텍스트를 임시적으로 할성화 하기 위해 사용 될 수 있다.
이것을 이용하여 <a class="reference internal" href="index.html#flask.request" title="flask.request"><code class="xref py py-class docutils literal"><span class="pre">request</span></code></a> , <a class="reference internal" href="index.html#flask.g" title="flask.g"><code class="xref py py-class docutils literal"><span class="pre">g</span></code></a> 과  <a class="reference internal" href="index.html#flask.session" title="flask.session"><code class="xref py py-class docutils literal"><span class="pre">session</span></code></a>
같은 뷰 함수들에서 사용하는 객체들에 접근 할 수 있다.
다음 예제는 이런 방법들을 보여주는 전체 예제이다.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">app</span> <span class="o">=</span> <span class="n">flask</span><span class="o">.</span><span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="k">with</span> <span class="n">app</span><span class="o">.</span><span class="n">test_request_context</span><span class="p">(</span><span class="s">&#39;/?name=Peter&#39;</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">flask</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">path</span> <span class="o">==</span> <span class="s">&#39;/&#39;</span>
    <span class="k">assert</span> <span class="n">flask</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;Peter&#39;</span>
</pre></div>
</div>
<p>컨텍스트와 함께 바인드된 모든 객체는 같은 방법으로 사용이 가능하다.</p>
<p>만약 서로 다른 설정구성으로 어플리케이션을 테스트하기 원할경우 이것을
해결하기 위한 좋은 방법은 없는것 같다. 이와 같이 어플리케이션을 테스트
하려면 어플리케이션 팩토리에 대해서 고혀해 보길 바란다. (참고 <a class="reference internal" href="index.html#app-factories"><span>어플리케이션 팩토리</span></a>)</p>
<p>그러나 만약 테스트 요청 컨텍스트를 사용하는 경우 <a class="reference internal" href="index.html#flask.Flask.before_request" title="flask.Flask.before_request"><code class="xref py py-meth docutils literal"><span class="pre">before_request()</span></code></a>
함수 와 <a class="reference internal" href="index.html#flask.Flask.after_request" title="flask.Flask.after_request"><code class="xref py py-meth docutils literal"><span class="pre">after_request()</span></code></a> 는 자동으로 호출되지 않는다.
반면에:meth:<cite>~flask.Flask.teardown_request</cite> 함수는 <cite>with</cite> 블럭에서 요청 컨텍스트를
빠져나올때 실제로 실행된다.
만약 <a class="reference internal" href="index.html#flask.Flask.before_request" title="flask.Flask.before_request"><code class="xref py py-meth docutils literal"><span class="pre">before_request()</span></code></a> 함수도 마찬가지로 호출되기를 원한다면,
<a class="reference internal" href="index.html#flask.Flask.preprocess_request" title="flask.Flask.preprocess_request"><code class="xref py py-meth docutils literal"><span class="pre">preprocess_request()</span></code></a> 를 직접 호출해야 한다.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">app</span> <span class="o">=</span> <span class="n">flask</span><span class="o">.</span><span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="k">with</span> <span class="n">app</span><span class="o">.</span><span class="n">test_request_context</span><span class="p">(</span><span class="s">&#39;/?name=Peter&#39;</span><span class="p">):</span>
    <span class="n">app</span><span class="o">.</span><span class="n">preprocess_request</span><span class="p">()</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>이경우 어플리케이션이 어떻게 설계되었느냐에 따라 데이터베이스 컨넥션 연결이
필요할 수도 있다.</p>
<p>만약 <a class="reference internal" href="index.html#flask.Flask.after_request" title="flask.Flask.after_request"><code class="xref py py-meth docutils literal"><span class="pre">after_request()</span></code></a> 함수를 호출하려 한다면, <a class="reference internal" href="index.html#flask.Flask.process_response" title="flask.Flask.process_response"><code class="xref py py-meth docutils literal"><span class="pre">process_response()</span></code></a>
함수에 응답객체(Response Object)를 전달하여 직접 호출하여야 한다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">app</span> <span class="o">=</span> <span class="n">flask</span><span class="o">.</span><span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="k">with</span> <span class="n">app</span><span class="o">.</span><span class="n">test_request_context</span><span class="p">(</span><span class="s">&#39;/?name=Peter&#39;</span><span class="p">):</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">Response</span><span class="p">(</span><span class="s">&#39;...&#39;</span><span class="p">)</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">process_response</span><span class="p">(</span><span class="n">resp</span><span class="p">)</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>이같은 방식은 일반적으로 해당 시점에 직접 테스트 클라이언트를 사용 할 수
있기 때문에 크게 유용한 방법은 아니다.</p>
</div>
<div class="section" id="id6">
<h4>컨텍스트 유지시키기<a class="headerlink" href="#id6" title="제목 주소">¶</a></h4>
<div class="versionadded">
<p><span class="versionmodified">버전 0.4에 추가.</span></p>
</div>
<p>때로는 일반적인 요청이 실행되는 경우에도 테스트 검증이 필요해질 경우가
있기 때문에 컨텍스트 정보를 좀더 유지 하는 것이 도움이 될 수 있다.
Flask 0.4 버전에서 부터는 <a class="reference internal" href="index.html#flask.Flask.test_client" title="flask.Flask.test_client"><code class="xref py py-meth docutils literal"><span class="pre">test_client()</span></code></a> 를 <cite>with</cite> 블럭과 함께
사용하면 가능하다.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">app</span> <span class="o">=</span> <span class="n">flask</span><span class="o">.</span><span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="k">with</span> <span class="n">app</span><span class="o">.</span><span class="n">test_client</span><span class="p">()</span> <span class="k">as</span> <span class="n">c</span><span class="p">:</span>
    <span class="n">rv</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;/?tequila=42&#39;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="s">&#39;tequila&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;42&#39;</span>
</pre></div>
</div>
<p>만약 <a class="reference internal" href="index.html#flask.Flask.test_client" title="flask.Flask.test_client"><code class="xref py py-meth docutils literal"><span class="pre">test_client()</span></code></a> 를 <cite>with</cite> 블럭이 없이 사용한다면 ,
<cite>request</cite> 가 더이상 유효하지 않기 때문에 <cite>assert</cite> 가 실패 하게 된다.
(그 이유는 실제 요청의 바깥에서 사용하려고 했기 때문이다.)</p>
</div>
<div class="section" id="id7">
<h4>세션에 접근하고 수정하기<a class="headerlink" href="#id7" title="제목 주소">¶</a></h4>
<div class="versionadded">
<p><span class="versionmodified">버전 0.8에 추가.</span></p>
</div>
<p>때로는 테스트 클라이언트에서  세션에 접근하고 수정하는 일은 매우 유용할 수 있다.
일반적으로 이를 위한 두가지 방법이 있다. 만약 세션이 특정 키 값으로 설정이 되어 있고
그 값이 컨텍스트를 통해서 유지 된다고 접근 가능한것을 보장하는 경우 <a class="reference internal" href="index.html#flask.session" title="flask.session"><code class="xref py py-data docutils literal"><span class="pre">flask.session</span></code></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">with</span> <span class="n">app</span><span class="o">.</span><span class="n">test_client</span><span class="p">()</span> <span class="k">as</span> <span class="n">c</span><span class="p">:</span>
    <span class="n">rv</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">flask</span><span class="o">.</span><span class="n">session</span><span class="p">[</span><span class="s">&#39;foo&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">42</span>
</pre></div>
</div>
<p>그렇지만 이와 같은 경우는 세션을 수정하거나 접급하는 하는 것을 요청이 실행되기전에
가능하도록 해주지는 않는다. Flask 0.8 버전 부터는 &#8220;세션 트랜잭션(session transparent)&#8221;
이라고 부르는 세션에 대한 적절한 호출과 테스트 클라이언트에서의 수정이 가능한지
시뮬레이션이 가능하도록 하고 있다. 트랜잭션의 끝에서 해당 세션은 저장된다.
이것은 백엔드(backend)에서 사용되었던 세션과 독립적으로 작동가능하다.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">with</span> <span class="n">app</span><span class="o">.</span><span class="n">test_client</span><span class="p">()</span> <span class="k">as</span> <span class="n">c</span><span class="p">:</span>
    <span class="k">with</span> <span class="n">c</span><span class="o">.</span><span class="n">session_transaction</span><span class="p">()</span> <span class="k">as</span> <span class="n">sess</span><span class="p">:</span>
        <span class="n">sess</span><span class="p">[</span><span class="s">&#39;a_key&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;a value&#39;</span>

    <span class="c"># once this is reached the session was stored</span>
</pre></div>
</div>
<p>이경우에 <a class="reference internal" href="index.html#flask.session" title="flask.session"><code class="xref py py-data docutils literal"><span class="pre">flask.session</span></code></a> 프록시의 <code class="docutils literal"><span class="pre">sess</span></code> 객체를  대신에 사용하여야 함을
주의하자. 이 객체는 동일한 인터페이스를 제공한다.</p>
</div>
</div>
<span id="document-errorhandling"></span><div class="section" id="application-errors">
<span id="id1"></span><h3>어플리케이션 에러 로깅하기<a class="headerlink" href="#application-errors" title="제목 주소">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">버전 0.3에 추가.</span></p>
</div>
<p>어플리케이션이 실패하면 서버도 실패한다. 조만간 여러분은 운영환경에서 예뢰를 보게 될 것이다.
비록 여러분의 코드가 100%가 정확하다 하더라도 여러분은 여전히 가끔씩 예외를 볼 것이다. 왜?
왜냐하면 포함된 그 밖에 모든 것들이 실패할 것이기 때문이다. 여기에 완벽하게 좋은 코드가 서버
에러를 발생시킬 수 있는 상황이 있다:</p>
<ul class="simple">
<li>클라이언트가 request를 일찍 없애 버렸는데 여전히 어플리케이션이 입력되는 데이타를 읽고 있는 경우.</li>
<li>데이타베이스 서버가 과부하로 인해 쿼리를 다룰 수 없는 경우.</li>
<li>파일시스템이 꽉찬 경우</li>
<li>하드 드라이브가 크래쉬된 경우</li>
<li>백엔드 서버가 과부하 걸린 경우</li>
<li>여러분이 사용하고 있는 라이브러에서 프로그래밍 에러가 발생하는 경우</li>
<li>서버에서 다른 시스템으로의 네트워크 연결이 실패한 경우</li>
</ul>
<p>위 상황은 여러분이 직면할 수 있는 이슈들의 작은 예일 뿐이다. 이러한 종류의 문제들을 어떻게
다루어야 할 까? 기본적으로 어플리케이션이 운영 모드에서 실행되고 있다면, Flask는 매우
간단한 페이지를 보여주고 <a class="reference internal" href="index.html#flask.Flask.logger" title="flask.Flask.logger"><code class="xref py py-attr docutils literal"><span class="pre">logger</span></code></a> 에 예외를 로깅할 것이다.</p>
<p>그러나 여러분이 할 수 있는 더 많은 것들이 있다. 우리는 에러를 다루기 위해 더 나은 셋업을
다룰 것이다.</p>
<div class="section" id="id2">
<h4>메일로 에러 발송하기<a class="headerlink" href="#id2" title="제목 주소">¶</a></h4>
<blockquote>
<div>만약 어플리케이션이 운영 모드에서 실행되고 있다면(여러분의 서버에서) 여러분은 기본으로
어떠한 로그 메세지도 보지 못할 것이다. 그건 왜일까? Flask는 설정이 없는 프레임워크가
되려고 노력한다. 만약 어떠한 설정도 없다면 Flask는 어디에 로그를 떨어뜨려야 하나? 추측은
좋은 아이디어가 아닌다. 왜냐하면 추측되어진 위치는 사용자가 로그 파일을 생성할 권한을
가지고 있는 위치가 아니기 때문이다.(?) 또한 어쨌든 대부분의 작은 어플리케이션에서는 아무도
로그 파일을 보지 않을 것이다.</div></blockquote>
<p>사실 어플리케이션 에러에 대한 로그 파일을 설정한다하더라도 사용자가 이슈를 보고 했을 때
디버깅을 할 때를 제외하고 결코 로그 파일을 보지 않을 것이라는 것을 확신한다. 대신 여러분이
원하는 것은 예외가 발생했을 때 메일을 받는 것이다. 그리고 나서 여러분은 경보를 받고 그것에
대한 무언가를 할 수 있다.</p>
<p>Flask는 파이썬에 빌트인된 로깅 시스템을 사용한다. 실제로 에러가 발생했을 때 아마도
여러분이 원하는 메일을 보낸다. 아래는 예외가 발생했을 때 Flask 로거가 메일을 보내는 것을
설정하는 방법을 보여준다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">ADMINS</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;yourname@example.com&#39;</span><span class="p">]</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">app</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">logging</span>
    <span class="kn">from</span> <span class="nn">logging.handlers</span> <span class="kn">import</span> <span class="n">SMTPHandler</span>
    <span class="n">mail_handler</span> <span class="o">=</span> <span class="n">SMTPHandler</span><span class="p">(</span><span class="s">&#39;127.0.0.1&#39;</span><span class="p">,</span>
                               <span class="s">&#39;server-error@example.com&#39;</span><span class="p">,</span>
                               <span class="n">ADMINS</span><span class="p">,</span> <span class="s">&#39;YourApplication Failed&#39;</span><span class="p">)</span>
    <span class="n">mail_handler</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">mail_handler</span><span class="p">)</span>
</pre></div>
</div>
<p>무슨 일이 일어났는가? 우리는 <code class="docutils literal"><span class="pre">127.0.0.1</span></code> 에서 리스닝하고 있는 메일 서버를 가지고
“YourApplication Failed”란 제목으로 <em>server-error&#64;example.com</em> 송신자로부터 모든
<cite>관리자</cite> 에게 메일을 보내는 새로운 <a class="reference external" href="http://docs.python.org/dev/library/logging.handlers.html#logging.handlers.SMTPHandler" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">SMTPHandler</span></code></a> 를 생성했다.
만약 여러분의 메일 서버가 자격을</p>
<blockquote>
<div>요구한다면 그것들 또한 제공될 수 있다. 이를 위해 <a class="reference external" href="http://docs.python.org/dev/library/logging.handlers.html#logging.handlers.SMTPHandler" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">SMTPHandler</span></code></a> 를 위한 문서를 확인해라.</div></blockquote>
<p>우리는 또한 단지 에러와 더 심각한 메세지를 보내라고 핸들러에게 말한다. 왜냐하면 우리는 주의
사항이나 요청을 핸들링하는 동안 발생할 수 있는 쓸데없는 로그들을에 대한 메일을 받는 것을
원하지 않는다</p>
<p>여러분이 운영 환경에서 이것을 실행하기 전에, 에러 메일 안에 더 많은 정보를 넣기 위해  <a class="reference internal" href="index.html#logformat"><span>로그 포맷 다루기</span></a>  챕터를 보아라. 그것은 많은 불만으로부터 너를 구해줄 것이다.</p>
</div>
<div class="section" id="id3">
<h4>파일에 로깅하기<a class="headerlink" href="#id3" title="제목 주소">¶</a></h4>
<p>여러분이 메일을 받는다 하더라도, 여러분은 아마 주의사항을 로깅하기를 원할지도 모른다.
문제를 디버그하기 위해 요구되어질 수 있는 많은 정보를 많이 유지하는 것은 좋은 생각이다.
Flask는 자체적으로 코어 시스템에서 어떠한 주의사항도 발생하지 않는다는 것을 주목해라.
그러므로 무언가 이상해 보일 때 코드 안에 주의사항을 남기는 것은 여러분의 책임이다.</p>
<p>로깅 시스템에 의해 제공되는 몇가지 핸들러가 있다. 그러나 기본 에러 로깅을 위해 그것들 모두가
유용한 것은 아니다. 가장 흥미로운 것은 아마 아래오 같은 것들일 것이다:</p>
<ul class="simple">
<li><a class="reference external" href="http://docs.python.org/dev/library/logging.handlers.html#logging.FileHandler" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">FileHandler</span></code></a> - 파일 시스템 내 파일에 메세지를 남긴다.</li>
<li><a class="reference external" href="http://docs.python.org/dev/library/logging.handlers.html#logging.handlers.RotatingFileHandler" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">RotatingFileHandler</span></code></a> - 파일 시스템 내 파일에 메세지를 남기며 특정 횟수로 순환한다.</li>
<li><a class="reference external" href="http://docs.python.org/dev/library/logging.handlers.html#logging.handlers.NTEventLogHandler" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">NTEventLogHandler</span></code></a> - 윈도 시스템의 시스템 이벤트 로그에 로깅할 것이다. 만약 여러분이 윈도에 디플로이를 한다면 이 방법이 사용하기 원하는 방법일 것이다.</li>
<li><a class="reference external" href="http://docs.python.org/dev/library/logging.handlers.html#logging.handlers.SysLogHandler" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">SysLogHandler</span></code></a> -     유닉스 syslog에 로그를 보낸다.</li>
</ul>
<p>일단 여러분이 로그 핸들러를 선택하면, 위에서 설명한 SMTP 핸들러를 가지고 여러분이 했던 더 낮은 레벨을 설정하는 것만 확인하라(필자는 WARNING을 추천한다.):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">if</span> <span class="ow">not</span> <span class="n">app</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">logging</span>
    <span class="kn">from</span> <span class="nn">themodule</span> <span class="kn">import</span> <span class="n">TheHandlerYouWant</span>
    <span class="n">file_handler</span> <span class="o">=</span> <span class="n">TheHandlerYouWant</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
    <span class="n">file_handler</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">file_handler</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="logformat">
<span id="id4"></span><h4>로그 포맷 다루기<a class="headerlink" href="#logformat" title="제목 주소">¶</a></h4>
<p>기본으로 해들러는 단지 파일 안에 메세지 문자열을 쓰거나 메일로 여러분에 메세지를 보내기만 할 것이다. 로그 기록은 더 많은 정보를 저장한다. 왜 에러가 발생했는니나 더 중요한 어디서 에러가 발생했는지 등의 더 많은 정보를 포함하도록 로거를 설정할 수 있다.</p>
<p>포매터는 포맷 문자열을 가지고 초기화될 수 있다. 자동으로 역추적이 로그 진입점에 추가되어진다는 것을 주목하라.(?) 여러분은 로그 포맷터 포맷 문자열안에 그걸 할 필요가 없다.</p>
<p>여기 몇가지 셋업 샘플들이 있다:</p>
<div class="section" id="id5">
<h5>이메일<a class="headerlink" href="#id5" title="제목 주소">¶</a></h5>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">logging</span> <span class="kn">import</span> <span class="n">Formatter</span>
<span class="n">mail_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">Formatter</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="s">Message type:       </span><span class="si">%(levelname)s</span><span class="s"></span>
<span class="s">Location:           </span><span class="si">%(pathname)s</span><span class="s">:</span><span class="si">%(lineno)d</span><span class="s"></span>
<span class="s">Module:             </span><span class="si">%(module)s</span><span class="s"></span>
<span class="s">Function:           </span><span class="si">%(funcName)s</span><span class="s"></span>
<span class="s">Time:               </span><span class="si">%(asctime)s</span><span class="s"></span>

<span class="s">Message:</span>

<span class="si">%(message)s</span><span class="s"></span>
<span class="s">&#39;&#39;&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="id6">
<h5>파일 로깅<a class="headerlink" href="#id6" title="제목 주소">¶</a></h5>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">logging</span> <span class="kn">import</span> <span class="n">Formatter</span>
<span class="n">file_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">Formatter</span><span class="p">(</span>
    <span class="s">&#39;</span><span class="si">%(asctime)s</span><span class="s"> </span><span class="si">%(levelname)s</span><span class="s">: </span><span class="si">%(message)s</span><span class="s"> &#39;</span>
    <span class="s">&#39;[in </span><span class="si">%(pathname)s</span><span class="s">:</span><span class="si">%(lineno)d</span><span class="s">]&#39;</span>
<span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="id7">
<h5>복잡한 로그 포맷<a class="headerlink" href="#id7" title="제목 주소">¶</a></h5>
<p>여기에 포맷 문자열을 위한 유용한 포맷팅 변수 목록이 있다. 이 목록은 완전하지는 않으며 전체 리스트를 보려면 <a class="reference external" href="http://docs.python.org/dev/library/logging.html#module-logging" title="(in Python v3.6)"><code class="xref py py-mod docutils literal"><span class="pre">logging</span></code></a>  의 공식 문서를 참조하라.</p>
<p>만약 여러분이 포맷티을 더 커스터마이징하기를 원한다면 포맷터를 상속받을 수 있다. 그 포매터는 세가지 흥미로운 메소드를 가지고 있다:</p>
<dl class="docutils">
<dt><a class="reference external" href="http://docs.python.org/dev/library/logging.html#logging.Formatter.format" title="(in Python v3.6)"><code class="xref py py-meth docutils literal"><span class="pre">format()</span></code></a>:</dt>
<dd>실제 포매팅을 다룬다. <a class="reference external" href="http://docs.python.org/dev/library/logging.html#logging.LogRecord" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">LogRecord</span></code></a> 객체를 전달하면 포매팅된 문자열을 반환해야 한다.</dd>
<dt><a class="reference external" href="http://docs.python.org/dev/library/logging.html#logging.Formatter.formatTime" title="(in Python v3.6)"><code class="xref py py-meth docutils literal"><span class="pre">formatTime()</span></code></a>:</dt>
<dd>called for <cite>asctime</cite> 포매팅을 위해 호출된다. 만약 다른 시간 포맷을 원한다면 이 메소드를 오버라이드할 수 있다.</dd>
<dt><a class="reference external" href="http://docs.python.org/dev/library/logging.html#logging.Formatter.formatException" title="(in Python v3.6)"><code class="xref py py-meth docutils literal"><span class="pre">formatException()</span></code></a></dt>
<dd>예외 포매팅을 위해 호출된다. <code class="xref py py-attr docutils literal"><span class="pre">exc_info</span></code> 튜플을 전달하면 문자열을 반환해야 한다. 보통 기본으로 사용해도 괜찮으며, 굳이 오버라이드할 필요는 없다.</dd>
</dl>
<p>더 많은 정보를 위해서 공식 문서를 참조해라.</p>
</div>
</div>
<div class="section" id="id8">
<h4>다른 라이브러리들<a class="headerlink" href="#id8" title="제목 주소">¶</a></h4>
<p>이제까지는 우리는 단지 여러분의 어플리케이션이 생성한 로거를 설정했다. 다른 라이브러리들
또한 로그를 남길 수 있다. 예를 들면 SQLAlchemy가 그것의 코어 안에서 무겁게 로깅을 사용한다.
<a class="reference external" href="http://docs.python.org/dev/library/logging.html#module-logging" title="(in Python v3.6)"><code class="xref py py-mod docutils literal"><span class="pre">logging</span></code></a> 패키지 안에 모든 로거들을 설정할 방법이 있지만 나는 그거을 사용하는 것을
추천하지 않는다. 여러분이 같은 파이썬 인터프리터에서 같이 실행되는 여러 개로 분리된
어플리케이션을 갖기를 원할 수도 있다. 이러한 상황을 위해 다른 로깅을 셋업하는 것은
불가능하다.</p>
<p>대신 <a class="reference external" href="http://docs.python.org/dev/library/logging.html#logging.getLogger" title="(in Python v3.6)"><code class="xref py py-func docutils literal"><span class="pre">getLogger()</span></code></a> 함수를 가지고 로거들을 얻고 핸들러를 첨부하기 위해 얻은
로거들을 반복하여 여러분이 관심있어 하는 로거들을 만드는 것을 추천한다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">logging</span> <span class="kn">import</span> <span class="n">getLogger</span>
<span class="n">loggers</span> <span class="o">=</span> <span class="p">[</span><span class="n">app</span><span class="o">.</span><span class="n">logger</span><span class="p">,</span> <span class="n">getLogger</span><span class="p">(</span><span class="s">&#39;sqlalchemy&#39;</span><span class="p">),</span>
           <span class="n">getLogger</span><span class="p">(</span><span class="s">&#39;otherlibrary&#39;</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">logger</span> <span class="ow">in</span> <span class="n">loggers</span><span class="p">:</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">mail_handler</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">file_handler</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id9">
<h3>어플리케이션 에러 디버깅<a class="headerlink" href="#id9" title="제목 주소">¶</a></h3>
<p>제품화된 어플리케이션의 경우, <a class="reference internal" href="index.html#application-errors"><span>어플리케이션 에러 로깅하기</span></a> 에 설명된것을 참고하여
로깅과 알림설정을 구성하는 것이 좋다. 이 섹션은 디버깅을 위한 설정으로 배포할때
완전한 기능을 갖춘 Python 디버거를 깊이있게 사용하는 방법을 제공한다.</p>
<div class="section" id="id10">
<h4>의심이 들때는 수동으로 실행하자<a class="headerlink" href="#id10" title="제목 주소">¶</a></h4>
<p>제품화를 위해 설정된 어플리케이션에서 문제를 겪고 있는가?
만약 해당 호스트에 쉘 접근 권한을 가지고 있다면, 배포 환경에서 쉘을 이용해
수동으로 어플리케이션을 실행 할 수 있는지 확인한다.
권한에 관련된 문제를 해결하기 위해서는 배포환경에 설정된 것과 동일한 사용자
계정에서 실행되어야 한다. 제품화된 운영 호스트에서 <cite>debug=True</cite> 를 이용하여
Flask에 내장된 개발 서버를 사용하면 설정 문제를 해결하는데 도움이되지만,
<strong>이와같은 설정은 통제된 환경에서 임시적으로만 사용해야 함을 명심하자.</strong>
<cite>debug=True</cite> 설정은 운영환경 혹은 제품화되었을때는 절대 사용해서는 안된다.</p>
</div>
<div class="section" id="working-with-debuggers">
<span id="id11"></span><h4>디버거로 작업하기<a class="headerlink" href="#working-with-debuggers" title="제목 주소">¶</a></h4>
<p>좀더깊이 들어가서 코드 실행을 추적한다면, Flask는 독자적인 디버거를 제공한다.
(<a class="reference internal" href="index.html#debug-mode"><span>디버그 모드</span></a> 참고) 만약 또다른 Python 디버거를 사용하고 싶다면 이 디버거들은
서로 간섭현상이 발생하므로 주의가 필요하다. 선호하는 디버거를 사용하기 위해서는
몇몇  디버깅 옵션을 설정해야만 한다.:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">debug</span></code>        - 디버그 모드를 사용하고 예외를 잡을 수 있는지 여부</li>
<li><code class="docutils literal"><span class="pre">use_debugger</span></code> - Flask 내부 디버거를 사용할지 여부</li>
<li><code class="docutils literal"><span class="pre">use_reloader</span></code> - 예외발생시 프로세스를 포크하고 리로드할지 여부</li>
</ul>
<p><code class="docutils literal"><span class="pre">debug</span></code> 옵션은 다른 두 옵션 이 어떤값을 갖던지 반드시 True 이어야 한다.
(즉, 예외는 잡아야만 한다.)</p>
<p>만약 Eclipse에서 Aptana를 디버깅을 위해 사용하고 싶다면, <code class="docutils literal"><span class="pre">use_debugger`</span> <span class="pre">와</span> <span class="pre">`use_reloader</span></code>
옵션을 False로 설정해야 한다.</p>
<p>config.yaml을 이용해서 다음과 같은 유용한 설정패턴을 사용하는 것이 가능하다
(물론 자신의 어플리케이션을위해 적절하게 블럭안의 값들을 변경시킬 수 있다.):</p>
<div class="highlight-python"><div class="highlight"><pre>FLASK:
    DEBUG: True
    DEBUG_WITH_APTANA: True
</pre></div>
</div>
<p>이렇게 설정한다음 어플리케이션의 시작점(main.py)에 다음과 같이 사용할 수 있다.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="c"># To allow aptana to receive errors, set use_debugger=False</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">create_app</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="s">&quot;config.yaml&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">app</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span> <span class="n">use_debugger</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c"># Disable Flask&#39;s debugger if external debugger is requested</span>
        <span class="n">use_debugger</span> <span class="o">=</span> <span class="ow">not</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;DEBUG_WITH_APTANA&#39;</span><span class="p">))</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">use_debugger</span><span class="o">=</span><span class="n">use_debugger</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="n">app</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span>
            <span class="n">use_reloader</span><span class="o">=</span><span class="n">use_debugger</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="s">&#39;0.0.0.0&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<span id="document-config"></span><div class="section" id="config">
<span id="id1"></span><h3>설정 다루기<a class="headerlink" href="#config" title="제목 주소">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">버전 0.3에 추가.</span></p>
</div>
<p>어플리케이션들은 일종의 설정 및 구성을 필요로 한다. 어플리케이션 실행 환경에서 다양한
종류의 설정 값들을 변경 할 수 있다. 디버깅모드를 변경하거나 비밀 키(secret key)를
설정하거나그밖의 다른 환경에 관련된 값을 변경시킬 수 있다.</p>
<p>Flask는 일반적인 경우 어플리케이션이 구동될때에 설정값들을 사용될 수 있어야
하도록 설계되었다. 설정값들을 하드코드(hard code)로 적용 할 수도 있는데 이 방식은
작은 규모의 어프리케이션에서는 그리 나쁘지 않은 방법이지만 더 나은 방법들이 있다.</p>
<p>설정값을 독립적으로 로드하는 방법으로, 이미 로드된 설정들값들 중에 속해 있는
설정 객체(config object)를 사용할 수 있다:
<a class="reference internal" href="index.html#flask.Flask" title="flask.Flask"><code class="xref py py-class docutils literal"><span class="pre">Flask</span></code></a> 객체의 <a class="reference internal" href="index.html#flask.Flask.config" title="flask.Flask.config"><code class="xref py py-attr docutils literal"><span class="pre">config</span></code></a> 속성을 참고.
이 객체의 속성을 통해 Flask 자신의 특정 설정값을 저장할수 있고 Flask의
확장 플러그인들도 자신의 설정값을 저장할 수 있다.
마찬가지로, 여러분의 어플리키에션 성정값 역시 저장할 수 있다.</p>
<div class="section" id="id2">
<h4>설정 기초연습<a class="headerlink" href="#id2" title="제목 주소">¶</a></h4>
<p><a class="reference internal" href="index.html#flask.Flask.config" title="flask.Flask.config"><code class="xref py py-attr docutils literal"><span class="pre">config</span></code></a> 은 실제로는 dictionary 의 서브클래스이며,
다른 dictionary 처럼 다음과 같이 수정될 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&#39;DEBUG&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>
</div>
<p>확정된 설정값들은 또한 <a class="reference internal" href="index.html#flask.Flask" title="flask.Flask"><code class="xref py py-attr docutils literal"><span class="pre">Flask</span></code></a> 객체로 전달될 수 있으며,
그 객체를 통해 설정값들을 읽거나 쓸수 있다.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">app</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>
</div>
<p>한번에 다수의 키(key)들을 업데이트 하기 위해서는 <a class="reference external" href="http://docs.python.org/dev/library/stdtypes.html#dict.update" title="(in Python v3.6)"><code class="xref py py-meth docutils literal"><span class="pre">dict.update()</span></code></a>
함수를 사용 할 수 있다.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
    <span class="n">DEBUG</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">SECRET_KEY</span><span class="o">=</span><span class="s">&#39;...&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h4>내장된 고유 설정값들<a class="headerlink" href="#id3" title="제목 주소">¶</a></h4>
<p>다음의 설정값들은 Flask 의 내부에서 이미 사용되고 있는 것들이다. :</p>
<table border="1" class="docutils">
<colgroup>
<col width="29%" />
<col width="71%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">DEBUG</span></code></td>
<td>디버그 모드를 활성화/비활성화 함</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">TESTING</span></code></td>
<td>테스팅 모드를 활성화/비활성화 함</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">PROPAGATE_EXCEPTIONS</span></code></td>
<td>명시적으로 예외를 전파하는 것에 대한
활성화 혹은 비활성화 함.
이 값을 특별히 설정을 안하거나
명시적으로 <cite>None</cite> 으로 설정했을 경우라도
<cite>TESTING</cite> 혹은 <cite>DEBUG</cite> 가 true 라면 이 값
역시 true 가 된다.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">PRESERVE_CONTEXT_ON_EXCEPTION</span></code></td>
<td>어플리케이션이 디버그모드에 있는 경우
요청 컨텍스트는 디버거에서 데이터를 확인
하기 위해 예외를 발생시키지 않는다.
이 설정을 이 키값을 설정하여 이 설정을
비활성화 할 수 있다. 또한 이 설정은
제품화된(하지만 매우 위험 할 수 있는)
어플리케이션을 디버깅하기위해 유리 할수
있으며 디버거 실행을 위해 강제로
사용하도록 설정하고 싶을 때 사용가능하다.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">SECRET_KEY</span></code></td>
<td>비밀키</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">SESSION_COOKIE_NAME</span></code></td>
<td>세션 쿠키의 이름</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">SESSION_COOKIE_DOMAIN</span></code></td>
<td>세션 쿠키에 대한 도메인.
이값이 설정되어 있지 않은 경우 쿠키는
<code class="docutils literal"><span class="pre">SERVER_NAME</span></code> 의 모든 하위 도메인에
대하여 유효하다.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">SESSION_COOKIE_PATH</span></code></td>
<td>세션 쿠키에 대한 경로를 설정한다.
이값이 설정되어 있지 않은 경우 쿠키는
<code class="docutils literal"><span class="pre">'/'</span></code> 로 설정되어 있지 않은 모든
<code class="docutils literal"><span class="pre">APPLICATION_ROOT</span></code> 에 대해서 유효하다</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">SESSION_COOKIE_HTTPONLY</span></code></td>
<td>쿠키가 httponly 플래그를 설정해야만
하도록 통제한다.
기본값은 <cite>True</cite> 이다.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">SESSION_COOKIE_SECURE</span></code></td>
<td>쿠키가 secure 플래그를 설정해야만
하도록 통제한다. 기본값은 <cite>False</cite> 이다.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">PERMANENT_SESSION_LIFETIME</span></code></td>
<td><a class="reference external" href="http://docs.python.org/dev/library/datetime.html#datetime.timedelta" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code></a> 를 이용하여
영구 세션 유지 시간을 설정한다.
Flask 0.8버전부터 integer 타입의 초단위로
설정이 가능하다.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">USE_X_SENDFILE</span></code></td>
<td>x-sendfile 기능을 활성화/비활성화 함</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">LOGGER_NAME</span></code></td>
<td>로거의 이름을 설정함</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">SERVER_NAME</span></code></td>
<td>서버의 이름과 포트 번호를 뜻한다.
서브도메인을 지원하기 위해 요구된다. (예:
<code class="docutils literal"><span class="pre">'myapp.dev:5000'</span></code>)
이 값을 “localhost” 로 설정하는 것은 서브
도메인을 지원하지 않는 것에 그리 도움이
되지는 않는다는 것을 주의하자.
또한 <code class="docutils literal"><span class="pre">SERVER_NAME</span></code> 를 설정하는 것은
기본적으로 요청 컨텍스트 없이 어플리케이션
컨텍스트를 통해 URL을 생성 할 수 있도록
해준다.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">APPLICATION_ROOT</span></code></td>
<td>어플리케이션이 전체 도메인을 사용하지
않거나 서브도메인을 사용하지 않는 경우
이 값은 어플리케이션이 어느 경로에서
실행되기 위해 설정되어 있는지 결정한다.
이값은 세션 쿠키에서 경로 값으로 사용된다
만약 도메인이 사용되는 경우 이 값은
<code class="docutils literal"><span class="pre">None</span></code> 이다.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">MAX_CONTENT_LENGTH</span></code></td>
<td>만약 이 변수 값이 바이트수로 설정되면, 들어오는
요청에 대해서 이 값보다 더 큰 길이의 컨텐트일 경우
413 상태 코드를 리턴한다.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">SEND_FILE_MAX_AGE_DEFAULT</span></code>:</td>
<td><a class="reference internal" href="index.html#flask.Flask.send_static_file" title="flask.Flask.send_static_file"><code class="xref py py-meth docutils literal"><span class="pre">send_static_file()</span></code></a> (기본 정적파일 핸들러)
와 <a class="reference internal" href="index.html#flask.send_file" title="flask.send_file"><code class="xref py py-func docutils literal"><span class="pre">send_file()</span></code></a> 에서 사용하는 캐시 제어에 대한
최대 시간은 초단위로 정한다. 파일 단위로 사용되는 이 값을
덮어쓰기 위해서는 <a class="reference internal" href="index.html#flask.Flask" title="flask.Flask"><code class="xref py py-class docutils literal"><span class="pre">Flask</span></code></a> 나 <a class="reference internal" href="index.html#flask.Blueprint" title="flask.Blueprint"><code class="xref py py-class docutils literal"><span class="pre">Blueprint</span></code></a> 를
개별적으로 후킹하여 <a class="reference internal" href="index.html#flask.Flask.get_send_file_max_age" title="flask.Flask.get_send_file_max_age"><code class="xref py py-meth docutils literal"><span class="pre">get_send_file_max_age()</span></code></a> 를 사용한다.
기본값은 43200초 이다(12 시간).</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">TRAP_HTTP_EXCEPTIONS</span></code></td>
<td>만약 이 값이 <code class="docutils literal"><span class="pre">True</span></code> 로 셋팅되어 있다면 Flask는
HTTP 익셉션 처리를 위한 에러 핸들러를 실행 하지 않는다.
하지만, 대신에 익셉션 스택을 발생시킨다. 이렇게 하면 디버깅이 어려운 상황에서
HTTP 에러가 발견되는 곳을 찾을 때 유용하다.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">TRAP_BAD_REQUEST_ERRORS</span></code></td>
<td>잘못된 요청(BadRequest)에 대한 주요 익셉션 에러들은 Werkzeug의 내부 데이터
구조에 의해 다루어 진다. 마찬가지로 많은 작업들이 잘못된 요청에 의해
암시적으로 일관성부분에서 실패할 수 있다.
이 플래그는 왜 실패가 발생했는지 디버깅 상황에서 명백하게 알고 싶을 때 좋다.
만약 <code class="docutils literal"><span class="pre">True</span></code> 로 설정 되어 있다면, 주기적인 추적값을 얻을 수 있을 것이다.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">PREFERRED_URL_SCHEME</span></code></td>
<td>사용가능한 URL 스키마가 존재하지 않을 경우 해당 URL에 대한 스키마가
반드시 필요하기 때문에 기본 URL 스키마가 필요하다. 기본값은 <code class="docutils literal"><span class="pre">http</span></code>.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">JSON_AS_ASCII</span></code></td>
<td>Flask 직렬화 객체는 기본으로 아스키로 인코딩된 JSON을 사용한다.
만약 이 값이 <code class="docutils literal"><span class="pre">False</span></code> 로 설정 되어 있다면, Flask는 ASCII로 인코딩하지 않을 것이며
현재의 출력 문자열을 유니코드 문자열로 리턴할 것이다.
<code class="docutils literal"><span class="pre">jsonify</span></code> 는 자동으로 <a href="#id4"><span class="problematic" id="id5">``</span></a>utf-8``로 인코딩을 한 후 해당 인스터스로 전송한다.</td>
</tr>
</tbody>
</table>
<div class="versionadded">
<p><span class="versionmodified">버전 0.4에 추가: </span><code class="docutils literal"><span class="pre">LOGGER_NAME</span></code></p>
</div>
<div class="versionadded">
<p><span class="versionmodified">버전 0.5에 추가: </span><code class="docutils literal"><span class="pre">SERVER_NAME</span></code></p>
</div>
<div class="versionadded">
<p><span class="versionmodified">버전 0.6에 추가: </span><code class="docutils literal"><span class="pre">MAX_CONTENT_LENGTH</span></code></p>
</div>
<div class="versionadded">
<p><span class="versionmodified">버전 0.7에 추가: </span><code class="docutils literal"><span class="pre">PROPAGATE_EXCEPTIONS</span></code>, <code class="docutils literal"><span class="pre">PRESERVE_CONTEXT_ON_EXCEPTION</span></code></p>
</div>
<div class="versionadded">
<p><span class="versionmodified">버전 0.8에 추가: </span><code class="docutils literal"><span class="pre">TRAP_BAD_REQUEST_ERRORS</span></code>, <code class="docutils literal"><span class="pre">TRAP_HTTP_EXCEPTIONS</span></code>,
<code class="docutils literal"><span class="pre">APPLICATION_ROOT</span></code>, <code class="docutils literal"><span class="pre">SESSION_COOKIE_DOMAIN</span></code>,
<code class="docutils literal"><span class="pre">SESSION_COOKIE_PATH</span></code>, <code class="docutils literal"><span class="pre">SESSION_COOKIE_HTTPONLY</span></code>,
<code class="docutils literal"><span class="pre">SESSION_COOKIE_SECURE</span></code></p>
</div>
<div class="versionadded">
<p><span class="versionmodified">버전 0.9에 추가: </span><code class="docutils literal"><span class="pre">PREFERRED_URL_SCHEME</span></code></p>
</div>
<div class="versionadded">
<p><span class="versionmodified">버전 0.10에 추가: </span><code class="docutils literal"><span class="pre">JSON_AS_ASCII</span></code></p>
</div>
</div>
<div class="section" id="id6">
<h4>파일을 통하여 설정하기<a class="headerlink" href="#id6" title="제목 주소">¶</a></h4>
<p>만약 설정을 실제 어플리케이션 패키지의 바깥쪽에 위치한 별도의 파일에 저장할
수 있다면 좀더 유용할 것이다. 이것은 어플리케이션의 패키징과 배포단계에서
다양한 패키지 도구 (<a class="reference internal" href="index.html#distribute-deployment"><span>Distribute으로 전개하기</span></a>) 들을 사용할 수 있도록 해주며,
결과적으로 사후에 설정 파일을 수정 할 수 있도록 해준다.</p>
<p>일반적인 패턴은 다음과 같다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">from_object</span><span class="p">(</span><span class="s">&#39;yourapplication.default_settings&#39;</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">from_envvar</span><span class="p">(</span><span class="s">&#39;YOURAPPLICATION_SETTINGS&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>이 예제 첫부분에서 설정 파일을 <cite>yourapplication.default_settings</cite> 모듈로부터 불러 온 다음
환경설정 값들을 <span class="target" id="index-0"></span><code class="xref std std-envvar docutils literal"><span class="pre">YOURAPPLICATION_SETTINGS</span></code> 파일의 내용으로 덮어씌운다.
이 환경 변수들은 리눅스(Linux) 혹은 OS X 에서는 서버를 시작하기 전에 쉘의 export 명령어로
설정 할 수도 있다:</p>
<div class="highlight-python"><div class="highlight"><pre>$ export YOURAPPLICATION_SETTINGS=/path/to/settings.cfg
$ python run-app.py
 * Running on http://127.0.0.1:5000/
 * Restarting with reloader...
</pre></div>
</div>
<p>윈도우 시스템에서는 내장 명령어인 <cite>set</cite> 을 대신 사용할 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre>&gt;set YOURAPPLICATION_SETTINGS=\path\to\settings.cfg
</pre></div>
</div>
<p>설정 파일들은 실제로는 파이썬 파일들이다. 오직 대문자로된 값들만 나중에 실제로
설정 객체에 저장된다. 그래서 반드시 설정 키값들은 대문자를 사용하여야 한다.</p>
<p>여기 설정 파일에 대한 예제가 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Example configuration</span>
<span class="n">DEBUG</span> <span class="o">=</span> <span class="bp">False</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">&#39;?</span><span class="se">\xbf</span><span class="s">,</span><span class="se">\xb4\x8d\xa3</span><span class="s">&quot;&lt;</span><span class="se">\x9c\xb0</span><span class="s">@</span><span class="se">\x0f</span><span class="s">5</span><span class="se">\xab</span><span class="s">,w</span><span class="se">\xee\x8d</span><span class="s">$0</span><span class="se">\x13\x8b</span><span class="s">83&#39;</span>
</pre></div>
</div>
<p>아주 초기에 설정을 로드 할수 있도록 확신할 수 있어야 하고, 확장(플러그인)들은 실행시점에
설정에 접근 할 수 있다. 설정 객체에서 뿐만 아니라 개별 파일에서도 역시 로드할 수 있는 방법이
존재 한다. 완전한 참고를 위해  <a class="reference internal" href="index.html#flask.Config" title="flask.Config"><code class="xref py py-class docutils literal"><span class="pre">Config</span></code></a> 객체에 대한 문서를 읽으면 된다.</p>
</div>
<div class="section" id="id7">
<h4>설정 베스트 사례<a class="headerlink" href="#id7" title="제목 주소">¶</a></h4>
<p>앞에서 언급한 접근 방법들에 대한 단점은 테스트를 좀더 확실히 해야 한다는 것이다.
이 문제에 대해서 일반적인 100%의 단일 해법은 존재하지 않는다. 하지만, 이러한 경험을
개선하기 위해 여두해 두어야 할 몇가지가 있다:</p>
<ol class="arabic simple">
<li>여러분의 어플리케이션을 함수에 구현하고 (Flask의) 블루프린트에 등록하자.
이러한 방법을 통해 어플리케이션에 대해서 다중인스턴스를 생성하여 유닛테스트를
보다 쉽게 진행 할 수 있다. 필요에 따라 설정값을 전달해주기 위해 이 방법을 사용할 수 있다.</li>
<li>임포트 시점에 설정정보를 필요로 하는 코드를 작성하지 않는다.
만약 여러분이 스스로 설정값에 대해서 오직 요청만 가능하도록 접근을 제한 한다면
필요에 의해 나중에 설정 객체를 재설정 할 수 있다.</li>
</ol>
</div>
<div class="section" id="id8">
<h4>개발 / 운영(혹은 제품)<a class="headerlink" href="#id8" title="제목 주소">¶</a></h4>
<p>대부분의 어플리케이션은 하나 이상의 설정(구성)이 필요 하다.
적어도 운영 환경과 개발환경은 독립된 설정값을 가지고 있어야만 한다.
이것을 다루는 가장 쉬운 방법은 버전 관리를 통하여 항상 로드되는 기본
설정값을 사용하는 것이다. 그리고 독립된 설정을값들을 필요에 따라
위에서 언급했던 방식으로 덮어쓰기한다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">from_object</span><span class="p">(</span><span class="s">&#39;yourapplication.default_settings&#39;</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">from_envvar</span><span class="p">(</span><span class="s">&#39;YOURAPPLICATION_SETTINGS&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>그런다음, 여러분은 단지 독립적인 <cite>config.py</cite> 파일을 추가한 후
<code class="docutils literal"><span class="pre">YOURAPPLICATION_SETTINGS=/path/to/config.py</span></code> 를 export 하면 끝난다.
물론 다른 방법들도 있다. 예를들면, import 혹은 상속과 같은 방법도 가능하다.</p>
<p>장고(Django)의 세계에서는 명시적으로 설정 파일을 <code class="docutils literal"><span class="pre">from</span> <span class="pre">yourapplication.default_settings</span> <span class="pre">import</span> <span class="pre">import</span> <span class="pre">*</span></code>
를 이용해 파일의 상단에 추가 하여 변경 사항은 수작업으로 덮어쓰기 하는 방법이 가장 일반적이다.
또한 <code class="docutils literal"><span class="pre">YOURAPPLICATION_MODE</span></code> 와 환경 변수에 대해서 <cite>production</cite> , <cite>development</cite> 등의 값을 조사하여
하드코드된 다른 값들을 import 할 수도 있다.</p>
<p>한가지 흥미로운 패턴은 설정에 대해서도 클래스와 상속을 사용할 수 있다는 것이다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Config</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="n">DEBUG</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="n">TESTING</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="n">DATABASE_URI</span> <span class="o">=</span> <span class="s">&#39;sqlite://:memory:&#39;</span>

<span class="k">class</span> <span class="nc">ProductionConfig</span><span class="p">(</span><span class="n">Config</span><span class="p">):</span>
    <span class="n">DATABASE_URI</span> <span class="o">=</span> <span class="s">&#39;mysql://user@localhost/foo&#39;</span>

<span class="k">class</span> <span class="nc">DevelopmentConfig</span><span class="p">(</span><span class="n">Config</span><span class="p">):</span>
    <span class="n">DEBUG</span> <span class="o">=</span> <span class="bp">True</span>

<span class="k">class</span> <span class="nc">TestingConfig</span><span class="p">(</span><span class="n">Config</span><span class="p">):</span>
    <span class="n">TESTING</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>
</div>
<p>이와 같은 설정을 활성화하기 위해서는 단지
meth:<cite>~flask.Config.from_object</cite>:: 를 호출 하면 된다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">from_object</span><span class="p">(</span><span class="s">&#39;configmodule.ProductionConfig&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>여기 많은 다양한 다른 방법이 있지만 이것은 여러분이 설정 파일을 어떻게 관리하기
원하는가에 달려 있다. 여기 몇가지 좋은 권고사항이 있다:</p>
<ul class="simple">
<li>버전관리에서 기본 설정을 유지한다.
각각의 설정 파일을 이전할때에 이 기본 설정 파일을 사용하거나 설정 값을 덮어쓰기 전에
기본 설정 파일의 내용을 자신의 파일로 가져오기</li>
<li>설정 사이를 전환할 환경변수를 사용한다.
이방식은 파이썬 인터프리터 외부에서 수행하고 빠르고 쉽기 때문에 결국 코드를 만지지 않고도
다른 설정 사이를 전환 할 수 있기 때문에 개발 및 배포를 훨씬 쉽게 만들어 줄 수 있다.
만약 여러분이 종종 다른 프로젝트들에서 작업한다면, virtualenv를 구동하는 자신만의 스크립트를
생성하여 자신을 위한 개발 설정을 export 하여 사용할 수 있다.</li>
<li>코드와 설정을 독립된 운영 서버에 배포하기 위해서  <a class="reference external" href="http://fabfile.org/">fabric</a> 과 같은 도구를 사용한다.
어떻게 할 수 있는지 자세한 내용은 다음의 내용을 참고 하면 된다.
<a class="reference internal" href="index.html#fabric-deployment"><span>Fabric으로 전개하기</span></a> 패턴</li>
</ul>
</div>
<div class="section" id="instance-folders">
<span id="id9"></span><h4>인스턴스 폴더<a class="headerlink" href="#instance-folders" title="제목 주소">¶</a></h4>
<div class="versionadded">
<p><span class="versionmodified">버전 0.8에 추가.</span></p>
</div>
<p>Flask 0.8 에서 임시 폴더가 도입되었다. 오랫시간동안 Flask는 가능한
어플리케이션에 대한 상대 경로를 직접 참조 할 수 있도록 해왔다( <code class="xref py py-attr docutils literal"><span class="pre">Flask.root_path</span></code> 를 통해서).
이것을 통해 어플리케이션의 설정을 바로 옆에 저장하고 불러오는 많은 개발자들이 있었다.
하지만 불행하게도 이 방법은 오직 어플리케이션이 루트 경로가 패키지의 내용을 참고하지
않는 경우에만 잘 작동 한다.</p>
<p>Flask 0.8 부터 새로룬 속성이 도입 되었다:
<code class="xref py py-attr docutils literal"><span class="pre">Flask.instance_path</span></code> . 이 새로운 컨셉의 속성은 “인스턴스 폴더” 라고 불린다.
인스턴스 폴더는 버전 관리와 특정한 배포에 속하지 않도록 설계되었다. 인스턴스 폴더는
런타임에서의 변경 사항 혹은 설정 파일의 변경 사항에 대한 것들을 보관하기에 완벽한 장소이다.</p>
<p>여러분은 인스턴스 폴더의 경로에 대해 Flask 어플리케이션이 생성될 때 혹은
Flask가 인스턴스 폴더를 자동으로 탐지 하도록 하여 명백하게 제공 받을 수 있다
명시적인 설정으로 사용하기 위해서는 <cite>instance_path</cite> 파라미터를 쓸 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">,</span> <span class="n">instance_path</span><span class="o">=</span><span class="s">&#39;/path/to/instance/folder&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>이때에 제공되는 폴더의 경로는 절대 경로임을 <em>반드시</em> 명심하자.</p>
<p>만약 <cite>instance_path</cite> 파라미터가 인스턴스 폴더를 제공하지 않는 다면
다음의 위치가 기본으로 사용된다:</p>
<ul>
<li><p class="first">Uninstalled module:</p>
<div class="highlight-python"><div class="highlight"><pre>/myapp.py
/instance
</pre></div>
</div>
</li>
<li><p class="first">Uninstalled package:</p>
<div class="highlight-python"><div class="highlight"><pre>/myapp
    /__init__.py
/instance
</pre></div>
</div>
</li>
<li><p class="first">Installed module or package:</p>
<div class="highlight-python"><div class="highlight"><pre>$PREFIX/lib/python2.X/site-packages/myapp
$PREFIX/var/myapp-instance
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">$PREFIX</span></code> 는 파이썬이 설치된 경로의 prefix 이다. 이 것은
<code class="docutils literal"><span class="pre">/usr</span></code> 혹은 여러분의 virtualenv 경로이다.
<code class="docutils literal"><span class="pre">sys.prefix</span></code> 를 이용해서 현재 설정된 prefix를 출력해 볼 수 있다.</p>
</li>
</ul>
<p>설정 객체가 설정 파일을 상대 경로로 부터 읽어 올 수 있도록 제공 하기 때문에
우리는 가능한 한 인스턴스 경로에 대한 상대 파일이름을 통해서 로딩을 변경했다.
설정파일이 있는 상대경로의 동작은 “relative to the application root” (디폴트)와
“relative to instance folder” 사이에서 <cite>instance_relative_config</cite> 어플리케이션 생성자에 의해
뒤바뀔 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">,</span> <span class="n">instance_relative_config</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>여기 어떻게 Flask에서 모듈의 설정을 미리 로드하고 설정 폴더가 존재 할 경우 설정 파일로 부터
설정을 덮어쓰기 할 수 있는 전체 예제가 있다</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">,</span> <span class="n">instance_relative_config</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">from_object</span><span class="p">(</span><span class="s">&#39;yourapplication.default_settings&#39;</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">from_pyfile</span><span class="p">(</span><span class="s">&#39;application.cfg&#39;</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>인스턴스 폴더의 경로를 통해 <code class="xref py py-attr docutils literal"><span class="pre">Flask.instance_path</span></code> 를 찾을 수 있다.
Flask는 또한 인스턴스 폴더의 파일을 열기 위한 바로가기를 <code class="xref py py-meth docutils literal"><span class="pre">Flask.open_instance_resource()</span></code> 를 통해 제공 한다.</p>
<p>두 경우에 대한 사용 예제:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">instance_path</span><span class="p">,</span> <span class="s">&#39;application.cfg&#39;</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="c"># or via open_instance_resource:</span>
<span class="k">with</span> <span class="n">app</span><span class="o">.</span><span class="n">open_instance_resource</span><span class="p">(</span><span class="s">&#39;application.cfg&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<span id="document-signals"></span><div class="section" id="signals">
<span id="id1"></span><h3>시그널(Signals)<a class="headerlink" href="#signals" title="제목 주소">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">버전 0.6에 추가.</span></p>
</div>
<p>플라스크 0.6부터 시그널 지원 기능이 플라스크에 통합됐다.  이 기능은
<a class="reference external" href="http://pypi.python.org/pypi/blinker">blinker</a> 라는 훌륭한 라이브러리로 제공되며 사용할 수 없을 경우
자연스럽게 지원하지 않는 상태로 돌아갈 것이다.</p>
<p>시그널이란 무엇인가?  시그널은 핵심 프레임워크나 다른 플라스크 확장의
어느 곳에서 동작이 발생했을 때 공지를 보내어 어플리케이션을 동작하게 하여
어플리케이션간의 의존성을 분리하도록 돕는다.  요약하자면 시그널은
특정 시그널 발신자가 어떤 일이 발생했다고 수신자에게 알려준다.</p>
<p>플라스크에는 여러 시그널이 있고 플라스크 확장은 더 많은 시그널을 제공할
수 도 있다.  또한 시그널은 수신자에게 무엇인가를 알리도록 의도한 것이지
수신자가 데이터를 변경하도록 권장하지 않아야 한다.  몇몇 빌트인 데코레이터의
동작과 같은 것을 하는 것 처럼 보이는 시그널이 있다는 것을 알게될 것이다.
(예를 들면 <a class="reference internal" href="index.html#flask.request_started" title="flask.request_started"><code class="xref py py-data docutils literal"><span class="pre">request_started</span></code></a> 은
<a class="reference internal" href="index.html#flask.Flask.before_request" title="flask.Flask.before_request"><code class="xref py py-meth docutils literal"><span class="pre">before_request()</span></code></a> 과 매우 유사하다) 하지만, 그 동작 방식에
차이는 있다.  예제의 핵심 <a class="reference internal" href="index.html#flask.Flask.before_request" title="flask.Flask.before_request"><code class="xref py py-meth docutils literal"><span class="pre">before_request()</span></code></a> 핸들러는 정해진
순서에 의해 실행되고 응답이 반환됨에 의해 일찍 요청처리를 중단할 수 있다.
반면에 다른 모든 시그널은 정해진 순서 없이 실행되며 어떤 데이터도 수정하지 않는다.</p>
<p>핸들러 대비 시그널의 큰 장점은 짧은 순간 동안 그 시그널을 안전하게 수신할 수
있다는 것이다.  예를 들면 이런 일시적인 수신은 단위테스팅에 도움이 된다.
여러분이 요청의 일부분으로 어떤 템플릿을 보여줄지 알고 싶다고 해보자: 시그널이
정확히 바로 그 작업을 하게 한다.</p>
<div class="section" id="id2">
<h4>시그널을 수신하기<a class="headerlink" href="#id2" title="제목 주소">¶</a></h4>
<p>시그널은 수신하려면 시그널의 <a class="reference external" href="http://discorporate.us/projects/Blinker/docs/1.1/api.html#blinker.base.Signal.connect" title="(in Blinker v1.1)"><code class="xref py py-meth docutils literal"><span class="pre">connect()</span></code></a> 메소드를
사용할 수 있다. 첫번째 인자는 시그널이 송신됐을 때 호출되는 함수고, 선택적인
두번째 인자는 송신자를 지정한다.  해당 시그널의 송신을 중단하려면
<a class="reference external" href="http://discorporate.us/projects/Blinker/docs/1.1/api.html#blinker.base.Signal.disconnect" title="(in Blinker v1.1)"><code class="xref py py-meth docutils literal"><span class="pre">disconnect()</span></code></a> 메소드를 사용하면 된다.</p>
<p>모든 핵심 플라스크 시그널에 대해서 송신자는 시그널을 발생하는 어플리케이션이다.
여러분이 시그널을 수신할 때, 모든 어플리케이션의 시그널을 수신하고 싶지 않다면
받고자하는 시그널의 송신자 지정을 잊지 말도록 해라.  여러분이 확장을 개발하고 있다면
특히나 주의해야한다.</p>
<p>예를 들면 여기에 단위테스팅에서 어떤 템플릿이 보여지고 어떤 변수가 템플릿으로
전달되는지 이해하기 위해 사용될 수 있는 헬퍼 컨택스트 매니저가 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">template_rendered</span>
<span class="kn">from</span> <span class="nn">contextlib</span> <span class="kn">import</span> <span class="n">contextmanager</span>

<span class="nd">@contextmanager</span>
<span class="k">def</span> <span class="nf">captured_templates</span><span class="p">(</span><span class="n">app</span><span class="p">):</span>
    <span class="n">recorded</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">def</span> <span class="nf">record</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">template</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="o">**</span><span class="n">extra</span><span class="p">):</span>
        <span class="n">recorded</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">template</span><span class="p">,</span> <span class="n">context</span><span class="p">))</span>
    <span class="n">template_rendered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">record</span><span class="p">,</span> <span class="n">app</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">recorded</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="n">template_rendered</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="n">record</span><span class="p">,</span> <span class="n">app</span><span class="p">)</span>
</pre></div>
</div>
<p>위의 메소드는 테스트 클라이언트와 쉽게 묶일 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">with</span> <span class="n">captured_templates</span><span class="p">(</span><span class="n">app</span><span class="p">)</span> <span class="k">as</span> <span class="n">templates</span><span class="p">:</span>
    <span class="n">rv</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">test_client</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">rv</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">templates</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
    <span class="n">template</span><span class="p">,</span> <span class="n">context</span> <span class="o">=</span> <span class="n">templates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">template</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s">&#39;index.html&#39;</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">context</span><span class="p">[</span><span class="s">&#39;items&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">10</span>
</pre></div>
</div>
<p>플라스크가 시그널에 새 인자를 알려준다면 여러분이 호출한 메소드는
실패하지 않을 것이므로 추가적인 <code class="docutils literal"><span class="pre">**extra</span></code> 인자로 수신하도록 해라.</p>
<p><cite>with</cite> 블럭의 내용에 있는 어플리케이션 <cite>app</cite> 이 생성한 코드에서 보여주는
모든 템플릿은 <cite>templates</cite> 변수에 기록될 것이다.  템플릿이 그려질 때마다
컨텍스트 뿐만 아니라 템플릿 객체도 어플리케이션에 덧붙여진다.</p>
<p>부가적으로 편리한 헬퍼 메소드도 존재한다(<a class="reference external" href="http://discorporate.us/projects/Blinker/docs/1.1/api.html#blinker.base.Signal.connected_to" title="(in Blinker v1.1)"><code class="xref py py-meth docutils literal"><span class="pre">connected_to()</span></code></a>).
그 메소드는 일시적으로 그 자체에 컨텍스트 메니저를 가진 시그널에 대한 함수를 수신한다.
컨텍스트 매니저의 반환값을 그런 방식으로 지정할 수 없기 때문에 인자로 템플릿의 목록을
넘겨줘야 한다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">template_rendered</span>

<span class="k">def</span> <span class="nf">captured_templates</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="n">recorded</span><span class="p">,</span> <span class="o">**</span><span class="n">extra</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">record</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">template</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
        <span class="n">recorded</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">template</span><span class="p">,</span> <span class="n">context</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">template_rendered</span><span class="o">.</span><span class="n">connected_to</span><span class="p">(</span><span class="n">record</span><span class="p">,</span> <span class="n">app</span><span class="p">)</span>
</pre></div>
</div>
<p>위의 예제는 아래처럼 보일 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">templates</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">with</span> <span class="n">captured_templates</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="n">templates</span><span class="p">,</span> <span class="o">**</span><span class="n">extra</span><span class="p">):</span>
    <span class="o">...</span>
    <span class="n">template</span><span class="p">,</span> <span class="n">context</span> <span class="o">=</span> <span class="n">templates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="admonition-blinker-api admonition">
<p class="first admonition-title">Blinker API 변경내용</p>
<p class="last"><a class="reference external" href="http://discorporate.us/projects/Blinker/docs/1.1/api.html#blinker.base.Signal.connected_to" title="(in Blinker v1.1)"><code class="xref py py-meth docutils literal"><span class="pre">connected_to()</span></code></a> 메소드는 Blinker
버전 1.1에 나왔다.</p>
</div>
</div>
<div class="section" id="id3">
<h4>시그널 생성하기<a class="headerlink" href="#id3" title="제목 주소">¶</a></h4>
<p>여러분이 어플리케이션에서 시그널을 사용하고 싶다면, 직접 blinker 라이브러리를
사용할 수 있다.  가장 일반적인 사용예는 변경된 <a class="reference external" href="http://discorporate.us/projects/Blinker/docs/1.1/api.html#blinker.base.Namespace" title="(in Blinker v1.1)"><code class="xref py py-class docutils literal"><span class="pre">Namespace</span></code></a>.
클래스에 시그널을 명명하는 것이다. 이것이 보통 권고되는 방식이다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">blinker</span> <span class="kn">import</span> <span class="n">Namespace</span>
<span class="n">my_signals</span> <span class="o">=</span> <span class="n">Namespace</span><span class="p">()</span>
</pre></div>
</div>
<p>이제 여러분은 아래와 같이 새 시그널을 생성할 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">model_saved</span> <span class="o">=</span> <span class="n">my_signals</span><span class="o">.</span><span class="n">signal</span><span class="p">(</span><span class="s">&#39;model-saved&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>여기에서 시그널에 이름을 준것은 시그널은 구분해주고 또한 디버깅을
단순화한다.  <a class="reference external" href="http://discorporate.us/projects/Blinker/docs/1.1/api.html#blinker.base.NamedSignal.name" title="(in Blinker v1.1)"><code class="xref py py-attr docutils literal"><span class="pre">name</span></code></a> 속성으로 시그널에
부여된 이름을 얻을 수 있다.</p>
<div class="admonition- admonition">
<p class="first admonition-title">플라스크 확장 개발자를 위해서</p>
<p class="last">여러분이 플라스크 확장을 개발하고 있고 blinker 설치를 놓친것에 대해 부드럽게
대처하고 싶다면, <a class="reference internal" href="index.html#flask.signals.Namespace" title="flask.signals.Namespace"><code class="xref py py-class docutils literal"><span class="pre">flask.signals.Namespace</span></code></a> 클래스를 사용할 수 있다.</p>
</div>
</div>
<div class="section" id="signals-sending">
<span id="id4"></span><h4>시그널 보내기<a class="headerlink" href="#signals-sending" title="제목 주소">¶</a></h4>
<p>시그널을 전송하고 싶다면, <a class="reference external" href="http://discorporate.us/projects/Blinker/docs/1.1/api.html#blinker.base.Signal.send" title="(in Blinker v1.1)"><code class="xref py py-meth docutils literal"><span class="pre">send()</span></code></a> 메소드를 호출하면 된다.
이 메소드는 첫번째 인자로 송신자를 넘겨주고 선택적으로 시그널 수신자에게 전달되는
키워드 인자도 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="o">...</span>

    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">model_saved</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</pre></div>
</div>
<p>항상 좋은 송신자를 뽑도록 한다.  여러분이 시그널을 보내는 클래스를 갖는다면
송신자로 <cite>self</cite> 를 넘겨준다.  여러분이 임의의 함수에서 시그널을 전송한다면,
<code class="docutils literal"><span class="pre">current_app._get_current_object()</span></code> 를 송신자로 전달할 수 있다.</p>
<div class="admonition- admonition">
<p class="first admonition-title">송신자로 프락시를 넘겨주기</p>
<p class="last">시그널의 송신자로 절대 <a class="reference internal" href="index.html#flask.current_app" title="flask.current_app"><code class="xref py py-data docutils literal"><span class="pre">current_app</span></code></a> 를 넘겨주지 않도록 하고
대신 <code class="docutils literal"><span class="pre">current_app._get_current_object()</span></code> 를 사용한다.  왜냐하면
<a class="reference internal" href="index.html#flask.current_app" title="flask.current_app"><code class="xref py py-data docutils literal"><span class="pre">current_app</span></code></a> 는 실제 어플리케이션 객체가 아닌 프락시 객체이기
때문이다.</p>
</div>
</div>
<div class="section" id="id5">
<h4>시그널과 플라스크 요청 컨텍스트<a class="headerlink" href="#id5" title="제목 주소">¶</a></h4>
<p>시그널을 수신할 때 <a class="reference internal" href="index.html#request-context"><span>요청 컨텍스트</span></a> 를 완전하게 지원한다. Context-local
변수는 <a class="reference internal" href="index.html#flask.request_started" title="flask.request_started"><code class="xref py py-data docutils literal"><span class="pre">request_started</span></code></a> 과 <a class="reference internal" href="index.html#flask.request_finished" title="flask.request_finished"><code class="xref py py-data docutils literal"><span class="pre">request_finished</span></code></a> 사이에서
일관성을 유지하므로 여러분은 필요에 따라 <a class="reference internal" href="index.html#flask.g" title="flask.g"><code class="xref py py-class docutils literal"><span class="pre">flask.g</span></code></a> 과 다른 변수를 참조할
수 있다.  <a class="reference internal" href="#signals-sending"><span>시그널 보내기</span></a> 과 <a class="reference internal" href="index.html#flask.request_tearing_down" title="flask.request_tearing_down"><code class="xref py py-data docutils literal"><span class="pre">request_tearing_down</span></code></a> 시그널에서
언급하는 제약에 대해 유의한다.</p>
</div>
<div class="section" id="id6">
<h4>시그널 수신 기반 데코레이터<a class="headerlink" href="#id6" title="제목 주소">¶</a></h4>
<p>Blinker 1.1 과 함께 여러분은 또한 <code class="xref py py-meth docutils literal"><span class="pre">connect_via()</span></code>
데코레이터를 사용하여 시그널을 쉽게 수신할 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">template_rendered</span>

<span class="nd">@template_rendered.connect_via</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">when_template_rendered</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">template</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="o">**</span><span class="n">extra</span><span class="p">):</span>
    <span class="k">print</span> <span class="s">&#39;Template </span><span class="si">%s</span><span class="s"> is rendered with </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">template</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id7">
<h4>핵심 시그널<a class="headerlink" href="#id7" title="제목 주소">¶</a></h4>
<p>플라스크에는 다음과 같은 시그널이 존재한다:</p>
<dl class="data">
<dt>
<code class="descclassname">flask.</code><code class="descname">template_rendered</code></dt>
<dd><p>이 시그널은 템플릿이 성공적으로 뿌려졌을 때 송신된다.  이 시그널은
<cite>template</cite> 으로 템플릿과 딕셔너리 형태인 <cite>context</cite> 로 컨텍스트를
인스턴스로 하여 호출된다.</p>
<p>수신 예제:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">log_template_renders</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">template</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="o">**</span><span class="n">extra</span><span class="p">):</span>
    <span class="n">sender</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;Rendering template &quot;</span><span class="si">%s</span><span class="s">&quot; with context </span><span class="si">%s</span><span class="s">&#39;</span><span class="p">,</span>
                        <span class="n">template</span><span class="o">.</span><span class="n">name</span> <span class="ow">or</span> <span class="s">&#39;string template&#39;</span><span class="p">,</span>
                        <span class="n">context</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">template_rendered</span>
<span class="n">template_rendered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">log_template_renders</span><span class="p">,</span> <span class="n">app</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="data">
<dt>
<code class="descclassname">flask.</code><code class="descname">request_started</code></dt>
<dd><p>이 시그널은 요청 처리가 시작되기 전이지만 요청 컨텍스트는 만들어졌을 때
송신된다.  요청 컨텍스트가 이미 연결됐기 때문에, 수신자는 표준 전역 프록시
객체인 <a class="reference internal" href="index.html#flask.request" title="flask.request"><code class="xref py py-class docutils literal"><span class="pre">request</span></code></a> 으로 요청을 참조할 수 있다.</p>
<p>수신 예제:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">log_request</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="o">**</span><span class="n">extra</span><span class="p">):</span>
    <span class="n">sender</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;Request context is set up&#39;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">request_started</span>
<span class="n">request_started</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">log_request</span><span class="p">,</span> <span class="n">app</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="data">
<dt>
<code class="descclassname">flask.</code><code class="descname">request_finished</code></dt>
<dd><p>이 시그널은 클라이언트로 응답이 가기 바로 전에 보내진다. <cite>response</cite> 인자로
응답 객체를 넘겨준다.</p>
<p>수신 예제:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">log_response</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">response</span><span class="p">,</span> <span class="o">**</span><span class="n">extra</span><span class="p">):</span>
    <span class="n">sender</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;Request context is about to close down.  &#39;</span>
                        <span class="s">&#39;Response: </span><span class="si">%s</span><span class="s">&#39;</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">request_finished</span>
<span class="n">request_finished</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">log_response</span><span class="p">,</span> <span class="n">app</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="data">
<dt>
<code class="descclassname">flask.</code><code class="descname">got_request_exception</code></dt>
<dd><p>이 시그널은 요청 처리 동안 예외가 발생했을 때 보내진다.  표준 예외처리가
<em>시작되기 전에</em> 송신되고 예외 처리를 하지 않는 디버깅 환경에서도 보내진다.
<cite>exception</cite> 인자로 예외 자체가 수신자에게 넘어간다.</p>
<p>수신 예제:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">log_exception</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">exception</span><span class="p">,</span> <span class="o">**</span><span class="n">extra</span><span class="p">):</span>
    <span class="n">sender</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;Got exception during processing: </span><span class="si">%s</span><span class="s">&#39;</span><span class="p">,</span> <span class="n">exception</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">got_request_exception</span>
<span class="n">got_request_exception</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">log_exception</span><span class="p">,</span> <span class="n">app</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="data">
<dt>
<code class="descclassname">flask.</code><code class="descname">request_tearing_down</code></dt>
<dd><p>이 시그널은 요청 객체가 제거될 때 보내진다.  요청 처리 과정에서 요류가
발생하더라도 항상 호출된다.  현재 시그널을 기다리고 있는 함수는 일반
teardown 핸들러 뒤에 호출되지만, 순서를 보장하지는 않는다.</p>
<p>수신 예제:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">close_db_connection</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="o">**</span><span class="n">extra</span><span class="p">):</span>
    <span class="n">session</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">request_tearing_down</span>
<span class="n">request_tearing_down</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">close_db_connection</span><span class="p">,</span> <span class="n">app</span><span class="p">)</span>
</pre></div>
</div>
<p>플라스크 0.9에서, 예외가 있는 경우 이 시그널을 야기하는 예외에 대한
참조를 갖는 &#8216;exc&#8217; 키워드 인자를 또한 넘겨줄 것이다.</p>
</dd></dl>

<dl class="data">
<dt>
<code class="descclassname">flask.</code><code class="descname">appcontext_tearing_down</code></dt>
<dd><p>이 시그널은 어플리케이션 컨텍스트가 제거될 때 보내진다.  예외가 발생하더라도
이 시그널은 항상 호출되고, 일반 teardown 핸들러 뒤에 시그널에 대한 콜백 함수가
호출되지만, 순서는 보장하지 않는다.</p>
<p>수신 예제:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">close_db_connection</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="o">**</span><span class="n">extra</span><span class="p">):</span>
    <span class="n">session</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">appcontext_tearing_down</span>
<span class="n">appcontext_tearing_down</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">close_db_connection</span><span class="p">,</span> <span class="n">app</span><span class="p">)</span>
</pre></div>
</div>
<p>&#8216;request_tearing_down&#8217; 과 마찬가지로 예외에 대한 참조를 <cite>exc</cite> 키워드 인자로
넘겨줄 것이다.</p>
</dd></dl>

</div>
</div>
<span id="document-views"></span><div class="section" id="pluggable-views">
<span id="views"></span><h3>플러거블 뷰(Pluggable Views)<a class="headerlink" href="#pluggable-views" title="제목 주소">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">버전 0.7에 추가.</span></p>
</div>
<p>플라스크 0.7은 함수가 아닌 클래스를 기반으로한 Django 프레임워크의 제너릭 뷰(generic view)에
영향을 받은 플러거블 뷰(pluggable view : 끼워넣는 뷰)를 소개한다. 이 뷰의 주 목적는
여러분이 구현체의 부분들을 바꿀수 있고 이 방식으로 맞춤과 끼워넣는것이 가능한 뷰를 갖는
것이다.</p>
<div class="section" id="basic-principle">
<h4>기본 원칙(Basic Principle)<a class="headerlink" href="#basic-principle" title="제목 주소">¶</a></h4>
<p>여러분이 데이타베이스에서 어떤 객체의 목록을 읽어서 템플릿에 보여주는 함수를 가진다고 고려해보자:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/users/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">show_users</span><span class="p">(</span><span class="n">page</span><span class="p">):</span>
    <span class="n">users</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">&#39;users.html&#39;</span><span class="p">,</span> <span class="n">users</span><span class="o">=</span><span class="n">users</span><span class="p">)</span>
</pre></div>
</div>
<p>위의 코드는 간단하고 유연하지만, 여러분이 다른 모델이나 템플릿에도 적용가능한 일반적인
방식으로 이 뷰를 제공하고 싶다면 더 유연한 구조를 원할지 모른다. 이 경우가 끼워넣을 수 있는
클래스를 기반으로 한 뷰가 적합한 곳이다. 클래스 기반의 뷰로 변환하기 위한 첫 단계는 아래와
같다.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask.views</span> <span class="kn">import</span> <span class="n">View</span>

<span class="k">class</span> <span class="nc">ShowUsers</span><span class="p">(</span><span class="n">View</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">dispatch_request</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">users</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">&#39;users.html&#39;</span><span class="p">,</span> <span class="n">objects</span><span class="o">=</span><span class="n">users</span><span class="p">)</span>

<span class="n">app</span><span class="o">.</span><span class="n">add_url_rule</span><span class="p">(</span><span class="s">&#39;/users/&#39;</span><span class="p">,</span> <span class="n">view_func</span><span class="o">=</span><span class="n">ShowUsers</span><span class="o">.</span><span class="n">as_view</span><span class="p">(</span><span class="s">&#39;show_users&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>위에서 볼 수 있는 것처럼, 여러분은 <a class="reference internal" href="index.html#flask.views.View" title="flask.views.View"><code class="xref py py-class docutils literal"><span class="pre">flask.views.View</span></code></a> 의 서브클래스를 만들고
<a class="reference internal" href="index.html#flask.views.View.dispatch_request" title="flask.views.View.dispatch_request"><code class="xref py py-meth docutils literal"><span class="pre">dispatch_request()</span></code></a> 를 구현해야한다. 그리고 그 클래스를
<a class="reference internal" href="index.html#flask.views.View.as_view" title="flask.views.View.as_view"><code class="xref py py-meth docutils literal"><span class="pre">as_view()</span></code></a> 클래스 메소드를 사용해서 실제 뷰 함수로 변환해야한다.</p>
<blockquote>
<div><p>그 함수로 전달하는 문자열은 뷰가 가질 끝점(end-point)의 이름이다. 위의 코드를 조금
리팩토링해보자.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask.views</span> <span class="kn">import</span> <span class="n">View</span>

<span class="k">class</span> <span class="nc">ListView</span><span class="p">(</span><span class="n">View</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">get_template_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">render_template</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_template_name</span><span class="p">(),</span> <span class="o">**</span><span class="n">context</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">dispatch_request</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">context</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;objects&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_objects</span><span class="p">()}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">render_template</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">UserView</span><span class="p">(</span><span class="n">ListView</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">get_template_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&#39;users.html&#39;</span>

    <span class="k">def</span> <span class="nf">get_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">User</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
<p>물론 이것은 이런 작은 예제에서는 그다지 도움이 안될 수도 있지만, 기본 원칙을 설명하기에는
충분하다. 여러분이 클래스 기반의 뷰를 가질 때, <cite>self</cite> 가 가리키는 건 무엇이냐는 질문이
나온다. 이것이 동작하는 방식은 요청이 들어올 때마다 클래스의 새 인스턴스가 생성되고
<a class="reference internal" href="index.html#flask.views.View.dispatch_request" title="flask.views.View.dispatch_request"><code class="xref py py-meth docutils literal"><span class="pre">dispatch_request()</span></code></a> 메소드가 URL 규칙으로부터 나온 인자를
가지고 호출된다. 클래스 그 자체로는 <a class="reference internal" href="index.html#flask.views.View.as_view" title="flask.views.View.as_view"><code class="xref py py-meth docutils literal"><span class="pre">as_view()</span></code></a> 함수에 넘겨지는
인자들을 가지고 인스턴스화된다. 예를 들면, 아래와 같은 클래스를 작성할 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">RenderTemplateView</span><span class="p">(</span><span class="n">View</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">template_name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">template_name</span> <span class="o">=</span> <span class="n">template_name</span>
    <span class="k">def</span> <span class="nf">dispatch_request</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">template_name</span><span class="p">)</span>
</pre></div>
</div>
<p>그런 다음에 여러분은 아래와 같이 뷰 함수를 등록할 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">app</span><span class="o">.</span><span class="n">add_url_rule</span><span class="p">(</span><span class="s">&#39;/about&#39;</span><span class="p">,</span> <span class="n">view_func</span><span class="o">=</span><span class="n">RenderTemplateView</span><span class="o">.</span><span class="n">as_view</span><span class="p">(</span>
    <span class="s">&#39;about_page&#39;</span><span class="p">,</span> <span class="n">template_name</span><span class="o">=</span><span class="s">&#39;about.html&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="id1">
<h4>메소드 힌트<a class="headerlink" href="#id1" title="제목 주소">¶</a></h4>
<p>끼워넣을수 있는 뷰는 <a class="reference internal" href="index.html#flask.Flask.route" title="flask.Flask.route"><code class="xref py py-func docutils literal"><span class="pre">route()</span></code></a> 나 더 낫게는
<code class="xref py py-meth docutils literal"><span class="pre">methods()</span></code> 속성 정보를 제공할 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MyView</span><span class="p">(</span><span class="n">View</span><span class="p">):</span>
    <span class="n">methods</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">,</span> <span class="s">&#39;POST&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">dispatch_request</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s">&#39;POST&#39;</span><span class="p">:</span>
            <span class="o">...</span>
        <span class="o">...</span>

<span class="n">app</span><span class="o">.</span><span class="n">add_url_rule</span><span class="p">(</span><span class="s">&#39;/myview&#39;</span><span class="p">,</span> <span class="n">view_func</span><span class="o">=</span><span class="n">MyView</span><span class="o">.</span><span class="n">as_view</span><span class="p">(</span><span class="s">&#39;myview&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h4>메소드 기반 디스패치<a class="headerlink" href="#id2" title="제목 주소">¶</a></h4>
<p>RESTful API에서 각 HTTP 메소드별로 다른 함수를 수행하는 것은 굉장히 도움이 된다.
<a class="reference internal" href="index.html#flask.views.MethodView" title="flask.views.MethodView"><code class="xref py py-class docutils literal"><span class="pre">flask.views.MethodView</span></code></a> 로 여러분은 그 작업을 쉽게 할 수 있다. 각 HTTP
메소드는 같은 이름을 가진 함수(소문자)로 연결된다.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask.views</span> <span class="kn">import</span> <span class="n">MethodView</span>

<span class="k">class</span> <span class="nc">UserAPI</span><span class="p">(</span><span class="n">MethodView</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">users</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="o">...</span>

    <span class="k">def</span> <span class="nf">post</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">from_form_data</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">)</span>
        <span class="o">...</span>

<span class="n">app</span><span class="o">.</span><span class="n">add_url_rule</span><span class="p">(</span><span class="s">&#39;/users/&#39;</span><span class="p">,</span> <span class="n">view_func</span><span class="o">=</span><span class="n">UserAPI</span><span class="o">.</span><span class="n">as_view</span><span class="p">(</span><span class="s">&#39;users&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>이 방식은 또한 여러분이 <a class="reference internal" href="index.html#flask.views.View.methods" title="flask.views.View.methods"><code class="xref py py-attr docutils literal"><span class="pre">methods</span></code></a> 속성을 제공하지 않아도 된다.
클래스에 정의된 메소드 기반으로 자동으로 설정된다.</p>
</div>
<div class="section" id="id3">
<h4>데코레이팅 뷰<a class="headerlink" href="#id3" title="제목 주소">¶</a></h4>
<p>뷰 클래스 그 자체는 라우팅 시스템에 추가되는 뷰 함수가 아니기 때문에, 클래스 자체를
데코레이팅하는 것은 이해되지 않는다. 대신, 여러분이 수동으로 <a class="reference internal" href="index.html#flask.views.View.as_view" title="flask.views.View.as_view"><code class="xref py py-meth docutils literal"><span class="pre">as_view()</span></code></a> 함수의 리턴값을 데코레이팅해야한다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">user_required</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Checks whether user is logged in or raises error 401.&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">g</span><span class="o">.</span><span class="n">user</span><span class="p">:</span>
            <span class="n">abort</span><span class="p">(</span><span class="mi">401</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">decorator</span>

<span class="n">view</span> <span class="o">=</span> <span class="n">user_required</span><span class="p">(</span><span class="n">UserAPI</span><span class="o">.</span><span class="n">as_view</span><span class="p">(</span><span class="s">&#39;users&#39;</span><span class="p">))</span>
<span class="n">app</span><span class="o">.</span><span class="n">add_url_rule</span><span class="p">(</span><span class="s">&#39;/users/&#39;</span><span class="p">,</span> <span class="n">view_func</span><span class="o">=</span><span class="n">view</span><span class="p">)</span>
</pre></div>
</div>
<p>플라스크 0.8부터 클래스 선언에도 적용할 데코레이터 목록을 표시할 수 있는 대안이 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">UserAPI</span><span class="p">(</span><span class="n">MethodView</span><span class="p">):</span>
    <span class="n">decorators</span> <span class="o">=</span> <span class="p">[</span><span class="n">user_required</span><span class="p">]</span>
</pre></div>
</div>
<p>호출하는 입장에서 그 자체로 암시적이기 때문에 여러분이 뷰의 개별 메소드에 일반적인 뷰
데코레이터를 사용할 수 없다는 것을 명심하길 바란다.</p>
</div>
<div class="section" id="api">
<h4>메소드 뷰 API<a class="headerlink" href="#api" title="제목 주소">¶</a></h4>
<p>웹 API는 보통 HTTP 메소드와 매우 밀접하게 동작하는데
<a class="reference internal" href="index.html#flask.views.MethodView" title="flask.views.MethodView"><code class="xref py py-class docutils literal"><span class="pre">MethodView</span></code></a> 기반의 API를 구현할때는
더욱 의미가 들어맞는다. 그렇긴 하지만, 여러분은 그 API가 대부분 같은 메소드 뷰로 가는 여러
다른 URL 규칙을 요구할 것이라는 것을 알아야 할 것이다. 예를 들면, 여러분이 웹에서 사용자
객체에 노출된 상황을 고려해보자:</p>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="22%" />
<col width="56%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>URL</td>
<td>Method</td>
<td>Description</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">/users/</span></code></td>
<td><code class="docutils literal"><span class="pre">GET</span></code></td>
<td>전체 사용자 정보 목록 얻기</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">/users/</span></code></td>
<td><code class="docutils literal"><span class="pre">POST</span></code></td>
<td>새로운 사용자 정보 생성</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">/users/&lt;id&gt;</span></code></td>
<td><code class="docutils literal"><span class="pre">GET</span></code></td>
<td>단일 사용자 정보 얻기</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">/users/&lt;id&gt;</span></code></td>
<td><code class="docutils literal"><span class="pre">PUT</span></code></td>
<td>단일 사용자 정보 갱신</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">/users/&lt;id&gt;</span></code></td>
<td><code class="docutils literal"><span class="pre">DELETE</span></code></td>
<td>단일 사용자 정보 삭제</td>
</tr>
</tbody>
</table>
<p>그렇다면 <a class="reference internal" href="index.html#flask.views.MethodView" title="flask.views.MethodView"><code class="xref py py-class docutils literal"><span class="pre">MethodView</span></code></a> 를 가지고는 어떻게 위와 같은 작업을 계속할
것인가? 여러분이 같은 뷰에 여러 규칙을 제공할 수 있는 것이 요령이다.</p>
<p>뷰가 아래와 같이 보일 때를 가정해보자:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">UserAPI</span><span class="p">(</span><span class="n">MethodView</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">user_id</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c"># return a list of users</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># expose a single user</span>
            <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">post</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># create a new user</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">):</span>
        <span class="c"># delete a single user</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">put</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">):</span>
        <span class="c"># update a single user</span>
        <span class="k">pass</span>
</pre></div>
</div>
<p>그렇다면 우리는 이것을 어떻게 라우팅 시스템으로 연결하는가? 두가지 규칙을 추가하고
명시적으로 각 메소드를 언급한다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">user_view</span> <span class="o">=</span> <span class="n">UserAPI</span><span class="o">.</span><span class="n">as_view</span><span class="p">(</span><span class="s">&#39;user_api&#39;</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">add_url_rule</span><span class="p">(</span><span class="s">&#39;/users/&#39;</span><span class="p">,</span> <span class="n">defaults</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;user_id&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">},</span>
                 <span class="n">view_func</span><span class="o">=</span><span class="n">user_view</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">,])</span>
<span class="n">app</span><span class="o">.</span><span class="n">add_url_rule</span><span class="p">(</span><span class="s">&#39;/users/&#39;</span><span class="p">,</span> <span class="n">view_func</span><span class="o">=</span><span class="n">user_view</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;POST&#39;</span><span class="p">,])</span>
<span class="n">app</span><span class="o">.</span><span class="n">add_url_rule</span><span class="p">(</span><span class="s">&#39;/users/&lt;int:user_id&gt;&#39;</span><span class="p">,</span> <span class="n">view_func</span><span class="o">=</span><span class="n">user_view</span><span class="p">,</span>
                 <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">,</span> <span class="s">&#39;PUT&#39;</span><span class="p">,</span> <span class="s">&#39;DELETE&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>여러분이 유사하게 보이는 여러 API를 갖고 있다면, 등록하는 메소드를 추가하도록 아래처럼
리팩토링할 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">register_api</span><span class="p">(</span><span class="n">view</span><span class="p">,</span> <span class="n">endpoint</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">pk</span><span class="o">=</span><span class="s">&#39;id&#39;</span><span class="p">,</span> <span class="n">pk_type</span><span class="o">=</span><span class="s">&#39;int&#39;</span><span class="p">):</span>
    <span class="n">view_func</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="n">as_view</span><span class="p">(</span><span class="n">endpoint</span><span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">add_url_rule</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">defaults</span><span class="o">=</span><span class="p">{</span><span class="n">pk</span><span class="p">:</span> <span class="bp">None</span><span class="p">},</span>
                     <span class="n">view_func</span><span class="o">=</span><span class="n">view_func</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">,])</span>
    <span class="n">app</span><span class="o">.</span><span class="n">add_url_rule</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">view_func</span><span class="o">=</span><span class="n">view_func</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;POST&#39;</span><span class="p">,])</span>
    <span class="n">app</span><span class="o">.</span><span class="n">add_url_rule</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%s</span><span class="s">&lt;</span><span class="si">%s</span><span class="s">:</span><span class="si">%s</span><span class="s">&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">pk_type</span><span class="p">,</span> <span class="n">pk</span><span class="p">),</span> <span class="n">view_func</span><span class="o">=</span><span class="n">view_func</span><span class="p">,</span>
                     <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">,</span> <span class="s">&#39;PUT&#39;</span><span class="p">,</span> <span class="s">&#39;DELETE&#39;</span><span class="p">])</span>

<span class="n">register_api</span><span class="p">(</span><span class="n">UserAPI</span><span class="p">,</span> <span class="s">&#39;user_api&#39;</span><span class="p">,</span> <span class="s">&#39;/users/&#39;</span><span class="p">,</span> <span class="n">pk</span><span class="o">=</span><span class="s">&#39;user_id&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<span id="document-appcontext"></span><div class="section" id="app-context">
<span id="id1"></span><h3>어플리케이션 컨텍스트<a class="headerlink" href="#app-context" title="제목 주소">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">버전 0.9에 추가.</span></p>
</div>
<p>Flask의 설계에 숨겨진 사상들 중 하나는 코드가 수행되는 두가지 다른 “상태”가 있다는 것이다.
하나는 어플리케이션이 암묵적으로 모듈 레벨에 있는 어플리케이션 셋업 상태이다. 그 상태는
<code class="xref py py-class docutils literal"><span class="pre">Flask</span></code> 객체가 초기화될 때때 시작되고, 첫 요청을 받았을 때 암묵적으로 종료된다.
어플리케이션이 이 상태에 있을 때, 아래와 같은 몇가지 가정이 성립한다:</p>
<ul class="simple">
<li>개발자는 어플리케이션 객체를 안전하게 수정할 수 있다.</li>
<li>현재까지 어떤 요청도 처리되지 않았다.</li>
<li>여러분이 어플리케이션 객체를 수정하려면 그 객체에 대한 참조를 가져야만한다.여러분이 현재 생성하고 수정하고 있는 어플리케이션 객체에 대한 참조를 줄 수 있는 어떠한 매직 프록시(magic proxy)는 존재하지 않는다.</li>
</ul>
<p>반대로, 요청을 처리하는 동안에는, 몇 가지 다른 룰이 존재한다:</p>
<ul class="simple">
<li>요청이 살아있는 동안에는 컨텍스트 로컬 객체( <a class="reference internal" href="index.html#flask.request" title="flask.request"><code class="xref py py-data docutils literal"><span class="pre">flask.request</span></code></a> 와 몇가지 객체들)가 현재 요청을 가리킨다.</li>
<li>어떤 코드도 언제든지 이 컨텍스트 로컬 객체를 가질 수 있다.</li>
</ul>
<p>이 상태의 작은 틈 사이에 있는 세번째 상태가 있다. 때때로 여러분은 요청처리 동안 요청이
활성화되지 않은 어플리케이션과 상호작용하는 방식과 유사하게 어플리케이션을 다룰 것이다. 예를 들면, 여러분이 대화형 파이썬 쉘에 있고 어플리케이션이나 명령행으로 어플리케이션을 실행하는
상황을 고려할 수 있다.</p>
<p>어플리케이션 컨텍스트는 <a class="reference internal" href="index.html#flask.current_app" title="flask.current_app"><code class="xref py py-data docutils literal"><span class="pre">current_app</span></code></a> 라는 컨텍스트 로컬을 작동시킨다.</p>
<div class="section" id="id2">
<h4>어플리케이션 컨텍스트의 목적<a class="headerlink" href="#id2" title="제목 주소">¶</a></h4>
<p>어플리케이션의 컨텍스트가 존재하는 주요한 이유는 과거에 다수의 기능이 더 나은 솔루션의
부족으로 요청 컨텍스트에 덧붙여있었다는 것이다. Flask의 기본 설계 중 하나는 여러분이 같은
파이썬 프로세스에 하나 이상의 어플리케이션을 갖을 수 있다는 것이다.</p>
<p>그래서 코드는 어떻게 “적합한” 어플리케이션을 찾을 수 있는가? 과거에 우리는 명시적으로
어플리케이션을 제공했었지만, 그 방식은 명시적 전달을 염두하지 않은 라이브러리와 문제를
야기했다.</p>
<blockquote>
<div>그 문제의 일반적인 차선책은 현재 요청에 대한 어플리케이션 참조와 연결되있는 <a class="reference internal" href="index.html#flask.current_app" title="flask.current_app"><code class="xref py py-data docutils literal"><span class="pre">current_app</span></code></a>  프록시를 나중에 사용하는 것이었다. 그러나, 그런 요청 컨텍스트를 생성하는 것은 어떤 요청도 없는 경우에 불필요하게 고비용 동작이기 때문에, 그 어플리케이션 컨텍스트가 소개되었다.</div></blockquote>
</div>
<div class="section" id="id3">
<h4>어플리케이션 컨텍스트 생성하기<a class="headerlink" href="#id3" title="제목 주소">¶</a></h4>
<p>어플리케이션 컨텍스트를 만들기 위해서는 두 가지 방법이 있다. 첫번째는 임의적인 방식으로,
요청 컨텍스트가 들어올 때마다, 어플리케이션 컨텍스트가 필요한 경우 바로 옆에 생성될 것이다.
그 결과로 여러분은 어플리케이션 컨텍스트가 필요없다면 그 존재를 무시할 수 있다.</p>
<p>두 번째 방식은 <a class="reference internal" href="index.html#flask.Flask.app_context" title="flask.Flask.app_context"><code class="xref py py-meth docutils literal"><span class="pre">app_context()</span></code></a> 메소드를 사용하는 명시적으로 방법이다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">current_app</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
<span class="k">with</span> <span class="n">app</span><span class="o">.</span><span class="n">app_context</span><span class="p">():</span>
    <span class="c"># within this block, current_app points to app.</span>
    <span class="k">print</span> <span class="n">current_app</span><span class="o">.</span><span class="n">name</span>
</pre></div>
</div>
<p>어플리케이션 문맥은 <code class="docutils literal"><span class="pre">SERVER_NAME</span></code> 이 설정된 경우 <a class="reference internal" href="index.html#flask.url_for" title="flask.url_for"><code class="xref py py-func docutils literal"><span class="pre">url_for()</span></code></a> 함수에
의해서도 사용된다. 이것은 요청이 없는 경우에도 여러분이 URL을 생성할 수 있게 해준다.</p>
</div>
<div class="section" id="id4">
<h4>컨텍스트의 지역성<a class="headerlink" href="#id4" title="제목 주소">¶</a></h4>
<p>어플리케이션 문맥은 필요에 따라 생성되고 소멸된다. 그것은 결코 쓰레드들 사이를 이동할 수
없고 요청 사이에서 공유되지 않을 것이다. 그와 같이, 어플리케이션 문맥은 데이타베이스 연결
정보와 다른 정보들을 저장하는 최적의 장소다. 내부 스택 객체는 <a class="reference internal" href="index.html#flask._app_ctx_stack" title="flask._app_ctx_stack"><code class="xref py py-data docutils literal"><span class="pre">flask._app_ctx_stack</span></code></a> 이다.
확장들은 충분히 구별되는 이름을 선택하다는 가정하에서 자유롭게 가장 상위에 추가적인 정보를
저장한다.</p>
<p>더 많은 정보에 대해서는 <a class="reference internal" href="index.html#extension-dev"><span>Flask Extension Development</span></a> 을 살펴보라.</p>
</div>
<div class="section" id="id5">
<h4>컨텍스트 사용<a class="headerlink" href="#id5" title="제목 주소">¶</a></h4>
<p>컨텍스트는 일반적으로 요청당 하나씩 생성되거나 직접 사용하는 경우에 캐시 리소스에 사용된다.
예를 들어 데이터베이스 연결과 같은 경우다. 어플리케이션 컨텍스트에 저장할 때에는 반드시
고유한 이름을 선택하여야 한다.
이 영역은 Flask 어플리케이션들과 확장(플러그인 같은)들에서 공유되기 때문이다.</p>
<p>가장 일반적인 사용법은 리소스 관리를 두개의 파트로 나누는 것이다:</p>
<ol class="arabic simple">
<li>컨텍스트에서의 암시적인 자원 캐시</li>
<li>컨텍스트 분해를 통한 리소스 할당 해제</li>
</ol>
<p>일반적으로 자원 <code class="docutils literal"><span class="pre">X</span></code> 를 생성하는 <code class="docutils literal"><span class="pre">get_X()</span></code> 함수가 있다고 하자.
만약 그것이 아직 존재 하지 않고, 다른 방법으로 같은 자원을 반환하는 <code class="docutils literal"><span class="pre">teardown_X()</span></code> 함수가
teardown 핸들러에 등록되어 있다.</p>
<p>여기 데이터베이스에 연결하는 예제가 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">sqlite3</span>
<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">_app_ctx_stack</span>

<span class="k">def</span> <span class="nf">get_db</span><span class="p">():</span>
    <span class="n">top</span> <span class="o">=</span> <span class="n">_app_ctx_stack</span><span class="o">.</span><span class="n">top</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="s">&#39;database&#39;</span><span class="p">):</span>
        <span class="n">top</span><span class="o">.</span><span class="n">database</span> <span class="o">=</span> <span class="n">connect_to_database</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">top</span><span class="o">.</span><span class="n">database</span>

<span class="nd">@app.teardown_appcontext</span>
<span class="k">def</span> <span class="nf">teardown_db</span><span class="p">(</span><span class="n">exception</span><span class="p">):</span>
    <span class="n">top</span> <span class="o">=</span> <span class="n">_app_ctx_stack</span><span class="o">.</span><span class="n">top</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="s">&#39;database&#39;</span><span class="p">):</span>
        <span class="n">top</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>처음 <code class="docutils literal"><span class="pre">get_db()</span></code> 가 호출된 시점에 연결이 이루어진다.
이 것을 암시적으로 만들기 위해서는 <a class="reference external" href="http://werkzeug.pocoo.org/docs/local/#werkzeug.local.LocalProxy" title="(in Werkzeug v0.11-dev)"><code class="xref py py-class docutils literal"><span class="pre">LocalProxy</span></code></a> 를 사용할 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">werkzeug.local</span> <span class="kn">import</span> <span class="n">LocalProxy</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">LocalProxy</span><span class="p">(</span><span class="n">get_db</span><span class="p">)</span>
</pre></div>
</div>
<p>이것은 사용자가 <a href="#id6"><span class="problematic" id="id7">``</span></a>db``에 내부 호출인 <a href="#id8"><span class="problematic" id="id9">``</span></a>get_db()``를 통해서 직접 접근 가능하게 해준다.</p>
</div>
</div>
<span id="document-reqcontext"></span><div class="section" id="request-context">
<span id="id1"></span><h3>요청 컨텍스트<a class="headerlink" href="#request-context" title="제목 주소">¶</a></h3>
<p>이 문서는 플라스크 0.7에 있는 동작을 설명하는데 대부분은 이전 버전과 비슷하지만, 몇몇 작고
미묘한 차이를 갖는다.</p>
<p>13장인 어플리케이션 컨텍스트 <a class="reference internal" href="index.html#app-context"><span>어플리케이션 컨텍스트</span></a> 을 먼저 읽는 것을 권고한다.</p>
<div class="section" id="id2">
<h4>컨텍스트 로컬로 다이빙하기<a class="headerlink" href="#id2" title="제목 주소">¶</a></h4>
<p>여러분이 사용자를 리디렉트해야하는 URL을 반환하는 유틸리티 함수를 갖는다고 하자. 그 함수는
항상 URL의 next 인자나 HTTP referer 또는 index에 대한 URL을 리디렉트한다고 가정하자:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">request</span><span class="p">,</span> <span class="n">url_for</span>

<span class="k">def</span> <span class="nf">redirect_url</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;next&#39;</span><span class="p">)</span> <span class="ow">or</span> \
           <span class="n">request</span><span class="o">.</span><span class="n">referrer</span> <span class="ow">or</span> \
           <span class="n">url_for</span><span class="p">(</span><span class="s">&#39;index&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>여러분이 볼 수 있는 것처럼, 그것은 요청 객체를 접근한다. 여러분은 플레인 파이썬 쉘에서
이것을 실행하면, 여러분은 아래와 같은 예외를 볼 것이다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">redirect_url</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<span class="gr">AttributeError</span>: <span class="n">&#39;NoneType&#39; object has no attribute &#39;request&#39;</span>
</pre></div>
</div>
<p>우리가 현재 접근할 수 있는 요청을 갖고 있지 않기 때문에 그것은 이해가 된다. 그래서 우리는
요청을 만들고 그것을 현재 컨텍스트에 연결시켜야 한다.
<a class="reference internal" href="index.html#flask.Flask.test_request_context" title="flask.Flask.test_request_context"><code class="xref py py-attr docutils literal"><span class="pre">test_request_context</span></code></a> 메소드는 우리에게
<a class="reference internal" href="index.html#flask.ctx.RequestContext" title="flask.ctx.RequestContext"><code class="xref py py-class docutils literal"><span class="pre">RequestContext</span></code></a> 를 만들어 줄 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">ctx</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">test_request_context</span><span class="p">(</span><span class="s">&#39;/?next=http://example.com/&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>이 컨텍스트는 두 가지 방식으로 사용될 수 있다. <cite>with</cite> 절과 함께 사용되거나
<a class="reference internal" href="index.html#flask.ctx.RequestContext.push" title="flask.ctx.RequestContext.push"><code class="xref py py-meth docutils literal"><span class="pre">push()</span></code></a> 와 <a class="reference internal" href="index.html#flask.ctx.RequestContext.pop" title="flask.ctx.RequestContext.pop"><code class="xref py py-meth docutils literal"><span class="pre">pop()</span></code></a> 메소드를 호출하여 사용된다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">ctx</span><span class="o">.</span><span class="n">push</span><span class="p">()</span>
</pre></div>
</div>
<p>이 시점부터 여러분은 요청 객체를 가지고 작업할 수 있다 :</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">redirect_url</span><span class="p">()</span>
<span class="go">u&#39;http://example.com/&#39;</span>
</pre></div>
</div>
<p><cite>pop</cite> 함수를 호출할 때까지:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">ctx</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</pre></div>
</div>
<p>요청 컨텍스트는 내부적으로 스택을 유지하기 때문에 여러분은 여러번 push와 pop을 할 수 있다.
이것이 내부적인 리디렉트와 같은 것을 손쉽게 구현한 것이다.</p>
<p>상호작용 파이썬 쉘로부터 요청 컨텍스트를 사용하는 더 많은 정보는 <a class="reference internal" href="index.html#shell"><span>쉘에서 작업하기</span></a> 장으로 넘어가라.</p>
</div>
<div class="section" id="id3">
<h4>컨텍스트가 작동하는 방식<a class="headerlink" href="#id3" title="제목 주소">¶</a></h4>
<p>여러분이 플라스크 WSGI 어플리케이션이 내부적으로 동작하는 방식을 살펴보려면, 아래와 대단히
유사한 코드를 찾게될 것이다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">wsgi_app</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">environ</span><span class="p">):</span>
    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_context</span><span class="p">(</span><span class="n">environ</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dispatch_request</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_response</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle_exception</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">response</span><span class="p">(</span><span class="n">environ</span><span class="p">,</span> <span class="n">start_response</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="xref py py-meth docutils literal"><span class="pre">request_context()</span></code> 메소드는 새로운 <a class="reference internal" href="index.html#flask.ctx.RequestContext" title="flask.ctx.RequestContext"><code class="xref py py-class docutils literal"><span class="pre">RequestContext</span></code></a>  객체를 반환하고 컨텍스트를 연결하기 위해 <cite>with</cite> 구문과 조합하여
RequestContext 객체를 사용한다. 이 시점부터 <cite>with</cite> 구문의 끝까지 같은
쓰레드에서 호출되는 모든 것은 요청 글로벌 객체( <a class="reference internal" href="index.html#flask.request" title="flask.request"><code class="xref py py-data docutils literal"><span class="pre">flask.request</span></code></a> 와 기타 다른것들)에 접근할 수 있을 것이다.</p>
<p>요청 컨텍스트도 내부적으로 스택처럼 동작한다.
스택의 가장 상위에는 현재 활성화된 요청이 있다.
<a class="reference internal" href="index.html#flask.ctx.RequestContext.push" title="flask.ctx.RequestContext.push"><code class="xref py py-meth docutils literal"><span class="pre">push()</span></code></a> 는 스택의 제일 위에 컨텍스트를 더하고, <a class="reference internal" href="index.html#flask.ctx.RequestContext.pop" title="flask.ctx.RequestContext.pop"><code class="xref py py-meth docutils literal"><span class="pre">pop()</span></code></a> 은 스택으로부터 제일 상위에 있는 컨텍스트를 제거한다.
컨텍스트를 제거하는 pop 동작 시, 어플리케이션의 <a class="reference internal" href="index.html#flask.Flask.teardown_request" title="flask.Flask.teardown_request"><code class="xref py py-func docutils literal"><span class="pre">teardown_request()</span></code></a>  함수 또한 실행된다.</p>
<p>주목할 다른 것은 요청 컨텍스트가 들어오고 그때까지 해당 어플리케이션에 어떠한 어플리케이션
컨텍스트가 없었다면, 자동으로 <a class="reference internal" href="index.html#app-context"><span>application context</span></a> 또한 생성할 것이라는 것이다.</p>
</div>
<div class="section" id="callbacks-and-errors">
<span id="id4"></span><h4>콜백과 오류<a class="headerlink" href="#callbacks-and-errors" title="제목 주소">¶</a></h4>
<p>Flask에서 요청 처리하는 동안 오류가 발생하면 어떻게 되는가? 버전 0.7에서 이 특별한 동작이
변경되었는데, 왜냐하면 우리가 실제로 발생하는 것이 무엇인지 좀 더 쉽게 이해가기 원했기
때문이다:</p>
<ol class="arabic simple">
<li>각 요청 전에, <a class="reference internal" href="index.html#flask.Flask.before_request" title="flask.Flask.before_request"><code class="xref py py-meth docutils literal"><span class="pre">before_request()</span></code></a> 함수들이 수행된다.
이런 함수들 중 하나라도 응답을 반환하면, 다른 함수들은 더 이상 호출되지 않는다.
그러나 어떤 경우라도 반환값은 뷰의 반환값에 대한 대체값으로 처리된다.</li>
<li><a class="reference internal" href="index.html#flask.Flask.before_request" title="flask.Flask.before_request"><code class="xref py py-meth docutils literal"><span class="pre">before_request()</span></code></a> 함수들이 응닶을 반환하지 않는다면,
보통 요청 처리가 시작되고 요청에 맞는 뷰 함수가 응답을 반환하게 된다.</li>
<li>그리고 나서, 뷰의 반환값은 실제 응답 객체로 변환되고 응답 객체를 대체하거나 변경할
준비가 되있는 <a class="reference internal" href="index.html#flask.Flask.after_request" title="flask.Flask.after_request"><code class="xref py py-meth docutils literal"><span class="pre">after_request()</span></code></a> 함수로 전달된다.</li>
<li>요청의 종료 시에는 <a class="reference internal" href="index.html#flask.Flask.teardown_request" title="flask.Flask.teardown_request"><code class="xref py py-meth docutils literal"><span class="pre">teardown_request()</span></code></a> 함수가 실행된다.
이 함수는 심지어 처리되지 않는 예외의 경우나
before-request 핸들러가 아직 처리되지 않거나 전혀 실해되지 않는 경우에도 항상 발생한다.
(예를 들면, 테스트 환경에서 때때로 before-request 콜백이 호출되지 않기를 원할수도 있다.)</li>
</ol>
<p>자 오류가 발생하면 무슨일이 발생하는가? 운영 환경에서는 예외가 처리되지 않으면, 500 내부
서버 핸들러가 실행된다. 그러나, 개발 환경에서는 예외는 더 진행되지 않고 WSGI 서버로 영향을
미친다. 대화형 디버거와 같은 방식에서는 도움되는 디버깅 정보를 제공할 수 있다.</p>
<p>버전 0.7에서 중요한 변화는 내부 서버 오류가 더 이상 after-request 콜백에 의해 사후
처리되지 않고 after-request 콜백이 실행되는 것을 보장해주지 않는다는 것이다. 이 방식으로
내부 디스패칭 코드는 더 깔끔해졌고 커스터마이징과 이해가 더 쉬워졌다.</p>
<p>새로운 teardown 함수는 요청의 마지막에서 반드시 행이 필요한 경우에 대체할 목적으로 사용되는 것을 가정한다.</p>
</div>
<div class="section" id="teardown">
<h4>테어다운(Teardown) 콜백<a class="headerlink" href="#teardown" title="제목 주소">¶</a></h4>
<p>테어다운 콜백은 특별한 콜백인데 여러 다른 시점에 실행되기 때문이다. 엄격하게 말하자면,
그것들이 <a class="reference internal" href="index.html#flask.ctx.RequestContext" title="flask.ctx.RequestContext"><code class="xref py py-class docutils literal"><span class="pre">RequestContext</span></code></a> 객체의 생명주기와 연결되있긴 하지만, 그것들은 실제 요청 처리와  독립되있다. 요청 문맥이 꺼내질 때, <a class="reference internal" href="index.html#flask.Flask.teardown_request" title="flask.Flask.teardown_request"><code class="xref py py-meth docutils literal"><span class="pre">teardown_request()</span></code></a> 함수는 호출된다.</p>
<p>with 구문이  있는 테스트 클라이언트를 사용하여 요청 문맥의 생명이 범위가 늘었는지 또는 명령줄에서 요청 문맥을 사용할 때를 아는 것이 중요하다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">with</span> <span class="n">app</span><span class="o">.</span><span class="n">test_client</span><span class="p">()</span> <span class="k">as</span> <span class="n">client</span><span class="p">:</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;/foo&#39;</span><span class="p">)</span>
    <span class="c"># the teardown functions are still not called at that point</span>
    <span class="c"># even though the response ended and you have the response</span>
    <span class="c"># object in your hand</span>

<span class="c"># only when the code reaches this point the teardown functions</span>
<span class="c"># are called.  Alternatively the same thing happens if another</span>
<span class="c"># request was triggered from the test client</span>
</pre></div>
</div>
<p>명령줄에서 이 동작을 보기는 쉽다.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@app.teardown_request</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">teardown_request</span><span class="p">(</span><span class="n">exception</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="s">&#39;this runs after request&#39;</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ctx</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">test_request_context</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ctx</span><span class="o">.</span><span class="n">push</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ctx</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
<span class="go">this runs after request</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>before-request 콜백은 아직 실행되지 않고 예외가 발생했더라도,teardown 콜백은 항상
호출된다는 것을 명심하라. 테스트 시스템의 어떤 부분들 또한 before-request 핸들러를
호출하지 않고 일시적으로 요청 문맥을 생성할지도 모른다. 절대로 실패하지 않는 방식으로
여러분의 teardown-request 핸들러를 쓰는 것을 보장하라.</p>
</div>
<div class="section" id="notes-on-proxies">
<span id="id5"></span><h4>프록시에서 주의할 점<a class="headerlink" href="#notes-on-proxies" title="제목 주소">¶</a></h4>
<p>플라스크에서 제공하는 일부 객체들은 다른 객체에 대한 프록시들이다. 이렇게 하는 뒷 배경에는
이런 프락시들이 쓰레들간에 공유되어 있고 그 프락시들이 쓰레드들에 연결된 실제 객체로
필요시에 보이지 않게 디스패치되어야 한다는 것이다.</p>
<p>대게 여러분은 그 프락시에 대해서 신경쓰지 않아도 되지만, 이 객체가 실제 프락시인지 알면 좋은 몇 가지 예외의 경우가 있다. :</p>
<ul class="simple">
<li>프락시 객체들이 상속받은 타입을 속이지 않아서, 여러분이 실제 인스턴스를 확인한다면,
프락시로 된 인스턴스에서 타입을 확인해야한다.(아래의 <cite>_get_current_object</cite> 를 보라).</li>
<li>객체의 참조가 중요한 경우( <a class="reference internal" href="index.html#signals"><span>시그널(Signals)</span></a> 을 보내는 경우)</li>
</ul>
<p>여러분이 프록시된 감춰진 객체에 접근할 필요가 있다면, <a class="reference external" href="http://werkzeug.pocoo.org/docs/local/#werkzeug.local.LocalProxy._get_current_object" title="(in Werkzeug v0.11-dev)"><code class="xref py py-meth docutils literal"><span class="pre">_get_current_object()</span></code></a> 메소드를 사용할 수 있다:</p>
<blockquote>
<div>app = current_app._get_current_object()
my_signal.send(app)</div></blockquote>
</div>
<div class="section" id="id6">
<h4>오류 시 컨텍스트 보존<a class="headerlink" href="#id6" title="제목 주소">¶</a></h4>
<p>오류가 발생하거나 하지 않거나, 요청의 마지막에서 요청 문맥은 스택에서 빠지게 되고 그 문맥과
관련된 모든 데이타는 소멸된다. 하지만, 개발하는 동안 그것은 예외가 발생하는 경우에 여러분이
더 오랜 시간동안 그 정보를 갖고 있기를 원하기 때문에 문제가 될 수 있다. 플라스크 0.6과 그
이전 버전의 디버그 모드에서는 예외가 발생했을 때, 요청 문맥이 꺼내지지 않아서 인터렉티브(
상호작용하는) 디버거가 여러분에게 여전히 중요한 정보를 제공할 수 있었다.</p>
<p>플라스크 0.7부터 여러분은 <code class="docutils literal"><span class="pre">PRESERVE_CONTEXT_ON_EXCEPTION</span></code> 설정 변수값을 설정하여 그
행동을 좀 더 세밀하게 설정한다. 디폴트로 이 설정은 <code class="docutils literal"><span class="pre">DEBUG</span></code> 설정과 연결된다.
어플리케이션이 디버그 모드라면, 그 문맥은 보존되지만, 운영 모드라면 보존되지 않는다.</p>
<p>어플리케이션이 예외 발생 시 메모리 누수를 야기할 수 있으므로 운영 모드에서
<a href="#id7"><span class="problematic" id="id8">``</span></a>PRESERVE_CONTEXT_ON_EXCEPTION``을 강제로 활성화하지 않아야 한다. 하지만, 개발
모드에서 운영 설정에서만 발생하는 오류를 디버그하려 할 때 개발 모드로 같은 오류 보존 동작을 얻는 것은 개발하는 동안에는 유용할 수 있다.</p>
</div>
</div>
<span id="document-blueprints"></span><div class="section" id="blueprints">
<span id="id1"></span><h3>블루프린트를 가진 모듈화된 어플리케이션<a class="headerlink" href="#blueprints" title="제목 주소">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">버전 0.7에 추가.</span></p>
</div>
<p>플라스크는 어플리케이션 컴포넌트를 만들고 어플리케이션 내부나 어플리케이션간에
공통 패턴을 지원하기 위해 <em>블루프린트(blueprint)</em> 라는 개념을 사용한다.  블루프린트는
보통 대형 어플리케이션이 동작하는 방식을 단순화하고 어플리케이션의 동작을
등록하기 위한 플라스크 확장에 대한 중앙 집중된 수단을 제공할 수 있다.
<code class="xref py py-class docutils literal"><span class="pre">Blueprint</span></code> 객체는 <code class="xref py py-class docutils literal"><span class="pre">Flask</span></code> 어플리케이션 객체와 유사하게 동작하지만
실제로 어플리케이션은 아니다. 다만 어플리케이션을 생성하거나 확장하는 방식에 대한
<em>블루프린트</em> 이다.</p>
<div class="section" id="id2">
<h4>왜 블루프린트인가?<a class="headerlink" href="#id2" title="제목 주소">¶</a></h4>
<p>플라스크의 블루프린트는 다음 경우로 인해 만들어졌다:</p>
<ul class="simple">
<li>어플리케이션을 블루프린트의 집합으로 고려한다.  이 방식은 대형 어플리케이션에
있어서 이상적이다; 프로젝트는 어플리케이션 객체를 인스턴스화하고,
여러 확장을 초기화하고, 블루프린트의 묶음을 등록할 수 있다.</li>
<li>어플리케이션 상에 URL 접두어와/또는 서브도메인으로 블루프린트를 등록한다.
URL 접두어와/또는 서브도메인에 있는 파라메터는 블루프린트에 있는 모든 뷰 함수에
걸쳐있는 공통 뷰 인자(기본값을 가진)가 된다.</li>
<li>어플리케이션에 여러 URL 규칙을 가진 블루프린트를 여러번 등록한다.</li>
<li>블루프린트를 통해 템플릿 필터, 정적 파일, 템플릿, 그리고 다른 유틸리티를 제공한다.
블루프린트는 어플리케이션이나 뷰 함수를 구현하지 않아도 된다.</li>
<li>플라스크 확장을 초기화할 때 이런 경우 중 어떤 경우라도 어플리케이션에 블루프린트를
등록한다.</li>
</ul>
<p>플라스크에 있는 블루프린트는 끼우고 뺄수 있는 앱이 아니다 왜냐하면 블루프린트는 실제
어플리케이션이 아니기 때문이다 &#8211; 그것은 어플리케이션에 등록될 수 있는 동작의
집합인데 심지어 여러번 등록될 수 있다.  왜 복수의 어플리케이션 객체를 가지지
않는가?  여러분은 그렇게(<a class="reference internal" href="index.html#app-dispatch"><span>어플리케이션 디스패칭</span></a> 을 살펴봐라)할 수 있지만,
어플리케이션은 분리된 설정을 가질것 이고 WSGI 계층에서 관리될 것이다.</p>
<p>대신에 블루프린트는 플라스크 레벨에서 분리를 제공하고, 어플리케이션 설정을 공유하며
, 그리고 등록된 것을 가지고 필요에 따라 어플리케이션 객체를 변경할 수 있다.
이것의 단점은 일단 전체 어플리케이션 객체를 제거할 필요없이 어플리케이션이
생성됐을 때 여러분은 블루프린트를 해지할 수 없다.</p>
</div>
<div class="section" id="id3">
<h4>블루프린트의 개념<a class="headerlink" href="#id3" title="제목 주소">¶</a></h4>
<p>블루프린트의 기본 개념은 어플리케이션에 블루프린트이 등록될 때 실행할 동작을
기록한다는 것이다.  플라스크는 요청을 보내고 하나의 끝점에서 다른 곳으로
URL을 생성할 때 뷰 함수와 블루프린트의 연관을 맺는다.</p>
</div>
<div class="section" id="id4">
<h4>첫번째 블루프린트<a class="headerlink" href="#id4" title="제목 주소">¶</a></h4>
<p>아래는 가장 기본적인 블루프린트의 모습이다.  이 경우에 우리는 정적 템플릿을
간단하게 그려주는 블루프린트를 구현하기를 원할 것이다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Blueprint</span><span class="p">,</span> <span class="n">render_template</span><span class="p">,</span> <span class="n">abort</span>
<span class="kn">from</span> <span class="nn">jinja2</span> <span class="kn">import</span> <span class="n">TemplateNotFound</span>

<span class="n">simple_page</span> <span class="o">=</span> <span class="n">Blueprint</span><span class="p">(</span><span class="s">&#39;simple_page&#39;</span><span class="p">,</span> <span class="n">__name__</span><span class="p">,</span>
                        <span class="n">template_folder</span><span class="o">=</span><span class="s">&#39;templates&#39;</span><span class="p">)</span>

<span class="nd">@simple_page.route</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">,</span> <span class="n">defaults</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;page&#39;</span><span class="p">:</span> <span class="s">&#39;index&#39;</span><span class="p">})</span>
<span class="nd">@simple_page.route</span><span class="p">(</span><span class="s">&#39;/&lt;page&gt;&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="n">page</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">&#39;pages/</span><span class="si">%s</span><span class="s">.html&#39;</span> <span class="o">%</span> <span class="n">page</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">TemplateNotFound</span><span class="p">:</span>
        <span class="n">abort</span><span class="p">(</span><span class="mi">404</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">&#64;simple_page.route</span></code> 데코레이터와 함수를 연결할 때 블루프린트는
어플리케이션에 있는 그  함수를 등록하겠다는 의도를 기록할 것이다.
게다가 블루프린트는 <code class="xref py py-class docutils literal"><span class="pre">Blueprint</span></code> 생성자(위의 경우에는 <code class="docutils literal"><span class="pre">simple_page</span></code>)
에 들어가는 그 이름을 가지고 등록된 함수의 끝점 앞에 붙일 것이다.</p>
</div>
<div class="section" id="id5">
<h4>블루프린트 등록하기<a class="headerlink" href="#id5" title="제목 주소">¶</a></h4>
<p>그렇다면 블루프린트를 어떻게 등록할 것 인가? 아래와 같이 등록한다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
<span class="kn">from</span> <span class="nn">yourapplication.simple_page</span> <span class="kn">import</span> <span class="n">simple_page</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">register_blueprint</span><span class="p">(</span><span class="n">simple_page</span><span class="p">)</span>
</pre></div>
</div>
<p>여러분이 어플리케이션에 등록된 규칙을 확인한다면, 여러분은 아래와
같은 것을 찾을 것이다:</p>
<div class="highlight-python"><div class="highlight"><pre>[&lt;Rule &#39;/static/&lt;filename&gt;&#39; (HEAD, OPTIONS, GET) -&gt; static&gt;,
 &lt;Rule &#39;/&lt;page&gt;&#39; (HEAD, OPTIONS, GET) -&gt; simple_page.show&gt;,
 &lt;Rule &#39;/&#39; (HEAD, OPTIONS, GET) -&gt; simple_page.show&gt;]
</pre></div>
</div>
<p>첫 규칙은 명시적으로 어플리케이션에 있는 정적 파일에 대한 것이다.
다른 두 규칙은 <code class="docutils literal"><span class="pre">simple_page</span></code> 블루프린트의 <cite>show</cite> 함수에 대한 것이다.
볼 수 있는 것 처럼, 블루프린트의 이름이 접두어로 붙어있고 점 (<code class="docutils literal"><span class="pre">.</span></code>)
으로 구분되있다.</p>
<p>하지만 블루프린트는 또한 다른 지점으로 마운트 될 수 있도 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">app</span><span class="o">.</span><span class="n">register_blueprint</span><span class="p">(</span><span class="n">simple_page</span><span class="p">,</span> <span class="n">url_prefix</span><span class="o">=</span><span class="s">&#39;/pages&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>그리고 물론 말할 것도 없이, 아래와 같은 규칙이 생성된다:</p>
<div class="highlight-python"><div class="highlight"><pre>[&lt;Rule &#39;/static/&lt;filename&gt;&#39; (HEAD, OPTIONS, GET) -&gt; static&gt;,
 &lt;Rule &#39;/pages/&lt;page&gt;&#39; (HEAD, OPTIONS, GET) -&gt; simple_page.show&gt;,
 &lt;Rule &#39;/pages/&#39; (HEAD, OPTIONS, GET) -&gt; simple_page.show&gt;]
</pre></div>
</div>
<p>무엇보다 모든 블루프린트이 복수로 적용되는 것에 적절한 응답을 주지는 않지만
여러분은 블루프린트를 여러번 등록할 수 있다.  사실 한번 이상 블루프린트를 마운트할
수 있다면 제대로 블루프린트이 동작하느냐는 블루프린트를 어떻게 구현했으냐에 달려있다.</p>
</div>
<div class="section" id="id6">
<h4>블루프린트 리소스<a class="headerlink" href="#id6" title="제목 주소">¶</a></h4>
<p>블루프린트는 리소스 또한 제공할 수 있다.  때때로 여러분은 단지 리소스만을
제공하기 위해 블루프린트를 사용하고 싶을 수도 있다.</p>
<div class="section" id="id7">
<h5>블루프린트 리소스 폴더<a class="headerlink" href="#id7" title="제목 주소">¶</a></h5>
<p>보통 어플리케이션처럼, 블루프린트는 폴더안에 포함되도록 고려된다.  다수의
블루프린트이 같은 폴더에서 제공될 수 있지만, 그런 경우가 될 필요도 없고
보통 권고하지 않는다.</p>
<p>폴더는 보통 <cite>__name__</cite> 인 <code class="xref py py-class docutils literal"><span class="pre">Blueprint</span></code> 에 두번째 인자로 생각된다.
이 인자는 어떤 논리적인 파이썬 모듈이나 패키지가 블루프린트과 상응되는지
알려준다.  그것이 실제 파이썬 패키지를 가리킨다면 그 패키지 (파일 시스템의
폴더인) 는 리소스 폴더다.  그것이 모듈이라면, 모듈이 포함되있는 패키지는
리소스 폴더가 될 것이다.  리소스 폴더가 어떤것인지 보기 위해서는
<code class="xref py py-attr docutils literal"><span class="pre">Blueprint.root_path</span></code> 속성에 접근할 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">simple_page</span><span class="o">.</span><span class="n">root_path</span>
<span class="go">&#39;/Users/username/TestProject/yourapplication&#39;</span>
</pre></div>
</div>
<p>이 폴더에서 소스를 빨리 열기 위해서 여러분은 <code class="xref py py-meth docutils literal"><span class="pre">open_resource()</span></code>
함수를 사용할 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">with</span> <span class="n">simple_page</span><span class="o">.</span><span class="n">open_resource</span><span class="p">(</span><span class="s">&#39;static/style.css&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">code</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="id8">
<h5>정적 파일<a class="headerlink" href="#id8" title="제목 주소">¶</a></h5>
<p>블루프린트는 <cite>static_folder</cite> 키워드 인자를 통해서 파일시스템에 있는 폴더에 경로를
제공하여 정적 파일을 가진 폴더를 노출할 수 있다.  그것은 절대 경로이거나
블루프린트 폴더에 대해 상대 경로일 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">admin</span> <span class="o">=</span> <span class="n">Blueprint</span><span class="p">(</span><span class="s">&#39;admin&#39;</span><span class="p">,</span> <span class="n">__name__</span><span class="p">,</span> <span class="n">static_folder</span><span class="o">=</span><span class="s">&#39;static&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>기본값으로 경로의 가장 오른쪽 부분이 웹에 노출되는 곳이다.  폴더는 여기서
<code class="docutils literal"><span class="pre">static</span></code> 이라고 불리기 때문에 블루프린트 위치 + <code class="docutils literal"><span class="pre">static</span></code> 으로 될 것이다.
블루프린트이 <code class="docutils literal"><span class="pre">/admin</span></code> 으로 등록되있다고 하면 정적 폴더는 <code class="docutils literal"><span class="pre">/admin/static</span></code>
으로 될 것이다.</p>
<p>끝점은 <cite>bluepirnt_name.static</cite> 으로 되고 여러분은 어플리케이션의 정적 폴더에
한 것 처럼 그 끝점에 URL을 생성할 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">url_for</span><span class="p">(</span><span class="s">&#39;admin.static&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s">&#39;style.css&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id9">
<h5>템플릿<a class="headerlink" href="#id9" title="제목 주소">¶</a></h5>
<p>여러분이 블루프린트이 템플릿을 노출하게 하고 싶다면 <code class="xref py py-class docutils literal"><span class="pre">Blueprint</span></code> 생성자에
<cite>template_folder</cite> 인자를 제공하여 노출할 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">admin</span> <span class="o">=</span> <span class="n">Blueprint</span><span class="p">(</span><span class="s">&#39;admin&#39;</span><span class="p">,</span> <span class="n">__name__</span><span class="p">,</span> <span class="n">template_folder</span><span class="o">=</span><span class="s">&#39;templates&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>정적 파일에 관해서, 그 경로는 절대 경로일 수 있고 블루프린트 리소스 폴더 대비
상대적일 수 있다.  템플릿 폴더는 템플릿 검색경로에 추가되지만 실제
어플리케이션의 템플릿 폴더보다 낮은 우선순위를 갖는다.  그런 방식으로
여러분은 블루프린트이 실제 어플리케이션에서 제공하는 템플릿을 쉽게 오버라이드
할 수 있다.</p>
<p>그러므로 <code class="docutils literal"><span class="pre">yourapplication/admin</span></code> 폴더에 블루프린트이 있고 <code class="docutils literal"><span class="pre">'admin/index.html'</span></code>
를 뿌려주고 <cite>template_folder</cite> 로 <code class="docutils literal"><span class="pre">templates</span></code> 를 제공한다면 여러분은
<code class="docutils literal"><span class="pre">yourapplication/admin/templates/admin/index.html</span></code> 같이 파일을 생성해야
할 것이다.</p>
</div>
</div>
<div class="section" id="url">
<h4>URL 만들기<a class="headerlink" href="#url" title="제목 주소">¶</a></h4>
<p>하나의 페이지에서 다른 페이지로 링크하고 싶다면 보통 블루프린트명을 접두어로
하고 점 (<code class="docutils literal"><span class="pre">.</span></code>) 으로 URL 끝점을 구분하는 것처럼 <code class="xref py py-func docutils literal"><span class="pre">url_for()</span></code> 함수를
사용할 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">url_for</span><span class="p">(</span><span class="s">&#39;admin.index&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>추가적으로 여러분이 블루프린트의 뷰 함수에 있거나 뿌려진 템플릿에 있고
같은 블루프린트의 다른 끝점으로 링크를 걸고 싶다면, 점을 접두어로 하여
끝점에 붙여서 상대적인 리디렉션을 사용할 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">url_for</span><span class="p">(</span><span class="s">&#39;.index&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>예를 들면 현재 요청을 어떤 다른 블루프린트의 끝점으로 보내는 경우에 <code class="docutils literal"><span class="pre">admin.index</span></code>
로 링크할 것이다.</p>
</div>
</div>
<span id="document-extensions"></span><div class="section" id="flask">
<h3>Flask 확장기능<a class="headerlink" href="#flask" title="제목 주소">¶</a></h3>
<p>Flask 확장기능(extensions)은 서로 다른 다양한 방법으로 Flask 의 기능을 추가 시킬 수 있게 해준다.
예를 들어 확장기능을 이용하여 데이터베이스 그리고 다른 일반적인 태스크들을 지원할 수 있다.</p>
<div class="section" id="id1">
<h4>확장기능 찾아내기<a class="headerlink" href="#id1" title="제목 주소">¶</a></h4>
<p>플라스크 확장기능들의 목록은 <a class="reference external" href="http://flask.pocoo.org/extensions/">Flask Extension Registry</a> 에서 살펴볼 수 있다.
그리고 <code class="docutils literal"><span class="pre">easy_install</span></code> 혹은 <code class="docutils literal"><span class="pre">pip</span></code> 를 통해 다운로드 할 수 있다.
만약 여러분이 Flask 확장기능을 추가하면,  <code class="docutils literal"><span class="pre">requirements.rst</span></code> 혹은 <code class="docutils literal"><span class="pre">setup.py</span></code> 에 명시된
파일 의존관계로부터 간단한 명령어의 실행이나 응용 프로그램 설치와 함께 설치될 수 있다.</p>
</div>
<div class="section" id="id2">
<h4>확장기능 사용하기<a class="headerlink" href="#id2" title="제목 주소">¶</a></h4>
<p>확장기능은 일반적으로 해당 기능을 사용하는 방법을 보여주는 문서를 가지고 있다.
이 확장기능의 작동 방식에 대한 일반적인 규칙은 없지만, 확장기능은 공통된 위치에서
가져오게 된다. 만약 여러분이 <code class="docutils literal"><span class="pre">Flask-Foo</span></code> 혹은 <code class="docutils literal"><span class="pre">Foo-Flask</span></code> 라는 확장기능을
호출 하였다면, 그것은 항상 <code class="docutils literal"><span class="pre">flask.ext.foo</span></code> 을 통해서 가져오게 될 것이다</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask.ext</span> <span class="kn">import</span> <span class="n">foo</span>
</pre></div>
</div>
</div>
<div class="section" id="flask-0-8">
<h4>Flask 0.8 이전버전의 경우<a class="headerlink" href="#flask-0-8" title="제목 주소">¶</a></h4>
<p>만약 여러분의 Flask가 0.7 버전 혹은 그 이전의 것이라면 <code class="xref py py-data docutils literal"><span class="pre">flask.ext</span></code> 패키지가
존재하지 않는다. 대신에 여러분은 <code class="docutils literal"><span class="pre">flaskext.foo</span></code> 혹은 <code class="docutils literal"><span class="pre">flask_foo</span></code> 등의 형식으로
확장기능이 배포되는 방식에 따라 불러와야만 한다. 만약 여러분이 여전히 Flask 0.7 혹은 이전
이전 버전을 지원하는 어플리케이션을 개발하기 원한다면, 여러분은 여전히  <code class="xref py py-data docutils literal"><span class="pre">flask.ext</span></code>
패키지를 불러와야만 한다. 우리는 Flask 의 이전 버전의 Flask를 위한 호환성 모듈을 제공하고 있다.
여러분은 github을 통해서 : <a class="reference external" href="https://github.com/mitsuhiko/flask/raw/master/scripts/flaskext_compat.py">flaskext_compat.py</a> 를 다운로드 받을 수 있다.</p>
<p>그리고 여기에서 호환성 모듈의 사용 방법을 볼 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">flaskext_compat</span>
<span class="n">flaskext_compat</span><span class="o">.</span><span class="n">activate</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">flask.ext</span> <span class="kn">import</span> <span class="n">foo</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">flaskext_compat</span></code> 모듈이 활성화 되면  <code class="xref py py-data docutils literal"><span class="pre">flask.ext</span></code> 가 존재하게 되고
여러분은 이것을 통해 여기서부터 불러오기를 시작 할 수 있다.</p>
</div>
</div>
<span id="document-shell"></span><div class="section" id="shell">
<span id="id1"></span><h3>쉘에서 작업하기<a class="headerlink" href="#shell" title="제목 주소">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">버전 0.3에 추가.</span></p>
</div>
<p>많은 사람들이 파이썬을 좋아하는 이유 중 한가지는 바로 대화식 쉘이다.
그것은 기본적으로 여러분이 실시간으로 파이썬 명령을 싱행하고 결과를 실시간으로
즉시 받아 볼 수 있다. Flask 자체는 대화식 쉘과 함께 제공되지 않는다. 왜냐하면
Flask는 특정한 선행 작업이 필요하지 않고, 단지 여러분의 어플리케이션에서 불러오기만 하면
시작할 수 있기 때문이다.</p>
<p>하지만, 쉘에서 좀 더 많은 즐거운 경험을 얻을 수 있는 몇 가지 유용한 헬퍼들이 있다.
대화식 콘솔 세션에서의 가장 중요한 문제는 여러분이 직접 브라우저에서 처럼 <a class="reference internal" href="index.html#flask.g" title="flask.g"><code class="xref py py-data docutils literal"><span class="pre">g</span></code></a>, <a class="reference internal" href="index.html#flask.request" title="flask.request"><code class="xref py py-data docutils literal"><span class="pre">request</span></code></a> 를 발생 시킬 수 없고,   그 밖의 다른 것들도 가능하지 않다. 하지만 테스트 해야 할 코드가 그것들에게 종속관계에 있다면 여러분은 어떻게 할 것인가?</p>
<p>이 장에는 몇가지 도움이 되는 함수가 있다.
이 함수들은 대화식 쉘에서의 사용뿐만 아니라, 단위테스트와 같은 그리고 요청 컨텍스트를
위조해야 하는 상황에서 또한 유용하다는 것을 염두해 두자.</p>
<p>일반적으로 여러분이 <a class="reference internal" href="index.html#request-context"><span>요청 컨텍스트</span></a> 를 먼저 읽기를 권장한다.</p>
<div class="section" id="id2">
<h4>요청 컨텍스트 생성하기<a class="headerlink" href="#id2" title="제목 주소">¶</a></h4>
<p>쉘에서 적절한 요청 컨텍스트를 생성하는 가장 쉬운 방법은 <a class="reference internal" href="index.html#flask.ctx.RequestContext" title="flask.ctx.RequestContext"><code class="xref py py-class docutils literal"><span class="pre">RequestContext</span></code></a>: 를 우리에게 생성해주는 <a class="reference internal" href="index.html#flask.Flask.test_request_context" title="flask.Flask.test_request_context"><code class="xref py py-attr docutils literal"><span class="pre">test_request_context</span></code></a> 메소드를 사용하는 것이다.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">ctx</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">test_request_context</span><span class="p">()</span>
</pre></div>
</div>
<p>일반적으로 여러분은 <cite>with</cite> 구문을 사용하여 이 요청 객체를 활성화 하겠지만,
쉘에서는 <a class="reference internal" href="index.html#flask.ctx.RequestContext.push" title="flask.ctx.RequestContext.push"><code class="xref py py-meth docutils literal"><span class="pre">push()</span></code></a> 와 <a class="reference internal" href="index.html#flask.ctx.RequestContext.pop" title="flask.ctx.RequestContext.pop"><code class="xref py py-meth docutils literal"><span class="pre">pop()</span></code></a> 를
직접 다루는 방법이 더 쉽다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">ctx</span><span class="o">.</span><span class="n">push</span><span class="p">()</span>
</pre></div>
</div>
<p>여러분이 <cite>pop</cite> 을 호출하는 그 시점까지 request 객체를 사용하여 작업 할 수 있다.
:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">ctx</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="firing">
<h4>요청하기 전/후에 발사하기(Firing)<a class="headerlink" href="#firing" title="제목 주소">¶</a></h4>
<p>단지 요청 컨텍스트를 생성만 하면, 일반적으로 요청전에 실행되는 코드를 실행할 필요가 없다.
이것은 만약 여러분이 before-request 콜백에서 데이터베이스 연결을 하거나 , 혹은 현재 사용자가 <a class="reference internal" href="index.html#flask.g" title="flask.g"><code class="xref py py-data docutils literal"><span class="pre">g</span></code></a> 객체에 저장하지 않을 경우에 발생할 수 있다..</p>
<p>그러나 이것은 단지 <a class="reference internal" href="index.html#flask.Flask.preprocess_request" title="flask.Flask.preprocess_request"><code class="xref py py-meth docutils literal"><span class="pre">preprocess_request()</span></code></a> 를 호출하여 쉽게 수행 할 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">ctx</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">test_request_context</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ctx</span><span class="o">.</span><span class="n">push</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span><span class="o">.</span><span class="n">preprocess_request</span><span class="p">()</span>
</pre></div>
</div>
<p>다음을 염두 해 두어야 한다.
이 경우에 <a class="reference internal" href="index.html#flask.Flask.preprocess_request" title="flask.Flask.preprocess_request"><code class="xref py py-meth docutils literal"><span class="pre">preprocess_request()</span></code></a> 함수는 응답(response) 객체를 리턴할 것이고, 이것은 그냥 무시해도 된다.</p>
<p>요청을 종료시키기 위해서, 여러분은 사후 요청 함수 ( <a class="reference internal" href="index.html#flask.Flask.process_response" title="flask.Flask.process_response"><code class="xref py py-meth docutils literal"><span class="pre">process_response()</span></code></a> 에 의해 트리거되는)가 응답 객체에서 사용 전에 약간의 트릭을 사용해야 한다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">app</span><span class="o">.</span><span class="n">process_response</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">response_class</span><span class="p">())</span>
<span class="go">&lt;Response 0 bytes [200 OK]&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ctx</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</pre></div>
</div>
<p>컨텍스트가 열리게 되면 <a class="reference internal" href="index.html#flask.Flask.teardown_request" title="flask.Flask.teardown_request"><code class="xref py py-meth docutils literal"><span class="pre">teardown_request()</span></code></a> 로 등록된 함수가
자동으로 호출된다. 그래서 이것은 자동으로 요청 컨텍스트 (데이터 베이스 연결과 같은)에
필요한 자원을 해제 할 수 있는 완벽한 장소이다..</p>
</div>
<div class="section" id="id3">
<h4>쉘 경험을 더욱 향상시키기<a class="headerlink" href="#id3" title="제목 주소">¶</a></h4>
<p>여러분이 만약 쉘에서의 실험적인 아이디어를 실험하기 좋아한다면,
본인 스스로 여러분의 대화형 세션으로 불러올 모듈을 만들 수 있다.
여기에 또한 여러분은 데이터베이스를 초기화 하거나 테이블을 삭제하는등의 좀 더 유용한 도우미 메소드등을 정의 할 수 있다.</p>
<p>단지 모듈에 이렇게 삽입하면 된다 (<cite>shelltools</cite> 처럼 불러온다.) :</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">shelltools</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
</div>
<span id="document-patterns/index"></span><div class="section" id="flask">
<span id="patterns"></span><h3>Flask를 위한 패턴들<a class="headerlink" href="#flask" title="제목 주소">¶</a></h3>
<p>어떤 것들은 충분히 일반적이어서 여러분이 대부분의 웹 어플리케이션에서 찾을 가능성이 높다. 예를 들면 많은 어플리케이션들이 관계형 데이타베이스와 사용자 인증을 사용한다. 그 경우에, 그 어플리케이션들은 요청 초반에 데이타베이스 연결을 열고 사용자 테이블에서 현재 로그인된 사용자의 정보를 얻을 것이다. 요청의 마지막에는 그 데이타베이스 연결을 다시 닫는다.</p>
<p><a class="reference external" href="http://flask.pocoo.org/snippets/">플라스크 스니핏 묶음(Flask Snippet Archives)</a> 에 많은 사용자들이 기여한 스니핏과 패턴들이 있다.</p>
<div class="toctree-wrapper compound">
<span id="document-patterns/packages"></span><div class="section" id="larger-applications">
<span id="id1"></span><h4>더 큰 어플케이션들<a class="headerlink" href="#larger-applications" title="제목 주소">¶</a></h4>
<p>더 큰 어플리케이션들의 경우, 모듈 대신 패키지를 사용하는게 좋다.패키지의 사용은 꽤 간단하다.작은 어플리케이션은 아래와 같은 구조로 되어있다고 생각해보자:</p>
<div class="highlight-python"><div class="highlight"><pre>/yourapplication
    /yourapplication.py
    /static
        /style.css
    /templates
        layout.html
        index.html
        login.html
        ...
</pre></div>
</div>
<div class="section" id="id2">
<h5>간단한 패키지<a class="headerlink" href="#id2" title="제목 주소">¶</a></h5>
<p>작은 어플리케이션을 큰 어플리케이션 구조로 변환하기 위해, 단지 기존에 존재하던 폴더에
새 폴더 <cite>yourapplication</cite> 를 생성하고 그 폴더로 모두 옯긴다.
그리고 나서, <cite>yourapplication.py</cite> 를 <cite>__init__.py</cite> 으로 이름을 바꾼다.
(먼저 모든 <cite>.pyc</cite> 을 삭제해야지, 그렇지 않으면 모든 파일이 깨질 가능성이 크다.)</p>
<p>여러분은 아래와 같은 구조를 최종적으로 보게 될 것이다:</p>
<div class="highlight-python"><div class="highlight"><pre>/yourapplication
    /yourapplication
        /__init__.py
        /static
            /style.css
        /templates
            layout.html
            index.html
            login.html
            ...
</pre></div>
</div>
<p>하지만 이 상황에서 여러분은 어떻게 어플리케이션을 실행하는가?
<code class="docutils literal"><span class="pre">python</span> <span class="pre">yourapplication/__init__.py</span></code> 와 같은 순진한 명령은 실행되지 않을 것이다.</p>
<p>파이썬은 패키지에 있는 모듈이 스타트업 파일이 되는 것을 원하지 않는다고 해보자.
하지만, 그것은 큰 문제는 아니고, 아래와 같이 단지 <cite>runserver.py</cite> 라는 새 파일을
루트 폴더 바로 아래 있는 <cite>yourapplication</cite> 폴더 안에 추가하기만 하면 된다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">yourapplication</span> <span class="kn">import</span> <span class="n">app</span>
<span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>이렇게해서 우리는 무엇을 얻었는가?
이제 우리는 이 어플리케이션을 복개의 모듈들로 재구조화할 수 있다.
여러분이 기억해야할 유일한 것은 다음의 체크리스트이다:</p>
<ol class="arabic simple">
<li><cite>플라스크</cite> 어플리케이션 객체 생성은 <cite>__init__.py</cite> 파일에서 해야한다.
그런 방식으로 개별 모듈은 안전하게 포함되고 <cite>__name__</cite> 변수는 알맞은 패키지로 해석될 것이다.</li>
<li>모든 뷰 함수들은(함수의 선언부 위에 <a class="reference internal" href="index.html#flask.Flask.route" title="flask.Flask.route"><code class="xref py py-meth docutils literal"><span class="pre">route()</span></code></a> 데코레이터(decorator)를 가진
함수)는 <cite>__init__.py</cite> 파일에 임포트되어야 하는데, 객체가 아닌 함수가 있는 모듈을
임포트해야한다. <strong>어플리케이션 객체를 생성한 후에</strong> 뷰 모듈을 임포트해라.</li>
</ol>
<p>여기에 <cite>__init__.py</cite> 파일의 예제가 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">yourapplication.views</span>
</pre></div>
</div>
<p>그리고 아래가 <cite>views.py</cite> 파일의 예제일 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">yourapplication</span> <span class="kn">import</span> <span class="n">app</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">return</span> <span class="s">&#39;Hello World!&#39;</span>
</pre></div>
</div>
<p>여러분은 최종적으로 아래와 같은 구조를 얻을 것이다:</p>
<div class="highlight-python"><div class="highlight"><pre>/yourapplication
    /runserver.py
    /yourapplication
        /__init__.py
        /views.py
        /static
            /style.css
        /templates
            layout.html
            index.html
            login.html
            ...
</pre></div>
</div>
<div class="admonition-circular-imports admonition">
<p class="first admonition-title">순환 임포트(Circular Imports)</p>
<p>모든 파이썬 프로그래머는 순환 임포트를 싫어하지만, 우리는 일부 그것을 더했다:
순환 임포트는(두 모듈이 서로 의존 관계가 있는 경우이다. 위 경우 <cite>views.py</cite> 는 <cite>__init__.py</cite> 에 의존한다).
Be advised that this is a bad idea in general but here it is actually fine.
이런 방식은 일반적으로 나쁘지만, 이 경우는 실제로 괜찮다고 생각해도 된다.
왜냐하면 <a href="#id3"><span class="problematic" id="id4">`</span></a>__init__.py`에 있는 뷰들을 실제로 사용하지 않고 단지 모듈들이 임포트되었는지
보장하고 그 파일의 제일 하단에서 임포트하기 때문이다.</p>
<p class="last">이런 접근법에도 일부 문제가 남아있지만 여러분이 데코레이터(decoroator)를 사용하고 싶다면
문제를 피할 방도는 없다. 그것을 다루는 방법에 대한 몇 가지 영감을 위해 <a class="reference internal" href="index.html#becomingbig"><span>크게 만들기</span></a> 단락을 확인해라</p>
</div>
</div>
<div class="section" id="blueprints">
<span id="working-with-modules"></span><h5>청사진(Blueprints)으로 작업하기<a class="headerlink" href="#blueprints" title="제목 주소">¶</a></h5>
<p>여러분이 더 큰 규모의 어플리케이션을 갖고 있다면, 그것들을 청사진으로 구현된 더 작은 그룹으로
나누는 것을 추천한다. 이 주제에 대한 가벼운 소개는 이 문서의 <a class="reference internal" href="index.html#blueprints"><span>블루프린트를 가진 모듈화된 어플리케이션</span></a> 장을 참고해라.</p>
</div>
</div>
<span id="document-patterns/appfactories"></span><div class="section" id="app-factories">
<span id="id1"></span><h4>어플리케이션 팩토리<a class="headerlink" href="#app-factories" title="제목 주소">¶</a></h4>
<p>여러분이 어플리케이션에 이미 패키지들과 청사진들을 사용한다면(<a class="reference internal" href="index.html#blueprints"><span>블루프린트를 가진 모듈화된 어플리케이션</span></a>)
그 경험들을 좀 더 개선할 몇 가지 정말 좋은 방법들이 있다.
일반적인 패턴은 청사진을 임포트할 때 어플리케이션 객체를 생성하는 것이다.
하지만 여러분이 이 객체의 생성을 함수로 옮긴다면,
나중에 이 객체에 대한 복수 개의 인스턴스를 생성할 수 있다.</p>
<p>그래서 여러분은 왜 이렇게 하고 싶은 것인가?</p>
<ol class="arabic simple">
<li>테스팅.  여러분은 모든 케이스를 테스트하기 위해 여러 설정을 가진 어플리케이션 인스턴스들을 가질수 있다.</li>
<li>복수 개의 인스턴스.  여러분이 같은 어플리케이션의 여러 다른 버전을 실행하고 싶다고 가정하자.
물론 여러분은 여러분은 웹서버에 여러 다른 설정을 가진 복수 개의 인스턴스를 가질 수도 있지만,
여러분이 팩토리를 사용한다면, 여러분은 간편하게 같은 어플리케이션 프로세스에서 동작하는
복수 개의 인스턴스를 가질 수 있다.</li>
</ol>
<p>그렇다면 어떻게 여러분은 실제로 그것을 구현할 것인가?</p>
<div class="section" id="id2">
<h5>기본 팩토리<a class="headerlink" href="#id2" title="제목 주소">¶</a></h5>
<p>이 방식은 함수 안에 어플리케이션을 설정하는 방법이다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">create_app</span><span class="p">(</span><span class="n">config_filename</span><span class="p">):</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">from_pyfile</span><span class="p">(</span><span class="n">config_filename</span><span class="p">)</span>

    <span class="kn">from</span> <span class="nn">yourapplication.views.admin</span> <span class="kn">import</span> <span class="n">admin</span>
    <span class="kn">from</span> <span class="nn">yourapplication.views.frontend</span> <span class="kn">import</span> <span class="n">frontend</span>
    <span class="n">app</span><span class="o">.</span><span class="n">register_blueprint</span><span class="p">(</span><span class="n">admin</span><span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">register_blueprint</span><span class="p">(</span><span class="n">frontend</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">app</span>
</pre></div>
</div>
<p>이 방식의 단점은 여러분은 임포트하는 시점에 청사진 안에 있는 어플리케이션 객체를 사용할 수 없다.
그러나 여러분은 요청 안에서 어플리케이션 객체를 사용할 수 있다.
어떻게 여러분이 설정을 갖고 있는 어플리케이션에 접근하는가? <a class="reference internal" href="index.html#flask.current_app" title="flask.current_app"><code class="xref py py-data docutils literal"><span class="pre">current_app</span></code></a> 을 사용하면 된다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">current_app</span><span class="p">,</span> <span class="n">Blueprint</span><span class="p">,</span> <span class="n">render_template</span>
<span class="n">admin</span> <span class="o">=</span> <span class="n">Blueprint</span><span class="p">(</span><span class="s">&#39;admin&#39;</span><span class="p">,</span> <span class="n">__name__</span><span class="p">,</span> <span class="n">url_prefix</span><span class="o">=</span><span class="s">&#39;/admin&#39;</span><span class="p">)</span>

<span class="nd">@admin.route</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="n">current_app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&#39;INDEX_TEMPLATE&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>여기에서 우리는 설정에 있는 템플릿 이름을 찾아낸다.</p>
</div>
<div class="section" id="application">
<h5>어플리케이션(Application) 사용하기<a class="headerlink" href="#application" title="제목 주소">¶</a></h5>
<p>그렇다면 그런 어플리케이션을 사용하기 위해서 어려분은 먼저 어플리케이션을 생성해야한다.
아래는 그런 어플리케이션을 실행하는 <cite>run.py</cite> 파일이다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">yourapplication</span> <span class="kn">import</span> <span class="n">create_app</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">create_app</span><span class="p">(</span><span class="s">&#39;/path/to/config.cfg&#39;</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h5>팩토리 개선<a class="headerlink" href="#id3" title="제목 주소">¶</a></h5>
<p>위에서 팩토리 함수는 지금까지는 그다지 똑똑하지 않았지만, 여러분은 개선할 수 있다.
다음 변경들은 간단하고 가능성이 있다:</p>
<ol class="arabic simple">
<li>여러분이 파일시스템에 설정 파일을 만들지 않도록 유닛테스트를 위해 설정값을 전달하도록 만들어라.</li>
<li>여러분이 어플리케이션의 속성들을 변경할 곳을 갖기 위해 어플리케이션이 셋업될 때 청사진에서 함수를 호출해라.
(요청 핸들러의 앞/뒤로 가로채는 것 처럼)</li>
<li>필요하다면 어플리케이션이 생성될 때, WSGI 미들웨어에 추가해라.</li>
</ol>
</div>
</div>
<span id="document-patterns/appdispatch"></span><div class="section" id="app-dispatch">
<span id="id1"></span><h4>어플리케이션 디스패칭<a class="headerlink" href="#app-dispatch" title="제목 주소">¶</a></h4>
<p>어플리케이션 디스패칭은 WSGI 레벨에서 복수의 플라스크 어플리케이션들을 결합하는 과정이다.
여러분은 플라스크 어플리케이션들을 더 큰 것으로 만들수 있을뿐 아니라
어떤 WSGI 어플리케이션으로도 결합할 수 있다.
이것은 여러분이 원하다면 심지어 같은 인터프리터에서 장고(Django) 와 플라스크 어플리케이션을
바로 옆에서 실행할 수 있게해준다. 이 유용함 어플리케이션들이 내부적으로 동작하는 방식에 의존한다.</p>
<p><a class="reference internal" href="index.html#larger-applications"><span>module approach</span></a> 과 근본적인 차이점은 이 경우에 여러분은
서로 완전히 분리된 동일하거나 다른 플라스크 어플리케이션들을 실행한다는 것이다.
그것들은 다른 설정에서 실행되고 WSGI 레벨에서 디스패치된다.</p>
<div class="section" id="id2">
<h5>이 문서를 가지고 작업하기<a class="headerlink" href="#id2" title="제목 주소">¶</a></h5>
<p>아래의 각 기법들과 예제들은 어떤 WSGI 서버에서 실행가능한 <code class="docutils literal"><span class="pre">application</span></code> 객체이다.
운영 환경의 경우, <a class="reference internal" href="index.html#deployment"><span>배포 옵션</span></a> 를 살펴봐라.
개발 환경의 경우, 베르크쭉(Werkzeug)은 <a class="reference external" href="http://werkzeug.pocoo.org/docs/serving/#werkzeug.serving.run_simple" title="(in Werkzeug v0.11-dev)"><code class="xref py py-func docutils literal"><span class="pre">werkzeug.serving.run_simple()</span></code></a> 에 개발용 빌트인 서버를 제공한다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">werkzeug.serving</span> <span class="kn">import</span> <span class="n">run_simple</span>
<span class="n">run_simple</span><span class="p">(</span><span class="s">&#39;localhost&#39;</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="n">application</span><span class="p">,</span> <span class="n">use_reloader</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p><a class="reference external" href="http://werkzeug.pocoo.org/docs/serving/#werkzeug.serving.run_simple" title="(in Werkzeug v0.11-dev)"><code class="xref py py-func docutils literal"><span class="pre">run_simple</span></code></a> 은 운영환경에서 사용을 의도하지 않는다.
운영환경에 맞는 기능이 갖춰진 서버(<a class="reference internal" href="index.html#deployment"><span>full-blown WSGI server</span></a>)를 사용해라.</p>
<p>대화형(interactive) 디버거를 사용하기 위해서, 디버깅이 어플리케이션과
심플 서버(simple server) 양쪽에서 활성화되어 있어야한다.
아래는 디버깅과  <a class="reference external" href="http://werkzeug.pocoo.org/docs/serving/#werkzeug.serving.run_simple" title="(in Werkzeug v0.11-dev)"><code class="xref py py-func docutils literal"><span class="pre">run_simple</span></code></a> 를 사용한
&#8220;hellow world&#8221; 예제이다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
<span class="kn">from</span> <span class="nn">werkzeug.serving</span> <span class="kn">import</span> <span class="n">run_simple</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="bp">True</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">hello_world</span><span class="p">():</span>
    <span class="k">return</span> <span class="s">&#39;Hello World!&#39;</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">run_simple</span><span class="p">(</span><span class="s">&#39;localhost&#39;</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="n">app</span><span class="p">,</span>
               <span class="n">use_reloader</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">use_debugger</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">use_evalex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h5>어플리케이션 결합하기<a class="headerlink" href="#id3" title="제목 주소">¶</a></h5>
<p>여러분이 완전하게 분리된 어플리케이션들을 갖고 있고 그것들이 동일한 파이썬 프로세스 위의
바로 옆에서 동작하기를 원한다면, <a class="reference external" href="http://werkzeug.pocoo.org/docs/middlewares/#werkzeug.wsgi.DispatcherMiddleware" title="(in Werkzeug v0.11-dev)"><code class="xref py py-class docutils literal"><span class="pre">werkzeug.wsgi.DispatcherMiddleware</span></code></a> 를 이용할 수 있다.
그 방식은 각 플라스크 어플리케이션이 유효한 WSGI 어플리케이션이고 디스패처 미들웨어에 의해
URL 접두어(prefix)에 기반해서 디스패치되는 하나의 더 커다란 어플리케이션으로 결합되는 것이다.</p>
<p>예를 들면, 여러분의 주(main) 어플리케이션을 &#8216;/&#8217;에 두고 백엔드 인터페이스는 <a href="#id4"><span class="problematic" id="id5">`</span></a>/backend`에 둘 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">werkzeug.wsgi</span> <span class="kn">import</span> <span class="n">DispatcherMiddleware</span>
<span class="kn">from</span> <span class="nn">frontend_app</span> <span class="kn">import</span> <span class="n">application</span> <span class="k">as</span> <span class="n">frontend</span>
<span class="kn">from</span> <span class="nn">backend_app</span> <span class="kn">import</span> <span class="n">application</span> <span class="k">as</span> <span class="n">backend</span>

<span class="n">application</span> <span class="o">=</span> <span class="n">DispatcherMiddleware</span><span class="p">(</span><span class="n">frontend</span><span class="p">,</span> <span class="p">{</span>
    <span class="s">&#39;/backend&#39;</span><span class="p">:</span>     <span class="n">backend</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="subdomain">
<h5>하위도메인(subdomain)으로 디스패치하기<a class="headerlink" href="#subdomain" title="제목 주소">¶</a></h5>
<p>여러분은 때때로 다른 구성으로 같은 어플리케이션에 대한 복수 개의 인스턴스를
사용하고 싶을 때가 있을 것이다. 그 어플리케이션이 어떤 함수 안에서 생성됐고
여러분이 그 어플리케이션을 인스턴스화 하기위해 그 함수를 호출할 수 있다고 가정하면,
그런 방식은 굉장히 구현하기 쉽다. 함수로 새 인스턴스를 생성을 지원하도록 어플리케이션을
개발하기 위해서는 <a class="reference internal" href="index.html#app-factories"><span>어플리케이션 팩토리</span></a> 패턴을 살펴보도록 해라.</p>
<p>매우 일반적인 예제는 하위도메인 별로 어플리케이션을 생성하는 것이다.
예를 들면, 여러분은 어플리케이션의 모든 하위도메인에 대한 모든 요청을
디스패치 하도록 웹서버를 구성하고 사용자 지정 인스턴스를 생성하기 위해
하위도메인 정보를 사용한다. 일단 여러분의 웹서버가 모든 하위도메인의 요청을
받아들이도록(listen) 설정하면, 여러분은 동적인 어플리케이션 생성을 할 수있는
매우 간단한 WSGI 어플리케이션을 사용할 수 있다.</p>
<p>이 관점에서 추상화의 최적의 레벨은 WSGI 계층이다. 여러분은 들어오는 요청을
보고 그것을 여러분의 플라스크 어플리케이션으로 위임하는 여러분 자신만의
WSGI 어플리케이션을 작성할 수 있다. 그 어플리케이션이 아직 존재하지 않는다면,
그것은 동적으로 생성되고 기억된다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">threading</span> <span class="kn">import</span> <span class="n">Lock</span>

<span class="k">class</span> <span class="nc">SubdomainDispatcher</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">domain</span><span class="p">,</span> <span class="n">create_app</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">domain</span> <span class="o">=</span> <span class="n">domain</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_app</span> <span class="o">=</span> <span class="n">create_app</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock</span> <span class="o">=</span> <span class="n">Lock</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">instances</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">get_application</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">host</span><span class="p">):</span>
        <span class="n">host</span> <span class="o">=</span> <span class="n">host</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;:&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">assert</span> <span class="n">host</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">domain</span><span class="p">),</span> <span class="s">&#39;Configuration error&#39;</span>
        <span class="n">subdomain</span> <span class="o">=</span> <span class="n">host</span><span class="p">[:</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">domain</span><span class="p">)]</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">)</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
            <span class="n">app</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">instances</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">subdomain</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">app</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">app</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_app</span><span class="p">(</span><span class="n">subdomain</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">instances</span><span class="p">[</span><span class="n">subdomain</span><span class="p">]</span> <span class="o">=</span> <span class="n">app</span>
            <span class="k">return</span> <span class="n">app</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">environ</span><span class="p">,</span> <span class="n">start_response</span><span class="p">):</span>
        <span class="n">app</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_application</span><span class="p">(</span><span class="n">environ</span><span class="p">[</span><span class="s">&#39;HTTP_HOST&#39;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">app</span><span class="p">(</span><span class="n">environ</span><span class="p">,</span> <span class="n">start_response</span><span class="p">)</span>
</pre></div>
</div>
<p>그리고나서 이 디스패쳐는 아래와 같이 사용될 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">myapplication</span> <span class="kn">import</span> <span class="n">create_app</span><span class="p">,</span> <span class="n">get_user_for_subdomain</span>
<span class="kn">from</span> <span class="nn">werkzeug.exceptions</span> <span class="kn">import</span> <span class="n">NotFound</span>

<span class="k">def</span> <span class="nf">make_app</span><span class="p">(</span><span class="n">subdomain</span><span class="p">):</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">get_user_for_subdomain</span><span class="p">(</span><span class="n">subdomain</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">user</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="c"># if there is no user for that subdomain we still have</span>
        <span class="c"># to return a WSGI application that handles that request.</span>
        <span class="c"># We can then just return the NotFound() exception as</span>
        <span class="c"># application which will render a default 404 page.</span>
        <span class="c"># You might also redirect the user to the main page then</span>
        <span class="k">return</span> <span class="n">NotFound</span><span class="p">()</span>

    <span class="c"># otherwise create the application for the specific user</span>
    <span class="k">return</span> <span class="n">create_app</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>

<span class="n">application</span> <span class="o">=</span> <span class="n">SubdomainDispatcher</span><span class="p">(</span><span class="s">&#39;example.com&#39;</span><span class="p">,</span> <span class="n">make_app</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id6">
<h5>경로로 디스패치하기<a class="headerlink" href="#id6" title="제목 주소">¶</a></h5>
<p>URL 경로로 디스패치하는 것도 하위도메인과 굉장히 유사하다. 하위도메인 헤더를
확인하기 위해 <cite>Host</cite> 헤더를 보는 것 대신, 간단히 첫 번째 슬래쉬(/)까지의
요청 경로를 보는 것이다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">threading</span> <span class="kn">import</span> <span class="n">Lock</span>
<span class="kn">from</span> <span class="nn">werkzeug.wsgi</span> <span class="kn">import</span> <span class="n">pop_path_info</span><span class="p">,</span> <span class="n">peek_path_info</span>

<span class="k">class</span> <span class="nc">PathDispatcher</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default_app</span><span class="p">,</span> <span class="n">create_app</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default_app</span> <span class="o">=</span> <span class="n">default_app</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_app</span> <span class="o">=</span> <span class="n">create_app</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock</span> <span class="o">=</span> <span class="n">Lock</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">instances</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">get_application</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefix</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
            <span class="n">app</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">instances</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">app</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">app</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_app</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">app</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">instances</span><span class="p">[</span><span class="n">prefix</span><span class="p">]</span> <span class="o">=</span> <span class="n">app</span>
            <span class="k">return</span> <span class="n">app</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">environ</span><span class="p">,</span> <span class="n">start_response</span><span class="p">):</span>
        <span class="n">app</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_application</span><span class="p">(</span><span class="n">peek_path_info</span><span class="p">(</span><span class="n">environ</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">app</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">pop_path_info</span><span class="p">(</span><span class="n">environ</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">app</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_app</span>
        <span class="k">return</span> <span class="n">app</span><span class="p">(</span><span class="n">environ</span><span class="p">,</span> <span class="n">start_response</span><span class="p">)</span>
</pre></div>
</div>
<p>경로와 하위도메인 디스패치의 큰 차이점은 경로 디스패치는 생성 함수가 <cite>None</cite>
을 반환하면 다른 어플리케이션으로 넘어갈 수 있다는 것이다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">myapplication</span> <span class="kn">import</span> <span class="n">create_app</span><span class="p">,</span> <span class="n">default_app</span><span class="p">,</span> <span class="n">get_user_for_prefix</span>

<span class="k">def</span> <span class="nf">make_app</span><span class="p">(</span><span class="n">prefix</span><span class="p">):</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">get_user_for_prefix</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">user</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">create_app</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>

<span class="n">application</span> <span class="o">=</span> <span class="n">PathDispatcher</span><span class="p">(</span><span class="n">default_app</span><span class="p">,</span> <span class="n">make_app</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<span id="document-patterns/urlprocessors"></span><div class="section" id="url">
<h4>URL 프로세서 이용하기<a class="headerlink" href="#url" title="제목 주소">¶</a></h4>
<div class="versionadded">
<p><span class="versionmodified">버전 0.7에 추가.</span></p>
</div>
<p>플라스크 0.7 은 URL 프로세서의 개념을 소개한다. 이 방식은 여러분이 항상
명시적으로 제공하기를 원하지 않는 URL의 공통 부분을 포함하는 여러 리소스를
가질 수 있다는 것이다.  예를 들면, 여러분은 URL 안에 언어 코드를 갖지만
모든 개별 함수에서 그것을 처리하고 싶지않은 다수의 URL을 가질 수 있다.</p>
<p>청사진과 결합될 때, URL 프로세서는 특히나 도움이 된다. 청사진이 지정된
URL 프로세서 뿐만아니라 어플리케이션이 지정된 URL 프로세서 둘 다 다룰 것이다.</p>
<div class="section" id="id1">
<h5>국제화된 어플리케이션 URL<a class="headerlink" href="#id1" title="제목 주소">¶</a></h5>
<p>아래와 같은 어플리케이션을 고려해보자:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">g</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/&lt;lang_code&gt;/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="n">lang_code</span><span class="p">):</span>
    <span class="n">g</span><span class="o">.</span><span class="n">lang_code</span> <span class="o">=</span> <span class="n">lang_code</span>
    <span class="o">...</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/&lt;lang_code&gt;/about&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">about</span><span class="p">(</span><span class="n">lang_code</span><span class="p">):</span>
    <span class="n">g</span><span class="o">.</span><span class="n">lang_code</span> <span class="o">=</span> <span class="n">lang_code</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>이것은 여러분이 모든 개별 함수마다 <a class="reference internal" href="index.html#flask.g" title="flask.g"><code class="xref py py-data docutils literal"><span class="pre">g</span></code></a> 객체에 언어 코드 설정을
처리해야하기 때문에 엄청나게 많은 반복이다. 물론, 데코레이터가 이런 작업을
간단하게 만들어 줄 수 있지만, 여러분이 하나의 함수에서 다른 함수로 URL을
생성하고 싶다면, 여러분은 언어 코드를 명시적으로 제공하는 성가신 작업을
여전히 해야한다.</p>
<p>후자의 경우, <a class="reference internal" href="index.html#flask.Flask.url_defaults" title="flask.Flask.url_defaults"><code class="xref py py-func docutils literal"><span class="pre">url_defaults()</span></code></a> 가 관여하는 곳 이다.
그것들은 자동으로 <a class="reference internal" href="index.html#flask.url_for" title="flask.url_for"><code class="xref py py-func docutils literal"><span class="pre">url_for()</span></code></a> 호출에 대해 값을 주입한다.
아래의 코드는 언어 코드가 URL 딕셔너리에는 아직 없는지와 끝점(endpoint)가
<code class="docutils literal"><span class="pre">'lang_code'</span></code> 라는 변수의 값을 원하는지를 확인한다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.url_defaults</span>
<span class="k">def</span> <span class="nf">add_language_code</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
    <span class="k">if</span> <span class="s">&#39;lang_code&#39;</span> <span class="ow">in</span> <span class="n">values</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">g</span><span class="o">.</span><span class="n">lang_code</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="k">if</span> <span class="n">app</span><span class="o">.</span><span class="n">url_map</span><span class="o">.</span><span class="n">is_endpoint_expecting</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="s">&#39;lang_code&#39;</span><span class="p">):</span>
        <span class="n">values</span><span class="p">[</span><span class="s">&#39;lang_code&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">lang_code</span>
</pre></div>
</div>
<p>URL 맵에 대한 <a class="reference external" href="http://werkzeug.pocoo.org/docs/routing/#werkzeug.routing.Map.is_endpoint_expecting" title="(in Werkzeug v0.11-dev)"><code class="xref py py-meth docutils literal"><span class="pre">is_endpoint_expecting()</span></code></a> 메소드는
주어진 끝점에 대해 언어 코드를 제공하는 것이 적합한지 확인하는데 사용된다.</p>
<p>위의 함수와 반대되는 함수로는 <a class="reference internal" href="index.html#flask.Flask.url_value_preprocessor" title="flask.Flask.url_value_preprocessor"><code class="xref py py-meth docutils literal"><span class="pre">url_value_preprocessor()</span></code></a> 가 있다.
그것들은 요청이 URL과 매치된 후에 바로 실행되고 URL 값에 기반된 코드를 실행할 수 있다.
이 방식은 그 함수들이 딕셔너리로 부터 값을 꺼내고 다른 곳에 그 값을 넣는 것이다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.url_value_preprocessor</span>
<span class="k">def</span> <span class="nf">pull_lang_code</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
    <span class="n">g</span><span class="o">.</span><span class="n">lang_code</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;lang_code&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
</pre></div>
</div>
<p>이 방식으로 여러분은 더 이상 모든 함수에서 <a class="reference internal" href="index.html#flask.g" title="flask.g"><code class="xref py py-data docutils literal"><span class="pre">g</span></code></a> 에 <cite>lang_code</cite> 를
할당하지 않아도 된다. 여러분은 언어 코드를 URL의 접두어로 만드는 데코레이터를 작성하여
좀 더 개선할 수 있지만, 더 아름다운 해결책은 청사진(blueprint)을 사용하는 것이다.
일단 <code class="docutils literal"><span class="pre">'lang_code'</span></code> 가 URL 값의 딕셔너리에서 꺼내지면 그 값은 아래와 같이 코드가 줄어든
뷰 함수로 더 이상 넘어가지 않는다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">g</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="nd">@app.url_defaults</span>
<span class="k">def</span> <span class="nf">add_language_code</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
    <span class="k">if</span> <span class="s">&#39;lang_code&#39;</span> <span class="ow">in</span> <span class="n">values</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">g</span><span class="o">.</span><span class="n">lang_code</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="k">if</span> <span class="n">app</span><span class="o">.</span><span class="n">url_map</span><span class="o">.</span><span class="n">is_endpoint_expecting</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="s">&#39;lang_code&#39;</span><span class="p">):</span>
        <span class="n">values</span><span class="p">[</span><span class="s">&#39;lang_code&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">lang_code</span>

<span class="nd">@app.url_value_preprocessor</span>
<span class="k">def</span> <span class="nf">pull_lang_code</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
    <span class="n">g</span><span class="o">.</span><span class="n">lang_code</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;lang_code&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/&lt;lang_code&gt;/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="o">...</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/&lt;lang_code&gt;/about&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">about</span><span class="p">():</span>
    <span class="o">...</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h5>국제화된 청사진 URL<a class="headerlink" href="#id2" title="제목 주소">¶</a></h5>
<p>청사진은 자동으로 공통 문자열을 모든 URL에 접두어화 시킬 수 있기 때문에
모든 함수에 자동으로 그 값을 처리한다.  게다가, 청사진은 청사진 별로
<a class="reference internal" href="index.html#flask.Flask.url_defaults" title="flask.Flask.url_defaults"><code class="xref py py-meth docutils literal"><span class="pre">url_defaults()</span></code></a> 함수에서 많은 로직을 제거하는
URL 프로세서를 가질 수 있는데, 왜냐하면 청사진은 더 이상 URL이
진짜 <code class="docutils literal"><span class="pre">'lang_code'</span></code> 에 관심이 있는지 확인하지 않아도 되기 때문이다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Blueprint</span><span class="p">,</span> <span class="n">g</span>

<span class="n">bp</span> <span class="o">=</span> <span class="n">Blueprint</span><span class="p">(</span><span class="s">&#39;frontend&#39;</span><span class="p">,</span> <span class="n">__name__</span><span class="p">,</span> <span class="n">url_prefix</span><span class="o">=</span><span class="s">&#39;/&lt;lang_code&gt;&#39;</span><span class="p">)</span>

<span class="nd">@bp.url_defaults</span>
<span class="k">def</span> <span class="nf">add_language_code</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
    <span class="n">values</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s">&#39;lang_code&#39;</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">lang_code</span><span class="p">)</span>

<span class="nd">@bp.url_value_preprocessor</span>
<span class="k">def</span> <span class="nf">pull_lang_code</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
    <span class="n">g</span><span class="o">.</span><span class="n">lang_code</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;lang_code&#39;</span><span class="p">)</span>

<span class="nd">@bp.route</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="o">...</span>

<span class="nd">@bp.route</span><span class="p">(</span><span class="s">&#39;/about&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">about</span><span class="p">():</span>
    <span class="o">...</span>
</pre></div>
</div>
</div>
</div>
<span id="document-patterns/distribute"></span><div class="section" id="distribute">
<span id="distribute-deployment"></span><h4>Distribute으로 전개하기<a class="headerlink" href="#distribute" title="제목 주소">¶</a></h4>
<p>예전에 설치툴(setuptool)이었던 <a class="reference external" href="http://pypi.python.org/pypi/distribute">distribute</a> 가 지금은 파이썬 라이브러리와
확장(extentions)을 배포(툴의 이름처럼)하는데 일반적으로 사용되는 확장 라이브러리이다.
그것은 더 규모있는 어플리케이션의 배포를 쉽게 만드는 여러 더 복잡한 생성자 또한
지원하기 위해 파이썬과 같이 설치되는 disutils를 확장한 것이다:</p>
<ul class="simple">
<li><strong>의존성 지원(support for dependencies)</strong>: 라이브러리나 어플리케이션은 여러분을 위해 자동으로 설치되어야 할
그것에 의존적인 다른 라이브러리들의 목록을 선언할 수 있다.</li>
<li><strong>패키지 레지스트리(package registry)</strong>: 설치툴은 파이썬 설치와 함께 여러분의 패키지를 등록한다.
이것은 하나의 패키지에서 제공되는 정보를 다른 패키지에서 질의하는 것을 가능하게 한다.
이 시스템의 가장 잘 알려진 특징은 패키지가 다른 패키지를 확장하기 위해 끼어들 수 있는
&#8220;진입점(entry point)&#8221;을 선언할 수 있도록 하는 진입점을 지원하다는 것이다.</li>
<li><strong>설치 관리자(installation manager)</strong>: distribute와 함께 설치되는 <cite>easy_install</cite> 은 여러분을 위해
다른 라이브러리를 설치해준다.  여러분은 또한 조만간 패키지 설치 이상의 기능을 제공하는 <cite>easy_install</cite>
을 대체할 <a class="reference external" href="http://pypi.python.org/pypi/pip">pip</a> 을 사용할 수 있다.</li>
</ul>
<p>플라스크 그 자체와 cheeseshop(파이썬 라이브러리 인덱스)에서 찾을 수 있는 모든 라이브러리들은
distribute, the older setuptools 또는 distutils 중 한 가지로 배포된다.</p>
<p>이 경우, 여러분은 여러분의 어플리케이션이 <cite>yourapplication.py</cite> 이고 모듈을 사용하지 않지만
<a class="reference internal" href="index.html#larger-applications"><span>package</span></a> 를 사용한다고 가정하자.
표준 모듈들을 가진 리소스들을 배포하는 것은 <a class="reference external" href="http://pypi.python.org/pypi/distribute">distribute</a> 이 지원하지 않지만,
우리는 그것을 신경쓰지 않을 것이다.  여러분이 아직 어플리케이션을 패키지로 변환하지 않았다면,
어떻게 변환될 수 있는지 보기 위해 <a class="reference internal" href="index.html#larger-applications"><span>더 큰 어플케이션들</span></a> 패턴으로 돌아가길 바란다.</p>
<p>distribute를 가지고 배포하는 것은 좀 더 복잡하고 자동화된 배포 시나리오로 들어가는 첫 단계이다.
만약 여러분이 배포 프로세스를 완전히 자동화하고 싶다면, <a class="reference internal" href="index.html#fabric-deployment"><span>Fabric으로 전개하기</span></a> 장 또한 읽어야한다.</p>
<div class="section" id="id1">
<h5>기본 설치 스크립트<a class="headerlink" href="#id1" title="제목 주소">¶</a></h5>
<p>여러분은 플라스크를 실행시키고 있기 때문에, 어쨌든 여러분의 시스템에는
setuptools나 distribute를 사용할 수 있을 것이다.
만약 사용할 수 없다면, 두려워하지 말기 바란다. 여러분을 위해 그런 설치도구를 설치해 줄
<a class="reference external" href="http://python-distribute.org/distribute_setup.py">distribute_setup.py</a> 이라는 스크립트가 있다.  단지 다운받아서 파이썬으로 실행하면 된다.</p>
<p>표준적인 포기는 다음을 적용한다: <a class="reference internal" href="index.html#virtualenv"><span>여러분은 virtualenv를 사용하는 것이 낫다</span></a> .</p>
<p>여러분의 셋업 코드는 항상 <a href="#id2"><span class="problematic" id="id3">`</span></a>setup.py`이라는 파일명으로 여러분의 어플리케이션 옆에 놓인다.
그 파일명은 단지 관례일뿐이지만, 모두가 그 이름으로 파일을 찾을 것이기 때문에 다른 이름으로
바꾸지 않는게 좋을 것이다.</p>
<p>그렇다, 여러분은 <cite>distribute`를 사용하고 있음에도 불구하고, `setuptools`라 불리는
패키지를 입포트하고 있다.  `distribute</cite> 은 <cite>setuptools</cite> 과 완전하게 하위버전이 호환되므로
임포트 명을 또한 사용한다.</p>
<p>플라스크 어플리케이션에 대한 기본적인 <cite>setup.py</cite> 파일은 아래와 같다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">setuptools</span> <span class="kn">import</span> <span class="n">setup</span>

<span class="n">setup</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s">&#39;Your Application&#39;</span><span class="p">,</span>
    <span class="n">version</span><span class="o">=</span><span class="s">&#39;1.0&#39;</span><span class="p">,</span>
    <span class="n">long_description</span><span class="o">=</span><span class="n">__doc__</span><span class="p">,</span>
    <span class="n">packages</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;yourapplication&#39;</span><span class="p">],</span>
    <span class="n">include_package_data</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">zip_safe</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">install_requires</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;Flask&#39;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<p>여러분은 명시적으로 하위 패키지들을 나열해야만 한다는 것을 명심해야한다.
여러분이 자동적으로 distribute가 패키지명을 찾아보기를 원한다면,
<cite>find_packages</cite> 함수를 사용할 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre>from setuptools import setup, find_packages

setup(
    ...
    packages=find_packages()
)
</pre></div>
</div>
<p><cite>include_package_data</cite> 과 <cite>zip_safe</cite> 은 아닐수도 있지만, <cite>setup</cite> 함수의
대부분 인자들은 스스로 설명이 가능해야 한다.
<cite>include_package_data</cite> 은 distribute 에게 <cite>MANIFEST.in</cite> 파일을 찾고
패키지 데이타로서 일치하는 모든 항목을 설치하도록 요청한다.
우리들은 파이썬 모듈과 같이 정적 파일들과 템플릿들을 배포하기 위해
이것을 사용할 것이다.(see <a class="reference internal" href="#distributing-resources"><span>리소스 배포하기</span></a>).
<cite>zip_safe</cite> 플래그는 zip 아카이브의 생성을 강제하거나 막기위해 사용될 수 있다.
일반적으로 여러분은 아마 여러분의 패키지들이 zip 파일로 설치되기를 원하지는 않을 것인데,
왜냐하면 어떤 도구들은 그것들을 지원하지 않으며 디버깅을 훨씬 더 어렵게 한다.</p>
</div>
<div class="section" id="distributing-resources">
<span id="id4"></span><h5>리소스 배포하기<a class="headerlink" href="#distributing-resources" title="제목 주소">¶</a></h5>
<p>여러분이 방금 생성한 패키지를 설치하려고 한다면, 여러분은 <cite>static</cite> 이나
&#8216;templates&#8217; 같은 폴더들이 생성되어 있지 않다는 것을 알게될 것이다.
왜냐하면 distribute 은 추가할 파일이 어떤 것인지 모르기 때문이다.
여러분이 해야하는 것은 <cite>setup.py&#8217; 파일 옆에 `MANIFEST.in</cite> 파일을 생성하는 것이다.
이 파일은 여러분의 타르볼(tarball)에 추가되어야 하는 모든 파일들을 나열한다:</p>
<div class="highlight-python"><div class="highlight"><pre>recursive-include yourapplication/templates *
recursive-include yourapplication/static *
</pre></div>
</div>
<p>여러분이 <cite>MANIFEST.in</cite> 파일에 그 목록들을 요청함에도 불구하고, <cite>setup</cite> 함수의
<cite>include_package_data</cite> 인자가 <cite>True</cite> 로 설정되지 않는다면, 그것들은 설치되지
않을 것이라는 것을 잊지 말도록 해라.</p>
</div>
<div class="section" id="id5">
<h5>의존성 선언하기<a class="headerlink" href="#id5" title="제목 주소">¶</a></h5>
<p>의존성은 <cite>install_requires</cite> 인자에 리스트로 선언된다. 그 리스트에 있는 각 항목은
설치 시 PyPI로 부터 당겨져야 하는 패키지 명이다. 디폴트로 항상 최신 버전을 사용하지만,
여러분은 또한 최소 버전과 최대 버전에 대한 요구사항을 제공할 수 있다. 아래에 예가 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">install_requires</span><span class="o">=</span><span class="p">[</span>
    <span class="s">&#39;Flask&gt;=0.2&#39;</span><span class="p">,</span>
    <span class="s">&#39;SQLAlchemy&gt;=0.6&#39;</span><span class="p">,</span>
    <span class="s">&#39;BrokenPackage&gt;=0.7,&lt;=1.0&#39;</span>
<span class="p">]</span>
</pre></div>
</div>
<p>앞에서 의존성은 PyPI로부터 당겨진다고 언급했다. 다른 사람과 공유하고
싶지 않은 내부 패키지기 때문에 PyPI에서 찾을 수 없고 찾지도 못하는
패키지에 의존하고 싶다면 어떻게 되는가? 여전히 PyPI 목록이 있는 것 처럼
처리하고 distribute 가 타르볼을 찾아야할 다른 장소의 목록을 제공하면 된다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">dependency_links</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;http://example.com/yourfiles&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>페이지가 디렉토리 목록를 갖고 있고 그 페이지의 링크는 distribute가 파일들을 찾는
방법처럼 실제 타르볼을 가리키도록 해야한다.  만약 여러분이 회사의 내부 서버에
패키지를 갖고 있다면, 그 서버에 대한 URL을 제공하도록 해라.</p>
</div>
<div class="section" id="id6">
<h5>설치하기/개발하기<a class="headerlink" href="#id6" title="제목 주소">¶</a></h5>
<p>여러분의 어플리케이션을 설치하는 것은(이상적으로는 virtualenv를 이용해서)
단지 <cite>install</cite> 인자로 <a href="#id7"><span class="problematic" id="id8">`</span></a>setup.py`를 실행하기만 하면 된다.  그것은 여러분의
어플리케이션을 virtualenv의 사이트 패키지(site-packages) 폴더로 설치되고
또한 모든 의존성을 갖고 받아지고 설치될 것이다:</p>
<div class="highlight-python"><div class="highlight"><pre>$ python setup.py install
</pre></div>
</div>
<p>만약 어려분이 패키지 기반으로 개발하고 있고 또한 패키지 기반에 대한 필수 항목이
설치되어야 한다면, <cite>develop</cite> 명령을 대신 사용할 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre>$ python setup.py develop
</pre></div>
</div>
<p>이것의 이점은 데이타를 복사하는 것이 아니라 사이트 패키지 폴더에 대한 링크를
설치한다는 것이다.  그러면 여러분은 개별 변경 후에도 다시 <cite>install</cite> 을 실행할
필요없이 계속해서 코드에 대한 작업을 할 수 있다.</p>
</div>
</div>
<span id="document-patterns/fabric"></span><div class="section" id="fabric">
<span id="fabric-deployment"></span><h4>Fabric으로 전개하기<a class="headerlink" href="#fabric" title="제목 주소">¶</a></h4>
<p><a class="reference external" href="http://fabfile.org/">Fabric</a> Makefiles과 유사하지만 원격 서버에 있는 명령을 실행할 수 있는
기능도 갖고 있는 파이썬 도구이다.  적당한 파이썬 설치 패키지
(<a class="reference internal" href="index.html#larger-applications"><span>더 큰 어플케이션들</span></a>) 와 설정 (<a class="reference internal" href="index.html#config"><span>설정 다루기</span></a>)에 대한 좋은 개념의 결합은
플라스크 어플리케이션을 외부 서버에 상당히 쉽게 전개하도록 해준다.</p>
<p>시작하기에 앞서, 우리가 사전에 빠르게 확인해야할 체크리스트가 있다:</p>
<ul class="simple">
<li>Fabric 1.0 은 로컬에 설치되어 있어야한다.  이 문서는 Fabric의
가장 최신버전을 가정한다.</li>
<li>어플리케이션은 이미 패키지로 되어있고 동작하는 <cite>setup.py</cite> 파일을
요구한다 (<a class="reference internal" href="index.html#distribute-deployment"><span>Distribute으로 전개하기</span></a>).</li>
<li>뒤따르는 예제에서 우리는 원격 서버에 <cite>mod_wsgi</cite> 를 사용할 것이다.
물론 여러분이 좋아하는 서버를 사용할 수 있겠지만, 이 예제에서는
Apache + <cite>mod_wsgi</cite> 를 사용하기로 했는데, 그 방식이 설치가 쉽고
root 권한 없이도 어플리케이션을 간단하게 리로드할 수 있기 때문이다.</li>
</ul>
<div class="section" id="fabfile">
<h5>첫 번째 Fabfile 파일 생성하기<a class="headerlink" href="#fabfile" title="제목 주소">¶</a></h5>
<p>fabfile 은 Fabric이 실행할 대상을 제어하는 것이다.  fabfile은 <cite>fabfile.py</cite>
라는 파일명을 갖고, <cite>fab</cite> 명령으로 실행된다.  그 파일에 정의된 모든 기능들은
<cite>fab</cite> 하위명령(subcommands)가 보여준다.  그 명령들은 하나 이상의 호스트에서
실행된다.  이 호스트들은 fabfile 파일이나 명령줄에서 정의될 수 있다.
여기에서는 fabfile 파일에 호스트들을 추가할 것이다.</p>
<p>아래는 현재 소스코드를 서버로 업로드하고 사전에 만들어진 가상 환경에
설치하는 기능을 하는 기본적인 첫 번째 예제이다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">fabric.api</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c"># the user to use for the remote commands</span>
<span class="n">env</span><span class="o">.</span><span class="n">user</span> <span class="o">=</span> <span class="s">&#39;appuser&#39;</span>
<span class="c"># the servers where the commands are executed</span>
<span class="n">env</span><span class="o">.</span><span class="n">hosts</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;server1.example.com&#39;</span><span class="p">,</span> <span class="s">&#39;server2.example.com&#39;</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">pack</span><span class="p">():</span>
    <span class="c"># create a new source distribution as tarball</span>
    <span class="n">local</span><span class="p">(</span><span class="s">&#39;python setup.py sdist --formats=gztar&#39;</span><span class="p">,</span> <span class="n">capture</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">deploy</span><span class="p">():</span>
    <span class="c"># figure out the release name and version</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="n">local</span><span class="p">(</span><span class="s">&#39;python setup.py --fullname&#39;</span><span class="p">,</span> <span class="n">capture</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="c"># upload the source tarball to the temporary folder on the server</span>
    <span class="n">put</span><span class="p">(</span><span class="s">&#39;dist/</span><span class="si">%s</span><span class="s">.tar.gz&#39;</span> <span class="o">%</span> <span class="n">dist</span><span class="p">,</span> <span class="s">&#39;/tmp/yourapplication.tar.gz&#39;</span><span class="p">)</span>
    <span class="c"># create a place where we can unzip the tarball, then enter</span>
    <span class="c"># that directory and unzip it</span>
    <span class="n">run</span><span class="p">(</span><span class="s">&#39;mkdir /tmp/yourapplication&#39;</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">cd</span><span class="p">(</span><span class="s">&#39;/tmp/yourapplication&#39;</span><span class="p">):</span>
        <span class="n">run</span><span class="p">(</span><span class="s">&#39;tar xzf /tmp/yourapplication.tar.gz&#39;</span><span class="p">)</span>
        <span class="c"># now setup the package with our virtual environment&#39;s</span>
        <span class="c"># python interpreter</span>
        <span class="n">run</span><span class="p">(</span><span class="s">&#39;/var/www/yourapplication/env/bin/python setup.py install&#39;</span><span class="p">)</span>
    <span class="c"># now that all is set up, delete the folder again</span>
    <span class="n">run</span><span class="p">(</span><span class="s">&#39;rm -rf /tmp/yourapplication /tmp/yourapplication.tar.gz&#39;</span><span class="p">)</span>
    <span class="c"># and finally touch the .wsgi file so that mod_wsgi triggers</span>
    <span class="c"># a reload of the application</span>
    <span class="n">run</span><span class="p">(</span><span class="s">&#39;touch /var/www/yourapplication.wsgi&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>위의 예제는 문서화가 잘 되고 있고 직관적일 것이다.
아래는 fabric이 제공하는 가장 일반적인 명령들을 요약했다:</p>
<ul class="simple">
<li><cite>run</cite> - 원격 서버에서 명령을 수행함</li>
<li><cite>local</cite> - 로컬 서버에서 명령을 수행함</li>
<li><cite>put</cite> - 원격 서버로 파일을 업로드함</li>
<li><cite>cd</cite> - 서버에서 디렉토리를 변경함.</li>
</ul>
<p>이 명령은 <cite>with</cite> 절과 결합되어 사용되어야 한다.</p>
</div>
<div class="section" id="id1">
<h5>Fabfile 실행하기<a class="headerlink" href="#id1" title="제목 주소">¶</a></h5>
<p>이제 여러분은 어떻게 그 fabfile을 실행할 것인가?  <cite>fab</cite> 명령을 사용한다.
원격 서버에 있는 현재 버전의 코드를 전개하기 위해서 여러분은 아래 명령을
사용할 것이다:</p>
<div class="highlight-python"><div class="highlight"><pre>$ fab pack deploy
</pre></div>
</div>
<p>하지만 이것은 서버에 이미 <code class="docutils literal"><span class="pre">/var/www/yourapplication</span></code> 폴더가 생성되어있고
<code class="docutils literal"><span class="pre">/var/www/yourapplication/env</span></code> 을 가상 환경으로 갖고 있는 것을 요구한다.
더욱이 우리는 서버에 구성 파일이나 <cite>.wsgi</cite> 파일을 생성하지 않았다.  그렇다면
우리는 어떻게 신규 서버에 우리의 기반구조를 만들 수 있을까?</p>
<p>이것은 우리가 설치하고자 하는 서버의 개수에 달려있다.  우리가 단지
한 개의 어플리케이션 서버를 갖고 있다면 (다수의 어플리케이션들이 포함된),
fabfile 에서 명령을 생성하는 것은 과한 것이다.  그러나 명백하게 여러분은
그것을 할 수 있다.  이 경우에 여러분은 아마 그것을 <cite>setup</cite> 이나 <cite>bootstrap</cite>
으로 호출하고 그 다음에 명령줄에 명시적으로 서버명을 넣을 것이다:</p>
<div class="highlight-python"><div class="highlight"><pre>$ fab -H newserver.example.com bootstrap
</pre></div>
</div>
<p>신규 서버를 설치하기 위해서 여러분은 대략 다음과 같은 단계를 수행할 것이다:</p>
<ol class="arabic">
<li><p class="first"><code class="docutils literal"><span class="pre">/var/www</span></code> 에 디렉토리 구조를 생성한다:</p>
<div class="highlight-python"><div class="highlight"><pre>$ mkdir /var/www/yourapplication
$ cd /var/www/yourapplication
$ virtualenv --distribute env
</pre></div>
</div>
</li>
<li><p class="first">새로운 <cite>application.wsgi</cite> 파일과 설정 파일 (eg: <cite>application.cfg</cite>) 을
서버로 업로드한다.</p>
</li>
<li><p class="first"><cite>yourapplication</cite> 에 대한 Apache 설정을 생성하고 설정을 활성화 한다.
<cite>.wsgi</cite> 파일을 변경(touch)하여 어플리케이션을 자동으로 리로드하기 위해
그 파일의 변경에 대한 감시를 활성화하는 것을 확인한다.
( <a class="reference internal" href="index.html#mod-wsgi-deployment"><span>mod_wsgi (아파치)</span></a> 에 더 많은 정보가 있다)</p>
</li>
</ol>
<p>자 그렇다면 <cite>application.wsgi</cite> 파일과 <cite>application.cfg</cite> 파일은 어디서 왔을까?
라는 질문이 나온다.</p>
</div>
<div class="section" id="wsgi">
<h5>WSGI 파일<a class="headerlink" href="#wsgi" title="제목 주소">¶</a></h5>
<p>WSGI 파일은 어플리케이션이 설정파일을 어디서 찾아야 하는지 알기 위해
어플리케이션을 임포트해야하고 또한 환경 변수를 설정해야한다.  아래는
정확히 그 설정을 하는 짧은 예제이다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s">&#39;YOURAPPLICATION_CONFIG&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;/var/www/yourapplication/application.cfg&#39;</span>
<span class="kn">from</span> <span class="nn">yourapplication</span> <span class="kn">import</span> <span class="n">app</span>
</pre></div>
</div>
<p>그리고 나서 어플리케이션 그 자체는 그 환경 변수에 대한 설정을 찾기 위해
아래와 같은 방식으로 초기화 해야한다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">from_object</span><span class="p">(</span><span class="s">&#39;yourapplication.default_config&#39;</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">from_envvar</span><span class="p">(</span><span class="s">&#39;YOURAPPLICATION_CONFIG&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>이 접근법은 이 문서의 <a class="reference internal" href="index.html#config"><span>설정 다루기</span></a> 단락에 자세히 설명되어 있다.</p>
</div>
<div class="section" id="id2">
<h5>설정 파일<a class="headerlink" href="#id2" title="제목 주소">¶</a></h5>
<p>위에서 언급한 것 처럼, 어플리케이션은 <cite>YOURAPPLICATION_CONFIG</cite> 환경 변수
를 찾음으로서 올바른 설정 파일을 찾을 것이다.  그래서 우리들은 어플리케이션이
그 변수를 찾을 수 있는 곳에 그 설정을 넣어야만 한다.  설정 파일들은 모든
컴퓨터에서 여러 다른 상태를 갖을수 있는 불친절한 특징을 갖기 때문에 보통은
설정 파일들을 버전화하지 않는다.</p>
<p>많이 사용되는 접근법은 분리된 버전 관리 저장소에 여러 다른 서버에 대한
설정 파일들을 보관하고 모든 서버에 그것들을 받아가는(check-out) 것이다.
그리고 나서 어떤 서버에 대해 사용 중인 설정 파일은 그 파일이 심볼릭 링크로
생성되도록 기대되는 곳으로 링크를 건다 (eg: <code class="docutils literal"><span class="pre">/var/www/yourapplication</span></code>).</p>
<p>다른 방법으로는, 여기에서 우리는 단지 하나 또는 두개의 서버만 가정했으므로
수동으로 그것들은 생각보다 빨리 업로드할 수 있다.</p>
</div>
<div class="section" id="id3">
<h5>첫 번째 전개<a class="headerlink" href="#id3" title="제목 주소">¶</a></h5>
<p>이제 여러분은 첫 번째 전개를 할 수 있게 되었다.  우리는 서버가 가상환경과
활성화된 apache 설정들을 갖게하기 위해 그 서버들을 설치한다.  우리는
아래의 명령을 이용해서 어플리케이션을 감싸서 전개할 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre>$ fab pack deploy
</pre></div>
</div>
<p>Fabric은 이제 모든 서버에 연결될 것이고 fabfile에 적힌 명령들을 수행할 것이다.
먼저 타르볼을 준비하기위해 pack을 실행할 것이고 그리고 나서 deploy를 실행해서
모든 서버에 소스코드를 업로드하고 하고 거기에 그것을 설치할 것이다.  자동으로
필수 라이브러리들과 받아서 우리의 가상 환경으로 넣어주는 <cite>setup.py</cite> 파일에
감사할 뿐이다.</p>
</div>
<div class="section" id="id4">
<h5>다음 단계들<a class="headerlink" href="#id4" title="제목 주소">¶</a></h5>
<p>이 시점부터는 실제로 전개를 재밌게 만들 수 있는 많은 것들이 있다:</p>
<ul class="simple">
<li>신규 서버를 초기화하는 <cite>bootstrap</cite> 명령을 생성한다.  그것은 새로운 가상 환경을
초기화하고 알맞게 apache를 설치 등을 할 수 있다.</li>
<li>설정 파일들을 분리된 버전 관리 저장소에 넣고 활성화된 설정들에 대해 지정된
위치로 심볼릭 링크를 생성한다.</li>
<li>여러분의 어플리케이션 코드 또한 저장소에 넣을 수 있고 서버에 가장 최신 버전을
받아 설치할 수 있다.  그런 방식으로 이전 버전들로 쉽게 돌아갈 수도 있다.</li>
<li>외부 서버에 전개하고 테스트묶음을 실행할 수 있도록 테스팅 기능을 끼워 넣는다.</li>
</ul>
<p>Fabric을 가지고 작업하는 것이 재미있다면 여러분은 <code class="docutils literal"><span class="pre">fab</span> <span class="pre">deploy</span></code> 을 입력하는 것이
상당히 마법같다는 것을 알 것이고 하나 이상의 원격 서버에 자동으로 여러분의
어플리케이션이 전개되는 것을 볼 수 있을 것이다.</p>
</div>
</div>
<span id="document-patterns/sqlite3"></span><div class="section" id="flask-sqlite-3">
<span id="sqlite3"></span><h4>Flask에서 SQLite 3 사용하기<a class="headerlink" href="#flask-sqlite-3" title="제목 주소">¶</a></h4>
<p>여러분은 Flask에서 필요할 때 데이타베이스 연결을 열고 문맥이 끝났을 때
(보통 요청이 끝에서) 연결을 닫는 것을 쉽게 구현할 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">sqlite3</span>
<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">_app_ctx_stack</span>

<span class="n">DATABASE</span> <span class="o">=</span> <span class="s">&#39;/path/to/database.db&#39;</span>

<span class="k">def</span> <span class="nf">get_db</span><span class="p">():</span>
    <span class="n">top</span> <span class="o">=</span> <span class="n">_app_ctx_stack</span><span class="o">.</span><span class="n">top</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="s">&#39;sqlite_db&#39;</span><span class="p">):</span>
        <span class="n">top</span><span class="o">.</span><span class="n">sqlite_db</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">DATABASE</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">top</span><span class="o">.</span><span class="n">sqlite_db</span>

<span class="nd">@app.teardown_appcontext</span>
<span class="k">def</span> <span class="nf">close_connection</span><span class="p">(</span><span class="n">exception</span><span class="p">):</span>
    <span class="n">top</span> <span class="o">=</span> <span class="n">_app_ctx_stack</span><span class="o">.</span><span class="n">top</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="s">&#39;sqlite_db&#39;</span><span class="p">):</span>
        <span class="n">top</span><span class="o">.</span><span class="n">sqlite_db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>데이타베이스를 지금 사용하기 위해서 어플리케이션에서 필요한 전부는 활성화된
어플리케이션 문맥을 갖거나 (전달중인 요청이 있다면 항상 활성화 된 것이다)
어플리케이션 문맥 자체를 생성하는 것이다.  그 시점에 <code class="docutils literal"><span class="pre">get_db</span></code> 함수는 현재
데이타베이스 연결을 얻기위해 사용될 수 있다.  그 문맥이 소멸될 때마다
그 데이타베이스 연결은 종료될 것이다.</p>
<p>예제:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="n">cur</span> <span class="o">=</span> <span class="n">get_db</span><span class="p">()</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="o">...</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">주석</p>
<p class="last">before-request 핸들러가 실패하거나 절대 실행되지 않더라도, teardown 요청과
appcontext 함수는 항상 실행되다는 것을 명심하길 바란다. 그런 이유로 우리가
데이타베이스를 닫기전에 거기에 데이타베이스가 있었다는 것을 여기서 보장해야한다.</p>
</div>
<div class="section" id="id1">
<h5>필요할 때 연결하기<a class="headerlink" href="#id1" title="제목 주소">¶</a></h5>
<p>이 접근법의 장점은 (첫 사용시 연결하는 것) 정말 필요할 때만 연결이 열린다는 것이다.
여러분이 요청 문맥 밖에서 이 코드를 사용하고 싶다면 파이썬 쉘에서 수동으로
어플리케이션 문맥을 열고서 그 연결을 사용할 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre>with app.app_context():
    # now you can use get_db()
</pre></div>
</div>
</div>
<div class="section" id="easy-querying">
<span id="id2"></span><h5>쉬운 질의하기<a class="headerlink" href="#easy-querying" title="제목 주소">¶</a></h5>
<p>이제 각 요청 핸들링 함수에서 현재 열린 데이타베이스 연결을 얻기 위해
여러분은 <cite>g.db</cite> 에 접근할 수 있다.  SQLite 로 작업을 간단하게 하기 위해,
행(row) 팩토리 함수가 유용하다.  결과를 변환하기 위해 데이타베이스에서
반환된 모든 결과에 대해 실행된다.  예를 들면 튜플 대신 딕셔너리를 얻기 위해
아래와 같이 사용될 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">make_dicts</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">row</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">dict</span><span class="p">((</span><span class="n">cur</span><span class="o">.</span><span class="n">description</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">value</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row</span><span class="p">))</span>

<span class="n">db</span><span class="o">.</span><span class="n">row_factory</span> <span class="o">=</span> <span class="n">make_dicts</span>
</pre></div>
</div>
<p>덧붙이자면 커서를 얻고, 결과를 실행하고 꺼내는 것을 결합한 질의 함수를
제공하는 것은 괜찮은 생각이다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">query_db</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">one</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="n">cur</span> <span class="o">=</span> <span class="n">get_db</span><span class="p">()</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
    <span class="n">rv</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
    <span class="n">cur</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">rv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">rv</span> <span class="k">else</span> <span class="bp">None</span><span class="p">)</span> <span class="k">if</span> <span class="n">one</span> <span class="k">else</span> <span class="n">rv</span>
</pre></div>
</div>
<p>이 유용한 작은 함수는 행 팩토리와 결합되어 데이타베이스와 작업을 단지
원형의 커서와 연결 객체를 사용하는 것 보다 훨씬 더 기분 좋게 만든다.</p>
<p>아래에 그것을 사용하는 방법이 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">query_db</span><span class="p">(</span><span class="s">&#39;select * from users&#39;</span><span class="p">):</span>
    <span class="k">print</span> <span class="n">user</span><span class="p">[</span><span class="s">&#39;username&#39;</span><span class="p">],</span> <span class="s">&#39;has the id&#39;</span><span class="p">,</span> <span class="n">user</span><span class="p">[</span><span class="s">&#39;user_id&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>또는 여러분이 단지 단일 결과를 원한다면:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">user</span> <span class="o">=</span> <span class="n">query_db</span><span class="p">(</span><span class="s">&#39;select * from users where username = ?&#39;</span><span class="p">,</span>
                <span class="p">[</span><span class="n">the_username</span><span class="p">],</span> <span class="n">one</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">if</span> <span class="n">user</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
    <span class="k">print</span> <span class="s">&#39;No such user&#39;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span> <span class="n">the_username</span><span class="p">,</span> <span class="s">&#39;has the id&#39;</span><span class="p">,</span> <span class="n">user</span><span class="p">[</span><span class="s">&#39;user_id&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>변수의 일부분을 SQL 구문으로 전달하기 위해, 구문 안에 물음표를 사용하고
목록으로 인자안에 전달한다.  절대로 직접 인자들을 문자열 형태로 SQL 구문에
추가하면 안되는데 왜냐하면 <a class="reference external" href="http://en.wikipedia.org/wiki/SQL_injection">SQL 인젝션(Injections)</a> 을 사용해서 그 어플리케이션을
공격할 수 있기 때문이다.</p>
</div>
<div class="section" id="id3">
<h5>초기 스키마<a class="headerlink" href="#id3" title="제목 주소">¶</a></h5>
<p>관계형 데이타베이스들은 스키마를 필요로 하기 때문에, 어플리케이션들은
데이타베이스를 생성하는 <cite>schema.sql</cite> 파일을 종종 만들어낸다.  그 스키마에
기반한 데이타베이스를 생성하는 함수를 제공하는 것은 괜찮은 생각이다.
아래 함수는 여러분을 위해 그러한 작업을 할 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">init_db</span><span class="p">():</span>
    <span class="k">with</span> <span class="n">app</span><span class="o">.</span><span class="n">app_context</span><span class="p">():</span>
        <span class="n">db</span> <span class="o">=</span> <span class="n">get_db</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">app</span><span class="o">.</span><span class="n">open_resource</span><span class="p">(</span><span class="s">&#39;schema.sql&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">db</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span><span class="o">.</span><span class="n">executescript</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
        <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>
</div>
<p>그리고 나면 여러분은 파이썬 쉘에서 그런 데이타베이스를 생성할 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">yourapplication</span> <span class="kn">import</span> <span class="n">init_db</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">init_db</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<span id="document-patterns/sqlalchemy"></span><div class="section" id="flask-sqlalchemy">
<span id="sqlalchemy-pattern"></span><h4>Flask에서 SQLAlchemy 사용하기<a class="headerlink" href="#flask-sqlalchemy" title="제목 주소">¶</a></h4>
<p>많은 사람들이 데이타베이스에 접근하기 위해 <a class="reference external" href="http://www.sqlalchemy.org/">SQLAlchemy</a> 선호한다.
이런 경우 여러분의 Flask 어플리케이션에 대해 모듈 보다는 패키지를
사용하고 모델들을 분리된 모듈로 만드는 것이 독려된다(<a class="reference internal" href="index.html#larger-applications"><span>더 큰 어플케이션들</span></a>).
그것이 필수는 아니지만, 많은 부분에서 이해가 될만하다.</p>
<p>There are four very common ways to use SQLAlchemy를 사용하는 매우 일반적인
네가지 방식이 있다.  여기서 그것들을 각각 간략하게 설명할 것이다:</p>
<div class="section" id="id1">
<h5>Flask-SQLAlchemy 확장<a class="headerlink" href="#id1" title="제목 주소">¶</a></h5>
<p>SQLAlchemy는 공통 데이타베이스 추상 계층이고 설정하는데 약간의 노력을 요하는
객체 관계형 맵퍼(mapper)이기 때문에, 여러분을 위해 그 역할을 해줄 Flask
확장(extension)이 있다.  여러분이 빨리 시작하기를 원한다면 이 방식을 추천한다.</p>
<p>여러분은 <a href="#id5"><span class="problematic" id="id6">`PyPI&lt;http://pypi.python.org/pypi/Flask-SQLAlchemy&gt;`_</span></a> 에서
<a class="reference external" href="http://packages.python.org/Flask-SQLAlchemy/">Flask-SQLAlchemy</a> 를 받을 수 있다.</p>
</div>
<div class="section" id="declarative">
<h5>선언부(Declarative)<a class="headerlink" href="#declarative" title="제목 주소">¶</a></h5>
<p>SQLAlchemy에서 선언부(declarative) 확장은 SQLAlchemy를 사용하는 가장 최신
방법이다.  그 방법은 여러분이 한꺼번에 테이블들과 모델들을 정의하도록 해주는데,
그 방식은 Django(장고)가 동작하는 방식과 유사하다.  다음의 내용에 추가하여
<a class="reference external" href="http://www.sqlalchemy.org/docs/orm/extensions/declarative.html">declarative</a> 확장에 대한 공식 문서를 권고한다.</p>
<p>아래는 여러분의 어플리케이션을 위해 <cite>database.py</cite> 모듈의 예제이다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">create_engine</span>
<span class="kn">from</span> <span class="nn">sqlalchemy.orm</span> <span class="kn">import</span> <span class="n">scoped_session</span><span class="p">,</span> <span class="n">sessionmaker</span>
<span class="kn">from</span> <span class="nn">sqlalchemy.ext.declarative</span> <span class="kn">import</span> <span class="n">declarative_base</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s">&#39;sqlite:////tmp/test.db&#39;</span><span class="p">,</span> <span class="n">convert_unicode</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">db_session</span> <span class="o">=</span> <span class="n">scoped_session</span><span class="p">(</span><span class="n">sessionmaker</span><span class="p">(</span><span class="n">autocommit</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                                         <span class="n">autoflush</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                                         <span class="n">bind</span><span class="o">=</span><span class="n">engine</span><span class="p">))</span>
<span class="n">Base</span> <span class="o">=</span> <span class="n">declarative_base</span><span class="p">()</span>
<span class="n">Base</span><span class="o">.</span><span class="n">query</span> <span class="o">=</span> <span class="n">db_session</span><span class="o">.</span><span class="n">query_property</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">init_db</span><span class="p">():</span>
    <span class="c"># import all modules here that might define models so that</span>
    <span class="c"># they will be registered properly on the metadata.  Otherwise</span>
    <span class="c"># you will have to import them first before calling init_db()</span>
    <span class="kn">import</span> <span class="nn">yourapplication.models</span>
    <span class="n">Base</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">bind</span><span class="o">=</span><span class="n">engine</span><span class="p">)</span>
</pre></div>
</div>
<p>모델들을 정의하기 위해, 위의 코드로 생성된 <cite>Base</cite> 클래스를 상속하면 된다.
여러분이 왜 우리가 여기서 쓰레드를 신경쓰지 않아도 되는지 궁금하다면
(위의 SQLite3 예제에서 <a class="reference internal" href="index.html#flask.g" title="flask.g"><code class="xref py py-data docutils literal"><span class="pre">g</span></code></a> 객체를 가지고 한 것 처럼):
that&#8217;s because SQLAlchemy does that for us already with the <code class="xref py py-class docutils literal"><span class="pre">scoped_session</span></code>.
그것은 SQLAlchemy가 <code class="xref py py-class docutils literal"><span class="pre">scoped_session</span></code> 을 가지고
여러분을 위해서 이미 그러한 작업을 했기 때문이다.</p>
<p>여러분의 어플리케이션에서 선언적인 방식으로 SQLAlchemy를 사용하려면,
여러분의 어플리케이션 모듈에 아래의 코드를 집어넣기만 하면 된다.
Flask는 여러분을 위해 요청의 끝에서 데이타베이스 세션을 제거할 것이다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">yourapplication.database</span> <span class="kn">import</span> <span class="n">db_session</span>

<span class="nd">@app.teardown_request</span>
<span class="k">def</span> <span class="nf">shutdown_session</span><span class="p">(</span><span class="n">exception</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="n">db_session</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
</pre></div>
</div>
<p>아래는 예제 모델이다  (이 코드를 <cite>models.py</cite> 에 넣어라, e.g.):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">Column</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">String</span>
<span class="kn">from</span> <span class="nn">yourapplication.database</span> <span class="kn">import</span> <span class="n">Base</span>

<span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s">&#39;users&#39;</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span> <span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">email</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">120</span><span class="p">),</span> <span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">email</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">email</span> <span class="o">=</span> <span class="n">email</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&#39;&lt;User </span><span class="si">%r</span><span class="s">&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
<p>데이타베이스를 생성하기 위해서 여러분은 <cite>init_db</cite> 함수를 사용할 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">yourapplication.database</span> <span class="kn">import</span> <span class="n">init_db</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">init_db</span><span class="p">()</span>
</pre></div>
</div>
<p>여러분은 아래와 같이 항목들을 데이타베이스에 추가할 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">yourapplication.database</span> <span class="kn">import</span> <span class="n">db_session</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">yourapplication.models</span> <span class="kn">import</span> <span class="n">User</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">User</span><span class="p">(</span><span class="s">&#39;admin&#39;</span><span class="p">,</span> <span class="s">&#39;admin@localhost&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db_session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db_session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>
</div>
<p>질의하는것 또한 간단하다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">User</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</pre></div>
</div>
<p>[&lt;User u&#8217;admin&#8217;&gt;]
&gt;&gt;&gt; User.query.filter(User.name == &#8216;admin&#8217;).first()
&lt;User u&#8217;admin&#8217;&gt;</p>
</div>
<div class="section" id="id4">
<h5>수동 객체 관계 매핑<a class="headerlink" href="#id4" title="제목 주소">¶</a></h5>
<p>수동 객체 관계 매핑은 앞에서 나온 선언적 접근에 대비하여 몇 가지
장단점을 갖는다.  주요한 차이점은 여러분이 테이블들과 클래스들을
분리해서 정의하고 그것들을 함께 매핑한다는 것이다.  그 방식은
더 유연하지만 입력할 것이 약간 더 있다.  일반적으로 선언적 접근처럼
동작하기 때문에 어려분의 어플리케이션 또한 패키지안에 여러 모듈로
분리되도록 보장해라.</p>
<p>여기 여러분의 어플리케이션에 대한 <cite>database.py</cite> 모듈의 예가 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">MetaData</span>
<span class="kn">from</span> <span class="nn">sqlalchemy.orm</span> <span class="kn">import</span> <span class="n">scoped_session</span><span class="p">,</span> <span class="n">sessionmaker</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s">&#39;sqlite:////tmp/test.db&#39;</span><span class="p">,</span> <span class="n">convert_unicode</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">metadata</span> <span class="o">=</span> <span class="n">MetaData</span><span class="p">()</span>
<span class="n">db_session</span> <span class="o">=</span> <span class="n">scoped_session</span><span class="p">(</span><span class="n">sessionmaker</span><span class="p">(</span><span class="n">autocommit</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                                         <span class="n">autoflush</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                                         <span class="n">bind</span><span class="o">=</span><span class="n">engine</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">init_db</span><span class="p">():</span>
    <span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">bind</span><span class="o">=</span><span class="n">engine</span><span class="p">)</span>
</pre></div>
</div>
<p>선언적 접근법에 대하여 여러분은 각 요청 후에 세션을 닫을 필요가 있다.
이것을 여러분의 어플리케이션 모듈에 넣어라:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">yourapplication.database</span> <span class="kn">import</span> <span class="n">db_session</span>

<span class="nd">@app.teardown_request</span>
<span class="k">def</span> <span class="nf">shutdown_session</span><span class="p">(</span><span class="n">exception</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="n">db_session</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
</pre></div>
</div>
<p>여기에 예제 테이블과 모델이 있다 (이것을 <cite>models.py</cite> 에 넣어라):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">Table</span><span class="p">,</span> <span class="n">Column</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">String</span>
<span class="kn">from</span> <span class="nn">sqlalchemy.orm</span> <span class="kn">import</span> <span class="n">mapper</span>
<span class="kn">from</span> <span class="nn">yourapplication.database</span> <span class="kn">import</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">db_session</span>

<span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="n">query</span> <span class="o">=</span> <span class="n">db_session</span><span class="o">.</span><span class="n">query_property</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">email</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">email</span> <span class="o">=</span> <span class="n">email</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&#39;&lt;User </span><span class="si">%r</span><span class="s">&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<span class="n">users</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s">&#39;users&#39;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span>
    <span class="n">Column</span><span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
    <span class="n">Column</span><span class="p">(</span><span class="s">&#39;name&#39;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span> <span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
    <span class="n">Column</span><span class="p">(</span><span class="s">&#39;email&#39;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="mi">120</span><span class="p">),</span> <span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">mapper</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="n">users</span><span class="p">)</span>
</pre></div>
</div>
<p>질의하고 추가하는 것은 위의 예제에서와 정확히 같게 동작한다.</p>
</div>
<div class="section" id="sql">
<h5>SQL 추상 계층<a class="headerlink" href="#sql" title="제목 주소">¶</a></h5>
<p>여러분이 단지 데이타베이스 시스템 (그리고 SQL) 추상 계층을 사용하고 싶다면
여러분은 기본적으로 단지 그 엔진만 필요한 것이다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">MetaData</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s">&#39;sqlite:////tmp/test.db&#39;</span><span class="p">,</span> <span class="n">convert_unicode</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">metadata</span> <span class="o">=</span> <span class="n">MetaData</span><span class="p">(</span><span class="n">bind</span><span class="o">=</span><span class="n">engine</span><span class="p">)</span>
</pre></div>
</div>
<p>그러면 여러분은 위의 예제에서 처럼 여러분의 코드에 테이블을 선언할 수 있거나,
자동으로 그것들을 적재할 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">users</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s">&#39;users&#39;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">autoload</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>데이타를 추가하기 위해서 여러분은 <cite>insert</cite> 메소드를 사용할 수 있다.
우리는 트랜젝션을 사용할 수 있도록 먼저 연결을 얻어야 한다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">insert</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;admin&#39;</span><span class="p">,</span> <span class="n">email</span><span class="o">=</span><span class="s">&#39;admin@localhost&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>SQLAlchemy는 자동으로 커밋을 할 것이다.</p>
<p>여러분의 데이타베이스에 질의하기 위해서, 여러분은 직접 엔진을 사용하거나
트랜잭션을 사용한다.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">users</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="go">(1, u&#39;admin&#39;, u&#39;admin@localhost&#39;)</span>
</pre></div>
</div>
<p>이런 결과들 또한 딕셔너리와 같은 튜플이다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">users</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>u&#8217;admin&#8217;</p>
<p>여러분은 또한 <code class="xref py py-meth docutils literal"><span class="pre">execute()</span></code> 메소드에
SQL 구문의 문자열을 넘길 수 있다.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s">&#39;select * from users where id = :1&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="go">(1, u&#39;admin&#39;, u&#39;admin@localhost&#39;)</span>
</pre></div>
</div>
<p>SQLAlchemy에 대해서 더 많은 정보는 <a class="reference external" href="http://sqlalchemy.org/">website</a> 로
넘어가면 된다.</p>
</div>
</div>
<span id="document-patterns/fileuploads"></span><div class="section" id="uploading-files">
<span id="id1"></span><h4>파일 업로드하기<a class="headerlink" href="#uploading-files" title="제목 주소">¶</a></h4>
<p>오 그렇다, 그리운 파일 업로드이다.  파일 업로드의 기본 방식은
실제로 굉장히 간단하다.  기본적으로 다음과 같이 동작한다:</p>
<ol class="arabic simple">
<li><code class="docutils literal"><span class="pre">&lt;form&gt;</span></code> 태그에 <code class="docutils literal"><span class="pre">enctype=multipart/form-data</span></code> 과 <code class="docutils literal"><span class="pre">&lt;input</span> <span class="pre">type=file&gt;</span></code>
을 넣는다.</li>
<li>어플리케이션이 요청 객체에 <code class="xref py py-attr docutils literal"><span class="pre">files</span></code> 딕셔너리로 부터 파일 객체에
접근한다.</li>
<li>파일시스템에 영구적으로 저장하기 위해 파일 객체의
<a class="reference external" href="http://werkzeug.pocoo.org/docs/datastructures/#werkzeug.datastructures.FileStorage.save" title="(in Werkzeug v0.11-dev)"><code class="xref py py-meth docutils literal"><span class="pre">save()</span></code></a> 메소드를 사용한다.</li>
</ol>
<div class="section" id="id2">
<h5>파일 업로드의 가벼운 소개<a class="headerlink" href="#id2" title="제목 주소">¶</a></h5>
<p>지정된 업로드 폴더에 파일을 업로드하고 사용자에게 파일을 보여주는 매우
간단한 어플리케이션으로 시작해보자:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">redirect</span><span class="p">,</span> <span class="n">url_for</span>
<span class="kn">from</span> <span class="nn">werkzeug</span> <span class="kn">import</span> <span class="n">secure_filename</span>

<span class="n">UPLOAD_FOLDER</span> <span class="o">=</span> <span class="s">&#39;/path/to/the/uploads&#39;</span>
<span class="n">ALLOWED_EXTENSIONS</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="s">&#39;txt&#39;</span><span class="p">,</span> <span class="s">&#39;pdf&#39;</span><span class="p">,</span> <span class="s">&#39;png&#39;</span><span class="p">,</span> <span class="s">&#39;jpg&#39;</span><span class="p">,</span> <span class="s">&#39;jpeg&#39;</span><span class="p">,</span> <span class="s">&#39;gif&#39;</span><span class="p">])</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&#39;UPLOAD_FOLDER&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">UPLOAD_FOLDER</span>
</pre></div>
</div>
<p>자 첫번째로 몇 가지 패키지를 임포트해야한다.  대부분 직관적이지만,
<code class="xref py py-func docutils literal"><span class="pre">werkzeug.secure_filename()</span></code> 은 나중에 약간 설명이 더 필요하다.
<cite>UPLOAD_FOLDER</cite> 는 업로드된 파일이 저장되는 것이고 <cite>ALLOWED_EXTENSIONS</cite> 은
허용할 파일의 확장자들이다.  그리고 나면 보통은 어플리케이션에 직접 URL
규칙을 추가하는데 여기서는 그렇게 하지 않을 것이다.  왜 여기서는 하지 않는가?
왜냐하면 우리가 사용하는 웹서버 (또는 개발 서버) 가 이런 파일을 업로드하는
역할도 하기 때문에 이 파일에 대한 URL을 생성하기 위한 규칙만 필요로 한다.</p>
<p>왜 허용할 파일 확장자를 제한하는가?  서버가 클라이언트로 직접 데이타를 전송한다면
여러분은 아마도 사용자가 그 서버에 뭐든지 올릴 수 있는 것을 원하지 않을 것이다.
그런 방식으로 여러분은 사용자가 XSS 문제 (<a class="reference internal" href="index.html#xss"><span>Cross-Site Scripting (XSS)</span></a>) 를 야기할 수도 있는
HTML 파일을 업로드하지 못하도록 할 수 있다.  또한 서버가 <cite>.php</cite> 파일과 같은
스크립트를 실행할 수 있다면 그 파일 또한 허용하지 말아야 한다. 하지만, 누가
이 서버에 PHP를 설치하겠는가, 그렇지 않은가?  :)</p>
<p>다음은 확장자가 유효한지 확인하고 파일을 업로드하고 업로드된 파일에 대한 URL로
사용자를 리디렉션하는 함수들이다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">allowed_file</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="k">return</span> <span class="s">&#39;.&#39;</span> <span class="ow">in</span> <span class="n">filename</span> <span class="ow">and</span> \
           <span class="n">filename</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">ALLOWED_EXTENSIONS</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">,</span> <span class="s">&#39;POST&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">upload_file</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s">&#39;POST&#39;</span><span class="p">:</span>
        <span class="nb">file</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="s">&#39;file&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">file</span> <span class="ow">and</span> <span class="n">allowed_file</span><span class="p">(</span><span class="nb">file</span><span class="o">.</span><span class="n">filename</span><span class="p">):</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">secure_filename</span><span class="p">(</span><span class="nb">file</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
            <span class="nb">file</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&#39;UPLOAD_FOLDER&#39;</span><span class="p">],</span> <span class="n">filename</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s">&#39;uploaded_file&#39;</span><span class="p">,</span>
                                    <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">))</span>
    <span class="k">return</span> <span class="s">&#39;&#39;&#39;</span>
<span class="s">    &lt;!doctype html&gt;</span>
<span class="s">    &lt;title&gt;Upload new File&lt;/title&gt;</span>
<span class="s">    &lt;h1&gt;Upload new File&lt;/h1&gt;</span>
<span class="s">    &lt;form action=&quot;&quot; method=post enctype=multipart/form-data&gt;</span>
<span class="s">      &lt;p&gt;&lt;input type=file name=file&gt;</span>
<span class="s">         &lt;input type=submit value=Upload&gt;</span>
<span class="s">    &lt;/form&gt;</span>
<span class="s">    &#39;&#39;&#39;</span>
</pre></div>
</div>
<p>그렇다면 이 <a class="reference external" href="http://werkzeug.pocoo.org/docs/utils/#werkzeug.utils.secure_filename" title="(in Werkzeug v0.11-dev)"><code class="xref py py-func docutils literal"><span class="pre">secure_filename()</span></code></a> 함수는 실제로 무엇을 하는건가?
이제 문제는 &#8220;절대로 사용자의 입력을 믿지마라&#8221; 라고 불리우는 원칙에 있다.
이것은 또한 업로드된 파일명에 대해서도 적용된다. 모든 전송된 폼 데이타는
위조될 수 있고, 그래서 파일명이 위험할 수도 있다.  잠시동안 기억해보자:
파일시스템에 직접 파일을 저장하기 전에 파일명을 보호하기 위해 항상 이 함수를
사용하자.</p>
<div class="admonition-information-for-the-pros admonition">
<p class="first admonition-title">Information for the Pros 장점에 대한 정보</p>
<p>그래서 여러분은 <a class="reference external" href="http://werkzeug.pocoo.org/docs/utils/#werkzeug.utils.secure_filename" title="(in Werkzeug v0.11-dev)"><code class="xref py py-func docutils literal"><span class="pre">secure_filename()</span></code></a> 함수가 하는 것에
관심이 있고 그 함수를 사용하지 않는다면 무슨 문제가 있는가?  그렇다면 어떤 사람이
여러분의 어플리케이션에 <a href="#id3"><span class="problematic" id="id4">`</span></a>filename`으로 다음과 같은 정보를 보낸다고 생각해보자:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">filename</span> <span class="o">=</span> <span class="s">&quot;../../../../home/username/.bashrc&quot;</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">../</span></code> 의 개수가 맞게 되있고 이것과 <cite>UPLOAD_FOLDER</cite> 와 더한다고 가정하면
사용자는 수정하면 않아야하는 서버의 파일시스템에 있는 파일을 수정할 수 있게
된다.  이것은 어플리케이션이 어떻게 생겼는가에 대한 약간의 정보를 요구하지만,
나를 믿어라, 해커들은 참을성이 많다 :)</p>
<p>이제 이 함수가 동작하는 것을 살펴보자:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">secure_filename</span><span class="p">(</span><span class="s">&#39;../../../../home/username/.bashrc&#39;</span><span class="p">)</span>
<span class="go">&#39;home_username_.bashrc&#39;</span>
</pre></div>
</div>
</div>
<p>지금 한가지 마지막으로 놓친것이 있다: 업로드된 파일의 제공. 플라스크 0.5에
관해서 우리는 업로드된 파일을 받을 수 있는 함수를 사용할 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">send_from_directory</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/uploads/&lt;filename&gt;&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">uploaded_file</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">send_from_directory</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&#39;UPLOAD_FOLDER&#39;</span><span class="p">],</span>
                               <span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
<p>다른방법으로 여러분은 <cite>build_only</cite> 로써 <cite>uploaded_file</cite> 을 등록하고
<a class="reference external" href="http://werkzeug.pocoo.org/docs/middlewares/#werkzeug.wsgi.SharedDataMiddleware" title="(in Werkzeug v0.11-dev)"><code class="xref py py-class docutils literal"><span class="pre">SharedDataMiddleware</span></code></a> 를 사용할 수 있다.  이것은
또한 플라스크의 지난 과거 버전에서도 동작한다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">werkzeug</span> <span class="kn">import</span> <span class="n">SharedDataMiddleware</span>
<span class="n">app</span><span class="o">.</span><span class="n">add_url_rule</span><span class="p">(</span><span class="s">&#39;/uploads/&lt;filename&gt;&#39;</span><span class="p">,</span> <span class="s">&#39;uploaded_file&#39;</span><span class="p">,</span>
                 <span class="n">build_only</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">wsgi_app</span> <span class="o">=</span> <span class="n">SharedDataMiddleware</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">wsgi_app</span><span class="p">,</span> <span class="p">{</span>
    <span class="s">&#39;/uploads&#39;</span><span class="p">:</span>  <span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&#39;UPLOAD_FOLDER&#39;</span><span class="p">]</span>
<span class="p">})</span>
</pre></div>
</div>
<p>여러분 이제 이 어플리케이션을 실행하면 기대하는데로 모든 것이 동작해야
할 것이다.</p>
</div>
<div class="section" id="id5">
<h5>업로드 개선하기<a class="headerlink" href="#id5" title="제목 주소">¶</a></h5>
<div class="versionadded">
<p><span class="versionmodified">버전 0.6에 추가.</span></p>
</div>
<p>그렇다면 정확히 플라스크가 업로드를 어떻게 처리한다는 것인가?  플라스크는
업로드된 파일이 적당히 작다면 웹서버의 메모리에 저장하고 그렇지 않다면
웹서버의 임시 장소 (<a class="reference external" href="http://docs.python.org/dev/library/tempfile.html#tempfile.gettempdir" title="(in Python v3.6)"><code class="xref py py-func docutils literal"><span class="pre">tempfile.gettempdir()</span></code></a>) 저장할 것이다.  그러나
여러분은 어떻게 업로드를 중단된 후에 최대 파일 크기를 지정할 수 있는가?
기본으로 플라스크는 제한되지 않은 메모리까지 파일 업로드를 허용할 것이지만,
여러분은 <code class="docutils literal"><span class="pre">MAX_CONTENT_LENGTH</span></code> 설정 키값을 설정하여 크기를 제한할 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">Request</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&#39;MAX_CONTENT_LENGTH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">16</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span>
</pre></div>
</div>
<p>위의 코드는 허용되는 최대 파일 크기를 16메가바이트로 제한할 것이다.
그 최대 크기보다 더 큰 파일이 업로드되면, 플라스크는
<a class="reference external" href="http://werkzeug.pocoo.org/docs/exceptions/#werkzeug.exceptions.RequestEntityTooLarge" title="(in Werkzeug v0.11-dev)"><code class="xref py py-exc docutils literal"><span class="pre">RequestEntityTooLarge</span></code></a> 예외를 발생시킬 것이다.</p>
<p>이 기능은 플라스크 0.6에서 추가됐지만, 요청 객체를 상속받아서 이전 버전에서
사용할 수도 있다.  더 많은 정보는 벡자이크(Werkzeug) 문서의 파일 처리(file handling)
을 검토해봐라.</p>
</div>
<div class="section" id="id6">
<h5>업로드 진행 상태바<a class="headerlink" href="#id6" title="제목 주소">¶</a></h5>
<p>얼마전에 많은 개발자들이 클라이언트에서 자바스크립트로 업로드 진행 상태를
받아올 수 있도록 작은 단위로 유입되는 파일을 읽어서 데이터베이스에 진행 상태를
저장하는 방식을 생각했다.  짧게 얘기하자면: 클라이언트가 서버에 5초마다 얼마나
전송됐는지 묻는다.  얼마나 아이러니인지 알겠는가?  클리언트는 이미 자신이 알고
있는 사실을 묻고 있는 것이다.</p>
<p>이제 더 빠르고 안정적으로 동작하는 더 좋은 해결책이 있다.  웹은 최근에 많은
변화가 있었고 여러분은 HTML5, Java, Silverlight 나 Flash 을 사용해서 클라이언트에서
더 좋은 업로드 경험을 얻을 수 있다.  다음 라이브러리들은 그런 작업을 할 수 있는
몇 가지 좋은 예제들을 보여준다:</p>
<ul class="simple">
<li><a class="reference external" href="http://www.plupload.com/">Plupload</a> - HTML5, Java, Flash</li>
<li><a class="reference external" href="http://www.swfupload.org/">SWFUpload</a> - Flash</li>
<li><a class="reference external" href="http://jumploader.com/">JumpLoader</a> - Java</li>
</ul>
</div>
<div class="section" id="id7">
<h5>더 쉬운 해결책<a class="headerlink" href="#id7" title="제목 주소">¶</a></h5>
<p>업로드를 다루는 모든 어플리케이션에서 파일 업로드에 대한 일반적인 패턴은
거의 변화가 없었기 때문에, 파일 확장자에 대한 화이트/블랙리스트와 다른 많은 기능을
제공하는 업로드 메커니즘을 구현한 <a class="reference external" href="http://packages.python.org/Flask-Uploads/">Flask-Uploads</a> 라는 플라스크 확장이 있다.</p>
</div>
</div>
<span id="document-patterns/caching"></span><div class="section" id="caching">
<span id="caching-pattern"></span><h4>캐싱(Caching)<a class="headerlink" href="#caching" title="제목 주소">¶</a></h4>
<p>여러분의 어플리케이션이 느린 경우, 일종의 캐시를 넣어봐라.  그것이
속도를 높이는 최소한의 가장 쉬운 방법이다.  캐시가 무엇을 하는가?
여러분이 수행을 마치는데 꽤 시간이 걸리는 함수를 갖고 있지만 결과가
실시간이 아닌 5분이 지난 결과도 괜찮다고 하자.  그렇다면 여러분은
그 시간동안 결과를 캐시에 넣어두고 사용해도 좋다는게 여기의 생각이다.</p>
<p>플라스크 그 자체는 캐시를 제공하지 않지만, 플라스크의 토대가 되는
라이브러중 하나인 벡자이크(Werkzeug)는 굉장히 기본적인 캐시를 지원한다.
보통은 여러분이 memchached 서버로 사용하고 싶은
다중 캐시 백엔드를 지원한다.</p>
<div class="section" id="id1">
<h5>캐시 설정하기<a class="headerlink" href="#id1" title="제목 주소">¶</a></h5>
<p>여러분은 <a class="reference internal" href="index.html#flask.Flask" title="flask.Flask"><code class="xref py py-class docutils literal"><span class="pre">Flask</span></code></a> 을 생성하는 방법과 유사하게 캐시 객체를
일단 생성하고 유지한다.  여러분이 개발 서버를 사용하고 있따면 여러분은
<a class="reference external" href="http://werkzeug.pocoo.org/docs/contrib/cache/#werkzeug.contrib.cache.SimpleCache" title="(in Werkzeug v0.11-dev)"><code class="xref py py-class docutils literal"><span class="pre">SimpleCache</span></code></a> 객체를 생성할 수 있고,
그 객체는 파이썬 인터프리터의 메모리에 캐시의 항목을 저장하는 간단한 캐시다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">werkzeug.contrib.cache</span> <span class="kn">import</span> <span class="n">SimpleCache</span>
<span class="n">cache</span> <span class="o">=</span> <span class="n">SimpleCache</span><span class="p">()</span>
</pre></div>
</div>
<p>여러분이 memcached를 사용하고 싶다면, 지원되는 memcache 모듈중 하나를 갖고
(<a class="reference external" href="http://pypi.python.org/">PyPI</a> 에서 얻음) 어디선가 memcached 서버가
동작하는 것을 보장해라.  그리고 나면 아래의 방식으로 memcached 서버에
연결하면 된다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">werkzeug.contrib.cache</span> <span class="kn">import</span> <span class="n">MemcachedCache</span>
<span class="n">cache</span> <span class="o">=</span> <span class="n">MemcachedCache</span><span class="p">([</span><span class="s">&#39;127.0.0.1:11211&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>여러분이 App 엔진을 사용한다면, 손쉽게 App 엔진 ememcache 서버에 연결할
수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">werkzeug.contrib.cache</span> <span class="kn">import</span> <span class="n">GAEMemcachedCache</span>
<span class="n">cache</span> <span class="o">=</span> <span class="n">GAEMemcachedCache</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h5>캐시 사용하기<a class="headerlink" href="#id2" title="제목 주소">¶</a></h5>
<p>캐시는 어떻게 사용할 수 있을까?  두가지 굉장히 중요한 함수가 있다:
<a class="reference external" href="http://werkzeug.pocoo.org/docs/contrib/cache/#werkzeug.contrib.cache.BaseCache.get" title="(in Werkzeug v0.11-dev)"><code class="xref py py-meth docutils literal"><span class="pre">get()</span></code></a> 과
<a class="reference external" href="http://werkzeug.pocoo.org/docs/contrib/cache/#werkzeug.contrib.cache.BaseCache.set" title="(in Werkzeug v0.11-dev)"><code class="xref py py-meth docutils literal"><span class="pre">set()</span></code></a> 이다.  아래는 사용 방법이다:</p>
<p>캐시에서 항목을 얻기 위해서는 문자열로 된 키 명으로
<a class="reference external" href="http://werkzeug.pocoo.org/docs/contrib/cache/#werkzeug.contrib.cache.BaseCache.get" title="(in Werkzeug v0.11-dev)"><code class="xref py py-meth docutils literal"><span class="pre">get()</span></code></a> 를 호출하면 된다. 캐시에 그 키에
값이 있따면, 그 값이 반환된다.  없다면 <a href="#id3"><span class="problematic" id="id4">`</span></a>None`이 반환될 것이다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">rv</span> <span class="o">=</span> <span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;my-item&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>캐시에 항목을 넣기 위해서는, <a class="reference external" href="http://werkzeug.pocoo.org/docs/contrib/cache/#werkzeug.contrib.cache.BaseCache.set" title="(in Werkzeug v0.11-dev)"><code class="xref py py-meth docutils literal"><span class="pre">set()</span></code></a> 를
사용하면 된다.  첫번째 인자는 키이고 두번째는 설정할 값이다.  타임아웃 또한
항목으로 넣을 수가 있는데 그 시간이 지나면 캐시에서 자동으로 그 항목은 삭제된다.</p>
<p>아래는 보통 정상적으로 사용되는 전체 예제이다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">get_my_item</span><span class="p">():</span>
    <span class="n">rv</span> <span class="o">=</span> <span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;my-item&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">rv</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">calculate_value</span><span class="p">()</span>
        <span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&#39;my-item&#39;</span><span class="p">,</span> <span class="n">rv</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">5</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rv</span>
</pre></div>
</div>
</div>
</div>
<span id="document-patterns/viewdecorators"></span><div class="section" id="view-decorators">
<h4>뷰 데코레이터(View Decorators)<a class="headerlink" href="#view-decorators" title="제목 주소">¶</a></h4>
<p>파이썬에는 함수 데코레이터라 불리는 꽤 흥미로운 기능이 있다.  이 기능은
웹 어플리케이션에서 정말 깔끔한 기능을 허용한다.  플라스크 각 뷰는 한 개
이상의 함수에 추가적인 기능을 주입하는데 사용될 수 있는 함수 데코레이터
이기 때문인다.  여러분은 이미 <a class="reference internal" href="index.html#flask.Flask.route" title="flask.Flask.route"><code class="xref py py-meth docutils literal"><span class="pre">route()</span></code></a> 데코레이터를
사용했을 것이다.  하지만 여러분 자신만의 데코레이터를 구현하는 몇가지
사용법이 있다.  예를 들면, 로그인한 사람들에게만 사용되야하는 뷰가 있다고
하자.  사용자가 해당 사이트로 가서 로그인 하지 않았다면, 그 사용자는
로그인 페이지로 리디렉션 되어야한다.  이런 상황이 데코레이터가 훌륭한
해결책이 되는 사용법의 좋은 예이다.</p>
<div class="section" id="id1">
<h5>로그인이 필수적인 데코레이터<a class="headerlink" href="#id1" title="제목 주소">¶</a></h5>
<p>자 그렇다면 그런 데코레이터를 구현해보자.  데코레이터는 함수를 반환하는
함수이다.  사실 꽤 간단한 개념이다.  이런것을 구현할 때 꼭 유념해야할
것은 <cite>__name__</cite>, <cite>__module__</cite> 그리고 함수의 몇 가지 다른 속성들이다.
이런 것을 자주 잊곤하는데, 수동으로 그것을 할 필요는 없고, 그것을 해주는
데코레이터처럼 사용되는 함수가 있다 (<a class="reference external" href="http://docs.python.org/dev/library/functools.html#functools.wraps" title="(in Python v3.6)"><code class="xref py py-func docutils literal"><span class="pre">functools.wraps()</span></code></a>).</p>
<p>이 예제는 로그인 페이지를 <code class="docutils literal"><span class="pre">login</span></code> 이라하고 현재 사용자는 <cite>g.user</cite> 로
저장돼있으며 로그인되지 않았다면 <cite>None</cite> 이 저장된다고 가정한다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">wraps</span>
<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">g</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">redirect</span><span class="p">,</span> <span class="n">url_for</span>

<span class="k">def</span> <span class="nf">login_required</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="nd">@wraps</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">decorated_function</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">g</span><span class="o">.</span><span class="n">user</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s">&#39;login&#39;</span><span class="p">,</span> <span class="nb">next</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">decorated_function</span>
</pre></div>
</div>
<p>그렇다면 여러분은 여기서 그 데코레이터를 어떻게 사용하겠는가?  뷰 함수의
가장 안쪽에 있는 데코레이터로 사용하면 된다.  더 나아가서 적용할 때,
<a class="reference internal" href="index.html#flask.Flask.route" title="flask.Flask.route"><code class="xref py py-meth docutils literal"><span class="pre">route()</span></code></a> 데코레이터가 가장 바깥에 있다는 것을 기억해라:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/secret_page&#39;</span><span class="p">)</span>
<span class="nd">@login_required</span>
<span class="k">def</span> <span class="nf">secret_page</span><span class="p">():</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h5>캐싱 데코레이터<a class="headerlink" href="#id2" title="제목 주소">¶</a></h5>
<p>여러분이 시간이 많이 소요되는 계산을 하는 뷰 함수를 가지고 있고 그것 때문에
일정 시간동안 계산된 결과를 캐시하고 싶다고 생각해보자.  이런 경우 데코레이터가
멋지게 적용될 수 있다. 우리는 여러분이 <a class="reference internal" href="index.html#caching-pattern"><span>캐싱(Caching)</span></a> 라 언급한 캐시를
만든다고 가정할 것이다.</p>
<p>여기에 캐시 함수의 예제가 있다.  그 캐시 함수는 특정 접두어(형식이 있는 문자열)
로부터 캐시 키와 요청에 대한 현재 경로를 생성한다.  먼저 함수 자체를 데코레이트하는
데코레이터를 먼저 생성하는 함수를 사용하고 있다는 것에 주목해라.  끔찍하게
들리는가?  불행히도 약간 더 복잡하지만, 그 코드는 읽기엔 여전히 직관적일 것이다.</p>
<p>데코레이트된 함수는 다음과 같이 동작할 것이다</p>
<ol class="arabic simple">
<li>현재 경로에 기반한 현재 요청에 대한 유일한 캐시 키를 얻는다.</li>
<li>캐시에서 그 키에 대한 값을 얻는다.  캐시가 어떤값을 반환하면
우리는 그 값을 반환할 것이다.</li>
<li>그 밖에는 원본 함수가 호출되고 반환값은 주어진 타임아웃
(기본값 5분) 동안 캐시에 저장된다.</li>
</ol>
<p>여기 코드가 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">wraps</span>
<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">request</span>

<span class="k">def</span> <span class="nf">cached</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">5</span> <span class="o">*</span> <span class="mi">60</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s">&#39;view/</span><span class="si">%s</span><span class="s">&#39;</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="nd">@wraps</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">decorated_function</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="n">cache_key</span> <span class="o">=</span> <span class="n">key</span> <span class="o">%</span> <span class="n">request</span><span class="o">.</span><span class="n">path</span>
            <span class="n">rv</span> <span class="o">=</span> <span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cache_key</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">rv</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">rv</span>
            <span class="n">rv</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">cache_key</span><span class="p">,</span> <span class="n">rv</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">rv</span>
        <span class="k">return</span> <span class="n">decorated_function</span>
    <span class="k">return</span> <span class="n">decorator</span>
</pre></div>
</div>
<p>이 함수는 인스턴스화된 <cite>cache</cite> 객체가 사용 가능하다고 가정한다는 것에
주목하고, 더 많은 정보는 <a class="reference internal" href="index.html#caching-pattern"><span>캐싱(Caching)</span></a> 을 살펴봐라.</p>
</div>
<div class="section" id="id3">
<h5>데코레이터를 템플화하기<a class="headerlink" href="#id3" title="제목 주소">¶</a></h5>
<p>일전에 터보기어스(TurboGears) 친구들이 고안한 공통 패턴이 데코레이터
템플릿화이다.  그 데코레이터의 방식은 여러분은 뷰 함수로부터 템플릿에
넘겨질 값들을 가진 딕셔너리를 반환하고 그 템플릿은 자동으로 값을
화면에 뿌려준다.  그 템플릿으로, 아래 세가지 예제는 정확히 같은 동작을
한다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">&#39;index.html&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)</span>
<span class="nd">@templated</span><span class="p">(</span><span class="s">&#39;index.html&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)</span>
<span class="nd">@templated</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
<p>여러분이 볼 수 있는 것처럼, 템플릿 명이 없다면 URL 맵의 끝점의 점(dot)을
슬래쉬(/)로 바꾸고 <code class="docutils literal"><span class="pre">'.html'</span></code> 을 더해서 사용할 것이다.  데코레이트된
함수가 반환할 때, 반환된 딕셔너리는 템플릿 렌더링 함수에 넘겨진다.
<cite>None</cite> 이 반환되고, 빈 딕셔너리를 가정한다면, 딕셔너리가 아닌 다른 것이
반환된다면 우리는 변경되지 않는 함수에서 그것을 반환한다. 그 방식으로
여러분은 여전히 리디렉트 함수를 사용하거나 간단한 문자열을 반환할 수 있다.</p>
<p>여기 그 데코레이터에 대한 코드가 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">wraps</span>
<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">request</span>

<span class="k">def</span> <span class="nf">templated</span><span class="p">(</span><span class="n">template</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="nd">@wraps</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">decorated_function</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="n">template_name</span> <span class="o">=</span> <span class="n">template</span>
            <span class="k">if</span> <span class="n">template_name</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">template_name</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">endpoint</span> \
                    <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">,</span> <span class="s">&#39;/&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;.html&#39;</span>
            <span class="n">ctx</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ctx</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">ctx</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">ctx</span>
            <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="n">template_name</span><span class="p">,</span> <span class="o">**</span><span class="n">ctx</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">decorated_function</span>
    <span class="k">return</span> <span class="n">decorator</span>
</pre></div>
</div>
</div>
<div class="section" id="endpoint">
<h5>끝점(Endpoint) 데코레이터<a class="headerlink" href="#endpoint" title="제목 주소">¶</a></h5>
<p>여러분이 더 유연함을 제공하는 벡자이크 라우팅 시스템을 사용하고 싶을 때
여러분은 <a class="reference external" href="http://werkzeug.pocoo.org/docs/routing/#werkzeug.routing.Rule" title="(in Werkzeug v0.11-dev)"><code class="xref py py-class docutils literal"><span class="pre">Rule</span></code></a> 에 정의된 것 처럼 끝점을 뷰 함수와
맞출(map) 필요가 있다. 이것은 이 끝점 데코레이터와 함께 사용하여 가능하다.
예를 들면:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
<span class="kn">from</span> <span class="nn">werkzeug.routing</span> <span class="kn">import</span> <span class="n">Rule</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">url_map</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Rule</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="s">&#39;index&#39;</span><span class="p">))</span>

<span class="nd">@app.endpoint</span><span class="p">(</span><span class="s">&#39;index&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">my_index</span><span class="p">():</span>
    <span class="k">return</span> <span class="s">&quot;Hello world&quot;</span>
</pre></div>
</div>
</div>
</div>
<span id="document-patterns/wtforms"></span><div class="section" id="wtforms">
<h4>WTForms를 가지고 폼 유효성 확인하기<a class="headerlink" href="#wtforms" title="제목 주소">¶</a></h4>
<p>여러분이 브라우저에서 전송되는 폼 데이타를 가지고 작업해야할 때
곧 뷰 코드는 읽기가 매우 어려워진다.  이 과정을 더 쉽게 관리할 수 있도록
설계된 라이브러리들이 있다.  그것들 중 하나가 우리가 여기서 다룰 예정인
<a class="reference external" href="http://wtforms.simplecodes.com/">WTForms</a>  이다.  여러분이 많은 폼을 갖는 상황에 있다면, 이것을 한번
시도해보길 원할지도 모른다.</p>
<p>여러분이 WTForms로 작업하고 있을 때 여러분은 먼저 클래스로 그 폼들을
정의해야한다.  어플리케이션을 여러 모듈로 쪼개고 (<a class="reference internal" href="index.html#larger-applications"><span>더 큰 어플케이션들</span></a>)
폼에 대한 분리된 모듈을 추가하는 것을 권고한다.</p>
<div class="admonition-wtforms admonition">
<p class="first admonition-title">확장을 가지고 대부분의 WTForms 얻기</p>
<p class="last"><a class="reference external" href="http://packages.python.org/Flask-WTF/">Flask-WTF</a> 확장은 이 패턴을 확대하고 폼과 작업하면서 플라스크를 더
재밌게 만드는 몇가지 유효한 작은 헬퍼들을 추가한다.  여러분은 <a class="reference external" href="http://pypi.python.org/pypi/Flask-WTF">PyPI</a> 에서 그 확장을 얻을 수 있다.</p>
</div>
<div class="section" id="forms">
<h5>폼(Forms)<a class="headerlink" href="#forms" title="제목 주소">¶</a></h5>
<p>이것은 전형적인 등록 페이지에 대한 예제 폼이다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">wtforms</span> <span class="kn">import</span> <span class="n">Form</span><span class="p">,</span> <span class="n">BooleanField</span><span class="p">,</span> <span class="n">TextField</span><span class="p">,</span> <span class="n">PasswordField</span><span class="p">,</span> <span class="n">validators</span>

<span class="k">class</span> <span class="nc">RegistrationForm</span><span class="p">(</span><span class="n">Form</span><span class="p">):</span>
    <span class="n">username</span> <span class="o">=</span> <span class="n">TextField</span><span class="p">(</span><span class="s">&#39;Username&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">validators</span><span class="o">.</span><span class="n">Length</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">25</span><span class="p">)])</span>
    <span class="n">email</span> <span class="o">=</span> <span class="n">TextField</span><span class="p">(</span><span class="s">&#39;Email Address&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">validators</span><span class="o">.</span><span class="n">Length</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">35</span><span class="p">)])</span>
    <span class="n">password</span> <span class="o">=</span> <span class="n">PasswordField</span><span class="p">(</span><span class="s">&#39;New Password&#39;</span><span class="p">,</span> <span class="p">[</span>
        <span class="n">validators</span><span class="o">.</span><span class="n">Required</span><span class="p">(),</span>
        <span class="n">validators</span><span class="o">.</span><span class="n">EqualTo</span><span class="p">(</span><span class="s">&#39;confirm&#39;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s">&#39;Passwords must match&#39;</span><span class="p">)</span>
    <span class="p">])</span>
    <span class="n">confirm</span> <span class="o">=</span> <span class="n">PasswordField</span><span class="p">(</span><span class="s">&#39;Repeat Password&#39;</span><span class="p">)</span>
    <span class="n">accept_tos</span> <span class="o">=</span> <span class="n">BooleanField</span><span class="p">(</span><span class="s">&#39;I accept the TOS&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">validators</span><span class="o">.</span><span class="n">Required</span><span class="p">()])</span>
</pre></div>
</div>
</div>
<div class="section" id="in-the-view">
<h5>뷰 안에서(In the View)<a class="headerlink" href="#in-the-view" title="제목 주소">¶</a></h5>
<p>뷰 함수에서, 이 폼의 사용은 이것 처럼 보인다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/register&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">,</span> <span class="s">&#39;POST&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">register</span><span class="p">():</span>
    <span class="n">form</span> <span class="o">=</span> <span class="n">RegistrationForm</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s">&#39;POST&#39;</span> <span class="ow">and</span> <span class="n">form</span><span class="o">.</span><span class="n">validate</span><span class="p">():</span>
        <span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="p">(</span><span class="n">form</span><span class="o">.</span><span class="n">username</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">form</span><span class="o">.</span><span class="n">email</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                    <span class="n">form</span><span class="o">.</span><span class="n">password</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="n">db_session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
        <span class="n">flash</span><span class="p">(</span><span class="s">&#39;Thanks for registering&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s">&#39;login&#39;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">&#39;register.html&#39;</span><span class="p">,</span> <span class="n">form</span><span class="o">=</span><span class="n">form</span><span class="p">)</span>
</pre></div>
</div>
<p>뷰가 SQLAlchemy (<a class="reference internal" href="index.html#sqlalchemy-pattern"><span>Flask에서 SQLAlchemy 사용하기</span></a>) 를 사용한다고 가정하지만,
물론 필수조건은 아니라는 사실을 염두해라. 필요에 따라 코드를 수정해라.</p>
<p>기억할 것 :</p>
<ol class="arabic simple">
<li>HTTP <cite>POST</cite> 메소드로 데이터가 전송됐다면 요청의 <code class="xref py py-attr docutils literal"><span class="pre">form</span></code>
값으로 부터 폼을 생성하고 <cite>GET</cite> 으로 전송됐다면 <code class="xref py py-attr docutils literal"><span class="pre">args</span></code>
에서 폼을 생성한다.</li>
<li>데이터를 검증하기 위해서, <code class="xref py py-func docutils literal"><span class="pre">validate()</span></code> 메소드
를 호출하고 데이터가 유효하면 <a href="#id1"><span class="problematic" id="id2">`</span></a>True`를 얻고 유효하지 않으면 <a href="#id3"><span class="problematic" id="id4">`</span></a>False`를
얻을 것이다.</li>
<li>폼에서 개별 값에 접근하기 위해서, <cite>form.&lt;NAME&gt;.data</cite> 으로 접근한다.</li>
</ol>
</div>
<div class="section" id="id5">
<h5>템플릿에 있는 폼<a class="headerlink" href="#id5" title="제목 주소">¶</a></h5>
<p>이제 템플릿 측면에서 살펴보자.  여러분이 템플릿에 폼을 넘겨주면 그 폼을
템플릿에서 쉽게 뿌려줄 수 있다.  이런 방식이 얼마나 쉽게 되는지 보기 위해
다음 템플릿 예제를 보자.  WTForms 가 이미 폼 생성의 반을 처리했다.  조금 더
멋지게 만들기 위해서, 우리는 레이블과 오류가 발생한다면 오류의 목록까지 가진
필드를 그려줄 매크로(macro)를 작성할 수 있다.</p>
<p>여기 그런 방식의 메크로를 가진 예제인 <cite>_formhelpers.html</cite> 템플릿이 있다:</p>
<div class="highlight-html+jinja"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">macro</span> <span class="nv">render_field</span><span class="o">(</span><span class="nv">field</span><span class="o">)</span> <span class="cp">%}</span>
  <span class="nt">&lt;dt&gt;</span><span class="cp">{{</span> <span class="nv">field.label</span> <span class="cp">}}</span>
  <span class="nt">&lt;dd&gt;</span><span class="cp">{{</span> <span class="nv">field</span><span class="o">(**</span><span class="nv">kwargs</span><span class="o">)|</span><span class="nf">safe</span> <span class="cp">}}</span>
  <span class="cp">{%</span> <span class="k">if</span> <span class="nv">field.errors</span> <span class="cp">%}</span>
    <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">errors</span><span class="nt">&gt;</span>
    <span class="cp">{%</span> <span class="k">for</span> <span class="nv">error</span> <span class="k">in</span> <span class="nv">field.errors</span> <span class="cp">%}</span>
      <span class="nt">&lt;li&gt;</span><span class="cp">{{</span> <span class="nv">error</span> <span class="cp">}}</span><span class="nt">&lt;/li&gt;</span>
    <span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
    <span class="nt">&lt;/ul&gt;</span>
  <span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
  <span class="nt">&lt;/dd&gt;</span>
<span class="cp">{%</span> <span class="k">endmacro</span> <span class="cp">%}</span>
</pre></div>
</div>
<p>이 매크로는 필드를 뿌리는 WTForm의 필드 함수로 넘겨지는 몇가지 키워드
인자를 허용한다.  그 키워드 인자는 HTML 속성으로 추가될 것이다.  그래서
예를 들면 여러분은 입력 요소에 클래스(class)를 추가하기 위해
<code class="docutils literal"><span class="pre">render_field(form.username,</span> <span class="pre">class='username')</span></code> 를 호출할 수 있다.
WTForms는 표준 파이썬 유니코드 문자열을 반환하므로 우리는 진자2(Jinja2)에
<cite>|safe</cite> 필터를 가지고 이 데이터를 이미 HTML 이스케이프처리 하게 해야한다
는 것에 주목해라.</p>
<p>아래는 <cite>_formhelpers.html</cite> 템플릿을 이용해서 위에서 사용된 함수로 만든
<cite>register.html</cite> 템플릿이다:</p>
<div class="highlight-html+jinja"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">from</span> <span class="s2">&quot;_formhelpers.html&quot;</span> <span class="k">import</span> <span class="nv">render_field</span> <span class="cp">%}</span>
<span class="nt">&lt;form</span> <span class="na">method=</span><span class="s">post</span> <span class="na">action=</span><span class="s">&quot;/register&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;dl&gt;</span>
    <span class="cp">{{</span> <span class="nv">render_field</span><span class="o">(</span><span class="nv">form.username</span><span class="o">)</span> <span class="cp">}}</span>
    <span class="cp">{{</span> <span class="nv">render_field</span><span class="o">(</span><span class="nv">form.email</span><span class="o">)</span> <span class="cp">}}</span>
    <span class="cp">{{</span> <span class="nv">render_field</span><span class="o">(</span><span class="nv">form.password</span><span class="o">)</span> <span class="cp">}}</span>
    <span class="cp">{{</span> <span class="nv">render_field</span><span class="o">(</span><span class="nv">form.confirm</span><span class="o">)</span> <span class="cp">}}</span>
    <span class="cp">{{</span> <span class="nv">render_field</span><span class="o">(</span><span class="nv">form.accept_tos</span><span class="o">)</span> <span class="cp">}}</span>
  <span class="nt">&lt;/dl&gt;</span>
  <span class="nt">&lt;p&gt;&lt;input</span> <span class="na">type=</span><span class="s">submit</span> <span class="na">value=</span><span class="s">Register</span><span class="nt">&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</pre></div>
</div>
<p>WTForms에 대한 더 많은 정보는, <a class="reference external" href="http://wtforms.simplecodes.com/">WTForms website</a> 로 가서 살펴봐라.</p>
</div>
</div>
<span id="document-patterns/templateinheritance"></span><div class="section" id="template-inheritance">
<span id="id1"></span><h4>템플릿 상속<a class="headerlink" href="#template-inheritance" title="제목 주소">¶</a></h4>
<p>진자(Jinja)의 가장 강력한 부분은 템플릿 상속 기능이다.  템플릿 상속은 여러분의 사이트에
대한 모든 일반적인 요소들을 포함한 기본 &#8220;스켈레톤(skeleton)&#8221; 템플릿을 생성하도록 하고
자식 템플릿은 기본 템플릿을 오버라이드(override)할 수 있는 <strong>blocks</strong> 을 정의한다.</p>
<p>복잡해 보이지만 꽤 간단하다.  예제로 시작하는게 이해하는데 가장 쉽다.</p>
<div class="section" id="id2">
<h5>기본 템플릿<a class="headerlink" href="#id2" title="제목 주소">¶</a></h5>
<p>우리가 <code class="docutils literal"><span class="pre">layout.html</span></code> 이라 부를 이 팀플릿은 간단한 두개의 칼럼을 가진 페이지로
사용할 간단한 HTML 스켈레톤 문서를 정의한다.  내용의 빈 블럭을 채우것이 &#8220;자식&#8221;
템플릿의 일이다:</p>
<div class="highlight-html+jinja"><div class="highlight"><pre><span class="cp">&lt;!doctype html&gt;</span>
<span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="cp">{%</span> <span class="k">block</span> <span class="nv">head</span> <span class="cp">%}</span>
    <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">url_for</span><span class="o">(</span><span class="s1">&#39;static&#39;</span><span class="o">,</span> <span class="nv">filename</span><span class="o">=</span><span class="s1">&#39;style.css&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;title&gt;</span><span class="cp">{%</span> <span class="k">block</span> <span class="nv">title</span> <span class="cp">%}{%</span> <span class="k">endblock</span> <span class="cp">%}</span> - My Webpage<span class="nt">&lt;/title&gt;</span>
    <span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
  <span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;content&quot;</span><span class="nt">&gt;</span><span class="cp">{%</span> <span class="k">block</span> <span class="nv">content</span> <span class="cp">%}{%</span> <span class="k">endblock</span> <span class="cp">%}</span><span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;footer&quot;</span><span class="nt">&gt;</span>
    <span class="cp">{%</span> <span class="k">block</span> <span class="nv">footer</span> <span class="cp">%}</span>
    <span class="ni">&amp;copy;</span> Copyright 2010 by <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;http://domain.invalid/&quot;</span><span class="nt">&gt;</span>you<span class="nt">&lt;/a&gt;</span>.
    <span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/body&gt;</span>
</pre></div>
</div>
<p>이 예제에서, <code class="docutils literal"><span class="pre">{%</span> <span class="pre">block</span> <span class="pre">%}</span></code> 태그는 자식 템플릿이 채울 수 있는 네개의 블럭을
정의한다. <cite>block</cite> 태그가 하는 전부는 템플릿 엔진에 자식 템플릿이 템플릿의 <cite>block</cite>
태그를 오버라이드할 수 도 있다라고 알려준다.</p>
</div>
<div class="section" id="id3">
<h5>자식 템플릿<a class="headerlink" href="#id3" title="제목 주소">¶</a></h5>
<p>자식 템플릿은 아래와 같이 보일 수도 있다:</p>
<div class="highlight-html+jinja"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">extends</span> <span class="s2">&quot;layout.html&quot;</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">block</span> <span class="nv">title</span> <span class="cp">%}</span>Index<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">block</span> <span class="nv">head</span> <span class="cp">%}</span>
  <span class="cp">{{</span> <span class="nb">super</span><span class="o">()</span> <span class="cp">}}</span>
  <span class="nt">&lt;style </span><span class="na">type=</span><span class="s">&quot;text/css&quot;</span><span class="nt">&gt;</span>
    <span class="nc">.important</span> <span class="p">{</span> <span class="k">color</span><span class="o">:</span> <span class="m">#336699</span><span class="p">;</span> <span class="p">}</span>
  <span class="nt">&lt;/style&gt;</span>
<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">block</span> <span class="nv">content</span> <span class="cp">%}</span>
  <span class="nt">&lt;h1&gt;</span>Index<span class="nt">&lt;/h1&gt;</span>
  <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">&quot;important&quot;</span><span class="nt">&gt;</span>
    Welcome on my awesome homepage.
<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">{%</span> <span class="pre">extends</span> <span class="pre">%}</span></code> 태그가 여기서 핵심이다.  이 태그는 템플릿 엔진에게 이 템플릿이
다른 템플릿을 &#8220;확장(extends)&#8221; 한다라고 알려준다.  템플릿 시스템이 이 템플릿을
검증할 때, 가장 먼저 부모 템플릿을 찾는다.  그 확장 태그가 템플릿에서 가장 먼저
있어야 한다.  부모 템플릿에 정의된 블럭의 내용을 보여주려면 <code class="docutils literal"><span class="pre">{{</span> <span class="pre">super()</span> <span class="pre">}}</span></code> 를
사용하면 된다.</p>
</div>
</div>
<span id="document-patterns/flashing"></span><div class="section" id="message-flashing">
<span id="message-flashing-pattern"></span><h4>메시지 플래싱(Message Flashing)<a class="headerlink" href="#message-flashing" title="제목 주소">¶</a></h4>
<p>좋은 어플리케이션과 사용자 인터페이스의 모든것은 피드백이다.  사용자가
충분한 피드백을 얻지 못한다면 그들은 결국 그 어플리케이션을 싫어할 것이다.
플라스크는 플래싱 시스템을 가지고 사용자에게 피드백을 주는 정말 간단한
방법을 제공한다.  플래싱 시스템은 기본적으로 요청의 끝에 메시지를 기록하고
그 다음 요청에서만 그 메시지에 접근할 수 있게 한다.  보통은 플래싱을 처리하는
레이아웃 템플릿과 결함되어 사용된다.</p>
<div class="section" id="id1">
<h5>간단한 플래싱<a class="headerlink" href="#id1" title="제목 주소">¶</a></h5>
<p>그래서 아래 전체 예제를 준비했다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">flash</span><span class="p">,</span> <span class="n">redirect</span><span class="p">,</span> <span class="n">render_template</span><span class="p">,</span> \
     <span class="n">request</span><span class="p">,</span> <span class="n">url_for</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">secret_key</span> <span class="o">=</span> <span class="s">&#39;some_secret&#39;</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">&#39;index.html&#39;</span><span class="p">)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/login&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">,</span> <span class="s">&#39;POST&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">login</span><span class="p">():</span>
    <span class="n">error</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s">&#39;POST&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s">&#39;username&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s">&#39;admin&#39;</span> <span class="ow">or</span> \
                <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s">&#39;password&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s">&#39;secret&#39;</span><span class="p">:</span>
            <span class="n">error</span> <span class="o">=</span> <span class="s">&#39;Invalid credentials&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">flash</span><span class="p">(</span><span class="s">&#39;You were successfully logged in&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s">&#39;index&#39;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">&#39;login.html&#39;</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>그리고 여기에 그 마법을 다룰 <code class="docutils literal"><span class="pre">layout.html</span></code> 템플릿이 있다:</p>
<div class="highlight-html+jinja"><div class="highlight"><pre><span class="cp">&lt;!doctype html&gt;</span>
<span class="nt">&lt;title&gt;</span>My Application<span class="nt">&lt;/title&gt;</span>
<span class="cp">{%</span> <span class="k">with</span> <span class="nv">messages</span> <span class="o">=</span> <span class="nv">get_flashed_messages</span><span class="o">()</span> <span class="cp">%}</span>
  <span class="cp">{%</span> <span class="k">if</span> <span class="nv">messages</span> <span class="cp">%}</span>
    <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">flashes</span><span class="nt">&gt;</span>
    <span class="cp">{%</span> <span class="k">for</span> <span class="nv">message</span> <span class="k">in</span> <span class="nv">messages</span> <span class="cp">%}</span>
      <span class="nt">&lt;li&gt;</span><span class="cp">{{</span> <span class="nv">message</span> <span class="cp">}}</span><span class="nt">&lt;/li&gt;</span>
    <span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
    <span class="nt">&lt;/ul&gt;</span>
  <span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">endwith</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">block</span> <span class="nv">body</span> <span class="cp">%}{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
</pre></div>
</div>
<p>이것은 index.html 템플릿이다:</p>
<div class="highlight-html+jinja"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">extends</span> <span class="s2">&quot;layout.html&quot;</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">block</span> <span class="nv">body</span> <span class="cp">%}</span>
  <span class="nt">&lt;h1&gt;</span>Overview<span class="nt">&lt;/h1&gt;</span>
  <span class="nt">&lt;p&gt;</span>Do you want to <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">url_for</span><span class="o">(</span><span class="s1">&#39;login&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span><span class="nt">&gt;</span>log in?<span class="nt">&lt;/a&gt;</span>
<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
</pre></div>
</div>
<p>물론 로그인 템플릿도 있다:</p>
<div class="highlight-html+jinja"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">extends</span> <span class="s2">&quot;layout.html&quot;</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">block</span> <span class="nv">body</span> <span class="cp">%}</span>
  <span class="nt">&lt;h1&gt;</span>Login<span class="nt">&lt;/h1&gt;</span>
  <span class="cp">{%</span> <span class="k">if</span> <span class="nv">error</span> <span class="cp">%}</span>
    <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">error</span><span class="nt">&gt;&lt;strong&gt;</span>Error:<span class="nt">&lt;/strong&gt;</span> <span class="cp">{{</span> <span class="nv">error</span> <span class="cp">}}</span>
  <span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
  <span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">&quot;&quot;</span> <span class="na">method=</span><span class="s">post</span><span class="nt">&gt;</span>
    <span class="nt">&lt;dl&gt;</span>
      <span class="nt">&lt;dt&gt;</span>Username:
      <span class="nt">&lt;dd&gt;&lt;input</span> <span class="na">type=</span><span class="s">text</span> <span class="na">name=</span><span class="s">username</span> <span class="na">value=</span><span class="s">&quot;</span><span class="cp">{{</span>
          <span class="nv">request.form.username</span> <span class="cp">}}</span><span class="s">&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;dt&gt;</span>Password:
      <span class="nt">&lt;dd&gt;&lt;input</span> <span class="na">type=</span><span class="s">password</span> <span class="na">name=</span><span class="s">password</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/dl&gt;</span>
    <span class="nt">&lt;p&gt;&lt;input</span> <span class="na">type=</span><span class="s">submit</span> <span class="na">value=</span><span class="s">Login</span><span class="nt">&gt;</span>
  <span class="nt">&lt;/form&gt;</span>
<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h5>카테고리를 가진 플래싱<a class="headerlink" href="#id2" title="제목 주소">¶</a></h5>
<div class="versionadded">
<p><span class="versionmodified">버전 0.3에 추가.</span></p>
</div>
<p>메시지를 플래싱 할 때 카테고리를 제공하는 것 또한 가능하다.  어떤 것도
제공되지 않는다면 기본 카테고리는 <code class="docutils literal"><span class="pre">'message'</span></code> 이다.  다른 카테고리도
사용자에게 더 좋은 피드백을 제공하는데 사용될 수 있다.  예를 들면, 오류
메시지는 붉은색 뒷배경으로 표시될 수 있다.</p>
<p>다른 카테고리로 메시지를 플래시하기 위해, <a class="reference internal" href="index.html#flask.flash" title="flask.flash"><code class="xref py py-func docutils literal"><span class="pre">flash()</span></code></a> function::
의 두번째 인자로 카테고리를 넘겨주면 된다.</p>
<blockquote>
<div>flash(u&#8217;Invalid password provided&#8217;, &#8216;error&#8217;)</div></blockquote>
<p>그리고 나서 템플릿 안에서 그 카테고리를 받으려면
<a class="reference internal" href="index.html#flask.get_flashed_messages" title="flask.get_flashed_messages"><code class="xref py py-func docutils literal"><span class="pre">get_flashed_messages()</span></code></a> 함수를 사용해야한다. 아래의 루프는
그러한 상황에서 약간 다르게 보인다:</p>
<div class="highlight-html+jinja"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">with</span> <span class="nv">messages</span> <span class="o">=</span> <span class="nv">get_flashed_messages</span><span class="o">(</span><span class="nv">with_categories</span><span class="o">=</span><span class="kp">true</span><span class="o">)</span> <span class="cp">%}</span>
  <span class="cp">{%</span> <span class="k">if</span> <span class="nv">messages</span> <span class="cp">%}</span>
    <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">flashes</span><span class="nt">&gt;</span>
    <span class="cp">{%</span> <span class="k">for</span> <span class="nv">category</span><span class="o">,</span> <span class="nv">message</span> <span class="k">in</span> <span class="nv">messages</span> <span class="cp">%}</span>
      <span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">category</span> <span class="cp">}}</span><span class="s">&quot;</span><span class="nt">&gt;</span><span class="cp">{{</span> <span class="nv">message</span> <span class="cp">}}</span><span class="nt">&lt;/li&gt;</span>
    <span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
    <span class="nt">&lt;/ul&gt;</span>
  <span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">endwith</span> <span class="cp">%}</span>
</pre></div>
</div>
<p>이것이 플래시 메시지를 보여주는 방법의 한가지 예이다.  메시지에
<code class="docutils literal"><span class="pre">&lt;strong&gt;Error:&lt;/strong&gt;</span></code> 과 같은 접두어를 더하기 위해 카테고리를
또한 사용할 수 도 있다.</p>
</div>
<div class="section" id="id3">
<h5>플래시 메시지를 필터링하기<a class="headerlink" href="#id3" title="제목 주소">¶</a></h5>
<div class="versionadded">
<p><span class="versionmodified">버전 0.9에 추가.</span></p>
</div>
<p>선택적으로 여러분은 <a class="reference internal" href="index.html#flask.get_flashed_messages" title="flask.get_flashed_messages"><code class="xref py py-func docutils literal"><span class="pre">get_flashed_messages()</span></code></a> 의 결과를 필터링할
카테고리의 목록을 넘겨줄 수 있다.  여러분이 분리된 블럭에 각 카테고리를
보여주고 싶다면 이 기능은 유용하다.</p>
<div class="highlight-html+jinja"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">with</span> <span class="nv">errors</span> <span class="o">=</span> <span class="nv">get_flashed_messages</span><span class="o">(</span><span class="nv">category_filter</span><span class="o">=[</span><span class="s2">&quot;error&quot;</span><span class="o">])</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">if</span> <span class="nv">errors</span> <span class="cp">%}</span>
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;alert-message block-message error&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">&quot;close&quot;</span> <span class="na">href=</span><span class="s">&quot;#&quot;</span><span class="nt">&gt;</span>×<span class="nt">&lt;/a&gt;</span>
  <span class="nt">&lt;ul&gt;</span>
    <span class="cp">{%</span>- <span class="k">for</span> <span class="nv">msg</span> <span class="k">in</span> <span class="nv">errors</span> <span class="cp">%}</span>
    <span class="nt">&lt;li&gt;</span><span class="cp">{{</span> <span class="nv">msg</span> <span class="cp">}}</span><span class="nt">&lt;/li&gt;</span>
    <span class="cp">{%</span> <span class="k">endfor</span> -<span class="cp">%}</span>
  <span class="nt">&lt;/ul&gt;</span>
<span class="nt">&lt;/div&gt;</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">endwith</span> <span class="cp">%}</span>
</pre></div>
</div>
</div>
</div>
<span id="document-patterns/jquery"></span><div class="section" id="jquery-ajax">
<h4>jQuery로  AJAX 처리하기<a class="headerlink" href="#jquery-ajax" title="제목 주소">¶</a></h4>
<p><a class="reference external" href="http://jquery.com/">jQuery</a> 는 DOM과 자바스크립트에 공통으로 사용되어 작업을 간편하게
해주는데 사용되는 작은 자바스크립트 라이브러리이다.  jQuery는 또한
서버와 클라이언트 사이에 JSON으로 통신하며 더 동적인 웹 어플리케이션을
만들게 해주는 최상의 도구이다.</p>
<p>JSON 그 자체는 매우 경량의 전송 포맷으로, 널리 지원되며 굉장히 파싱하기
쉬운 파이썬 기본 타입(numbers,strings, dicts와 lists)과 유사하게 생겼다.
그것은 수년전에 널리 사용되었고 웹 어플리케이션에서 전송포맷으로 XML을
빠르게 대체하고 있다.</p>
<p>여러분이 파이썬 2.6을 갖고 있다면 JSON은 그 패키지에서 사용될 것이고,
파이썬 2.5에서는 PyPI에서 <a class="reference external" href="http://pypi.python.org/pypi/simplejson">simplejson</a> 라이브러리를 설치해야할 것이다.</p>
<div class="section" id="id1">
<h5>jQuery 로딩하기<a class="headerlink" href="#id1" title="제목 주소">¶</a></h5>
<p>jQuery를 사용하기 위해서, 먼저 그것을 다운로드받고 여러분 어플리케이션의
static 폴더에 그 파일을 넣어야한다. 그리고 나서 그것이 로드되는지 확인한다.
이상적으로 여러분은 모든 페이지에서 사용할 layout 템플릿을 갖고 거기에서
<cite>&lt;body&gt;</cite> 의 하단에 jQuery를 로드할 스크립트 문을 추가해야한다:</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">text/javascript</span> <span class="na">src=</span><span class="s">&quot;{{</span>
<span class="s">  url_for(&#39;static&#39;, filename=&#39;jquery.js&#39;) }}&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</pre></div>
</div>
<p>다른 방법은 구글의 <a class="reference external" href="http://code.google.com/apis/ajaxlibs/documentation/">AJAX Libraries API</a> 를 사용하는 것이다:</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;//ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script&gt;</span><span class="nb">window</span><span class="p">.</span><span class="nx">jQuery</span> <span class="o">||</span> <span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="s1">&#39;&lt;script src=&quot;{{</span>
<span class="s1">  url_for(&#39;</span><span class="kr">static</span><span class="s1">&#39;, filename=&#39;</span><span class="nx">jquery</span><span class="p">.</span><span class="nx">js</span><span class="s1">&#39;) }}&quot;&gt;\x3C/script&gt;&#39;</span><span class="p">)</span><span class="nt">&lt;/script&gt;</span>
</pre></div>
</div>
<p>이 경우에 여러분은 대비책으로 static 폴더에 jQuery를 넣어둬야 하지만, 우선
구글로 부터 직접 그 라이브러리를 로딩하도록 할 것이다.  이것은 사용자들이
구글에서 같은 jQuery 버전을 사용하는 다른 웹사이트를 적어도 한번 방문했다면
여러분의 웹 사이트는 더 빠르게 로딩될 것이라는 점에서 장점이 있다. 왜냐하면
그 라이브러리는 브라우저 캐쉬에 이미 있을 것이기 때문이다.</p>
</div>
<div class="section" id="id2">
<h5>내 사이트는 어디에 있는가?<a class="headerlink" href="#id2" title="제목 주소">¶</a></h5>
<p>여러분의 어플리케이션이 어디에 있는지 알고 있는가?  여러분이 개발하고 있다면
그 답은 굉장히 간단하다:  로컬호스트의 어떤 포트와 직접적으로 그 서버의 루트에
있다.  그러나 여러분이 최근에 어플리케이션을 다른 위치로 이동하기로 결정했다면
어떠한가?  예를 들면 <code class="docutils literal"><span class="pre">http://example.com/myapp</span></code> 과 같은 사이트로 말이다.
서버 측면에서 이것은 어떤 문제도 되지 않는데 왜냐하면 우리는 그 질문에
답변할 수 있는 간편한 <a class="reference internal" href="index.html#flask.url_for" title="flask.url_for"><code class="xref py py-func docutils literal"><span class="pre">url_for()</span></code></a> 함수를 사용하고 있기 때문이다.
하지만, 우리는 jQuery를 사용하고 있고 어플리케이션에 경로를 하드코딩하지
않아야 하고 그것을 동적으로 만들어야 한다. 그렇다면 어떻게 해야겠는가?</p>
<p>간단한 방법은 어플리케이션의 루트에 대한 접두어에 전역 변수를 설정한 페이지에
스크립트 태그를 추가하는 것이다. 다음과 같다:</p>
<div class="highlight-html+jinja"><div class="highlight"><pre><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">text/javascript</span><span class="nt">&gt;</span>
  <span class="nx">$SCRIPT_ROOT</span> <span class="o">=</span> <span class="cp">{{</span> <span class="nv">request.script_root</span><span class="o">|</span><span class="nf">tojson</span><span class="o">|</span><span class="nf">safe</span> <span class="cp">}}</span><span class="p">;</span>
<span class="nt">&lt;/script&gt;</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">|safe</span></code> 는 진자가 HTML 규칙을 가진 JSON 인코딩된 문자열을 이스케이핑하지
못하게 하기 위해 필요하다.  보통은 이것이 필요하겠지만, 다른 규칙을 적용하는
<cite>script</cite> 블럭 안에 두겠다.</p>
<div class="admonition-information-for-pros admonition">
<p class="first admonition-title">Information for Pros</p>
<p class="last">HTML에서 <cite>script</cite> 태그는 엔티티로 분석되지 않는 <cite>CDATA</cite> 로 선언된다.
<code class="docutils literal"><span class="pre">&lt;/script&gt;</span></code> 까지 모든 것은 스크립트로 처리된다. 이것은 또한 <code class="docutils literal"><span class="pre">&lt;/</span></code> 와
script 태그 사이의 어떤것도 존재해서는 안된다는 것을 의미한다.
<code class="docutils literal"><span class="pre">|tojson</span></code> 은 여기서 제대로 적용되어 이스케이핑 슬래쉬도 잘 처리된다
(<code class="docutils literal"><span class="pre">{{</span> <span class="pre">&quot;&lt;/script&gt;&quot;|tojson|safe</span> <span class="pre">}}</span></code> 은 <code class="docutils literal"><span class="pre">&quot;&lt;\/script&gt;&quot;</span></code> 게 보인다).</p>
</div>
</div>
<div class="section" id="json">
<h5>JSON 뷰 함수<a class="headerlink" href="#json" title="제목 주소">¶</a></h5>
<p>이제 두개의 URL 인자를 받아서 더하고 그 결과를 JSON 객체로 어플리케이션에
되돌려주는 서버 측 함수를 생성하자.  이것은 정말 우스운 예제이고 보통은
클라이언트 측에서만 동작할 내용이지만, 그럼에도 불구하고  jQuery와 플라스크가
동작하는 방식을 보여주는 예제이다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">jsonify</span><span class="p">,</span> <span class="n">render_template</span><span class="p">,</span> <span class="n">request</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/_add_numbers&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">add_numbers</span><span class="p">():</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">jsonify</span><span class="p">(</span><span class="n">result</span><span class="o">=</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">&#39;index.html&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>여러분이 볼 수 있는 것처럼 템플릿을 뿌려주는 <cite>index</cite> 메소드를 추가했다.
이 템플릿은 위에서 처럼 jQuery를 로딩할 것이고 두 숫자를 더할 수 있는
작은 폼과 서버 측에서 호출될 함수에 대한 링크를 갖고 있다.</p>
<p>우리는 여기서 절대 실패하지 않을 <a class="reference external" href="http://werkzeug.pocoo.org/docs/datastructures/#werkzeug.datastructures.MultiDict.get" title="(in Werkzeug v0.11-dev)"><code class="xref py py-meth docutils literal"><span class="pre">get()</span></code></a>
메소드를 사용하고 있다는 점에 주목하라.  키가 없다면 기본값 (여기서는 <code class="docutils literal"><span class="pre">0</span></code>) 이
반환된다는 것이다.  게다가 그것은 값을 특정 타입 (여기서는 <cite>int</cite>)으로 변환할
수 있다.  이것은 특히나 스크립트 (APIs, 자바스크립트 등) 로 실행되는 코드에 특히나
유용한데 왜냐하면 여러분은 키가 없을 때 발생하는 특별한 오류 보고가 필요없기
때문이다.</p>
</div>
<div class="section" id="html">
<h5>HTML<a class="headerlink" href="#html" title="제목 주소">¶</a></h5>
<p>위의 index.html 템플릿은 jQuery를 로딩하고 <cite>$SCRIPT_ROOT</cite> 변수를 설정하면서
<cite>layout.html</cite> 템플릿을 확장하거나 제일 상위에 그것을 설정해야한다.
여기에 우리의 작은 어플리케이션에 대해 필요한 HTML 코드가 있다 (<cite>index.html</cite>).
우리는 또한 필요한 스크립트를 바로 HTML에 넣는다는 것에 주목해라. 분리된
스크립트 파일에 그 코드를 갖는게 일반적으로는 더 나은 방식이다:</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">text/javascript</span><span class="nt">&gt;</span>
  <span class="nx">$</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;a#calculate&#39;</span><span class="p">).</span><span class="nx">bind</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">$</span><span class="p">.</span><span class="nx">getJSON</span><span class="p">(</span><span class="nx">$SCRIPT_ROOT</span> <span class="o">+</span> <span class="s1">&#39;/_add_numbers&#39;</span><span class="p">,</span> <span class="p">{</span>
        <span class="nx">a</span><span class="o">:</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;input[name=&quot;a&quot;]&#39;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
        <span class="nx">b</span><span class="o">:</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;input[name=&quot;b&quot;]&#39;</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span>
      <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#result&quot;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">result</span><span class="p">);</span>
      <span class="p">});</span>
      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">});</span>
  <span class="p">});</span>
<span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;h1&gt;</span>jQuery Example<span class="nt">&lt;/h1&gt;</span>
<span class="nt">&lt;p&gt;&lt;input</span> <span class="na">type=</span><span class="s">text</span> <span class="na">size=</span><span class="s">5</span> <span class="na">name=</span><span class="s">a</span><span class="nt">&gt;</span> +
   <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">text</span> <span class="na">size=</span><span class="s">5</span> <span class="na">name=</span><span class="s">b</span><span class="nt">&gt;</span> =
   <span class="nt">&lt;span</span> <span class="na">id=</span><span class="s">result</span><span class="nt">&gt;</span>?<span class="nt">&lt;/span&gt;</span>
<span class="nt">&lt;p&gt;&lt;a</span> <span class="na">href=</span><span class="s">#</span> <span class="na">id=</span><span class="s">calculate</span><span class="nt">&gt;</span>calculate server side<span class="nt">&lt;/a&gt;</span>
</pre></div>
</div>
<p>여기서는 jQuery가 어떠헥 동작하는지 자세하게 들어가지는 않을 것이고,
단지 위에 있는 일부 코드에 대한 간략한 설명만 있을 것이다:</p>
<ol class="arabic simple">
<li><code class="docutils literal"><span class="pre">$(function()</span> <span class="pre">{</span> <span class="pre">...</span> <span class="pre">})</span></code> 는 브라우저가 해당 페이지의 기본 구성들을
로딩할 때 실행될 코드를 지정한다.</li>
<li><code class="docutils literal"><span class="pre">$('selector')</span></code> 는 요소를 선택하고 그 요소에서 실행하게 한다.</li>
<li><code class="docutils literal"><span class="pre">element.bind('event',</span> <span class="pre">func)</span></code> 는 사용자가 해당 요소에서 클릭했을 때
실행될 함수를 지정한다.  그 함수가 <cite>false</cite> 를 반환하면, 기본 동작은
시작되지 않을 것이다 (이 경우, <cite>#</cite> URL로 이동).</li>
<li><code class="docutils literal"><span class="pre">$.getJSON(url,</span> <span class="pre">data,</span> <span class="pre">func)</span></code> 은 <cite>url</cite> 로 <cite>GET</cite> 요청을 보내고 쿼리 인자로
<cite>data</cite> 객체의 내요을 보낼 것이다.  일단 데이터가 도착하면, 인자로 반환 값을
가지고 주어진 함수를 호출할 것이다. 여기서는 앞에서 설정한 <cite>$SCRIPT_ROOT</cite>
변수를 사용할 수 있다는 것에 주목해라.</li>
</ol>
<p>여러분이 전체적으로 이해가 안된다면, 깃허브(github)에서 이 예제에 대한
<a class="reference external" href="http://github.com/mitsuhiko/flask/tree/master/examples/jqueryexample">소스 코드</a>.</p>
</div>
</div>
<span id="document-patterns/errorpages"></span><div class="section" id="id1">
<h4>커스텀 오류 페이지<a class="headerlink" href="#id1" title="제목 주소">¶</a></h4>
<p>플라스크에는 앞에서 나온 HTTP 오류 코드를 가지고 요청을 중단하는
<a class="reference internal" href="index.html#flask.abort" title="flask.abort"><code class="xref py py-func docutils literal"><span class="pre">abort()</span></code></a> 함수가 있다.  그것은 또한 정말 꾸미지 않은 기본적인
설명을 가진 단순한 흑백의 오류 페이지를 제공할 것이다.</p>
<p>오류 코드에 따라서 사용자가 실제로 그런 오류를 볼 가능성이 있다.</p>
<div class="section" id="id2">
<h5>공통 오류 코드<a class="headerlink" href="#id2" title="제목 주소">¶</a></h5>
<p>다음의 오류 코드는 어플리케이션이 정상적으로 동작했음에도 불구하고 사용자에게
종종 보여지는 것이다:</p>
<dl class="docutils">
<dt><em>404 Not Found</em></dt>
<dd>즐겨쓰는 메시지에 &#8220;이봐 친구, 그 URL 입력에 실수가 있어&#8221; 가 있다.
인터넷 초보자 조차 그 404를 알고 있는 그렇게 일반적인 것은 다음을
의미한다 : 젠장, 내가 찾고 있는 것이 거기에 없네.  404 페이지에
적어도 index 페이지로 돌아갈 수 있는 링크와 같은 유용한 것이 있도록
하는게 매우 좋은 방식이다.</dd>
<dt><em>403 Forbidden</em></dt>
<dd>여러분의 웹사이트에 어떤 접근 제어가 있다면, 허용되지 않는 자원에 대해
403 코드를 보내야할 것이다.  그렇기 때문에 사용자가 금지된 자원에 대해
접근하려할 때 사용자가 링크를 잃어버리지 않도록 해야한다.</dd>
<dt><em>410 Gone</em></dt>
<dd>여러분은 &#8220;404 Not Found&#8221; 에게 &#8220;410 Gone&#8221; 이라는 형제가 있었다는 것을
알았는가?  일부 사람들만 실제로 그것을 구현했지만, 그 방식은 전에
존재했지만 현재 삭제된 자원에 대해 404 대신에 401 로 응답하는 것이다.
여러분이 데이터베이스에서 영구적으로 문서를 지우지 않고 삭제됐다고
표시만 한다면, 사용자에게 편의를 제공하며 410 코드를 대신 사용하고
그들이 찾고 있는 것은 영구적으로 삭제됐다는 메시지를 보여줘라.</dd>
<dt><em>500 Internal Server Error</em></dt>
<dd>보통 프로그래밍 오류나 서버에 한계 부하를 넘었을 때 이 오류가 발생한다.
그 경우에 멋진 페이지를 보여주는 것이 굉장히 좋은 방식인데, 왜냐하면
여러분의 어플리케이션은 머지않아 다시 동작하지 않을 것이기 때문이다
(여기를 또한 살펴봐라: <a class="reference internal" href="index.html#application-errors"><span>어플리케이션 에러 로깅하기</span></a>).</dd>
</dl>
</div>
<div class="section" id="id3">
<h5>오류 핸들러<a class="headerlink" href="#id3" title="제목 주소">¶</a></h5>
<p>오류 핸들러는 뷰 함수와 같은 일종의 함수이지만, 그것은 오류가 발생하고
그 오류를 전달했을 때 호출된다.  오류는 대부분
<a class="reference external" href="http://werkzeug.pocoo.org/docs/exceptions/#werkzeug.exceptions.HTTPException" title="(in Werkzeug v0.11-dev)"><code class="xref py py-exc docutils literal"><span class="pre">HTTPException</span></code></a> 이지만, 어떤 경우에는 다른
오류일 수도 있다: 내부 서버 오류에 대한 핸들러는 그 요류들이 잡히지 않을지
모르지만 다른 예외 인스턴스에 넘겨질 것이다.</p>
<p>오류 핸들러는 <a class="reference internal" href="index.html#flask.Flask.errorhandler" title="flask.Flask.errorhandler"><code class="xref py py-meth docutils literal"><span class="pre">errorhandler()</span></code></a> 데코레이터와 예외에 대한
오류 코드를 가지고 등록된다.  플라스크는 오류 코드를 설정하지 <em>않을 것</em>
이라는 것을 명심하고, 그렇기 때문에 응답을 반환할 때 HTTP 상태 코드를
제공하도록 해야한다.</p>
<p>여기에 &#8220;404 Page Not Found&#8221; 예외에 대한 구현 예제가 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">render_template</span>

<span class="nd">@app.errorhandler</span><span class="p">(</span><span class="mi">404</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">page_not_found</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">&#39;404.html&#39;</span><span class="p">),</span> <span class="mi">404</span>
</pre></div>
</div>
<p>예제 템플릿은 다음과 같을 것이다:</p>
<div class="highlight-html+jinja"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">extends</span> <span class="s2">&quot;layout.html&quot;</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">block</span> <span class="nv">title</span> <span class="cp">%}</span>Page Not Found<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">block</span> <span class="nv">body</span> <span class="cp">%}</span>
  <span class="nt">&lt;h1&gt;</span>Page Not Found<span class="nt">&lt;/h1&gt;</span>
  <span class="nt">&lt;p&gt;</span>What you were looking for is just not there.
  <span class="nt">&lt;p&gt;&lt;a</span> <span class="na">href=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">url_for</span><span class="o">(</span><span class="s1">&#39;index&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span><span class="nt">&gt;</span>go somewhere nice<span class="nt">&lt;/a&gt;</span>
<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
</pre></div>
</div>
</div>
</div>
<span id="document-patterns/lazyloading"></span><div class="section" id="lazily-loading-views">
<h4>지연 로딩 뷰(Lazily Loading Views)<a class="headerlink" href="#lazily-loading-views" title="제목 주소">¶</a></h4>
<p>플라스크는 보통 데코레이터를 가지고 사용된다.  데코레이터는 간단하고
여러분은 특정 URL에 대해 호출되는 함수 바로 옆에 URL을 놓게 된다.
그러나 이런 방식에 단점이 있다: 데코레이터를 사용하는 여러분의 모든 코드가
가장 앞단에서 임포트되어야 하고 그렇지 않다면 플라스크는 실제로 여러분의
함수를 결코 찾지 못할 것이다.</p>
<p>여러분의 어플리케이션이 빠르게 임포트되어야 한다면 이것은 문제가 될 수 있다.
구글 앱 엔진이나 다른 시스템처럼 그 자체가 그 임포트를 해야할 지도 모른다.
그렇기 때문에 여러분의 어플리케이션이 규모가 커져서 이 방식이 더 이상
맞지 않다는 것을 갑자기 알게된다면 여러분은 중앙집중식 URL 매핑으로 되돌아
갈 수 도 있다.</p>
<p>중앙식 URL 맴을 갖도록 활성화하는 시스템은 <a class="reference internal" href="index.html#flask.Flask.add_url_rule" title="flask.Flask.add_url_rule"><code class="xref py py-meth docutils literal"><span class="pre">add_url_rule()</span></code></a>
함수이다.  데코레이터를 사용하는 대신, 여러분은 어플리케이션의 모든 URL을
파일로 갖을 수 있다.</p>
<div class="section" id="url">
<h5>중앙집중식 URL 맴으로 변환하기<a class="headerlink" href="#url" title="제목 주소">¶</a></h5>
<p>현재 어플리케이션이 아래와 같은 모습이라고 상상해보자:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">pass</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/user/&lt;username&gt;&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">user</span><span class="p">(</span><span class="n">username</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>그렇다면 중앙집중 방식에서는 여러분은 데코레이터가 없는 뷰를 가진 하나의
파일 (<cite>views.py</cite>) 을 가질 것이다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">pass</span>

<span class="k">def</span> <span class="nf">user</span><span class="p">(</span><span class="n">username</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>그렇다면 URL과 함수를 매핑하는 어플리케이션을 설정하는 파일을 다음과 같다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
<span class="kn">from</span> <span class="nn">yourapplication</span> <span class="kn">import</span> <span class="n">views</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">add_url_rule</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">,</span> <span class="n">view_func</span><span class="o">=</span><span class="n">views</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">add_url_rule</span><span class="p">(</span><span class="s">&#39;/user/&lt;username&gt;&#39;</span><span class="p">,</span> <span class="n">view_func</span><span class="o">=</span><span class="n">views</span><span class="o">.</span><span class="n">user</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id1">
<h5>늦은 로딩<a class="headerlink" href="#id1" title="제목 주소">¶</a></h5>
<p>지금까지 우리는 단지 뷰와 라우팅만 분리했지만, 모듈은 여전히 처음에 로딩된다.
필요할 때 뷰 함수가 실제 로딩되는 기법이 있다.  이것은 함수와 같이 동작하는
도움 클래스와 같이 수행될 수 있지만, 내부적으로 첫 사용에는 실제 함수를
임포는 한다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">werkzeug</span> <span class="kn">import</span> <span class="n">import_string</span><span class="p">,</span> <span class="n">cached_property</span>

<span class="k">class</span> <span class="nc">LazyView</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">import_name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__module__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__name__</span> <span class="o">=</span> <span class="n">import_name</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">import_name</span> <span class="o">=</span> <span class="n">import_name</span>

    <span class="nd">@cached_property</span>
    <span class="k">def</span> <span class="nf">view</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">import_string</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">import_name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>여기서 중요한 것은 <cite>__module__</cite> 과 <cite>__name__</cite> 알맞게 설정되야 한다.
이것은 여러분이 URL 규칙에 대한 이름을 제공하는 않는 경우에 플라스크가
내부적으로 URL 규칙을 이름짓는 방식을 알기 위해 사용된다.</p>
<p>그리고 나서 여러분은 아래처럼 뷰와 결합할 중앙위치를 정의할 수 있다:</p>
<blockquote>
<div><p>from flask import Flask
from yourapplication.helpers import LazyView
app = Flask(__name__)
app.add_url_rule(&#8216;/&#8217;,</p>
<blockquote>
<div>view_func=LazyView(&#8216;yourapplication.views.index&#8217;))</div></blockquote>
<dl class="docutils">
<dt>app.add_url_rule(&#8216;/user/&lt;username&gt;&#8217;,</dt>
<dd>view_func=LazyView(&#8216;yourapplication.views.user&#8217;))</dd>
</dl>
</div></blockquote>
<p>여러분은 키보드로 입력하는 코드의 양이라는 측면에서 프로젝트 명과 점(dot)을
접두어화하고 필요에 따라 <cite>LazyView</cite> 에 있는 <cite>view_func</cite> 을 래핑한 것으로
<a class="reference internal" href="index.html#flask.Flask.add_url_rule" title="flask.Flask.add_url_rule"><code class="xref py py-meth docutils literal"><span class="pre">add_url_rule()</span></code></a> 을 호출하는 함수를 작성함으로 이것을
더 최적화할 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">url</span><span class="p">(</span><span class="n">url_rule</span><span class="p">,</span> <span class="n">import_name</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">):</span>
    <span class="n">view</span> <span class="o">=</span> <span class="n">LazyView</span><span class="p">(</span><span class="s">&#39;yourapplication.&#39;</span> <span class="o">+</span> <span class="n">import_name</span><span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">add_url_rule</span><span class="p">(</span><span class="n">url_rule</span><span class="p">,</span> <span class="n">view_func</span><span class="o">=</span><span class="n">view</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>

<span class="n">url</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">,</span> <span class="s">&#39;views.index&#39;</span><span class="p">)</span>
<span class="n">url</span><span class="p">(</span><span class="s">&#39;/user/&lt;username&gt;&#39;</span><span class="p">,</span> <span class="s">&#39;views.user&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>한가지 명심해야할 것은 전후 요청 핸들러가 첫 요청에 올바르게 동작하기 위해
앞단에서 임포트되는 파일에 있어야 한다는 것이다.  나머지 데코레이터도 같은
방식이 적용된다.</p>
</div>
</div>
<span id="document-patterns/mongokit"></span><div class="section" id="flask-mongokit">
<h4>Flask에서 MongoKit 사용하기<a class="headerlink" href="#flask-mongokit" title="제목 주소">¶</a></h4>
<p>기능을 갖춘 DBMS 보다 문서 기반 데이터베이스를 사용하는 것이 요즘은 더 일반적이다.
이번 패턴은 MongoDB와 통합하기 위한 문서 매핑 라이브러리인 MongoKit의 사용법을
보여준다.</p>
<p>이 패턴은 동작하는 MongoDB 서버와 MongoKit 라이브러리가 설치되있는 것을 전제로 한다.</p>
<p>MongoKit을 사용하는 두가지 일반적인 방식이 있다.  여기서 각 방법을 요약할 것이다:</p>
<div class="section" id="id1">
<h5>선언 부분<a class="headerlink" href="#id1" title="제목 주소">¶</a></h5>
<p>MongoKit의 기본 동작은 Django 나 SQLAlchemy의 선언적 확장의 공통 방식에
기반을 둔 선언적 방식이다.</p>
<p>아래는 <cite>app.py</cite> 모듈의 예제이다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
<span class="kn">from</span> <span class="nn">mongokit</span> <span class="kn">import</span> <span class="n">Connection</span><span class="p">,</span> <span class="n">Document</span>

<span class="c"># configuration</span>
<span class="n">MONGODB_HOST</span> <span class="o">=</span> <span class="s">&#39;localhost&#39;</span>
<span class="n">MONGODB_PORT</span> <span class="o">=</span> <span class="mi">27017</span>

<span class="c"># create the little application object</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">from_object</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="c"># connect to the database</span>
<span class="n">connection</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&#39;MONGODB_HOST&#39;</span><span class="p">],</span>
                        <span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&#39;MONGODB_PORT&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>여러분의 모델을 정의하기 위해, MongoKit에서 임포트한 <cite>Document</cite> 클래스는 상속해라.
SQLAlchemy 패턴을 봤다면 여러분은 왜 우리가 세션을 갖고 있지 않고 심지어
<cite>init_db</cite> 함수를 여기서 정의하지 않았는지 궁금해할 지도 모른다.  한편으로,
MongoKit은 세션같은 것을 갖지 않는다.  이것은 때때로 더 많이 타이핑을 하지만
엄청나게 빠르다. 다른 면으로, MongoDB는 스키마가 없다.  이것은 여러분이
하나의 입력 질의로부터 어떤 문제도 없이 다음 질의에서 데이터 구조를 변경할 수 있다.
MongoKit 또한 스키마가 없지만, 데이터의 무결성을 보장하기 위해 어떤 검증을 구현한다.</p>
<p>여기서 예제 문서가 있다 (예를 들면 이것 또한 <cite>app.py</cite> 에 넣는다):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">max_length</span><span class="p">(</span><span class="n">length</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">length</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%s</span><span class="s"> must be at most </span><span class="si">%s</span><span class="s"> characters long&#39;</span> <span class="o">%</span> <span class="n">length</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">validate</span>

<span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="n">Document</span><span class="p">):</span>
    <span class="n">structure</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="nb">unicode</span><span class="p">,</span>
        <span class="s">&#39;email&#39;</span><span class="p">:</span> <span class="nb">unicode</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">validators</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="n">max_length</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
        <span class="s">&#39;email&#39;</span><span class="p">:</span> <span class="n">max_length</span><span class="p">(</span><span class="mi">120</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="n">use_dot_notation</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&#39;&lt;User </span><span class="si">%r</span><span class="s">&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<span class="c"># register the User document with our current connection</span>
<span class="n">connection</span><span class="o">.</span><span class="n">register</span><span class="p">([</span><span class="n">User</span><span class="p">])</span>
</pre></div>
</div>
<p>이 예제는 여러분에게 스키마 (구조라 불리는) 를 정의하는 법, 최대 문자 길이에
대한 검증자를 보여주고 <cite>use_dot_notation</cite> 이라 불리는 특별한 MongoKit 기능을
사용한다.  기본 MongoKit 마다 파이썬 딕셔너리 같은 동작을 하지만
<cite>use_dot_notation</cite> 에 <cite>True</cite> 로 설정을 하면 여러분은 속성들 사이를 분리하기
위해 점(dot)을 사용해서 어떤 다른 ORM과 근접한 모델을 사용하는 것 처럼 문서를
사용할 수 있다.</p>
<p>여러분은 아래 처럼 데이터베이스에 항목을 넣을 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">yourapplication.database</span> <span class="kn">import</span> <span class="n">connection</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">yourapplication.models</span> <span class="kn">import</span> <span class="n">User</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collection</span> <span class="o">=</span> <span class="n">connection</span><span class="p">[</span><span class="s">&#39;test&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">users</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">user</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">User</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">user</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">u&#39;admin&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">user</span><span class="p">[</span><span class="s">&#39;email&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">u&#39;admin@localhost&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">user</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
<p>MongoKit은 사용된 컬럼 타입에 다소 엄격하고, 여러분은 유니코드인 <cite>name</cite> 또는 <cite>email</cite> 에
대한 공통의 <cite>str</cite> 타입을 사용하지 않아야 한다.</p>
<p>질의하는것 또한 간단하다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">collection</span><span class="o">.</span><span class="n">User</span><span class="o">.</span><span class="n">find</span><span class="p">())</span>
<span class="go">[&lt;User u&#39;admin&#39;&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collection</span><span class="o">.</span><span class="n">User</span><span class="o">.</span><span class="n">find_one</span><span class="p">({</span><span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="s">u&#39;admin&#39;</span><span class="p">})</span>
<span class="go">&lt;User u&#39;admin&#39;&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="pymongo">
<h5>PyMongo 호환성 계층<a class="headerlink" href="#pymongo" title="제목 주소">¶</a></h5>
<p>여러분이 PyMongo를 단지 사용하고 싶다면, MongoKit을 가지고 그것을 할 수 있다.
여러분이 데이터를 얻는데 가장 좋은 성능이 필요하다면 이 프로세스를 사용하면 된다.
이 예제는 Flask와 그것을 연결하는 방법을 보여주는지 않고, 예를 들면
위의 위의 MongoKit 코드를 봐라:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">MongoKit</span> <span class="kn">import</span> <span class="n">Connection</span>

<span class="n">connection</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">()</span>
</pre></div>
</div>
<p>데이터를 입력하기 위해 여러분은 <cite>insert</cite> 메소드를 사용할 수있다.  우리는 첫번째로
콜렉션을 얻어야하고, 이것은 SQL 세상에서 테이블과 약간 유사하다.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">collection</span> <span class="o">=</span> <span class="n">connection</span><span class="p">[</span><span class="s">&#39;test&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">users</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">user</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="s">u&#39;admin&#39;</span><span class="p">,</span> <span class="s">&#39;email&#39;</span><span class="p">:</span> <span class="s">u&#39;admin@localhost&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collection</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
</pre></div>
</div>
<p>MongoKit는 자동으로 커밋할 것이다.</p>
<p>데이터베이스에 질의하기 위해서, 여러분은 직접 컬렉션을 사용한다.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">collection</span><span class="o">.</span><span class="n">find</span><span class="p">())</span>
<span class="go">[{u&#39;_id&#39;: ObjectId(&#39;4c271729e13823182f000000&#39;), u&#39;name&#39;: u&#39;admin&#39;, u&#39;email&#39;: u&#39;admin@localhost&#39;}]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collection</span><span class="o">.</span><span class="n">find_one</span><span class="p">({</span><span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="s">u&#39;admin&#39;</span><span class="p">})</span>
<span class="go">{u&#39;_id&#39;: ObjectId(&#39;4c271729e13823182f000000&#39;), u&#39;name&#39;: u&#39;admin&#39;, u&#39;email&#39;: u&#39;admin@localhost&#39;}</span>
</pre></div>
</div>
<p>이 결과 또한 딕셔너리 형태의 객체이다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">find_one</span><span class="p">({</span><span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="s">u&#39;admin&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="p">[</span><span class="s">&#39;email&#39;</span><span class="p">]</span>
<span class="go">u&#39;admin@localhost&#39;</span>
</pre></div>
</div>
<p>MongoKit에 대한 더 많은 정보에 대해서, <a class="reference external" href="https://github.com/namlook/mongokit">website</a>
으로 가서 살펴봐라.</p>
</div>
</div>
<span id="document-patterns/favicon"></span><div class="section" id="id1">
<h4>파비콘 추가하기<a class="headerlink" href="#id1" title="제목 주소">¶</a></h4>
<p>&#8220;파비콘(favicon)&#8221;은 탭이나 북마크를 위해 브라우저에서 사용되는 아이콘이다.
이 아이콘은 여러분의 웹사이트를 구분하는데 도움을 주고 그 사이트에 유일한
표식을 준다.</p>
<p>일반적인 질문은 플라스크 어플리케이션에 어떻게 파이콘을 추가하는가 이다.
물론 제일 먼저 파이콘이 필요하다.  16 × 16 픽셀과 ICO 파일 형태이어야 한다.
이것은 전제사항은 아니지만 그 형태가 모든 브라우저에서 지원하는 업계 표준이다.
여러분의 static 디렉토리에 그 아이콘을 <code class="file docutils literal"><span class="pre">favicon.ico</span></code> 파일명으로 넣는다.</p>
<p>자, 그 아이콘을 브라우저에서 찾으려면, 여러분의 HTML에 link 태그를 추가하는게
알맞은 방법이다. 그래서 예를 들면:</p>
<div class="highlight-html+jinja"><div class="highlight"><pre><span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">&quot;shortcut icon&quot;</span> <span class="na">href=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">url_for</span><span class="o">(</span><span class="s1">&#39;static&#39;</span><span class="o">,</span> <span class="nv">filename</span><span class="o">=</span><span class="s1">&#39;favicon.ico&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span><span class="nt">&gt;</span>
</pre></div>
</div>
<p>대부분의 브라우저에서는 위의 한줄이 여러분이 해줄 전부이지만, 몇몇 예전 브라우저는
이 표준을 지원하지 않는다.  예전 업계 표준은 웹사이트의 루트에 그 파일을 위치시켜
제공하는 것이다.  여러분의 어플리케이션이 해당 도메인의 루트 경로에 마운트되지
않았다면 루트에서 그 아이콘이 제공되도록 웹서버 설정이 필요하므로 그렇게 할 수
없다면 여러분은 운이 없는 것이다.  그러나 어프리케이션이 루트에 있다면 여러분은
리디렉션으로 간단히 경로를 찾게할 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">app</span><span class="o">.</span><span class="n">add_url_rule</span><span class="p">(</span><span class="s">&#39;/favicon.ico&#39;</span><span class="p">,</span>
                 <span class="n">redirect_to</span><span class="o">=</span><span class="n">url_for</span><span class="p">(</span><span class="s">&#39;static&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s">&#39;favicon.ico&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>여러분이 추가적인 리디렉션 요청을 저장하고 싶다면 <a class="reference internal" href="index.html#flask.send_from_directory" title="flask.send_from_directory"><code class="xref py py-func docutils literal"><span class="pre">send_from_directory()</span></code></a>
를 사용한 뷰 함수 또한 작성할 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">send_from_directory</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/favicon.ico&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">favicon</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">send_from_directory</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">root_path</span><span class="p">,</span> <span class="s">&#39;static&#39;</span><span class="p">),</span>
                               <span class="s">&#39;favicon.ico&#39;</span><span class="p">,</span> <span class="n">mimetype</span><span class="o">=</span><span class="s">&#39;image/vnd.microsoft.icon&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>명시적인 마임타입(mimetype)을 생략할 수 있고 그 타입은 추측될 것이지만, 그것은
항상 같게 추측될 것이므로 추가적인 추측을 피하기 위해 타입을 지정하는 것이 좋다.</p>
<p>위의 예는 어플리케이션을 통해 아이콘을 제공할 것이고 가능하다면 웹서버 문서를
참고하여 그렇게 할 전담 웹서버를 구성하는 것이 더 좋다.</p>
<div class="section" id="id2">
<h5>추가로 볼 내용<a class="headerlink" href="#id2" title="제목 주소">¶</a></h5>
<ul class="simple">
<li>위키피디아(Wikipedia)의 <a class="reference external" href="http://en.wikipedia.org/wiki/Favicon">파비콘</a> 기사</li>
</ul>
</div>
</div>
<span id="document-patterns/streaming"></span><div class="section" id="id1">
<h4>컨텐트 스트리밍하기<a class="headerlink" href="#id1" title="제목 주소">¶</a></h4>
<p>종종 여러분은 클라이언트로 메모리에 유지하고 싶은 양보다 훨씬 더 큰,
엄청난 양의 데이터를 전송하기를 원한다.  여러분이 그 데이터를 바로 생성하고
있을 때, 파일시스템으로 갔다오지 않고 어떻게 클라이언트로 그것을 전송하는가?</p>
<p>답은 바로 생성기(generators)와 직접 응답이다.</p>
<div class="section" id="id2">
<h5>기본 사용법<a class="headerlink" href="#id2" title="제목 주소">¶</a></h5>
<p>이것은 많은 CSV 데이터를 즉각 생성하는 기초적인 뷰 함수이다.  데이터를 생성하는
생성기를 사용하는 내부(inner) 함수를 갖고 그 함수를 호출하면서 응답 객체에
그 함수를 넘기는것이 그 기법이다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Response</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/large.csv&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">generate_large_csv</span><span class="p">():</span>
    <span class="k">def</span> <span class="nf">generate</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">iter_all_rows</span><span class="p">():</span>
            <span class="k">yield</span> <span class="s">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
    <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="n">generate</span><span class="p">(),</span> <span class="n">mimetype</span><span class="o">=</span><span class="s">&#39;text/csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>각 <code class="docutils literal"><span class="pre">yield</span></code> 표현식은 브라우져에 직접 전송된다.  어떤 WSGI 미들웨어는
스트리밍을 깰수도 있지만, 프로파일러를 가진 디버그 환경과 여러분이 활성화
시킨 다른 것들을 조심하도록 유의하라.</p>
</div>
<div class="section" id="id3">
<h5>템플릿에서 스트리밍<a class="headerlink" href="#id3" title="제목 주소">¶</a></h5>
<p>진자2 템플릿 엔진은 또한 부분 단위로 템플릿을 뿌려주는 것을 지원한다.  이 기능은
꽤 일반적이지 않기 때문에 플라스크에 직접적으로 노출되지 않지만, 아래처럼 여러분이
쉽게 직접 구현할 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Response</span>

<span class="k">def</span> <span class="nf">stream_template</span><span class="p">(</span><span class="n">template_name</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span><span class="p">):</span>
    <span class="n">app</span><span class="o">.</span><span class="n">update_template_context</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">jinja_env</span><span class="o">.</span><span class="n">get_template</span><span class="p">(</span><span class="n">template_name</span><span class="p">)</span>
    <span class="n">rv</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">stream</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
    <span class="n">rv</span><span class="o">.</span><span class="n">enable_buffering</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rv</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/my-large-page.html&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">render_large_template</span><span class="p">():</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="n">iter_all_rows</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="n">stream_template</span><span class="p">(</span><span class="s">&#39;the_template.html&#39;</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">))</span>
</pre></div>
</div>
<p>여기서의 기법은 어플리케이션의 진자2 환경에서 템플릿 객체를 얻고 문자열 대신
스트림 객체를 반환하는 <code class="xref py py-meth docutils literal"><span class="pre">render()</span></code> 대신
<code class="xref py py-meth docutils literal"><span class="pre">stream()</span></code> 를 호출하는 것이다.  플라스크 템플릿 렌더 함수를
지나치고 템플릿 객체 자체를 사용하고 있기 때문에
<a class="reference internal" href="index.html#flask.Flask.update_template_context" title="flask.Flask.update_template_context"><code class="xref py py-meth docutils literal"><span class="pre">update_template_context()</span></code></a> 를 호출하여 렌더 컨텍스트를 갱신하도록
보장해야한다.  그리고 나서 스트림을 순환하면서 템플릿을 해석한다. 매번 여러분은 yield
를 호출하기 때문에 서버는 클라이언트로 내용을 밀어내어 보낼 것이고 여러분은
<code class="docutils literal"><span class="pre">rv.enable_buffering(size)</span></code> 을 가지고 템플릿 안에 몇가지 항목을 버퍼링하기를 원할지도
모른다.  <code class="docutils literal"><span class="pre">5</span></code> 가 보통 기본값이다.</p>
</div>
<div class="section" id="id4">
<h5>컨텍스트를 가진 스트리밍<a class="headerlink" href="#id4" title="제목 주소">¶</a></h5>
<div class="versionadded">
<p><span class="versionmodified">버전 0.9에 추가.</span></p>
</div>
<p>여러분이 데이터를 스트리밍할 때, 요청 컨텍스트는 그 함수가 호출된 순간 이미
종료된다는 것에 주목해라.  플라스크 0.9 는 생성기가 수행하는 동안 요청 컨텍스트를
유지하게 해주는 조력자를 제공한다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">stream_with_context</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">Response</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/stream&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">streamed_response</span><span class="p">():</span>
    <span class="k">def</span> <span class="nf">generate</span><span class="p">():</span>
        <span class="k">yield</span> <span class="s">&#39;Hello &#39;</span>
        <span class="k">yield</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">]</span>
        <span class="k">yield</span> <span class="s">&#39;!&#39;</span>
    <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="n">stream_with_context</span><span class="p">(</span><span class="n">generate</span><span class="p">()))</span>
</pre></div>
</div>
<p><a class="reference internal" href="index.html#flask.stream_with_context" title="flask.stream_with_context"><code class="xref py py-func docutils literal"><span class="pre">stream_with_context()</span></code></a> 함수 없다면 여러분은 그 시점에 <a class="reference external" href="http://docs.python.org/dev/library/exceptions.html#RuntimeError" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">RuntimeError</span></code></a>
를 얻을 것이다.</p>
</div>
</div>
<span id="document-patterns/deferredcallbacks"></span><div class="section" id="deferred">
<span id="deferred-callbacks"></span><h4>지연된(deferred) 요청 콜백<a class="headerlink" href="#deferred" title="제목 주소">¶</a></h4>
<p>플라스크의 설계 원칙 중 한가지는 응답 객체가 생성되고 그 객체를 수정하거나
대체할 수 있는 잠재적인 콜백의 호출 사슬로 그 객체를 전달하는 것이다.
요청 처리가 시작될 때, 아직은 응답 객체를 존재하지 않는다.  뷰 함수나
시스템에 있는 어떤 다른 컴포넌트에 의해 필요할 때 생성된다.</p>
<p>하지만 응답이 아직 존재하지 않는 시점에서 응답을 수정하려 하면 어떻게 되는가?
그에 대한 일반적인 예제는 응답 객체에 있는 쿠키를 설정하기를 원하는
before-request 함수에서 발생할 것이다.</p>
<p>한가지 방법은 그런 상황을 피하는 것이다. 꽤 자주 이렇게 하는게 가능하다.
예를 들면 여러분은 그런 로직을 after-request 콜백으로 대신 옮기도록
시도할 수 있다.  하지만 때때로 거기에 있는 코드를 옮기는 것은 유쾌한
일이 아니거나 코드가 대단히 부자연스럽게 보이게 된다.</p>
<p>다른 가능성으로서 여러분은 <a class="reference internal" href="index.html#flask.g" title="flask.g"><code class="xref py py-data docutils literal"><span class="pre">g</span></code></a> 객체에 여러 콜백 함수를
추가하고 요청의 끝부분에서 그것을 호출할 수 있다.  이 방식으로 여러분은
어플리케이션의 어느 위치로도 코드 실행을 지연시킬 수 있다.</p>
<div class="section" id="id1">
<h5>데코레이터<a class="headerlink" href="#id1" title="제목 주소">¶</a></h5>
<p>다음에 나올 데코레이터가 핵심이다. 그 데코레이터는 <a class="reference internal" href="index.html#flask.g" title="flask.g"><code class="xref py py-data docutils literal"><span class="pre">g</span></code></a> 객체에
있는 리스트에 함수를 등록한다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">g</span>

<span class="k">def</span> <span class="nf">after_this_request</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="s">&#39;after_request_callbacks&#39;</span><span class="p">):</span>
        <span class="n">g</span><span class="o">.</span><span class="n">after_request_callbacks</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">g</span><span class="o">.</span><span class="n">after_request_callbacks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">f</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h5>지연된 함수의 호출<a class="headerlink" href="#id2" title="제목 주소">¶</a></h5>
<p>이제 여러분은 요청의 마지막에서 호출될 함수를 표시하기 위해 <cite>after_this_request</cite>
데코레이터를 사용할 수 있다.  하지만 우리는 여전히 그 함수를 호출할 수도 있다.
이렇게 하기 위해 다음 함수가 <a class="reference internal" href="index.html#flask.Flask.after_request" title="flask.Flask.after_request"><code class="xref py py-meth docutils literal"><span class="pre">after_request()</span></code></a> 콜백으로 등록될
필요가 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.after_request</span>
<span class="k">def</span> <span class="nf">call_after_request_callbacks</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">callback</span> <span class="ow">in</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="s">&#39;after_request_callbacks&#39;</span><span class="p">,</span> <span class="p">()):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">callback</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h5>실제적인 예제<a class="headerlink" href="#id3" title="제목 주소">¶</a></h5>
<p>이제 우리는 이 특정 요청의 마지막에서 호출될 함수를 적절한 어느 시점에라도
쉽게 등록할 수 있다.  예를 들면 여러분은 before-request 함수에서 쿠키에 사용자의
현재 언어를 기억하게 할 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">request</span>

<span class="nd">@app.before_request</span>
<span class="k">def</span> <span class="nf">detect_user_language</span><span class="p">():</span>
    <span class="n">language</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">cookies</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;user_lang&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">language</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">language</span> <span class="o">=</span> <span class="n">guess_language_from_request</span><span class="p">()</span>
        <span class="nd">@after_this_request</span>
        <span class="k">def</span> <span class="nf">remember_language</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
            <span class="n">response</span><span class="o">.</span><span class="n">set_cookie</span><span class="p">(</span><span class="s">&#39;user_lang&#39;</span><span class="p">,</span> <span class="n">language</span><span class="p">)</span>
    <span class="n">g</span><span class="o">.</span><span class="n">language</span> <span class="o">=</span> <span class="n">language</span>
</pre></div>
</div>
</div>
</div>
<span id="document-patterns/methodoverrides"></span><div class="section" id="http">
<h4>HTTP 메소드 오버라이드 추가하기<a class="headerlink" href="#http" title="제목 주소">¶</a></h4>
<p>어떤 HTTP 프록시는 임시적인 HTTP 메소드나 새로운 HTTP 메소드 (PATCH 같은)
를 지원하지 않는다.  그런 경우에 프로토콜 전체를 위반하는 방식으로
HTTP 메소드를 다른 HTTP 메소드로 &#8220;프록시&#8221; 하는 것이 가능하다.</p>
<p>이렇게 동작하는 방식은 클라이언트가 HTTP POST로 요청하고
<code class="docutils literal"><span class="pre">X-HTTP-Method-Override</span></code> 헤더를 설정하고 그 값으로 의도하는 HTTP 메소드
(<code class="docutils literal"><span class="pre">PATCH</span></code> 와 같은)를 설정하면 된다.</p>
<p>이것은 HTTP 미들웨어로 쉽게 수행할 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">HTTPMethodOverrideMiddleware</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="n">allowed_methods</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">([</span>
        <span class="s">&#39;GET&#39;</span><span class="p">,</span>
        <span class="s">&#39;HEAD&#39;</span><span class="p">,</span>
        <span class="s">&#39;POST&#39;</span><span class="p">,</span>
        <span class="s">&#39;DELETE&#39;</span><span class="p">,</span>
        <span class="s">&#39;PUT&#39;</span><span class="p">,</span>
        <span class="s">&#39;PATCH&#39;</span><span class="p">,</span>
        <span class="s">&#39;OPTIONS&#39;</span>
    <span class="p">])</span>
    <span class="n">bodyless_methods</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">([</span><span class="s">&#39;GET&#39;</span><span class="p">,</span> <span class="s">&#39;HEAD&#39;</span><span class="p">,</span> <span class="s">&#39;OPTIONS&#39;</span><span class="p">,</span> <span class="s">&#39;DELETE&#39;</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">app</span> <span class="o">=</span> <span class="n">app</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">environ</span><span class="p">,</span> <span class="n">start_response</span><span class="p">):</span>
        <span class="n">method</span> <span class="o">=</span> <span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;HTTP_X_HTTP_METHOD_OVERRIDE&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">method</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allowed_methods</span><span class="p">:</span>
            <span class="n">method</span> <span class="o">=</span> <span class="n">method</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;ascii&#39;</span><span class="p">,</span> <span class="s">&#39;replace&#39;</span><span class="p">)</span>
            <span class="n">environ</span><span class="p">[</span><span class="s">&#39;REQUEST_METHOD&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">method</span>
        <span class="k">if</span> <span class="n">method</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bodyless_methods</span><span class="p">:</span>
            <span class="n">environ</span><span class="p">[</span><span class="s">&#39;CONTENT_LENGTH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;0&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="p">(</span><span class="n">environ</span><span class="p">,</span> <span class="n">start_response</span><span class="p">)</span>
</pre></div>
</div>
<p>플라스크로 이것을 하려면 아래와 같이 하면 된다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">wsgi_app</span> <span class="o">=</span> <span class="n">HTTPMethodOverrideMiddleware</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">wsgi_app</span><span class="p">)</span>
</pre></div>
</div>
</div>
<span id="document-patterns/requestchecksum"></span><div class="section" id="id1">
<h4>요청한 내용에 대한 체크섬<a class="headerlink" href="#id1" title="제목 주소">¶</a></h4>
<p>코드의 여러 부분이 요청 데이터로
Various pieces of code can consume the request data and preprocess it.
For instance JSON data ends up on the request object already read and
processed, form data ends up there as well but goes through a different
code path.  This seems inconvenient when you want to calculate the
checksum of the incoming request data.  This is necessary sometimes for
some APIs.</p>
<p>Fortunately this is however very simple to change by wrapping the input
stream.</p>
<p>The following example calculates the SHA1 checksum of the incoming data as
it gets read and stores it in the WSGI environment:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">hashlib</span>

<span class="k">class</span> <span class="nc">ChecksumCalcStream</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stream</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stream</span> <span class="o">=</span> <span class="n">stream</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hash</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha1</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stream</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="nb">bytes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hash</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">rv</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rv</span>

    <span class="k">def</span> <span class="nf">readline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size_hint</span><span class="p">):</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stream</span><span class="o">.</span><span class="n">readline</span><span class="p">(</span><span class="n">size_hint</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hash</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">rv</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rv</span>

<span class="k">def</span> <span class="nf">generate_checksum</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">env</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">environ</span>
    <span class="n">stream</span> <span class="o">=</span> <span class="n">ChecksumCalcStream</span><span class="p">(</span><span class="n">env</span><span class="p">[</span><span class="s">&#39;wsgi.input&#39;</span><span class="p">])</span>
    <span class="n">env</span><span class="p">[</span><span class="s">&#39;wsgi.input&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">stream</span>
    <span class="k">return</span> <span class="n">stream</span><span class="o">.</span><span class="n">_hash</span>
</pre></div>
</div>
<p>To use this, all you need to do is to hook the calculating stream in
before the request starts consuming data.  (Eg: be careful accessing
<code class="docutils literal"><span class="pre">request.form</span></code> or anything of that nature.  <code class="docutils literal"><span class="pre">before_request_handlers</span></code>
for instance should be careful not to access it).</p>
<p>Example usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/special-api&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;POST&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">special_api</span><span class="p">():</span>
    <span class="nb">hash</span> <span class="o">=</span> <span class="n">generate_checksum</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="c"># Accessing this parses the input stream</span>
    <span class="n">files</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">files</span>
    <span class="c"># At this point the hash is fully constructed.</span>
    <span class="n">checksum</span> <span class="o">=</span> <span class="nb">hash</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="k">return</span> <span class="s">&#39;Hash was: </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">checksum</span>
</pre></div>
</div>
</div>
</div>
</div>
<span id="document-deploying/index"></span><div class="section" id="deployment">
<span id="id1"></span><h3>배포 옵션<a class="headerlink" href="#deployment" title="제목 주소">¶</a></h3>
<p>여러분이 어떤 것을 이용할 수 있는지에 따라서, 플라스크 어플리케이션을  실행할 수 있는 다양한 방법이 있다.
개발 중에는 내장 서버를 사용할 수 있지만, 운영울 위해서는 모든 배포 옵션을 사용해야 한다.
(운영 중에는 내장 개발 서버를 사용하지 마라.) 사용할 수 있는 몇가지 옵션이 있다.</p>
<p>만약 다른 WSGI 서버가 있다면, WSGI 어플리케이션을 사용하는 방법에 대한 서버 문서를 참조하라.
단지 <code class="xref py py-class docutils literal"><span class="pre">Flask</span></code> 어플리케이션 객체가 실제 WSGI 어플리케이션임을 기억하라.</p>
<p>빠르게 배포하고 실행하기 위한 옵션을 보려면, 퀵스타트의 <a class="reference internal" href="index.html#quickstart-deployment"><span>웹서버에 배포하기</span></a> 를 참조하라.</p>
<div class="toctree-wrapper compound">
<span id="document-deploying/mod_wsgi"></span><div class="section" id="mod-wsgi">
<span id="mod-wsgi-deployment"></span><h4>mod_wsgi (아파치)<a class="headerlink" href="#mod-wsgi" title="제목 주소">¶</a></h4>
<p>만약 <a class="reference external" href="http://httpd.apache.org/">Apache</a> 웹서브를 사용하고 있다면, <a class="reference external" href="http://code.google.com/p/modwsgi/">mod_wsgi</a> 를 사용할 것을 고려하라.</p>
<div class="admonition- admonition">
<p class="first admonition-title">주의</p>
<p class="last">어플리케이션 파일에서 있을 수 있는 <code class="docutils literal"><span class="pre">app.run()</span></code> 호출이 <code class="docutils literal"><span class="pre">if</span> <span class="pre">__name__</span> <span class="pre">==</span> <span class="pre">'__main__':</span></code> 블럭안에 있는지
아니면 다른 파일로 분리되어 있는지 미리 확인해야 한다. 이것은 만약 우리가 어플리케이션을 mod_wsgi로 배포한다면
원하지 않게 로컬 WSGI 서버를 항상 실행하기 때문에 호출되지 않음을 확인해야 한다.</p>
</div>
<div class="section" id="id1">
<h5><cite>mod_wsgi</cite> 설치하기<a class="headerlink" href="#id1" title="제목 주소">¶</a></h5>
<p><cite>mod_wsgi</cite> 가 아직 설치되지 않았다면, 패키지 관리자를 사용하여 설치하거나, 직접 컴파일해야 한다.
mod_wsgi <a class="reference external" href="http://code.google.com/p/modwsgi/wiki/QuickInstallationGuide">installation instructions</a> 가 유닉스 시스템에서의 소스 설치를 다룬다.</p>
<p>만약 우분투/데비안을 사용하고 있다면 apt-get를 사용하여 다음과 같이 활성화할 수 있다:</p>
<div class="highlight-text"><div class="highlight"><pre># apt-get install libapache2-mod-wsgi
</pre></div>
</div>
<p>FreeBSD에에서는 <cite>www/mod_wsgi</cite> 포트를 컴파일하거나 pkg-add를 사용하여 <cite>mod_wsgi</cite> 를 설치하라:</p>
<div class="highlight-text"><div class="highlight"><pre># pkg_add -r mod_wsgi
</pre></div>
</div>
<p>만약 pkgsrc를 사용하고 있다면, <cite>www/ap2-wsgi</cite> 패키지를 컴파일하여 <cite>mod_wsgi</cite> 를 설치할 수 있다.</p>
<p>만약 처음 아파치를 리로드한 후에 세그멘테이션폴트가 나는 자식 프로세스를 발견한다면,
그것들을 무시할 수 있다. 단지 서버를 재시작하면 된다.</p>
</div>
<div class="section" id="wsgi">
<h5><cite>.wsgi</cite> 파일 생성하기<a class="headerlink" href="#wsgi" title="제목 주소">¶</a></h5>
<p>어플리케이션을 실행하기 위해서는 <cite>yourapplication.wsgi</cite> 파일이 필요하다.
이 파일은 application 객체를 얻기 위해 시작 시점에 <cite>mod_wsgi`가 실행할 코드를 포함하고 있다.
그 객체는 그 파일에서 `application</cite> 라고 불리며, application으로 사용된다.</p>
<p>대부분의 어플리케이션에서 다음과 같은 파일이면 충분하다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">yourapplication</span> <span class="kn">import</span> <span class="n">app</span> <span class="k">as</span> <span class="n">application</span>
</pre></div>
</div>
<p>만약 여러분이 application 객체 생성하는 팩토리 함수가 없다면,
&#8216;application&#8217;으로 하나를 직접 임포트하여 싱글톤 객체로 사용할 수 있다.</p>
<p>그 파일을 나중에 다시 찾을 수 있는 어딘가에 저장하고(예:<cite>/var/www/yourapplication</cite>)
<a href="#id13"><span class="problematic" id="id14">`yourapplication`과 사용되는 모든 라이브러리가 파이썬 로그 경로에 있는지 확인하라.
만약 파이썬을 설치하는 것을 원하지 않으면, 시스템 전반적으로 `virtual python`_</span></a> 객체를 사용하는 것을
고려하라. 실제로 어플리케이션을 virtualenv에 설치해야 하는 것을 기억하라.
다른 방법으로는 임포트 전에 <cite>.wsgi</cite> 파일 내 경로를 패치하기 위한 옵션이 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&#39;/path/to/the/application&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h5>아파치 설정하기<a class="headerlink" href="#id2" title="제목 주소">¶</a></h5>
<p>여러분이 해야할 마지막 일은 어플리케이션을 위한 아파치 설정 파일을 생성하는 것이다. 이 예제에서 보안적인 이유로
다른 사용자 하에서 어플리케이션을 실행하라고 &#8216;mod_wsgi&#8217;에게 말할 것이다:</p>
<div class="highlight-아파치"><div class="highlight"><pre>&lt;VirtualHost *&gt;
    ServerName example.com

    WSGIDaemonProcess yourapplication user=user1 group=group1 threads=5
    WSGIScriptAlias / /var/www/yourapplication/yourapplication.wsgi

    &lt;Directory /var/www/yourapplication&gt;
        WSGIProcessGroup yourapplication
        WSGIApplicationGroup %{GLOBAL}
        Order deny,allow
        Allow from all
    &lt;/Directory&gt;
&lt;/VirtualHost&gt;
</pre></div>
</div>
<p>Note: WSGIDaemonProcess는 윈도우에서 구현되어 있지 않으며 아파치는 위와 같은 설정을 허용하지 않을 것이다.
윈도우 시스템에서는 해당 라인들을 제거하라:</p>
<div class="highlight-아파치"><div class="highlight"><pre>&lt;VirtualHost *&gt;
        ServerName example.com
        WSGIScriptAlias / C:\yourdir\yourapp.wsgi
        &lt;Directory C:\yourdir&gt;
                Order deny,allow
                Allow from all
        &lt;/Directory&gt;
&lt;/VirtualHost&gt;
</pre></div>
</div>
<p>더 많은 정보를 위해 <a href="#id3"><span class="problematic" id="id4">`</span></a>mod_wsgi wiki`_를 참조하라.</p>
</div>
<div class="section" id="id6">
<h5>문제해결<a class="headerlink" href="#id6" title="제목 주소">¶</a></h5>
<p>만약 어플리케이션이 실행되지 않는다면 아래 문제해결 가이드를 참조하라:</p>
<dl class="docutils">
<dt><strong>문제:</strong> 어플리케이션이 실행되지 않으며, 에러로그는 SystemExit ignored를 보여준다</dt>
<dd><code class="docutils literal"><span class="pre">if</span> <span class="pre">__name__</span> <span class="pre">==</span> <span class="pre">'__main__':</span></code> 조건에 의해 보호되지 않는 어플리케이션 파일에서 <code class="docutils literal"><span class="pre">app.run()</span></code> 를 호출한다.
파일에서 <a class="reference internal" href="index.html#flask.Flask.run" title="flask.Flask.run"><code class="xref py py-meth docutils literal"><span class="pre">run()</span></code></a> 호출을 제거하고 <cite>run.py</cite> 파일로 옮기거나, if 블럭 안에 넣어라.</dd>
<dt><strong>문제:</strong> 어플리케이션이 퍼미션 에러를 준다.</dt>
<dd>아마 잘못된 사용자에 의해 어플리케이션이 실행되었을 것이다.
어플리케이션이 접근이 필요한 폴더가 적절한 권한이 설정되어 있는지 어플리케이션이 올바른 사용자로 실행되는지 확인하라
(<cite>WSGIDaemonProcess</cite> 지시어에 <code class="docutils literal"><span class="pre">user</span></code> 와 <code class="docutils literal"><span class="pre">group</span></code> 파라미터)</dd>
<dt><strong>문제:</strong> 어플리케이션이 에러를 출력하며 죽는다</dt>
<dd><p class="first">mod_wsgi는 <a class="reference external" href="http://docs.python.org/dev/library/sys.html#sys.stdout" title="(in Python v3.6)"><code class="xref py py-data docutils literal"><span class="pre">sys.stdout</span></code></a> 와 <code class="xref py py-data docutils literal"><span class="pre">sys.stderr`로</span> <span class="pre">어떤</span> <span class="pre">것을</span> <span class="pre">하는</span> <span class="pre">것을</span> <span class="pre">허용하지</span> <span class="pre">않는다는</span> <span class="pre">것을</span> <span class="pre">기억라라.</span>
<span class="pre">`WSGIRestrictStdout</span></code> 를 <a href="#id7"><span class="problematic" id="id8">``</span></a>off``로 설정하여 이 보호를 해지할 수 있다:</p>
<div class="highlight-아파치"><div class="highlight"><pre>WSGIRestrictStdout Off
</pre></div>
</div>
<p>다른 대안으로 .wsgi 파일에서의 표준 출력을 다른 스트림으로 변환할 수 있다:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">stdout</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span>
</pre></div>
</div>
</dd>
<dt><strong>문제:</strong> IO 에러가 나는 자원에 접근하기</dt>
<dd><p class="first">아마 어플리케이션이 site-packages 폴더안에 심볼링링크되어 있는 싱글 .py file일 것이다.
이것은 작동하지 않으며 대신 파일이 저장되어 있는 폴더를 pythonpath를 넣거나 어플리케이션을 패키지로 바꿔라.</p>
<p class="last">이러한 이유는 패키지로 설치되지 않은 경우, 모듈 파일명이 자원을 찾기 위해 사용되어 지며, 심볼링링크를 위해
잘못된 파일명이 선택되어 지기 때문이다.</p>
</dd>
</dl>
</div>
<div class="section" id="id9">
<h5>자동 리로딩 지원<a class="headerlink" href="#id9" title="제목 주소">¶</a></h5>
<p>배포 도구를 돕기 위애 여러분은 자동 리로딩 지원을 활성화할 수 있다.
<cite>.wsgi</cite> 파일이 변경되면, <a href="#id10"><span class="problematic" id="id11">`</span></a>mod_wsgi`는 모든 데몬 프로세스를 리로드할 것이다.</p>
<p>이를 위해 <cite>Directory</cite> 섹션에 다음과 같은 지시어만 추가하면 된다:</p>
<div class="highlight-아파치"><div class="highlight"><pre>WSGIScriptReloading On
</pre></div>
</div>
</div>
<div class="section" id="id12">
<h5>가상 환경에서 실행하기<a class="headerlink" href="#id12" title="제목 주소">¶</a></h5>
<p>가상환경은 필요한 의존적인 것들을 시스템 전반적으로 설치할 필요가 없어서 사용되는 것을 더 잘 컨트롤 할 수 있는 잇점이 있다.
만약 가상환경에서 mod_wsgi를 사용하고 싶다면, <cite>.wsgi</cite> 파일을 조금 변경할 필요가 있다.</p>
<p><cite>.wsgi</cite> 파일 위에 아래와 같은 내용을 추가하라:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">activate_this</span> <span class="o">=</span> <span class="s">&#39;/path/to/env/bin/activate_this.py&#39;</span>
<span class="nb">execfile</span><span class="p">(</span><span class="n">activate_this</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">__file__</span><span class="o">=</span><span class="n">activate_this</span><span class="p">))</span>
</pre></div>
</div>
<p>이것은 가상환경 설정에 따라서 로드할 경로를 설정한다. 경로가 절대 경로임을 명심하라.</p>
</div>
</div>
<span id="document-deploying/wsgi-standalone"></span><div class="section" id="wsgi">
<span id="deploying-wsgi-standalone"></span><h4>독립적인 WSGI 컨테이너<a class="headerlink" href="#wsgi" title="제목 주소">¶</a></h4>
<p>WSGI 어플리케이션을 포함하고 HTTP를 서비스하는 파이썬으로 개발된 인기있는 서버가 있다.
이 서버들은 실행될 때 독립적이다; 여러분은 그것들을 웹서버를 통해 프록시할 수 있다.
이와 같이 하려면 <a class="reference internal" href="index.html#deploying-proxy-setups"><span>프록시 설정</span></a> 단락을 참조하라.</p>
<div class="section" id="gunicorn">
<h5>Gunicorn<a class="headerlink" href="#gunicorn" title="제목 주소">¶</a></h5>
<p><a class="reference external" href="http://gunicorn.org/">Gunicorn</a> &#8216;Green Unicorn&#8217;은 UNIX를 위한 WSGI HTTP 서버이다.
이것은 루비의 Unicorn 프로젝트에서 포팅된 pre-fork worker 모델이다.
이것은 <a href="#id1"><span class="problematic" id="id2">`</span></a>eventlet`_와 <a href="#id3"><span class="problematic" id="id4">`</span></a>greenlet`_을 모두 지원한다.
이 서버에서 플라스크 어플리케이션을 실행하는 것은 매우 간단하다:</p>
<div class="highlight-python"><div class="highlight"><pre>gunicorn myproject:app
</pre></div>
</div>
<p><cite>Gunicorn`_은 많은 커맨드라인 옵션을 제공한다 &#8211; ``gunicorn -h`</cite> 를 참조하라.
예를 들면 로컬호스트 4000포트로 바인딩하면서(<code class="docutils literal"><span class="pre">-b</span> <span class="pre">127.0.0.1:4000</span></code>)
4개의 worker 프로세스로 실행하기 위해서는 (<code class="docutils literal"><span class="pre">-w</span> <span class="pre">4</span></code>) 아래와 같이 하면 된다:</p>
<div class="highlight-python"><div class="highlight"><pre>gunicorn -w 4 -b 127.0.0.1:4000 myproject:app
</pre></div>
</div>
</div>
<div class="section" id="tornado">
<h5>Tornado<a class="headerlink" href="#tornado" title="제목 주소">¶</a></h5>
<p><a href="#id6"><span class="problematic" id="id7">`</span></a>Tornado`_는 <a href="#id8"><span class="problematic" id="id9">`</span></a>FriendFeed`_를 강화한 확장성있는 넌블러킹 웹서버의 오픈소스 버전이다.
넌블러킹이며 epoll을 사용하기 때문에 수천개의 동시 연결을 처리할 수 있다.
이것은 이상적인 실시간 웹서비스를 의미한다. 플라스크를 이 서비스로 통합하는 것은 복잡하지 않다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">tornado.wsgi</span> <span class="kn">import</span> <span class="n">WSGIContainer</span>
<span class="kn">from</span> <span class="nn">tornado.httpserver</span> <span class="kn">import</span> <span class="n">HTTPServer</span>
<span class="kn">from</span> <span class="nn">tornado.ioloop</span> <span class="kn">import</span> <span class="n">IOLoop</span>
<span class="kn">from</span> <span class="nn">yourapplication</span> <span class="kn">import</span> <span class="n">app</span>

<span class="n">http_server</span> <span class="o">=</span> <span class="n">HTTPServer</span><span class="p">(</span><span class="n">WSGIContainer</span><span class="p">(</span><span class="n">app</span><span class="p">))</span>
<span class="n">http_server</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="mi">5000</span><span class="p">)</span>
<span class="n">IOLoop</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="gevent">
<h5>Gevent<a class="headerlink" href="#gevent" title="제목 주소">¶</a></h5>
<p><a href="#id23"><span class="problematic" id="id24">`Gevent`_는 `libevent`_</span></a> 이벤트 루프 위에서 고수준 동기화 API를 제공하기 위해 <a href="#id11"><span class="problematic" id="id12">`</span></a>greenlet`_를 사용하는
coroutine기반 파이썬 네트워킹 라이브러리이다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">gevent.wsgi</span> <span class="kn">import</span> <span class="n">WSGIServer</span>
<span class="kn">from</span> <span class="nn">yourapplication</span> <span class="kn">import</span> <span class="n">app</span>

<span class="n">http_server</span> <span class="o">=</span> <span class="n">WSGIServer</span><span class="p">((</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="mi">5000</span><span class="p">),</span> <span class="n">app</span><span class="p">)</span>
<span class="n">http_server</span><span class="o">.</span><span class="n">serve_forever</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="twisted-web">
<h5>Twisted Web<a class="headerlink" href="#twisted-web" title="제목 주소">¶</a></h5>
<p><cite>Twisted Web`_은 `Twisted`_에 포함되어 있는 웹서버이며, 성숙된 넌블러킹 이벤트 드리븐 네트워킹 라이브러리이다.
Twisted Web은 ``twistd`</cite> 유틸리티를 사용하여 커맨드라인을 통해 컨트롤할 수 있는 표준 WSGI 컨테이너이다:</p>
<div class="highlight-python"><div class="highlight"><pre>twistd web --wsgi myproject.app
</pre></div>
</div>
<p>이 예제는 <code class="docutils literal"><span class="pre">myproject</span></code> 모듈로부터 <a href="#id15"><span class="problematic" id="id16">``</span></a>app``을 호출하는 Flask application를 실행할 것이다.</p>
<p>Twisted Web은 많은 플래그와 옵션을 지원하며, <code class="docutils literal"><span class="pre">twistd</span></code> 유틸리티 또한 많은 것을 제공한다;
더 많은 정보를 위해 <code class="docutils literal"><span class="pre">twistd</span> <span class="pre">-h</span></code> 와 <code class="docutils literal"><span class="pre">twistd</span> <span class="pre">web</span> <span class="pre">-h``를</span> <span class="pre">참조하라.</span>
<span class="pre">예를</span> <span class="pre">들어,</span> <span class="pre">``myproject</span></code> 어플리케이션을 8080포트로  Twisted 웹서버로 서비스하려면 아래와 같이 하면 된다:</p>
<div class="highlight-python"><div class="highlight"><pre>twistd -n web --port 8080 --wsgi myproject.app
</pre></div>
</div>
</div>
<div class="section" id="deploying-proxy-setups">
<span id="id18"></span><h5>프록시 설정<a class="headerlink" href="#deploying-proxy-setups" title="제목 주소">¶</a></h5>
<p>어플리케이션을 HTTP 프록시 뒤에 있는 서버들 중 하나를 사용하여 배포한다면
어플리케이션을 실행하기 위해 몇가지 헤더를 rewrite할 필요가 있을 것이다.
WSGI 환경에서 문제가 있는 두가지 값을 <cite>REMOTE_ADDR</cite> 와 <cite>HTTP_HOST</cite> 이다.
이 헤더들은 httpd에 전달하기 위한 설정을 할 수 있다. 또는 미들웨어에서 그 헤더들을 수정할 수 있다.
Werkzeug는 몇가지 설정으로 해결할 수 있는 픽서(fixer)을 포함한다. 그러나 특정한 설정을 위해 WSGI 미들웨어를
사용하기를 원할지도 모른다.</p>
<p>아래는 적절한 헤더를 설정하여 로컬포스트 8000번 포트로 서비스되는 어플리케이션으로 프록시하는 간단한 nginx 설정이다:</p>
<div class="highlight-python"><div class="highlight"><pre>.. sourcecode:: nginx
</pre></div>
</div>
<blockquote>
<div><dl class="docutils">
<dt>server {</dt>
<dd><p class="first">listen 80;</p>
<p>server_name _;</p>
<p>access_log  /var/log/nginx/access.log;
error_log  /var/log/nginx/error.log;</p>
<dl class="docutils">
<dt>location / {</dt>
<dd><p class="first">proxy_pass         <a class="reference external" href="http://127.0.0.1:8000/">http://127.0.0.1:8000/</a>;
proxy_redirect     off;</p>
<p class="last">proxy_set_header   Host             $host;
proxy_set_header   X-Real-IP        $remote_addr;
proxy_set_header   X-Forwarded-For  $proxy_add_x_forwarded_for;</p>
</dd>
</dl>
<p class="last">}</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>만약 httpd가 이 헤더들을 제공하지 않는다면 가장 일반적인 설정은 <a href="#id19"><span class="problematic" id="id20">`</span></a>X-Forwarded-Host`로부터 호스트를
<a href="#id21"><span class="problematic" id="id22">`</span></a>X-Forwarded-For`로부터 원격 어드레스를 가져오는 것이다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">werkzeug.contrib.fixers</span> <span class="kn">import</span> <span class="n">ProxyFix</span>
<span class="n">app</span><span class="o">.</span><span class="n">wsgi_app</span> <span class="o">=</span> <span class="n">ProxyFix</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">wsgi_app</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition- admonition">
<p class="first admonition-title">헤더 신뢰</p>
<p class="last">악의저인 클라이언트에 의해 위조될 수 있는 헤더를 무조건 신뢰할 것이기 때문에 non-proxy 설정에서
이런 미들웨어를 사용하는 것은 보안적인 문제가 있다는 것을 기억하라.</p>
</div>
<p>만약 다른 헤더로부터 헤더들은 rewrite하려면, 아래와 같이 픽서를 사용할 수 있다:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">CustomProxyFix</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">app</span> <span class="o">=</span> <span class="n">app</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">environ</span><span class="p">,</span> <span class="n">start_response</span><span class="p">):</span>
        <span class="n">host</span> <span class="o">=</span> <span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;HTTP_X_FHOST&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">host</span><span class="p">:</span>
            <span class="n">environ</span><span class="p">[</span><span class="s">&#39;HTTP_HOST&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">host</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="p">(</span><span class="n">environ</span><span class="p">,</span> <span class="n">start_response</span><span class="p">)</span>

<span class="n">app</span><span class="o">.</span><span class="n">wsgi_app</span> <span class="o">=</span> <span class="n">CustomProxyFix</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">wsgi_app</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<span id="document-deploying/uwsgi"></span><div class="section" id="uwsgi">
<span id="deploying-uwsgi"></span><h4>uWSGI<a class="headerlink" href="#uwsgi" title="제목 주소">¶</a></h4>
<p>uWSGI는 <a class="reference external" href="http://nginx.org/">nginx</a>, <a class="reference external" href="http://www.lighttpd.net/">lighttpd</a>, <a class="reference external" href="http://www.cherokee-project.com/">cherokee</a> 와 같은 서버에서 사용할 수 있는 배포 옵션이다;
다른 옵션을 보려면 <a class="reference internal" href="index.html#deploying-fastcgi"><span>FastCGI</span></a> 와 <a class="reference internal" href="index.html#deploying-wsgi-standalone"><span>독립적인 WSGI 컨테이너</span></a> 를 확인하라.
uWSGI 프로토토콜로 WSGI 어플리케이션을 사용하기 위해서는 먼저 uWSGI 서버가 필요하다. uWSGI는프로토콜이면서 어플리케이션 서버이다;
어플리케이션서버는 uWSGI, FastCGI,  HTTP 프로토콜을 서비스할 수 있다.</p>
<p>가장 인기있는 uWSGI 서버는 <a href="#id1"><span class="problematic" id="id2">`</span></a>uwsgi`_이며,
설명을 위해 사용할 것이다. 아래와 같이 설치되어 있는지 확인하라.</p>
<div class="admonition- admonition">
<p class="first admonition-title">주의</p>
<p class="last">어플리케이션 파일에서 있을 수 있는 <code class="docutils literal"><span class="pre">app.run()</span></code> 호출이 <code class="docutils literal"><span class="pre">if</span> <span class="pre">__name__</span> <span class="pre">==</span> <span class="pre">'__main__':</span></code> 블럭안에 있는지
아니면 다른 파일로 분리되어 있는지 미리 확인해야 한다. 이것은 만약 우리가 어플리케이션을 uWSGI로 배포한다면
원하지 않게 로컬 WSGI 서버를 항상 실행하기 때문에 호출되지 않음을 확인해야 한다.</p>
</div>
<div class="section" id="uwsgi-app">
<h5>uwsgi로 app 시작하기<a class="headerlink" href="#uwsgi-app" title="제목 주소">¶</a></h5>
<p><a href="#id3"><span class="problematic" id="id4">`</span></a>uwsgi`는 파이썬 모듈에 있는 WSGI callables에서 운영하기 위해 설계되어 있다.</p>
<p>myapp.py에 flask application이 있다면 아래와 같이 사용하라:</p>
<div class="highlight-text"><div class="highlight"><pre>$ uwsgi -s /tmp/uwsgi.sock --module myapp --callable app
</pre></div>
</div>
<p>또는 아래와 같은 방법도 사용할 수 있다:</p>
<div class="highlight-text"><div class="highlight"><pre>$ uwsgi -s /tmp/uwsgi.sock -w myapp:app
</pre></div>
</div>
</div>
<div class="section" id="nginx">
<h5>nginx 설정하기<a class="headerlink" href="#nginx" title="제목 주소">¶</a></h5>
<p>nginx를 위한 기본적인 flask uWSGI 설정은 아래와 같다:</p>
<div class="highlight-python"><div class="highlight"><pre>location = /yourapplication { rewrite ^ /yourapplication/; }
location /yourapplication { try_files $uri @yourapplication; }
location @yourapplication {
  include uwsgi_params;
  uwsgi_param SCRIPT_NAME /yourapplication;
  uwsgi_modifier1 30;
  uwsgi_pass unix:/tmp/uwsgi.sock;
}
</pre></div>
</div>
<p>이 설정은 어플리케이션을 <a href="#id5"><span class="problematic" id="id6">`</span></a>/yourapplication`에 바인드한다.
URL 루트에 어플리케이션을 두길 원한다면, WSGI <a href="#id7"><span class="problematic" id="id8">`</span></a>SCRIPT_NAME`를 알려줄 필요가 없거나
uwsgi modifier를 설정할 필요가 없기 때문에 조금 더 간단하다:</p>
<p>This configuration binds the application to <cite>/yourapplication</cite>.  If you want
to have it in the URL root it&#8217;s a bit simpler because you don&#8217;t have to tell
it the WSGI <cite>SCRIPT_NAME</cite> or set the uwsgi modifier to make use of it:</p>
<div class="highlight-python"><div class="highlight"><pre>location / { try_files $uri @yourapplication; }
location @yourapplication {
    include uwsgi_params;
    uwsgi_pass unix:/tmp/uwsgi.sock;
}
</pre></div>
</div>
</div>
</div>
<span id="document-deploying/fastcgi"></span><div class="section" id="fastcgi">
<span id="deploying-fastcgi"></span><h4>FastCGI<a class="headerlink" href="#fastcgi" title="제목 주소">¶</a></h4>
<p>FastCGI는 <a class="reference external" href="http://nginx.org/">nginx</a>, <a class="reference external" href="http://www.lighttpd.net/">lighttpd</a>, <a class="reference external" href="http://www.cherokee-project.com/">cherokee</a> 와 같은 서버에서 사용할 수 있는 배포 옵션이다;
다른 옵션을 보려면 <a class="reference internal" href="index.html#deploying-uwsgi"><span>uWSGI</span></a> 와 <a class="reference internal" href="index.html#deploying-wsgi-standalone"><span>독립적인 WSGI 컨테이너</span></a> 를 확인하라.
WSGI 어플리케이션을 사용하기 위해서는 먼저 FastCGI 서버가 필요하다. 가장 인기있는 것은 <a href="#id1"><span class="problematic" id="id2">`</span></a>flup`_이며,
설명을 위해 사용할 것이다. 아래와 같이 설치되어 있는지 확인하라.</p>
<div class="admonition- admonition">
<p class="first admonition-title">주의</p>
<p class="last">어플리케이션 파일에서 있을 수 있는 <code class="docutils literal"><span class="pre">app.run()</span></code> 호출이 <code class="docutils literal"><span class="pre">if</span> <span class="pre">__name__</span> <span class="pre">==</span> <span class="pre">'__main__':</span></code> 블럭안에 있는지
아니면 다른 파일로 분리되어 있는지 미리 확인해야 한다. 이것은 만약 우리가 어플리케이션을 FastCGI로 배포한다면
원하지 않게 로컬 WSGI 서버를 항상 실행하기 때문에 호출되지 않음을 확인해야 한다.</p>
</div>
<div class="section" id="fcgi">
<h5><cite>.fcgi</cite> 파일 생성하기<a class="headerlink" href="#fcgi" title="제목 주소">¶</a></h5>
<p>먼저 FastCGI 서버 파일을 만드는 것이 필요하다. 그것을 <cite>yourapplication.fcgi</cite>:: 이라고 부르자.</p>
<blockquote>
<div><p>#!/usr/bin/python
from flup.server.fcgi import WSGIServer
from yourapplication import app</p>
<dl class="docutils">
<dt>if __name__ == &#8216;__main__&#8217;:</dt>
<dd>WSGIServer(app).run()</dd>
</dl>
</div></blockquote>
<p>이것은 아파치에 적용하기에는 충분하지만 nginx나 lighttpd의 오래된 버전의 경우 FastCGI 서버와ㅏ 통신하기 위해
명시적으로 소켓을 전달해야 한다. <code class="xref py py-class docutils literal"><span class="pre">WSGIServer</span></code>::에 소켓 경로를 전달해야 한다.</p>
<blockquote>
<div>WSGIServer(application, bindAddress=&#8217;/path/to/fcgi.sock&#8217;).run()</div></blockquote>
<p>그 경로는 서버 설정에 정의된 것과 정확히 같아야 한다.</p>
<p><cite>yourapplication.fcgi`을 다시 찾을 수 있는 어딘가에 저장하라.
`/var/www/yourapplication</cite> 나 비슷한 곳에 두면 된다.</p>
<p>서버가 이 파일을 실행할 수 있도록 실행 가능 비트를 설정하라:</p>
<div class="highlight-text"><div class="highlight"><pre># chmod +x /var/www/yourapplication/yourapplication.fcgi
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h5>아파치 설정하기<a class="headerlink" href="#id3" title="제목 주소">¶</a></h5>
<p>기본적인 아파치 배포는 위 예제로 충분하나, <cite>.fcgi</cite> 파일이 example.com/yourapplication.fcgi/news/ 와 같이
어플리케이션 URL에 보일 것이다. URL에 yourapplication.fcgi을 보이지 않게 하는 며가지 설정 방법이 있다.
가장 많이 사용되는 방법은 ScriptAlias 설정 지시어를 사용하는 것이다:</p>
<blockquote>
<div><dl class="docutils">
<dt>&lt;VirtualHost <a href="#id4"><span class="problematic" id="id5">*</span></a>&gt;</dt>
<dd>ServerName example.com
ScriptAlias / /path/to/yourapplication.fcgi/</dd>
</dl>
<p>&lt;/VirtualHost&gt;</p>
</div></blockquote>
<p>만약 공유된 웹호스트에서와 같이 ScriptAlias를 설정할 수 없다면,
URL에서 yourapplication.fcgi를 제거하기 위해 WSGI 미들웨어를 사용할 수 있다.
.htaccess:: 를 설정하라.</p>
<blockquote>
<div><dl class="docutils">
<dt>&lt;IfModule mod_fcgid.c&gt;</dt>
<dd><p class="first">AddHandler fcgid-script .fcgi
&lt;Files ~ (.fcgi)&gt;</p>
<blockquote>
<div>SetHandler fcgid-script
Options +FollowSymLinks +ExecCGI</div></blockquote>
<p class="last">&lt;/Files&gt;</p>
</dd>
</dl>
<p>&lt;/IfModule&gt;</p>
<dl class="docutils">
<dt>&lt;IfModule mod_rewrite.c&gt;</dt>
<dd>Options +FollowSymlinks
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*)$ yourapplication.fcgi/$1 [QSA,L]</dd>
</dl>
<p>&lt;/IfModule&gt;</p>
</div></blockquote>
<p>yourapplication.fcgi:: 를 설정하라.</p>
<blockquote>
<div><p>#!/usr/bin/python
#: optional path to your local python site-packages folder
import sys
sys.path.insert(0, &#8216;&lt;your_local_path&gt;/lib/python2.6/site-packages&#8217;)</p>
<p>from flup.server.fcgi import WSGIServer
from yourapplication import app</p>
<dl class="docutils">
<dt>class ScriptNameStripper(object):</dt>
<dd><dl class="first last docutils">
<dt>def __init__(self, app):</dt>
<dd>self.app = app</dd>
<dt>def __call__(self, environ, start_response):</dt>
<dd>environ[&#8216;SCRIPT_NAME&#8217;] = &#8216;&#8217;
return self.app(environ, start_response)</dd>
</dl>
</dd>
</dl>
<p>app = ScriptNameStripper(app)</p>
<dl class="docutils">
<dt>if __name__ == &#8216;__main__&#8217;:</dt>
<dd>WSGIServer(app).run()</dd>
</dl>
</div></blockquote>
</div>
<div class="section" id="lighttpd">
<h5>lighttpd 설정하기<a class="headerlink" href="#lighttpd" title="제목 주소">¶</a></h5>
<p>lighttpd를 위한 기본적인 FastCGI 설정은 아래와 같다:</p>
<div class="highlight-python"><div class="highlight"><pre>fastcgi.server = (&quot;/yourapplication.fcgi&quot; =&gt;
    ((
        &quot;socket&quot; =&gt; &quot;/tmp/yourapplication-fcgi.sock&quot;,
        &quot;bin-path&quot; =&gt; &quot;/var/www/yourapplication/yourapplication.fcgi&quot;,
        &quot;check-local&quot; =&gt; &quot;disable&quot;,
        &quot;max-procs&quot; =&gt; 1
    ))
)

alias.url = (
    &quot;/static/&quot; =&gt; &quot;/path/to/your/static&quot;
)

url.rewrite-once = (
    &quot;^(/static($|/.*))$&quot; =&gt; &quot;$1&quot;,
    &quot;^(/.*)$&quot; =&gt; &quot;/yourapplication.fcgi$1&quot;
</pre></div>
</div>
<p>FastCGI, alias, rewrite modules 모듈을 활성화하는 것을 기억하라.
이 설정은 어플리케이션을 <cite>/yourapplication`에 바인드한다.
만약 어플리케이션을 URL 루트에서 실행하기를 원한다면, :class:`~werkzeug.contrib.fixers.LighttpdCGIRootFix</cite> 미들웨어 관련
lighttpd 버그의 회피 수단을 적용해야 한다.</p>
<p>어플리케이션을 URL 루트에 마운트하는 경우에만 이것을 적용해야 한다.
또한 <a class="reference external" href="http://redmine.lighttpd.net/wiki/lighttpd/Docs:ModFastCGI">FastCGI and Python</a> 에 대한 더 많은 정보를 위해
lighttpd 문서를 확인하라.(명시적으로 소켓을 전달하는 것이 더 이상 필요하지 않음을 주목하라.)</p>
</div>
<div class="section" id="nginx">
<h5>nginx 설정하기<a class="headerlink" href="#nginx" title="제목 주소">¶</a></h5>
<p>nginx에 FastCGI 어플리케이션 설치는 기본적으로 어떠한 FastCGI 파라미터가 전달되지 않기 때문에 조금 다르다.</p>
<p>nginx를 위한 기본적인 플라스크 FastCGI 설정은 아래와 같다:</p>
<div class="highlight-python"><div class="highlight"><pre>location = /yourapplication { rewrite ^ /yourapplication/ last; }
location /yourapplication { try_files $uri @yourapplication; }
location @yourapplication {
    include fastcgi_params;
    fastcgi_split_path_info ^(/yourapplication)(.*)$;
    fastcgi_param PATH_INFO $fastcgi_path_info;
    fastcgi_param SCRIPT_NAME $fastcgi_script_name;
    fastcgi_pass unix:/tmp/yourapplication-fcgi.sock;
}
</pre></div>
</div>
<p>이 설정은 어플리케이션을 <cite>/yourapplication`에 바인드한다.
URL 루트에 어플리케이션을 두길 원한다면, `PATH_INFO</cite> 와 <a href="#id6"><span class="problematic" id="id7">`</span></a>SCRIPT_NAME`를 계산하는 방법을
이해할 필요가 없기 때문에 조금 더 간단하다:</p>
<div class="highlight-python"><div class="highlight"><pre>location / { try_files $uri @yourapplication; }
location @yourapplication {
    include fastcgi_params;
    fastcgi_param PATH_INFO $fastcgi_script_name;
    fastcgi_param SCRIPT_NAME &quot;&quot;;
    fastcgi_pass unix:/tmp/yourapplication-fcgi.sock;
}
</pre></div>
</div>
</div>
<div class="section" id="id8">
<h5>FastCGI 프로세스 실행하기<a class="headerlink" href="#id8" title="제목 주소">¶</a></h5>
<p>Nginx와 다른 서버들은 FastCGI 어플리케이션을 로드하지 않기 때문에, 스스로 로드를 해야 한다.
<a class="reference external" href="http://supervisord.org/configuration.html#fcgi-program-x-section-settings">관리자가 FastCGI 프로세스를 관리할 수 있다.</a>
다른 FastCGI 프로세스 관리자를 찾아 보거나, 부팅할 때 <cite>.fcgi</cite> 파일을 실행하도록 스크립트를 작성할 수 있다.
(예. SysV <code class="docutils literal"><span class="pre">init.d</span></code> 스크립트를 사용)
임시 방편으로는 GNU 화면 안에서 항상 <code class="docutils literal"><span class="pre">.fcgi</span></code> 스크립트를 실행할 수 있다.
상세를 위해 <code class="docutils literal"><span class="pre">man</span> <span class="pre">screen</span></code> 를 확인하고, 이것이 시스템을 재시작하면 지속되지 않는 수동적인 해결책임을 주의하라:</p>
<div class="highlight-python"><div class="highlight"><pre>$ screen
$ /var/www/yourapplication/yourapplication.fcgi
</pre></div>
</div>
</div>
<div class="section" id="id10">
<h5>디버깅<a class="headerlink" href="#id10" title="제목 주소">¶</a></h5>
<p>FastCGI 배포는 대부분 웹서버에서 디버깅하기 어려운 경향이 있다.
아주 종종 서버 로그가 알려는 유일한 정보는 &#8220;premature end of headers&#8221; 라인과 함께 나타난다.
어플리케이션을 디버깅하기 위해서, 여러분에게 정말로 줄 수 있는 유일한 방법은
정확한 사용자로 바꾸고 손으로 직접 어플리케이션을 실행하는 것이다.</p>
<p>아래 예제는 어플리케이션을 <cite>application.fcgi</cite> 라고 부르고, 웹서버가 사용자가 <a href="#id11"><span class="problematic" id="id12">`</span></a>www-data`라고 가정한다:</p>
<div class="highlight-python"><div class="highlight"><pre>$ su www-data
$ cd /var/www/yourapplication
$ python application.fcgi
Traceback (most recent call last):
  File &quot;yourapplication.fcgi&quot;, line 4, in &lt;module&gt;
ImportError: No module named yourapplication
</pre></div>
</div>
<p>이 경우 에러는 &#8220;yourapplication&#8221;가 파이썬 경로에 없는 것 같이 보인다. 일반적인 문제는 아래와 같다:</p>
<div class="highlight-python"><div class="highlight"><pre>-   상대 경로가 사용된 경우. 현재 작업 디렉토리에 의존하지 마라.
-   웹서버에 의해 설정되지 않는 환경 변수에 의존적인 코드.
-   다른 파이썬 해석기가 사용된 경우.
</pre></div>
</div>
</div>
</div>
<span id="document-deploying/cgi"></span><div class="section" id="cgi">
<h4>CGI<a class="headerlink" href="#cgi" title="제목 주소">¶</a></h4>
<p>다른 모든 배포 방법을 적용할 수 없다면, CGI는 확실히 가능할 것이다.
CGI는 거의 모든 주요 서버에 의해 제공되지만 보통 차선의 성능을 가진다.</p>
<p>또한 CGI와 같은 환경에서 실행할 수 있는 구글의 <a class="reference external" href="http://code.google.com/appengine/">App Engine</a> 에서 플라스크 어플리케이션을 사용할 수 있는 방법이기도 하다.</p>
<div class="admonition- admonition">
<p class="first admonition-title">주의</p>
<p class="last">어플리케이션 파일에서 있을 수 있는 <code class="docutils literal"><span class="pre">app.run()</span></code> 호출이 <code class="docutils literal"><span class="pre">if</span> <span class="pre">__name__</span> <span class="pre">==</span> <span class="pre">'__main__':</span></code> 블럭안에 있는지
아니면 다른 파일로 분리되어 있는지 미리 확인해야 한다. 이것은 만약 우리가 어플리케이션을 CGI/앱엔진으로 배포한다면
원하지 않게 로컬 WSGI 서버를 항상 실행하기 때문에 호출되지 않음을 확인해야 한다.</p>
</div>
<div class="section" id="id1">
<h5><cite>.cgi</cite> 파일 만들기<a class="headerlink" href="#id1" title="제목 주소">¶</a></h5>
<p>먼저 CGI 어플리케이션 파일을 만드는 것이 필요하다. 그것을 <cite>yourapplication.cgi</cite>:: 이라고 부르자.</p>
<blockquote>
<div><p>#!/usr/bin/python
from wsgiref.handlers import CGIHandler
from yourapplication import app</p>
<p>CGIHandler().run(app)</p>
</div></blockquote>
</div>
<div class="section" id="id2">
<h5>서버 설정<a class="headerlink" href="#id2" title="제목 주소">¶</a></h5>
<p>보통 서버를 설정하는 두가지 방법이 있다.
<cite>.cgi</cite> 를 <cite>cgi-bin</cite> 으로 복사하거나(<cite>mod_rewrite</cite> 나 URL을 재작성하는 유사한 것을 사용)
서버 지점을 파일에 직접 작성한다.</p>
<p>아파치의 경우, 아래와 같이 설정 파일 안에 입력할 수 있다:</p>
<div class="highlight-apache"><div class="highlight"><pre><span class="nb">ScriptAlias</span> <span class="sx">/app</span> <span class="sx">/path/to/the/application.cgi</span>
</pre></div>
</div>
<p>그러나 공유된 웹호스팅에서는 아파치 설정에 접근할 수 없을 지도 모른다.
이런 경우, 여러분의 어플리케이션이 실행되기를 원하는 공개 디렉토리에 있는 <cite>.htaccess</cite> 파일에
입력할 수 있으나, 이 경우엔는 <cite>ScriptAlias</cite> 지시어는 적용되지 않을 것이다:</p>
<div class="highlight-apache"><div class="highlight"><pre><span class="nb">RewriteEngine</span> <span class="k">On</span>
<span class="nb">RewriteCond</span> %{REQUEST_FILENAME} !-f # Don&#39;t interfere with static files
<span class="nb">RewriteRule</span> ^(.*)$ <span class="sx">/path/to/the/application.cgi/</span>$1 [L]
</pre></div>
</div>
<p>더 많은 정보를 위해 사용하는 웹서버의 문서를 참조하라.</p>
</div>
</div>
</div>
</div>
<span id="document-becomingbig"></span><div class="section" id="becomingbig">
<span id="id1"></span><h3>크게 만들기<a class="headerlink" href="#becomingbig" title="제목 주소">¶</a></h3>
<p>코드가 증가하고 어플리케이션의 규모가 커질 때 여러분에게 몇가지 선택사항이 있다.</p>
<div class="section" id="id2">
<h4>소스코드를 읽어라.<a class="headerlink" href="#id2" title="제목 주소">¶</a></h4>
<p>플라스크는 이미 존재하고 잘 사용되는 도구인 벡자이크(WSGI)와 진자(템플릿 엔진)
의 상위에서 여러분 자신의 프레임워크를 만들기 위한 방법을 설명하기 위해 부분적으로
시작되었고, 개발되어오면서, 넓은 사용자층에게 유용해졌다. 여러분의 코드가 점점
커진다면, 플라스크를 사용하지 않아야 한다 &#8211; 그 이유를 이해해라.  소스를 읽어라.
플라스크의 소스는 읽혀지기 위해 쓰여진것이다; 그것은 공표된 문서이기에 여러분은
그것의 내부 API를 사용할 수 있다.  플라스크는 여러분의 프로젝트에 필요한 훅 포인트
(hook point)를 찾을 수 있도록 상위 라이브러리에 있는 문서화된 API를 고수하고
그것의 내부 유틸리티를 문서화한다.</p>
</div>
<div class="section" id="hook">
<h4>훅(Hook)하고. 확장하라.<a class="headerlink" href="#hook" title="제목 주소">¶</a></h4>
<p><a class="reference internal" href="index.html#api"><span>API</span></a> 문서는 사용가능한 오버라이드, 훅 포인트, <a class="reference internal" href="index.html#signals"><span>시그널(Signals)</span></a> 로 가득 차 있다.
여러분은 요청과 응답 객체와 같은 것에 대한 커스텀 클래스를 제공할 수 있다. 여러분이
사용하는 API에 대해 좀 더 깊게 파보고, 플라스크 릴리즈에 특별하게 사용가능한
커스터마이징된 것을 찾아봐라.  여러분의 프로젝트가 여러 유틸리티나 플라스크 확장으로
리팩토링될 수 있는 방식을 찾아봐라.  커뮤니티에 있는 여러
<a class="reference external" href="http://flask.pocoo.org/extensions/">확장</a> 을 살펴보고 , 여러분이 필요한 도구를
찾을 수 없다면 여러분 자신의 확장을 만들기 위한 패턴을 찾아봐라.</p>
</div>
<div class="section" id="id4">
<h4>서브클래싱하라.<a class="headerlink" href="#id4" title="제목 주소">¶</a></h4>
<p><a class="reference internal" href="index.html#flask.Flask" title="flask.Flask"><code class="xref py py-class docutils literal"><span class="pre">Flask</span></code></a> 클래스는 서브클래싱에 대해 설계된 여러 메소드가 있다.
여러분은 <a class="reference internal" href="index.html#flask.Flask" title="flask.Flask"><code class="xref py py-class docutils literal"><span class="pre">Flask</span></code></a> (연결된 메소드 문서를 살펴봐라) 를
서브클래싱하고 어플리케이션 클래스를 인스턴스화한 곳 어디서나 그 서브클래스를
사용하여 동작을 빠르게 추가하거나 커스터마이징할 수 있다.  이것은
<a class="reference internal" href="index.html#app-factories"><span>어플리케이션 팩토리</span></a> 과 함께 잘 동작한다.</p>
</div>
<div class="section" id="id5">
<h4>미들웨어로 감싸라.<a class="headerlink" href="#id5" title="제목 주소">¶</a></h4>
<p><a class="reference internal" href="index.html#app-dispatch"><span>어플리케이션 디스패칭</span></a> 장에서 미들웨어를 적용하는 방법에 대해 자세히 보여줬다.
여러분의 플라스크 인스턴스를 감싸기 위해 WSGI 미들웨어와 여러분의 어플리케이션
과 HTTP 서버 사이에 있는 계층에 수정과 변경을 소개할 수 있다. 벡자이크는
다수의 <a class="reference external" href="http://werkzeug.pocoo.org/docs/middlewares/">미들웨어</a> 를 포함하고 있다.</p>
</div>
<div class="section" id="id7">
<h4>분기하라.<a class="headerlink" href="#id7" title="제목 주소">¶</a></h4>
<p>위에서 언급한 선택사항 중 어느 것에도 해당되지 않는다면, 플라스크를 분기해라.
플라스크 코드의 다수는 벡자이크와 진자2 안에 있는 것이다.  이런 라이브러리가
그 동작의 대다수를 수행한다.  플라스크는 단지 그런 라이브러리를 잘 붙여논
풀같은 것이다.  모든 프로젝트에 대해 하부 프레임워크가 방해가 되는 점이 있다
(왜냐하면 원 개발자들의 가진 가정들 때문에).  이것은 자연스러운 것인데 왜냐하면
그런 경우가 아니라면, 그 프레임워크는 시작부터 굉장히 가파른 학습 곡선과 많은
개발자의 좌절감을 유발하는 매우 복잡한 시스템이 될것이기 때문이다.</p>
<p>이것은 플라스크에만 유일하게 적용되지 않는다.  많은 사람들이 그들이 사용하는
프레임워크의 단점에 대응하기 위해 패치되고 변경된 버전의 프레임워크를 사용한다.
이 방식 또한 플라스크의 라이선스에 반영돼있다.  여러분이 플라스크에 변경하기로
결정했더라도 그 어떤 변경에 대해서도 다시 기여하지 않아도 된다.</p>
<p>물론 분기하는 것에 단점은 플라스크 확장에 대부분 깨질것이라는 점인데
왜냐하면 새로운 프레임워크는 다른 임포트 명을 가질 것이기 때문이다.
더 나아가서 변경의 개수의 따라 상위 변경을 통합하는 것이 복합한 과정일
수 있다.  그런것 때문에 분기하는 것은 최후의 보루가 되어야 할 것이다.</p>
</div>
<div class="section" id="id8">
<h4>프로페셔널처럼 규모를 조절하라.<a class="headerlink" href="#id8" title="제목 주소">¶</a></h4>
<p>많은 웹 어플리케이션에 대한 코드의 복잡도는 예상되는 사용자 수와 데이터
항목에 대한 규모를 조절하는것에 비하면 큰 이슈는 아니다.  플라스크
그 자체로는 여러분의 어플리케이션 코드, 사용하고자 하는 데이타 저장소 그리고
실행되는 파이썬 구현과 웹서버에 의한 규모 조절이라는 측면에서만 제한된다.</p>
<p>예를 자면 규모를 잘 조절한다는 것은 만약 여러분이 서버의 양을 두배로 했을 때
두배의 성능을 얻는다는 것을 의미한다.  규모 조절이 잘못됐다는 것은 여러분이
새로운 서버를 추가했을 때 어플리케이션이 더 좋은 성능을 내지 못하거나 심지어
대체되는 서버로 지원하지도 못하는 것을 의미한다.</p>
<p>문맥 로컬 프록시가 플라스크에서 규모 조절과 관련된 유일한 제한 요소이다.
그것들은 플라스크에 있는 쓰레드, 프로세스 혹은 그린렛으로 정의되는 문맥에
의존한다.  여러분의 서버가 쓰레드나 그린렛에 기반하지 않은 어떤 동시성의
기능을 사용한다면, 플라스크는 이와 같은 전역적인 프록시를 더 이상 제공할
수 없을 것이다.  하지만 서버의 다수는 기반에서 벡자이크 라이브러리에 의해
잘 지원되는 모든 메소드인 동시성을 수행하기 위해 쓰레드, 그린렛 또는 분리된
프로세스를 사용할 것이다.</p>
</div>
<div class="section" id="id9">
<h4>커뮤니티와 논의해라.<a class="headerlink" href="#id9" title="제목 주소">¶</a></h4>
<p>플라스크 개발자들은 사용자들에게 크고 작은 코드를 가지고 그 프레임워크에 접근할
수 있도록 유지한다. 여러분의 방식에서 플라스크로 인한 어떤 걸림돌을 만난다면
메일링 리스트나 IRC 채널을 통해 플라스크 개발자들에게 연락하는 것에 망설이지
말도록 해라.  더 큰 어플리케이션에 대한 도구를 개선하기 위해 플라스크와 그 확장
을 개발하는 개발자들에게 가장 좋은 방법은 사용자들에게 피드백을 얻는 것이다.</p>
</div>
</div>
</div>
</div>
<div class="section" id="api">
<h2>API 레퍼런스<a class="headerlink" href="#api" title="제목 주소">¶</a></h2>
<p>만약 여러분이 특정 함수, 클래스나 메소드에 대한 정보를 찾고 있다면, 문서의 이 부분은 당신에게 도움이 될 것 입니다.</p>
<div class="toctree-wrapper compound">
<span id="document-api"></span><div class="section" id="api">
<span id="id1"></span><h3>API<a class="headerlink" href="#api" title="제목 주소">¶</a></h3>
<span class="target" id="module-flask"></span><p>전체 문서 중 여기서는 플라스크의 모든 인터페이스를 다룬다. 플라스크에서
외부 라이브러리에 의존하는 부분에 대해서는 가장 중요한 것만 문서화했고
공식적인 문서에 대한 링크를 제공한다.</p>
<div class="section" id="application-object">
<h4>어플리케이션 객체(Application Object)<a class="headerlink" href="#application-object" title="제목 주소">¶</a></h4>
<dl class="class">
<dt id="flask.Flask">
<em class="property">class </em><code class="descclassname">flask.</code><code class="descname">Flask</code><span class="sig-paren">(</span><em>import_name</em>, <em>static_path=None</em>, <em>static_url_path=None</em>, <em>static_folder='static'</em>, <em>template_folder='templates'</em>, <em>instance_path=None</em>, <em>instance_relative_config=False</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask" title="정의 주소">¶</a></dt>
<dd><p>The flask object implements a WSGI application and acts as the central
object.  It is passed the name of the module or package of the
application.  Once it is created it will act as a central registry for
the view functions, the URL rules, template configuration and much more.</p>
<p>The name of the package is used to resolve resources from inside the
package or the folder the module is contained in depending on if the
package parameter resolves to an actual python package (a folder with
an <cite>__init__.py</cite> file inside) or a standard module (just a <cite>.py</cite> file).</p>
<p>For more information about resource loading, see <a class="reference internal" href="index.html#flask.Flask.open_resource" title="flask.Flask.open_resource"><code class="xref py py-func docutils literal"><span class="pre">open_resource()</span></code></a>.</p>
<p>Usually you create a <a class="reference internal" href="index.html#flask.Flask" title="flask.Flask"><code class="xref py py-class docutils literal"><span class="pre">Flask</span></code></a> instance in your main module or
in the <cite>__init__.py</cite> file of your package like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition-about-the-first-parameter admonition">
<p class="first admonition-title">About the First Parameter</p>
<p>The idea of the first parameter is to give Flask an idea what
belongs to your application.  This name is used to find resources
on the file system, can be used by extensions to improve debugging
information and a lot more.</p>
<p>So it&#8217;s important what you provide there.  If you are using a single
module, <cite>__name__</cite> is always the correct value.  If you however are
using a package, it&#8217;s usually recommended to hardcode the name of
your package there.</p>
<p>For example if your application is defined in <cite>yourapplication/app.py</cite>
you should create it with one of the two versions below:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="s">&#39;yourapplication&#39;</span><span class="p">)</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p class="last">Why is that?  The application will work even with <cite>__name__</cite>, thanks
to how resources are looked up.  However it will make debugging more
painful.  Certain extensions can make assumptions based on the
import name of your application.  For example the Flask-SQLAlchemy
extension will look for the code in your application that triggered
an SQL query in debug mode.  If the import name is not properly set
up, that debugging information is lost.  (For example it would only
pick up SQL queries in <cite>yourapplication.app</cite> and not
<cite>yourapplication.views.frontend</cite>)</p>
</div>
<div class="versionadded">
<p><span class="versionmodified">버전 0.7에 추가: </span>The <cite>static_url_path</cite>, <cite>static_folder</cite>, and <cite>template_folder</cite>
parameters were added.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified">버전 0.8에 추가: </span>The <cite>instance_path</cite> and <cite>instance_relative_config</cite> parameters were
added.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><ul class="first last simple">
<li><strong>import_name</strong> &#8211; the name of the application package</li>
<li><strong>static_url_path</strong> &#8211; can be used to specify a different path for the
static files on the web.  Defaults to the name
of the <cite>static_folder</cite> folder.</li>
<li><strong>static_folder</strong> &#8211; the folder with static files that should be served
at <cite>static_url_path</cite>.  Defaults to the <code class="docutils literal"><span class="pre">'static'</span></code>
folder in the root path of the application.</li>
<li><strong>template_folder</strong> &#8211; the folder that contains the templates that should
be used by the application.  Defaults to
<code class="docutils literal"><span class="pre">'templates'</span></code> folder in the root path of the
application.</li>
<li><strong>instance_path</strong> &#8211; An alternative instance path for the application.
By default the folder <code class="docutils literal"><span class="pre">'instance'</span></code> next to the
package or module is assumed to be the instance
path.</li>
<li><strong>instance_relative_config</strong> &#8211; if set to <cite>True</cite> relative filenames
for loading the config are assumed to
be relative to the instance path instead
of the application root.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="flask.Flask.add_template_filter">
<code class="descname">add_template_filter</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.add_template_filter" title="정의 주소">¶</a></dt>
<dd><p>Register a custom template filter.  Works exactly like the
<a class="reference internal" href="index.html#flask.Flask.template_filter" title="flask.Flask.template_filter"><code class="xref py py-meth docutils literal"><span class="pre">template_filter()</span></code></a> decorator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><strong>name</strong> &#8211; the optional name of the filter, otherwise the
function name will be used.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.add_template_global">
<code class="descname">add_template_global</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.add_template_global" title="정의 주소">¶</a></dt>
<dd><p>Register a custom template global function. Works exactly like the
<a class="reference internal" href="index.html#flask.Flask.template_global" title="flask.Flask.template_global"><code class="xref py py-meth docutils literal"><span class="pre">template_global()</span></code></a> decorator.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.10에 추가.</span></p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><strong>name</strong> &#8211; the optional name of the global function, otherwise the
function name will be used.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.add_template_test">
<code class="descname">add_template_test</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.add_template_test" title="정의 주소">¶</a></dt>
<dd><p>Register a custom template test.  Works exactly like the
<a class="reference internal" href="index.html#flask.Flask.template_test" title="flask.Flask.template_test"><code class="xref py py-meth docutils literal"><span class="pre">template_test()</span></code></a> decorator.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.10에 추가.</span></p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><strong>name</strong> &#8211; the optional name of the test, otherwise the
function name will be used.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.add_url_rule">
<code class="descname">add_url_rule</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.add_url_rule" title="정의 주소">¶</a></dt>
<dd><p>Connects a URL rule.  Works exactly like the <a class="reference internal" href="index.html#flask.Flask.route" title="flask.Flask.route"><code class="xref py py-meth docutils literal"><span class="pre">route()</span></code></a>
decorator.  If a view_func is provided it will be registered with the
endpoint.</p>
<p>Basically this example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>Is equivalent to the following:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">pass</span>
<span class="n">app</span><span class="o">.</span><span class="n">add_url_rule</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">,</span> <span class="s">&#39;index&#39;</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
<p>If the view_func is not provided you will need to connect the endpoint
to a view function like so:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">app</span><span class="o">.</span><span class="n">view_functions</span><span class="p">[</span><span class="s">&#39;index&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">index</span>
</pre></div>
</div>
<p>Internally <a class="reference internal" href="index.html#flask.Flask.route" title="flask.Flask.route"><code class="xref py py-meth docutils literal"><span class="pre">route()</span></code></a> invokes <a class="reference internal" href="index.html#flask.Flask.add_url_rule" title="flask.Flask.add_url_rule"><code class="xref py py-meth docutils literal"><span class="pre">add_url_rule()</span></code></a> so if you want
to customize the behavior via subclassing you only need to change
this method.</p>
<p>For more information refer to <a class="reference internal" href="index.html#url-route-registrations"><span>URL Route Registrations</span></a>.</p>
<div class="versionchanged">
<p><span class="versionmodified">버전 0.2으로 변경: </span><cite>view_func</cite> parameter added.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">버전 0.6으로 변경: </span><cite>OPTIONS</cite> is added automatically as method.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><ul class="first last simple">
<li><strong>rule</strong> &#8211; the URL rule as string</li>
<li><strong>endpoint</strong> &#8211; the endpoint for the registered URL rule.  Flask
itself assumes the name of the view function as
endpoint</li>
<li><strong>view_func</strong> &#8211; the function to call when serving a request to the
provided endpoint</li>
<li><strong>options</strong> &#8211; the options to be forwarded to the underlying
<a class="reference external" href="http://werkzeug.pocoo.org/docs/routing/#werkzeug.routing.Rule" title="(in Werkzeug v0.11-dev)"><code class="xref py py-class docutils literal"><span class="pre">Rule</span></code></a> object.  A change
to Werkzeug is handling of method options.  methods
is a list of methods this rule should be limited
to (<cite>GET</cite>, <cite>POST</cite> etc.).  By default a rule
just listens for <cite>GET</cite> (and implicitly <cite>HEAD</cite>).
Starting with Flask 0.6, <cite>OPTIONS</cite> is implicitly
added and handled by the standard request handling.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.after_request">
<code class="descname">after_request</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.after_request" title="정의 주소">¶</a></dt>
<dd><p>Register a function to be run after each request.  Your function
must take one parameter, a <a class="reference internal" href="index.html#flask.Flask.response_class" title="flask.Flask.response_class"><code class="xref py py-attr docutils literal"><span class="pre">response_class</span></code></a> object and return
a new response object or the same (see <a class="reference internal" href="index.html#flask.Flask.process_response" title="flask.Flask.process_response"><code class="xref py py-meth docutils literal"><span class="pre">process_response()</span></code></a>).</p>
<p>As of Flask 0.7 this function might not be executed at the end of the
request in case an unhandled exception occurred.</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.after_request_funcs">
<code class="descname">after_request_funcs</code><em class="property"> = None</em><a class="headerlink" href="#flask.Flask.after_request_funcs" title="정의 주소">¶</a></dt>
<dd><p>A dictionary with lists of functions that should be called after
each request.  The key of the dictionary is the name of the blueprint
this function is active for, <cite>None</cite> for all requests.  This can for
example be used to open database connections or getting hold of the
currently logged in user.  To register a function here, use the
<a class="reference internal" href="index.html#flask.Flask.after_request" title="flask.Flask.after_request"><code class="xref py py-meth docutils literal"><span class="pre">after_request()</span></code></a> decorator.</p>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.app_context">
<code class="descname">app_context</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.app_context" title="정의 주소">¶</a></dt>
<dd><p>Binds the application only.  For as long as the application is bound
to the current context the <a class="reference internal" href="index.html#flask.current_app" title="flask.current_app"><code class="xref py py-data docutils literal"><span class="pre">flask.current_app</span></code></a> points to that
application.  An application context is automatically created when a
request context is pushed if necessary.</p>
<p>Example usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">with</span> <span class="n">app</span><span class="o">.</span><span class="n">app_context</span><span class="p">():</span>
    <span class="o">...</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">버전 0.9에 추가.</span></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.app_ctx_globals_class">
<code class="descname">app_ctx_globals_class</code><a class="headerlink" href="#flask.Flask.app_ctx_globals_class" title="정의 주소">¶</a></dt>
<dd><p>The class that is used for the <a class="reference internal" href="index.html#flask.g" title="flask.g"><code class="xref py py-data docutils literal"><span class="pre">g</span></code></a> instance.</p>
<p>Example use cases for a custom class:</p>
<ol class="arabic simple">
<li>Store arbitrary attributes on flask.g.</li>
<li>Add a property for lazy per-request database connectors.</li>
<li>Return None instead of AttributeError on expected attributes.</li>
<li>Raise exception if an unexpected attr is set, a &#8220;controlled&#8221; flask.g.</li>
</ol>
<p>In Flask 0.9 this property was called <cite>request_globals_class</cite> but it
was changed in 0.10 to <a class="reference internal" href="index.html#flask.Flask.app_ctx_globals_class" title="flask.Flask.app_ctx_globals_class"><code class="xref py py-attr docutils literal"><span class="pre">app_ctx_globals_class</span></code></a> because the
flask.g object is not application context scoped.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.10에 추가.</span></p>
</div>
<p>alias of <code class="xref py py-class docutils literal"><span class="pre">_AppCtxGlobals</span></code></p>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.auto_find_instance_path">
<code class="descname">auto_find_instance_path</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.auto_find_instance_path" title="정의 주소">¶</a></dt>
<dd><p>Tries to locate the instance path if it was not provided to the
constructor of the application class.  It will basically calculate
the path to a folder named <code class="docutils literal"><span class="pre">instance</span></code> next to your main file or
the package.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.8에 추가.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.before_first_request">
<code class="descname">before_first_request</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.before_first_request" title="정의 주소">¶</a></dt>
<dd><p>Registers a function to be run before the first request to this
instance of the application.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.8에 추가.</span></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.before_first_request_funcs">
<code class="descname">before_first_request_funcs</code><em class="property"> = None</em><a class="headerlink" href="#flask.Flask.before_first_request_funcs" title="정의 주소">¶</a></dt>
<dd><p>A lists of functions that should be called at the beginning of the
first request to this instance.  To register a function here, use
the <a class="reference internal" href="index.html#flask.Flask.before_first_request" title="flask.Flask.before_first_request"><code class="xref py py-meth docutils literal"><span class="pre">before_first_request()</span></code></a> decorator.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.8에 추가.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.before_request">
<code class="descname">before_request</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.before_request" title="정의 주소">¶</a></dt>
<dd><p>Registers a function to run before each request.</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.before_request_funcs">
<code class="descname">before_request_funcs</code><em class="property"> = None</em><a class="headerlink" href="#flask.Flask.before_request_funcs" title="정의 주소">¶</a></dt>
<dd><p>A dictionary with lists of functions that should be called at the
beginning of the request.  The key of the dictionary is the name of
the blueprint this function is active for, <cite>None</cite> for all requests.
This can for example be used to open database connections or
getting hold of the currently logged in user.  To register a
function here, use the <a class="reference internal" href="index.html#flask.Flask.before_request" title="flask.Flask.before_request"><code class="xref py py-meth docutils literal"><span class="pre">before_request()</span></code></a> decorator.</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.blueprints">
<code class="descname">blueprints</code><em class="property"> = None</em><a class="headerlink" href="#flask.Flask.blueprints" title="정의 주소">¶</a></dt>
<dd><p>all the attached blueprints in a dictionary by name.  Blueprints
can be attached multiple times so this dictionary does not tell
you how often they got attached.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.7에 추가.</span></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.config">
<code class="descname">config</code><em class="property"> = None</em><a class="headerlink" href="#flask.Flask.config" title="정의 주소">¶</a></dt>
<dd><p>The configuration dictionary as <a class="reference internal" href="index.html#flask.Config" title="flask.Config"><code class="xref py py-class docutils literal"><span class="pre">Config</span></code></a>.  This behaves
exactly like a regular dictionary but supports additional methods
to load a config from files.</p>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.context_processor">
<code class="descname">context_processor</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.context_processor" title="정의 주소">¶</a></dt>
<dd><p>Registers a template context processor function.</p>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.create_global_jinja_loader">
<code class="descname">create_global_jinja_loader</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.create_global_jinja_loader" title="정의 주소">¶</a></dt>
<dd><p>Creates the loader for the Jinja2 environment.  Can be used to
override just the loader and keeping the rest unchanged.  It&#8217;s
discouraged to override this function.  Instead one should override
the <a class="reference internal" href="index.html#flask.Flask.jinja_loader" title="flask.Flask.jinja_loader"><code class="xref py py-meth docutils literal"><span class="pre">jinja_loader()</span></code></a> function instead.</p>
<p>The global loader dispatches between the loaders of the application
and the individual blueprints.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.7에 추가.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.create_jinja_environment">
<code class="descname">create_jinja_environment</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.create_jinja_environment" title="정의 주소">¶</a></dt>
<dd><p>Creates the Jinja2 environment based on <a class="reference internal" href="index.html#flask.Flask.jinja_options" title="flask.Flask.jinja_options"><code class="xref py py-attr docutils literal"><span class="pre">jinja_options</span></code></a>
and <a class="reference internal" href="index.html#flask.Flask.select_jinja_autoescape" title="flask.Flask.select_jinja_autoescape"><code class="xref py py-meth docutils literal"><span class="pre">select_jinja_autoescape()</span></code></a>.  Since 0.7 this also adds
the Jinja2 globals and filters after initialization.  Override
this function to customize the behavior.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.5에 추가.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.create_url_adapter">
<code class="descname">create_url_adapter</code><span class="sig-paren">(</span><em>request</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.create_url_adapter" title="정의 주소">¶</a></dt>
<dd><p>Creates a URL adapter for the given request.  The URL adapter
is created at a point where the request context is not yet set up
so the request is passed explicitly.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.6에 추가.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">버전 0.9으로 변경: </span>This can now also be called without a request object when the
URL adapter is created for the application context.</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.debug">
<code class="descname">debug</code><a class="headerlink" href="#flask.Flask.debug" title="정의 주소">¶</a></dt>
<dd><p>The debug flag.  Set this to <cite>True</cite> to enable debugging of the
application.  In debug mode the debugger will kick in when an unhandled
exception occurs and the integrated server will automatically reload
the application if changes in the code are detected.</p>
<p>This attribute can also be configured from the config with the <cite>DEBUG</cite>
configuration key.  Defaults to <cite>False</cite>.</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.debug_log_format">
<code class="descname">debug_log_format</code><em class="property"> = '--------------------------------------------------------------------------------\n%(levelname)s in %(module)s [%(pathname)s:%(lineno)d]:\n%(message)s\n--------------------------------------------------------------------------------'</em><a class="headerlink" href="#flask.Flask.debug_log_format" title="정의 주소">¶</a></dt>
<dd><p>The logging format used for the debug logger.  This is only used when
the application is in debug mode, otherwise the attached logging
handler does the formatting.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.3에 추가.</span></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.default_config">
<code class="descname">default_config</code><em class="property"> = ImmutableDict({'JSON_AS_ASCII': True, 'USE_X_SENDFILE': False, 'SESSION_COOKIE_PATH': None, 'SESSION_COOKIE_DOMAIN': None, 'SESSION_COOKIE_NAME': 'session', 'LOGGER_NAME': None, 'DEBUG': False, 'SECRET_KEY': None, 'MAX_CONTENT_LENGTH': None, 'APPLICATION_ROOT': None, 'SERVER_NAME': None, 'PREFERRED_URL_SCHEME': 'http', 'JSONIFY_PRETTYPRINT_REGULAR': True, 'TESTING': False, 'PERMANENT_SESSION_LIFETIME': datetime.timedelta(31), 'PROPAGATE_EXCEPTIONS': None, 'TRAP_BAD_REQUEST_ERRORS': False, 'JSON_SORT_KEYS': True, 'SESSION_COOKIE_HTTPONLY': True, 'SEND_FILE_MAX_AGE_DEFAULT': 43200, 'PRESERVE_CONTEXT_ON_EXCEPTION': None, 'SESSION_COOKIE_SECURE': False, 'TRAP_HTTP_EXCEPTIONS': False})</em><a class="headerlink" href="#flask.Flask.default_config" title="정의 주소">¶</a></dt>
<dd><p>Default configuration parameters.</p>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.dispatch_request">
<code class="descname">dispatch_request</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.dispatch_request" title="정의 주소">¶</a></dt>
<dd><p>Does the request dispatching.  Matches the URL and returns the
return value of the view or error handler.  This does not have to
be a response object.  In order to convert the return value to a
proper response object, call <a class="reference internal" href="index.html#flask.make_response" title="flask.make_response"><code class="xref py py-func docutils literal"><span class="pre">make_response()</span></code></a>.</p>
<div class="versionchanged">
<p><span class="versionmodified">버전 0.7으로 변경: </span>This no longer does the exception handling, this code was
moved to the new <a class="reference internal" href="index.html#flask.Flask.full_dispatch_request" title="flask.Flask.full_dispatch_request"><code class="xref py py-meth docutils literal"><span class="pre">full_dispatch_request()</span></code></a>.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.do_teardown_appcontext">
<code class="descname">do_teardown_appcontext</code><span class="sig-paren">(</span><em>exc=None</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.do_teardown_appcontext" title="정의 주소">¶</a></dt>
<dd><p>Called when an application context is popped.  This works pretty
much the same as <a class="reference internal" href="index.html#flask.Flask.do_teardown_request" title="flask.Flask.do_teardown_request"><code class="xref py py-meth docutils literal"><span class="pre">do_teardown_request()</span></code></a> but for the application
context.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.9에 추가.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.do_teardown_request">
<code class="descname">do_teardown_request</code><span class="sig-paren">(</span><em>exc=None</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.do_teardown_request" title="정의 주소">¶</a></dt>
<dd><p>Called after the actual request dispatching and will
call every as <a class="reference internal" href="index.html#flask.Flask.teardown_request" title="flask.Flask.teardown_request"><code class="xref py py-meth docutils literal"><span class="pre">teardown_request()</span></code></a> decorated function.  This is
not actually called by the <a class="reference internal" href="index.html#flask.Flask" title="flask.Flask"><code class="xref py py-class docutils literal"><span class="pre">Flask</span></code></a> object itself but is always
triggered when the request context is popped.  That way we have a
tighter control over certain resources under testing environments.</p>
<div class="versionchanged">
<p><span class="versionmodified">버전 0.9으로 변경: </span>Added the <cite>exc</cite> argument.  Previously this was always using the
current exception information.</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.enable_modules">
<code class="descname">enable_modules</code><em class="property"> = True</em><a class="headerlink" href="#flask.Flask.enable_modules" title="정의 주소">¶</a></dt>
<dd><p>Enable the deprecated module support?  This is active by default
in 0.7 but will be changed to False in 0.8.  With Flask 1.0 modules
will be removed in favor of Blueprints</p>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.endpoint">
<code class="descname">endpoint</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.endpoint" title="정의 주소">¶</a></dt>
<dd><p>A decorator to register a function as an endpoint.
Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.endpoint</span><span class="p">(</span><span class="s">&#39;example.endpoint&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">example</span><span class="p">():</span>
    <span class="k">return</span> <span class="s">&quot;example&quot;</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><strong>endpoint</strong> &#8211; the name of the endpoint</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.error_handler_spec">
<code class="descname">error_handler_spec</code><em class="property"> = None</em><a class="headerlink" href="#flask.Flask.error_handler_spec" title="정의 주소">¶</a></dt>
<dd><p>A dictionary of all registered error handlers.  The key is <cite>None</cite>
for error handlers active on the application, otherwise the key is
the name of the blueprint.  Each key points to another dictionary
where they key is the status code of the http exception.  The
special key <cite>None</cite> points to a list of tuples where the first item
is the class for the instance check and the second the error handler
function.</p>
<p>To register a error handler, use the <a class="reference internal" href="index.html#flask.Flask.errorhandler" title="flask.Flask.errorhandler"><code class="xref py py-meth docutils literal"><span class="pre">errorhandler()</span></code></a>
decorator.</p>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.errorhandler">
<code class="descname">errorhandler</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.errorhandler" title="정의 주소">¶</a></dt>
<dd><p>A decorator that is used to register a function give a given
error code.  Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.errorhandler</span><span class="p">(</span><span class="mi">404</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">page_not_found</span><span class="p">(</span><span class="n">error</span><span class="p">):</span>
    <span class="k">return</span> <span class="s">&#39;This page does not exist&#39;</span><span class="p">,</span> <span class="mi">404</span>
</pre></div>
</div>
<p>You can also register handlers for arbitrary exceptions:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.errorhandler</span><span class="p">(</span><span class="n">DatabaseError</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">special_exception_handler</span><span class="p">(</span><span class="n">error</span><span class="p">):</span>
    <span class="k">return</span> <span class="s">&#39;Database connection failed&#39;</span><span class="p">,</span> <span class="mi">500</span>
</pre></div>
</div>
<p>You can also register a function as error handler without using
the <a class="reference internal" href="index.html#flask.Flask.errorhandler" title="flask.Flask.errorhandler"><code class="xref py py-meth docutils literal"><span class="pre">errorhandler()</span></code></a> decorator.  The following example is
equivalent to the one above:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">page_not_found</span><span class="p">(</span><span class="n">error</span><span class="p">):</span>
    <span class="k">return</span> <span class="s">&#39;This page does not exist&#39;</span><span class="p">,</span> <span class="mi">404</span>
<span class="n">app</span><span class="o">.</span><span class="n">error_handler_spec</span><span class="p">[</span><span class="bp">None</span><span class="p">][</span><span class="mi">404</span><span class="p">]</span> <span class="o">=</span> <span class="n">page_not_found</span>
</pre></div>
</div>
<p>Setting error handlers via assignments to <a class="reference internal" href="index.html#flask.Flask.error_handler_spec" title="flask.Flask.error_handler_spec"><code class="xref py py-attr docutils literal"><span class="pre">error_handler_spec</span></code></a>
however is discouraged as it requires fiddling with nested dictionaries
and the special case for arbitrary exception types.</p>
<p>The first <cite>None</cite> refers to the active blueprint.  If the error
handler should be application wide <cite>None</cite> shall be used.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.7에 추가: </span>One can now additionally also register custom exception types
that do not necessarily have to be a subclass of the
<a class="reference external" href="http://werkzeug.pocoo.org/docs/exceptions/#werkzeug.exceptions.HTTPException" title="(in Werkzeug v0.11-dev)"><code class="xref py py-class docutils literal"><span class="pre">HTTPException</span></code></a> class.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><strong>code</strong> &#8211; the code as integer for the handler</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.extensions">
<code class="descname">extensions</code><em class="property"> = None</em><a class="headerlink" href="#flask.Flask.extensions" title="정의 주소">¶</a></dt>
<dd><p>a place where extensions can store application specific state.  For
example this is where an extension could store database engines and
similar things.  For backwards compatibility extensions should register
themselves like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="s">&#39;extensions&#39;</span><span class="p">):</span>
    <span class="n">app</span><span class="o">.</span><span class="n">extensions</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">app</span><span class="o">.</span><span class="n">extensions</span><span class="p">[</span><span class="s">&#39;extensionname&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SomeObject</span><span class="p">()</span>
</pre></div>
</div>
<p>The key must match the name of the <cite>flaskext</cite> module.  For example in
case of a &#8220;Flask-Foo&#8221; extension in <cite>flaskext.foo</cite>, the key would be
<code class="docutils literal"><span class="pre">'foo'</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.7에 추가.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.full_dispatch_request">
<code class="descname">full_dispatch_request</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.full_dispatch_request" title="정의 주소">¶</a></dt>
<dd><p>Dispatches the request and on top of that performs request
pre and postprocessing as well as HTTP exception catching and
error handling.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.7에 추가.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.get_send_file_max_age">
<code class="descname">get_send_file_max_age</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.get_send_file_max_age" title="정의 주소">¶</a></dt>
<dd><p>Provides default cache_timeout for the <a class="reference internal" href="index.html#flask.send_file" title="flask.send_file"><code class="xref py py-func docutils literal"><span class="pre">send_file()</span></code></a> functions.</p>
<p>By default, this function returns <code class="docutils literal"><span class="pre">SEND_FILE_MAX_AGE_DEFAULT</span></code> from
the configuration of <a class="reference internal" href="index.html#flask.current_app" title="flask.current_app"><code class="xref py py-data docutils literal"><span class="pre">current_app</span></code></a>.</p>
<p>Static file functions such as <a class="reference internal" href="index.html#flask.send_from_directory" title="flask.send_from_directory"><code class="xref py py-func docutils literal"><span class="pre">send_from_directory()</span></code></a> use this
function, and <a class="reference internal" href="index.html#flask.send_file" title="flask.send_file"><code class="xref py py-func docutils literal"><span class="pre">send_file()</span></code></a> calls this function on
<a class="reference internal" href="index.html#flask.current_app" title="flask.current_app"><code class="xref py py-data docutils literal"><span class="pre">current_app</span></code></a> when the given cache_timeout is <cite>None</cite>. If a
cache_timeout is given in <a class="reference internal" href="index.html#flask.send_file" title="flask.send_file"><code class="xref py py-func docutils literal"><span class="pre">send_file()</span></code></a>, that timeout is used;
otherwise, this method is called.</p>
<p>This allows subclasses to change the behavior when sending files based
on the filename.  For example, to set the cache timeout for .js files
to 60 seconds:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MyFlask</span><span class="p">(</span><span class="n">flask</span><span class="o">.</span><span class="n">Flask</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get_send_file_max_age</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">&#39;.js&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">60</span>
        <span class="k">return</span> <span class="n">flask</span><span class="o">.</span><span class="n">Flask</span><span class="o">.</span><span class="n">get_send_file_max_age</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">버전 0.9에 추가.</span></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.got_first_request">
<code class="descname">got_first_request</code><a class="headerlink" href="#flask.Flask.got_first_request" title="정의 주소">¶</a></dt>
<dd><p>This attribute is set to <cite>True</cite> if the application started
handling the first request.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.8에 추가.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.handle_exception">
<code class="descname">handle_exception</code><span class="sig-paren">(</span><em>e</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.handle_exception" title="정의 주소">¶</a></dt>
<dd><p>Default exception handling that kicks in when an exception
occurs that is not caught.  In debug mode the exception will
be re-raised immediately, otherwise it is logged and the handler
for a 500 internal server error is used.  If no such handler
exists, a default 500 internal server error message is displayed.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.3에 추가.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.handle_http_exception">
<code class="descname">handle_http_exception</code><span class="sig-paren">(</span><em>e</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.handle_http_exception" title="정의 주소">¶</a></dt>
<dd><p>Handles an HTTP exception.  By default this will invoke the
registered error handlers and fall back to returning the
exception as response.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.3에 추가.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.handle_url_build_error">
<code class="descname">handle_url_build_error</code><span class="sig-paren">(</span><em>error</em>, <em>endpoint</em>, <em>values</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.handle_url_build_error" title="정의 주소">¶</a></dt>
<dd><p>Handle <code class="xref py py-class docutils literal"><span class="pre">BuildError</span></code> on <a class="reference internal" href="index.html#flask.url_for" title="flask.url_for"><code class="xref py py-meth docutils literal"><span class="pre">url_for()</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.handle_user_exception">
<code class="descname">handle_user_exception</code><span class="sig-paren">(</span><em>e</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.handle_user_exception" title="정의 주소">¶</a></dt>
<dd><p>This method is called whenever an exception occurs that should be
handled.  A special case are
<code class="xref py py-class docutils literal"><span class="pre">HTTPException</span></code>s which are forwarded by
this function to the <a class="reference internal" href="index.html#flask.Flask.handle_http_exception" title="flask.Flask.handle_http_exception"><code class="xref py py-meth docutils literal"><span class="pre">handle_http_exception()</span></code></a> method.  This
function will either return a response value or reraise the
exception with the same traceback.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.7에 추가.</span></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.has_static_folder">
<code class="descname">has_static_folder</code><a class="headerlink" href="#flask.Flask.has_static_folder" title="정의 주소">¶</a></dt>
<dd><p>This is <cite>True</cite> if the package bound object&#8217;s container has a
folder named <code class="docutils literal"><span class="pre">'static'</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.5에 추가.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.init_jinja_globals">
<code class="descname">init_jinja_globals</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.init_jinja_globals" title="정의 주소">¶</a></dt>
<dd><p>Deprecated.  Used to initialize the Jinja2 globals.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.5에 추가.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">버전 0.7으로 변경: </span>This method is deprecated with 0.7.  Override
<a class="reference internal" href="index.html#flask.Flask.create_jinja_environment" title="flask.Flask.create_jinja_environment"><code class="xref py py-meth docutils literal"><span class="pre">create_jinja_environment()</span></code></a> instead.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.inject_url_defaults">
<code class="descname">inject_url_defaults</code><span class="sig-paren">(</span><em>endpoint</em>, <em>values</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.inject_url_defaults" title="정의 주소">¶</a></dt>
<dd><p>Injects the URL defaults for the given endpoint directly into
the values dictionary passed.  This is used internally and
automatically called on URL building.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.7에 추가.</span></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.instance_path">
<code class="descname">instance_path</code><em class="property"> = None</em><a class="headerlink" href="#flask.Flask.instance_path" title="정의 주소">¶</a></dt>
<dd><p>Holds the path to the instance folder.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.8에 추가.</span></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.jinja_env">
<code class="descname">jinja_env</code><a class="headerlink" href="#flask.Flask.jinja_env" title="정의 주소">¶</a></dt>
<dd><p>The Jinja2 environment used to load templates.</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.jinja_loader">
<code class="descname">jinja_loader</code><a class="headerlink" href="#flask.Flask.jinja_loader" title="정의 주소">¶</a></dt>
<dd><p>The Jinja loader for this package bound object.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.5에 추가.</span></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.jinja_options">
<code class="descname">jinja_options</code><em class="property"> = ImmutableDict({'extensions': ['jinja2.ext.autoescape', 'jinja2.ext.with_']})</em><a class="headerlink" href="#flask.Flask.jinja_options" title="정의 주소">¶</a></dt>
<dd><p>Options that are passed directly to the Jinja2 environment.</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.json_decoder">
<code class="descname">json_decoder</code><a class="headerlink" href="#flask.Flask.json_decoder" title="정의 주소">¶</a></dt>
<dd><p>The JSON decoder class to use.  Defaults to <a class="reference internal" href="index.html#flask.json.JSONDecoder" title="flask.json.JSONDecoder"><code class="xref py py-class docutils literal"><span class="pre">JSONDecoder</span></code></a>.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.10에 추가.</span></p>
</div>
<p>alias of <code class="xref py py-class docutils literal"><span class="pre">JSONDecoder</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.json_encoder">
<code class="descname">json_encoder</code><a class="headerlink" href="#flask.Flask.json_encoder" title="정의 주소">¶</a></dt>
<dd><p>The JSON encoder class to use.  Defaults to <a class="reference internal" href="index.html#flask.json.JSONEncoder" title="flask.json.JSONEncoder"><code class="xref py py-class docutils literal"><span class="pre">JSONEncoder</span></code></a>.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.10에 추가.</span></p>
</div>
<p>alias of <code class="xref py py-class docutils literal"><span class="pre">JSONEncoder</span></code></p>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.log_exception">
<code class="descname">log_exception</code><span class="sig-paren">(</span><em>exc_info</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.log_exception" title="정의 주소">¶</a></dt>
<dd><p>Logs an exception.  This is called by <a class="reference internal" href="index.html#flask.Flask.handle_exception" title="flask.Flask.handle_exception"><code class="xref py py-meth docutils literal"><span class="pre">handle_exception()</span></code></a>
if debugging is disabled and right before the handler is called.
The default implementation logs the exception as error on the
<a class="reference internal" href="index.html#flask.Flask.logger" title="flask.Flask.logger"><code class="xref py py-attr docutils literal"><span class="pre">logger</span></code></a>.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.8에 추가.</span></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.logger">
<code class="descname">logger</code><a class="headerlink" href="#flask.Flask.logger" title="정의 주소">¶</a></dt>
<dd><p>A <a class="reference external" href="http://docs.python.org/dev/library/logging.html#logging.Logger" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">logging.Logger</span></code></a> object for this application.  The
default configuration is to log to stderr if the application is
in debug mode.  This logger can be used to (surprise) log messages.
Here some examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">app</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;A value for debugging&#39;</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">&#39;A warning occurred (</span><span class="si">%d</span><span class="s"> apples)&#39;</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s">&#39;An error occurred&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">버전 0.3에 추가.</span></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.logger_name">
<code class="descname">logger_name</code><a class="headerlink" href="#flask.Flask.logger_name" title="정의 주소">¶</a></dt>
<dd><p>The name of the logger to use.  By default the logger name is the
package name passed to the constructor.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.4에 추가.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.make_config">
<code class="descname">make_config</code><span class="sig-paren">(</span><em>instance_relative=False</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.make_config" title="정의 주소">¶</a></dt>
<dd><p>Used to create the config attribute by the Flask constructor.
The <cite>instance_relative</cite> parameter is passed in from the constructor
of Flask (there named <cite>instance_relative_config</cite>) and indicates if
the config should be relative to the instance path or the root path
of the application.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.8에 추가.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.make_default_options_response">
<code class="descname">make_default_options_response</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.make_default_options_response" title="정의 주소">¶</a></dt>
<dd><p>This method is called to create the default <cite>OPTIONS</cite> response.
This can be changed through subclassing to change the default
behavior of <cite>OPTIONS</cite> responses.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.7에 추가.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.make_null_session">
<code class="descname">make_null_session</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.make_null_session" title="정의 주소">¶</a></dt>
<dd><p>Creates a new instance of a missing session.  Instead of overriding
this method we recommend replacing the <a class="reference internal" href="index.html#flask.Flask.session_interface" title="flask.Flask.session_interface"><code class="xref py py-class docutils literal"><span class="pre">session_interface</span></code></a>.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.7에 추가.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.make_response">
<code class="descname">make_response</code><span class="sig-paren">(</span><em>rv</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.make_response" title="정의 주소">¶</a></dt>
<dd><p>Converts the return value from a view function to a real
response object that is an instance of <a class="reference internal" href="index.html#flask.Flask.response_class" title="flask.Flask.response_class"><code class="xref py py-attr docutils literal"><span class="pre">response_class</span></code></a>.</p>
<p>The following types are allowed for <cite>rv</cite>:</p>
<table border="1" class="docutils">
<colgroup>
<col width="35%" />
<col width="65%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="index.html#flask.Flask.response_class" title="flask.Flask.response_class"><code class="xref py py-attr docutils literal"><span class="pre">response_class</span></code></a></td>
<td>the object is returned unchanged</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="http://docs.python.org/dev/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a></td>
<td>a response object is created with the
string as body</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-class docutils literal"><span class="pre">unicode</span></code></td>
<td>a response object is created with the
string encoded to utf-8 as body</td>
</tr>
<tr class="row-even"><td>a WSGI function</td>
<td>the function is called as WSGI application
and buffered as response object</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="http://docs.python.org/dev/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">tuple</span></code></a></td>
<td>A tuple in the form <code class="docutils literal"><span class="pre">(response,</span> <span class="pre">status,</span>
<span class="pre">headers)</span></code> where <cite>response</cite> is any of the
types defined here, <cite>status</cite> is a string
or an integer and <cite>headers</cite> is a list of
a dictionary with header values.</td>
</tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><strong>rv</strong> &#8211; the return value from the view function</td>
</tr>
</tbody>
</table>
<div class="versionchanged">
<p><span class="versionmodified">버전 0.9으로 변경: </span>Previously a tuple was interpreted as the arguments for the
response object.</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.name">
<code class="descname">name</code><a class="headerlink" href="#flask.Flask.name" title="정의 주소">¶</a></dt>
<dd><p>The name of the application.  This is usually the import name
with the difference that it&#8217;s guessed from the run file if the
import name is main.  This name is used as a display name when
Flask needs the name of the application.  It can be set and overridden
to change the value.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.8에 추가.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.open_instance_resource">
<code class="descname">open_instance_resource</code><span class="sig-paren">(</span><em>resource</em>, <em>mode='rb'</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.open_instance_resource" title="정의 주소">¶</a></dt>
<dd><p>Opens a resource from the application&#8217;s instance folder
(<a class="reference internal" href="index.html#flask.Flask.instance_path" title="flask.Flask.instance_path"><code class="xref py py-attr docutils literal"><span class="pre">instance_path</span></code></a>).  Otherwise works like
<a class="reference internal" href="index.html#flask.Flask.open_resource" title="flask.Flask.open_resource"><code class="xref py py-meth docutils literal"><span class="pre">open_resource()</span></code></a>.  Instance resources can also be opened for
writing.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><ul class="first last simple">
<li><strong>resource</strong> &#8211; the name of the resource.  To access resources within
subfolders use forward slashes as separator.</li>
<li><strong>mode</strong> &#8211; resource file opening mode, default is &#8216;rb&#8217;.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.open_resource">
<code class="descname">open_resource</code><span class="sig-paren">(</span><em>resource</em>, <em>mode='rb'</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.open_resource" title="정의 주소">¶</a></dt>
<dd><p>Opens a resource from the application&#8217;s resource folder.  To see
how this works, consider the following folder structure:</p>
<div class="highlight-python"><div class="highlight"><pre>/myapplication.py
/schema.sql
/static
    /style.css
/templates
    /layout.html
    /index.html
</pre></div>
</div>
<p>If you want to open the <cite>schema.sql</cite> file you would do the
following:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">with</span> <span class="n">app</span><span class="o">.</span><span class="n">open_resource</span><span class="p">(</span><span class="s">&#39;schema.sql&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">contents</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">do_something_with</span><span class="p">(</span><span class="n">contents</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><ul class="first last simple">
<li><strong>resource</strong> &#8211; the name of the resource.  To access resources within
subfolders use forward slashes as separator.</li>
<li><strong>mode</strong> &#8211; resource file opening mode, default is &#8216;rb&#8217;.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.open_session">
<code class="descname">open_session</code><span class="sig-paren">(</span><em>request</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.open_session" title="정의 주소">¶</a></dt>
<dd><p>Creates or opens a new session.  Default implementation stores all
session data in a signed cookie.  This requires that the
<a class="reference internal" href="index.html#flask.Flask.secret_key" title="flask.Flask.secret_key"><code class="xref py py-attr docutils literal"><span class="pre">secret_key</span></code></a> is set.  Instead of overriding this method
we recommend replacing the <a class="reference internal" href="index.html#flask.Flask.session_interface" title="flask.Flask.session_interface"><code class="xref py py-class docutils literal"><span class="pre">session_interface</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><strong>request</strong> &#8211; an instance of <a class="reference internal" href="index.html#flask.Flask.request_class" title="flask.Flask.request_class"><code class="xref py py-attr docutils literal"><span class="pre">request_class</span></code></a>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.permanent_session_lifetime">
<code class="descname">permanent_session_lifetime</code><a class="headerlink" href="#flask.Flask.permanent_session_lifetime" title="정의 주소">¶</a></dt>
<dd><p>A <a class="reference external" href="http://docs.python.org/dev/library/datetime.html#datetime.timedelta" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">timedelta</span></code></a> which is used to set the expiration
date of a permanent session.  The default is 31 days which makes a
permanent session survive for roughly one month.</p>
<p>This attribute can also be configured from the config with the
<cite>PERMANENT_SESSION_LIFETIME</cite> configuration key.  Defaults to
<code class="docutils literal"><span class="pre">timedelta(days=31)</span></code></p>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.preprocess_request">
<code class="descname">preprocess_request</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.preprocess_request" title="정의 주소">¶</a></dt>
<dd><p>Called before the actual request dispatching and will
call every as <a class="reference internal" href="index.html#flask.Flask.before_request" title="flask.Flask.before_request"><code class="xref py py-meth docutils literal"><span class="pre">before_request()</span></code></a> decorated function.
If any of these function returns a value it&#8217;s handled as
if it was the return value from the view and further
request handling is stopped.</p>
<p>This also triggers the <code class="xref py py-meth docutils literal"><span class="pre">url_value_processor()</span></code> functions before
the actual <a class="reference internal" href="index.html#flask.Flask.before_request" title="flask.Flask.before_request"><code class="xref py py-meth docutils literal"><span class="pre">before_request()</span></code></a> functions are called.</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.preserve_context_on_exception">
<code class="descname">preserve_context_on_exception</code><a class="headerlink" href="#flask.Flask.preserve_context_on_exception" title="정의 주소">¶</a></dt>
<dd><p>Returns the value of the <cite>PRESERVE_CONTEXT_ON_EXCEPTION</cite>
configuration value in case it&#8217;s set, otherwise a sensible default
is returned.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.7에 추가.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.process_response">
<code class="descname">process_response</code><span class="sig-paren">(</span><em>response</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.process_response" title="정의 주소">¶</a></dt>
<dd><p>Can be overridden in order to modify the response object
before it&#8217;s sent to the WSGI server.  By default this will
call all the <a class="reference internal" href="index.html#flask.Flask.after_request" title="flask.Flask.after_request"><code class="xref py py-meth docutils literal"><span class="pre">after_request()</span></code></a> decorated functions.</p>
<div class="versionchanged">
<p><span class="versionmodified">버전 0.5으로 변경: </span>As of Flask 0.5 the functions registered for after request
execution are called in reverse order of registration.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><strong>response</strong> &#8211; a <a class="reference internal" href="index.html#flask.Flask.response_class" title="flask.Flask.response_class"><code class="xref py py-attr docutils literal"><span class="pre">response_class</span></code></a> object.</td>
</tr>
<tr class="field-even field"><th class="field-name">반환:</th><td class="field-body">a new response object or the same, has to be an
instance of <a class="reference internal" href="index.html#flask.Flask.response_class" title="flask.Flask.response_class"><code class="xref py py-attr docutils literal"><span class="pre">response_class</span></code></a>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.propagate_exceptions">
<code class="descname">propagate_exceptions</code><a class="headerlink" href="#flask.Flask.propagate_exceptions" title="정의 주소">¶</a></dt>
<dd><p>Returns the value of the <cite>PROPAGATE_EXCEPTIONS</cite> configuration
value in case it&#8217;s set, otherwise a sensible default is returned.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.7에 추가.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.register_blueprint">
<code class="descname">register_blueprint</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.register_blueprint" title="정의 주소">¶</a></dt>
<dd><p>Registers a blueprint on the application.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.7에 추가.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.register_error_handler">
<code class="descname">register_error_handler</code><span class="sig-paren">(</span><em>code_or_exception</em>, <em>f</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.register_error_handler" title="정의 주소">¶</a></dt>
<dd><p>Alternative error attach function to the <a class="reference internal" href="index.html#flask.Flask.errorhandler" title="flask.Flask.errorhandler"><code class="xref py py-meth docutils literal"><span class="pre">errorhandler()</span></code></a>
decorator that is more straightforward to use for non decorator
usage.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.7에 추가.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.register_module">
<code class="descname">register_module</code><span class="sig-paren">(</span><em>module</em>, <em>**options</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.register_module" title="정의 주소">¶</a></dt>
<dd><p>Registers a module with this application.  The keyword argument
of this function are the same as the ones for the constructor of the
<code class="xref py py-class docutils literal"><span class="pre">Module</span></code> class and will override the values of the module if
provided.</p>
<div class="versionchanged">
<p><span class="versionmodified">버전 0.7으로 변경: </span>The module system was deprecated in favor for the blueprint
system.</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.request_class">
<code class="descname">request_class</code><a class="headerlink" href="#flask.Flask.request_class" title="정의 주소">¶</a></dt>
<dd><p>The class that is used for request objects.  See <a class="reference internal" href="index.html#flask.Request" title="flask.Request"><code class="xref py py-class docutils literal"><span class="pre">Request</span></code></a>
for more information.</p>
<p>alias of <a class="reference internal" href="index.html#flask.Request" title="flask.Request"><code class="xref py py-class docutils literal"><span class="pre">Request</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.request_context">
<code class="descname">request_context</code><span class="sig-paren">(</span><em>environ</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.request_context" title="정의 주소">¶</a></dt>
<dd><p>Creates a <a class="reference internal" href="index.html#flask.ctx.RequestContext" title="flask.ctx.RequestContext"><code class="xref py py-class docutils literal"><span class="pre">RequestContext</span></code></a> from the given
environment and binds it to the current context.  This must be used in
combination with the <cite>with</cite> statement because the request is only bound
to the current context for the duration of the <cite>with</cite> block.</p>
<p>Example usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">with</span> <span class="n">app</span><span class="o">.</span><span class="n">request_context</span><span class="p">(</span><span class="n">environ</span><span class="p">):</span>
    <span class="n">do_something_with</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
</pre></div>
</div>
<p>The object returned can also be used without the <cite>with</cite> statement
which is useful for working in the shell.  The example above is
doing exactly the same as this code:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">ctx</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">request_context</span><span class="p">(</span><span class="n">environ</span><span class="p">)</span>
<span class="n">ctx</span><span class="o">.</span><span class="n">push</span><span class="p">()</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">do_something_with</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="n">ctx</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</pre></div>
</div>
<div class="versionchanged">
<p><span class="versionmodified">버전 0.3으로 변경: </span>Added support for non-with statement usage and <cite>with</cite> statement
is now passed the ctx object.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><strong>environ</strong> &#8211; a WSGI environment</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.response_class">
<code class="descname">response_class</code><a class="headerlink" href="#flask.Flask.response_class" title="정의 주소">¶</a></dt>
<dd><p>The class that is used for response objects.  See
<a class="reference internal" href="index.html#flask.Response" title="flask.Response"><code class="xref py py-class docutils literal"><span class="pre">Response</span></code></a> for more information.</p>
<p>alias of <a class="reference internal" href="index.html#flask.Response" title="flask.Response"><code class="xref py py-class docutils literal"><span class="pre">Response</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.route">
<code class="descname">route</code><span class="sig-paren">(</span><em>rule</em>, <em>**options</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.route" title="정의 주소">¶</a></dt>
<dd><p>A decorator that is used to register a view function for a
given URL rule.  This does the same thing as <a class="reference internal" href="index.html#flask.Flask.add_url_rule" title="flask.Flask.add_url_rule"><code class="xref py py-meth docutils literal"><span class="pre">add_url_rule()</span></code></a>
but is intended for decorator usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">return</span> <span class="s">&#39;Hello World&#39;</span>
</pre></div>
</div>
<p>For more information refer to <a class="reference internal" href="index.html#url-route-registrations"><span>URL Route Registrations</span></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><ul class="first last simple">
<li><strong>rule</strong> &#8211; the URL rule as string</li>
<li><strong>endpoint</strong> &#8211; the endpoint for the registered URL rule.  Flask
itself assumes the name of the view function as
endpoint</li>
<li><strong>options</strong> &#8211; the options to be forwarded to the underlying
<a class="reference external" href="http://werkzeug.pocoo.org/docs/routing/#werkzeug.routing.Rule" title="(in Werkzeug v0.11-dev)"><code class="xref py py-class docutils literal"><span class="pre">Rule</span></code></a> object.  A change
to Werkzeug is handling of method options.  methods
is a list of methods this rule should be limited
to (<cite>GET</cite>, <cite>POST</cite> etc.).  By default a rule
just listens for <cite>GET</cite> (and implicitly <cite>HEAD</cite>).
Starting with Flask 0.6, <cite>OPTIONS</cite> is implicitly
added and handled by the standard request handling.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>host=None</em>, <em>port=None</em>, <em>debug=None</em>, <em>**options</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.run" title="정의 주소">¶</a></dt>
<dd><p>Runs the application on a local development server.  If the
<a class="reference internal" href="index.html#flask.Flask.debug" title="flask.Flask.debug"><code class="xref py py-attr docutils literal"><span class="pre">debug</span></code></a> flag is set the server will automatically reload
for code changes and show a debugger in case an exception happened.</p>
<p>If you want to run the application in debug mode, but disable the
code execution on the interactive debugger, you can pass
<code class="docutils literal"><span class="pre">use_evalex=False</span></code> as parameter.  This will keep the debugger&#8217;s
traceback screen active, but disable code execution.</p>
<div class="admonition-keep-in-mind admonition">
<p class="first admonition-title">Keep in Mind</p>
<p class="last">Flask will suppress any server error with a generic error page
unless it is in debug mode.  As such to enable just the
interactive debugger without the code reloading, you have to
invoke <a class="reference internal" href="index.html#flask.Flask.run" title="flask.Flask.run"><code class="xref py py-meth docutils literal"><span class="pre">run()</span></code></a> with <code class="docutils literal"><span class="pre">debug=True</span></code> and <code class="docutils literal"><span class="pre">use_reloader=False</span></code>.
Setting <code class="docutils literal"><span class="pre">use_debugger</span></code> to <cite>True</cite> without being in debug mode
won&#8217;t catch any exceptions because there won&#8217;t be any to
catch.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">버전 0.10으로 변경: </span>The default port is now picked from the <code class="docutils literal"><span class="pre">SERVER_NAME</span></code> variable.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><ul class="first last simple">
<li><strong>host</strong> &#8211; the hostname to listen on. Set this to <code class="docutils literal"><span class="pre">'0.0.0.0'</span></code> to
have the server available externally as well. Defaults to
<code class="docutils literal"><span class="pre">'127.0.0.1'</span></code>.</li>
<li><strong>port</strong> &#8211; the port of the webserver. Defaults to <code class="docutils literal"><span class="pre">5000</span></code> or the
port defined in the <code class="docutils literal"><span class="pre">SERVER_NAME</span></code> config variable if
present.</li>
<li><strong>debug</strong> &#8211; if given, enable or disable debug mode.
See <a class="reference internal" href="index.html#flask.Flask.debug" title="flask.Flask.debug"><code class="xref py py-attr docutils literal"><span class="pre">debug</span></code></a>.</li>
<li><strong>options</strong> &#8211; the options to be forwarded to the underlying
Werkzeug server.  See
<a class="reference external" href="http://werkzeug.pocoo.org/docs/serving/#werkzeug.serving.run_simple" title="(in Werkzeug v0.11-dev)"><code class="xref py py-func docutils literal"><span class="pre">werkzeug.serving.run_simple()</span></code></a> for more
information.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.save_session">
<code class="descname">save_session</code><span class="sig-paren">(</span><em>session</em>, <em>response</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.save_session" title="정의 주소">¶</a></dt>
<dd><p>Saves the session if it needs updates.  For the default
implementation, check <a class="reference internal" href="index.html#flask.Flask.open_session" title="flask.Flask.open_session"><code class="xref py py-meth docutils literal"><span class="pre">open_session()</span></code></a>.  Instead of overriding this
method we recommend replacing the <a class="reference internal" href="index.html#flask.Flask.session_interface" title="flask.Flask.session_interface"><code class="xref py py-class docutils literal"><span class="pre">session_interface</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><ul class="first last simple">
<li><strong>session</strong> &#8211; the session to be saved (a
<a class="reference external" href="http://werkzeug.pocoo.org/docs/contrib/securecookie/#werkzeug.contrib.securecookie.SecureCookie" title="(in Werkzeug v0.11-dev)"><code class="xref py py-class docutils literal"><span class="pre">SecureCookie</span></code></a>
object)</li>
<li><strong>response</strong> &#8211; an instance of <a class="reference internal" href="index.html#flask.Flask.response_class" title="flask.Flask.response_class"><code class="xref py py-attr docutils literal"><span class="pre">response_class</span></code></a></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.secret_key">
<code class="descname">secret_key</code><a class="headerlink" href="#flask.Flask.secret_key" title="정의 주소">¶</a></dt>
<dd><p>If a secret key is set, cryptographic components can use this to
sign cookies and other things.  Set this to a complex random value
when you want to use the secure cookie for instance.</p>
<p>This attribute can also be configured from the config with the
<cite>SECRET_KEY</cite> configuration key.  Defaults to <cite>None</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.select_jinja_autoescape">
<code class="descname">select_jinja_autoescape</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.select_jinja_autoescape" title="정의 주소">¶</a></dt>
<dd><p>Returns <cite>True</cite> if autoescaping should be active for the given
template name.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.5에 추가.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.send_static_file">
<code class="descname">send_static_file</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.send_static_file" title="정의 주소">¶</a></dt>
<dd><p>Function used internally to send static files from the static
folder to the browser.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.5에 추가.</span></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.session_cookie_name">
<code class="descname">session_cookie_name</code><a class="headerlink" href="#flask.Flask.session_cookie_name" title="정의 주소">¶</a></dt>
<dd><p>The secure cookie uses this for the name of the session cookie.</p>
<p>This attribute can also be configured from the config with the
<cite>SESSION_COOKIE_NAME</cite> configuration key.  Defaults to <code class="docutils literal"><span class="pre">'session'</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.session_interface">
<code class="descname">session_interface</code><em class="property"> = &lt;flask.sessions.SecureCookieSessionInterface object&gt;</em><a class="headerlink" href="#flask.Flask.session_interface" title="정의 주소">¶</a></dt>
<dd><p>the session interface to use.  By default an instance of
<a class="reference internal" href="index.html#flask.sessions.SecureCookieSessionInterface" title="flask.sessions.SecureCookieSessionInterface"><code class="xref py py-class docutils literal"><span class="pre">SecureCookieSessionInterface</span></code></a> is used here.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.8에 추가.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.should_ignore_error">
<code class="descname">should_ignore_error</code><span class="sig-paren">(</span><em>error</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.should_ignore_error" title="정의 주소">¶</a></dt>
<dd><p>This is called to figure out if an error should be ignored
or not as far as the teardown system is concerned.  If this
function returns <cite>True</cite> then the teardown handlers will not be
passed the error.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.10에 추가.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.teardown_appcontext">
<code class="descname">teardown_appcontext</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.teardown_appcontext" title="정의 주소">¶</a></dt>
<dd><p>Registers a function to be called when the application context
ends.  These functions are typically also called when the request
context is popped.</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">ctx</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">app_context</span><span class="p">()</span>
<span class="n">ctx</span><span class="o">.</span><span class="n">push</span><span class="p">()</span>
<span class="o">...</span>
<span class="n">ctx</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</pre></div>
</div>
<p>When <code class="docutils literal"><span class="pre">ctx.pop()</span></code> is executed in the above example, the teardown
functions are called just before the app context moves from the
stack of active contexts.  This becomes relevant if you are using
such constructs in tests.</p>
<p>Since a request context typically also manages an application
context it would also be called when you pop a request context.</p>
<p>When a teardown function was called because of an exception it will
be passed an error object.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.9에 추가.</span></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.teardown_appcontext_funcs">
<code class="descname">teardown_appcontext_funcs</code><em class="property"> = None</em><a class="headerlink" href="#flask.Flask.teardown_appcontext_funcs" title="정의 주소">¶</a></dt>
<dd><p>A list of functions that are called when the application context
is destroyed.  Since the application context is also torn down
if the request ends this is the place to store code that disconnects
from databases.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.9에 추가.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.teardown_request">
<code class="descname">teardown_request</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.teardown_request" title="정의 주소">¶</a></dt>
<dd><p>Register a function to be run at the end of each request,
regardless of whether there was an exception or not.  These functions
are executed when the request context is popped, even if not an
actual request was performed.</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">ctx</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">test_request_context</span><span class="p">()</span>
<span class="n">ctx</span><span class="o">.</span><span class="n">push</span><span class="p">()</span>
<span class="o">...</span>
<span class="n">ctx</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</pre></div>
</div>
<p>When <code class="docutils literal"><span class="pre">ctx.pop()</span></code> is executed in the above example, the teardown
functions are called just before the request context moves from the
stack of active contexts.  This becomes relevant if you are using
such constructs in tests.</p>
<p>Generally teardown functions must take every necessary step to avoid
that they will fail.  If they do execute code that might fail they
will have to surround the execution of these code by try/except
statements and log occurring errors.</p>
<p>When a teardown function was called because of a exception it will
be passed an error object.</p>
<div class="admonition-debug-note admonition">
<p class="first admonition-title">Debug Note</p>
<p class="last">In debug mode Flask will not tear down a request on an exception
immediately.  Instead if will keep it alive so that the interactive
debugger can still access it.  This behavior can be controlled
by the <code class="docutils literal"><span class="pre">PRESERVE_CONTEXT_ON_EXCEPTION</span></code> configuration variable.</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.teardown_request_funcs">
<code class="descname">teardown_request_funcs</code><em class="property"> = None</em><a class="headerlink" href="#flask.Flask.teardown_request_funcs" title="정의 주소">¶</a></dt>
<dd><p>A dictionary with lists of functions that are called after
each request, even if an exception has occurred. The key of the
dictionary is the name of the blueprint this function is active for,
<cite>None</cite> for all requests. These functions are not allowed to modify
the request, and their return values are ignored. If an exception
occurred while processing the request, it gets passed to each
teardown_request function. To register a function here, use the
<a class="reference internal" href="index.html#flask.Flask.teardown_request" title="flask.Flask.teardown_request"><code class="xref py py-meth docutils literal"><span class="pre">teardown_request()</span></code></a> decorator.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.7에 추가.</span></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.template_context_processors">
<code class="descname">template_context_processors</code><em class="property"> = None</em><a class="headerlink" href="#flask.Flask.template_context_processors" title="정의 주소">¶</a></dt>
<dd><p>A dictionary with list of functions that are called without argument
to populate the template context.  The key of the dictionary is the
name of the blueprint this function is active for, <cite>None</cite> for all
requests.  Each returns a dictionary that the template context is
updated with.  To register a function here, use the
<a class="reference internal" href="index.html#flask.Flask.context_processor" title="flask.Flask.context_processor"><code class="xref py py-meth docutils literal"><span class="pre">context_processor()</span></code></a> decorator.</p>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.template_filter">
<code class="descname">template_filter</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.template_filter" title="정의 주소">¶</a></dt>
<dd><p>A decorator that is used to register custom template filter.
You can specify a name for the filter, otherwise the function
name will be used. Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.template_filter</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">reverse</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">s</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><strong>name</strong> &#8211; the optional name of the filter, otherwise the
function name will be used.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.template_global">
<code class="descname">template_global</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.template_global" title="정의 주소">¶</a></dt>
<dd><p>A decorator that is used to register a custom template global function.
You can specify a name for the global function, otherwise the function
name will be used. Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.template_global</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">double</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">n</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">버전 0.10에 추가.</span></p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><strong>name</strong> &#8211; the optional name of the global function, otherwise the
function name will be used.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.template_test">
<code class="descname">template_test</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.template_test" title="정의 주소">¶</a></dt>
<dd><p>A decorator that is used to register custom template test.
You can specify a name for the test, otherwise the function
name will be used. Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.template_test</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">is_prime</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)))</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
    <span class="k">return</span> <span class="bp">True</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">버전 0.10에 추가.</span></p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><strong>name</strong> &#8211; the optional name of the test, otherwise the
function name will be used.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.test_client">
<code class="descname">test_client</code><span class="sig-paren">(</span><em>use_cookies=True</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.test_client" title="정의 주소">¶</a></dt>
<dd><p>Creates a test client for this application.  For information
about unit testing head over to <a class="reference internal" href="index.html#testing"><span>Flask 어플리케이션 테스트하기</span></a>.</p>
<p>Note that if you are testing for assertions or exceptions in your
application code, you must set <code class="docutils literal"><span class="pre">app.testing</span> <span class="pre">=</span> <span class="pre">True</span></code> in order for the
exceptions to propagate to the test client.  Otherwise, the exception
will be handled by the application (not visible to the test client) and
the only indication of an AssertionError or other exception will be a
500 status code response to the test client.  See the <a class="reference internal" href="index.html#flask.Flask.testing" title="flask.Flask.testing"><code class="xref py py-attr docutils literal"><span class="pre">testing</span></code></a>
attribute.  For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">app</span><span class="o">.</span><span class="n">testing</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">test_client</span><span class="p">()</span>
</pre></div>
</div>
<p>The test client can be used in a <cite>with</cite> block to defer the closing down
of the context until the end of the <cite>with</cite> block.  This is useful if
you want to access the context locals for testing:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">with</span> <span class="n">app</span><span class="o">.</span><span class="n">test_client</span><span class="p">()</span> <span class="k">as</span> <span class="n">c</span><span class="p">:</span>
    <span class="n">rv</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;/?vodka=42&#39;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="s">&#39;vodka&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;42&#39;</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="index.html#flask.testing.FlaskClient" title="flask.testing.FlaskClient"><code class="xref py py-class docutils literal"><span class="pre">FlaskClient</span></code></a> for more information.</p>
<div class="versionchanged">
<p><span class="versionmodified">버전 0.4으로 변경: </span>added support for <cite>with</cite> block usage for the client.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified">버전 0.7에 추가: </span>The <cite>use_cookies</cite> parameter was added as well as the ability
to override the client to be used by setting the
<a class="reference internal" href="index.html#flask.Flask.test_client_class" title="flask.Flask.test_client_class"><code class="xref py py-attr docutils literal"><span class="pre">test_client_class</span></code></a> attribute.</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.test_client_class">
<code class="descname">test_client_class</code><em class="property"> = None</em><a class="headerlink" href="#flask.Flask.test_client_class" title="정의 주소">¶</a></dt>
<dd><p>the test client that is used with when <cite>test_client</cite> is used.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.7에 추가.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.test_request_context">
<code class="descname">test_request_context</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.test_request_context" title="정의 주소">¶</a></dt>
<dd><p>Creates a WSGI environment from the given values (see
<code class="xref py py-func docutils literal"><span class="pre">werkzeug.test.EnvironBuilder()</span></code> for more information, this
function accepts the same arguments).</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.testing">
<code class="descname">testing</code><a class="headerlink" href="#flask.Flask.testing" title="정의 주소">¶</a></dt>
<dd><p>The testing flag.  Set this to <cite>True</cite> to enable the test mode of
Flask extensions (and in the future probably also Flask itself).
For example this might activate unittest helpers that have an
additional runtime cost which should not be enabled by default.</p>
<p>If this is enabled and PROPAGATE_EXCEPTIONS is not changed from the
default it&#8217;s implicitly enabled.</p>
<p>This attribute can also be configured from the config with the
<cite>TESTING</cite> configuration key.  Defaults to <cite>False</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.trap_http_exception">
<code class="descname">trap_http_exception</code><span class="sig-paren">(</span><em>e</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.trap_http_exception" title="정의 주소">¶</a></dt>
<dd><p>Checks if an HTTP exception should be trapped or not.  By default
this will return <cite>False</cite> for all exceptions except for a bad request
key error if <code class="docutils literal"><span class="pre">TRAP_BAD_REQUEST_ERRORS</span></code> is set to <cite>True</cite>.  It
also returns <cite>True</cite> if <code class="docutils literal"><span class="pre">TRAP_HTTP_EXCEPTIONS</span></code> is set to <cite>True</cite>.</p>
<p>This is called for all HTTP exceptions raised by a view function.
If it returns <cite>True</cite> for any exception the error handler for this
exception is not called and it shows up as regular exception in the
traceback.  This is helpful for debugging implicitly raised HTTP
exceptions.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.8에 추가.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.update_template_context">
<code class="descname">update_template_context</code><span class="sig-paren">(</span><em>context</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.update_template_context" title="정의 주소">¶</a></dt>
<dd><p>Update the template context with some commonly used variables.
This injects request, session, config and g into the template
context as well as everything template context processors want
to inject.  Note that the as of Flask 0.6, the original values
in the context will not be overridden if a context processor
decides to return a value with the same key.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><strong>context</strong> &#8211; the context as a dictionary that is updated in place
to add extra variables.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.url_build_error_handlers">
<code class="descname">url_build_error_handlers</code><em class="property"> = None</em><a class="headerlink" href="#flask.Flask.url_build_error_handlers" title="정의 주소">¶</a></dt>
<dd><p>A list of functions that are called when <a class="reference internal" href="index.html#flask.url_for" title="flask.url_for"><code class="xref py py-meth docutils literal"><span class="pre">url_for()</span></code></a> raises a
<code class="xref py py-exc docutils literal"><span class="pre">BuildError</span></code>.  Each function registered here
is called with <cite>error</cite>, <cite>endpoint</cite> and <cite>values</cite>.  If a function
returns <cite>None</cite> or raises a <cite>BuildError</cite> the next function is
tried.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.9에 추가.</span></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.url_default_functions">
<code class="descname">url_default_functions</code><em class="property"> = None</em><a class="headerlink" href="#flask.Flask.url_default_functions" title="정의 주소">¶</a></dt>
<dd><p>A dictionary with lists of functions that can be used as URL value
preprocessors.  The key <cite>None</cite> here is used for application wide
callbacks, otherwise the key is the name of the blueprint.
Each of these functions has the chance to modify the dictionary
of URL values before they are used as the keyword arguments of the
view function.  For each function registered this one should also
provide a <a class="reference internal" href="index.html#flask.Flask.url_defaults" title="flask.Flask.url_defaults"><code class="xref py py-meth docutils literal"><span class="pre">url_defaults()</span></code></a> function that adds the parameters
automatically again that were removed that way.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.7에 추가.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.url_defaults">
<code class="descname">url_defaults</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.url_defaults" title="정의 주소">¶</a></dt>
<dd><p>Callback function for URL defaults for all view functions of the
application.  It&#8217;s called with the endpoint and values and should
update the values passed in place.</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.url_map">
<code class="descname">url_map</code><em class="property"> = None</em><a class="headerlink" href="#flask.Flask.url_map" title="정의 주소">¶</a></dt>
<dd><p>The <a class="reference external" href="http://werkzeug.pocoo.org/docs/routing/#werkzeug.routing.Map" title="(in Werkzeug v0.11-dev)"><code class="xref py py-class docutils literal"><span class="pre">Map</span></code></a> for this instance.  You can use
this to change the routing converters after the class was created
but before any routes are connected.  Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">werkzeug.routing</span> <span class="kn">import</span> <span class="n">BaseConverter</span>

<span class="k">class</span> <span class="nc">ListConverter</span><span class="p">(</span><span class="n">BaseConverter</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">to_python</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">to_url</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">BaseConverter</span><span class="o">.</span><span class="n">to_url</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">)</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">url_map</span><span class="o">.</span><span class="n">converters</span><span class="p">[</span><span class="s">&#39;list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ListConverter</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.url_rule_class">
<code class="descname">url_rule_class</code><a class="headerlink" href="#flask.Flask.url_rule_class" title="정의 주소">¶</a></dt>
<dd><p>The rule object to use for URL rules created.  This is used by
<a class="reference internal" href="index.html#flask.Flask.add_url_rule" title="flask.Flask.add_url_rule"><code class="xref py py-meth docutils literal"><span class="pre">add_url_rule()</span></code></a>.  Defaults to <a class="reference external" href="http://werkzeug.pocoo.org/docs/routing/#werkzeug.routing.Rule" title="(in Werkzeug v0.11-dev)"><code class="xref py py-class docutils literal"><span class="pre">werkzeug.routing.Rule</span></code></a>.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.7에 추가.</span></p>
</div>
<p>alias of <code class="xref py py-class docutils literal"><span class="pre">Rule</span></code></p>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.url_value_preprocessor">
<code class="descname">url_value_preprocessor</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.url_value_preprocessor" title="정의 주소">¶</a></dt>
<dd><p>Registers a function as URL value preprocessor for all view
functions of the application.  It&#8217;s called before the view functions
are called and can modify the url values provided.</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.url_value_preprocessors">
<code class="descname">url_value_preprocessors</code><em class="property"> = None</em><a class="headerlink" href="#flask.Flask.url_value_preprocessors" title="정의 주소">¶</a></dt>
<dd><p>A dictionary with lists of functions that can be used as URL
value processor functions.  Whenever a URL is built these functions
are called to modify the dictionary of values in place.  The key
<cite>None</cite> here is used for application wide
callbacks, otherwise the key is the name of the blueprint.
Each of these functions has the chance to modify the dictionary</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.7에 추가.</span></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.use_x_sendfile">
<code class="descname">use_x_sendfile</code><a class="headerlink" href="#flask.Flask.use_x_sendfile" title="정의 주소">¶</a></dt>
<dd><p>Enable this if you want to use the X-Sendfile feature.  Keep in
mind that the server has to support this.  This only affects files
sent with the <a class="reference internal" href="index.html#flask.send_file" title="flask.send_file"><code class="xref py py-func docutils literal"><span class="pre">send_file()</span></code></a> method.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.2에 추가.</span></p>
</div>
<p>This attribute can also be configured from the config with the
<cite>USE_X_SENDFILE</cite> configuration key.  Defaults to <cite>False</cite>.</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.Flask.view_functions">
<code class="descname">view_functions</code><em class="property"> = None</em><a class="headerlink" href="#flask.Flask.view_functions" title="정의 주소">¶</a></dt>
<dd><p>A dictionary of all view functions registered.  The keys will
be function names which are also used to generate URLs and
the values are the function objects themselves.
To register a view function, use the <a class="reference internal" href="index.html#flask.Flask.route" title="flask.Flask.route"><code class="xref py py-meth docutils literal"><span class="pre">route()</span></code></a> decorator.</p>
</dd></dl>

<dl class="method">
<dt id="flask.Flask.wsgi_app">
<code class="descname">wsgi_app</code><span class="sig-paren">(</span><em>environ</em>, <em>start_response</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Flask.wsgi_app" title="정의 주소">¶</a></dt>
<dd><p>The actual WSGI application.  This is not implemented in
<cite>__call__</cite> so that middlewares can be applied without losing a
reference to the class.  So instead of doing this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">app</span> <span class="o">=</span> <span class="n">MyMiddleware</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
</pre></div>
</div>
<p>It&#8217;s a better idea to do this instead:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">app</span><span class="o">.</span><span class="n">wsgi_app</span> <span class="o">=</span> <span class="n">MyMiddleware</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">wsgi_app</span><span class="p">)</span>
</pre></div>
</div>
<p>Then you still have the original application object around and
can continue to call methods on it.</p>
<div class="versionchanged">
<p><span class="versionmodified">버전 0.7으로 변경: </span>The behavior of the before and after request callbacks was changed
under error conditions and a new callback was added that will
always execute at the end of the request, independent on if an
error occurred or not.  See <a class="reference internal" href="index.html#callbacks-and-errors"><span>콜백과 오류</span></a>.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><ul class="first last simple">
<li><strong>environ</strong> &#8211; a WSGI environment</li>
<li><strong>start_response</strong> &#8211; a callable accepting a status code,
a list of headers and an optional
exception context to start the response</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="blueprint-objects">
<h4>블루프린트 객체(Blueprint Objects)<a class="headerlink" href="#blueprint-objects" title="제목 주소">¶</a></h4>
<dl class="class">
<dt id="flask.Blueprint">
<em class="property">class </em><code class="descclassname">flask.</code><code class="descname">Blueprint</code><span class="sig-paren">(</span><em>name</em>, <em>import_name</em>, <em>static_folder=None</em>, <em>static_url_path=None</em>, <em>template_folder=None</em>, <em>url_prefix=None</em>, <em>subdomain=None</em>, <em>url_defaults=None</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Blueprint" title="정의 주소">¶</a></dt>
<dd><p>Represents a blueprint.  A blueprint is an object that records
functions that will be called with the
<code class="xref py py-class docutils literal"><span class="pre">BlueprintSetupState</span></code> later to register functions
or other things on the main application.  See <a class="reference internal" href="index.html#blueprints"><span>블루프린트를 가진 모듈화된 어플리케이션</span></a> for more
information.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.7에 추가.</span></p>
</div>
<dl class="method">
<dt id="flask.Blueprint.add_app_template_filter">
<code class="descname">add_app_template_filter</code><span class="sig-paren">(</span><em>f</em>, <em>name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Blueprint.add_app_template_filter" title="정의 주소">¶</a></dt>
<dd><p>Register a custom template filter, available application wide.  Like
<a class="reference internal" href="index.html#flask.Flask.add_template_filter" title="flask.Flask.add_template_filter"><code class="xref py py-meth docutils literal"><span class="pre">Flask.add_template_filter()</span></code></a> but for a blueprint.  Works exactly
like the <a class="reference internal" href="index.html#flask.Blueprint.app_template_filter" title="flask.Blueprint.app_template_filter"><code class="xref py py-meth docutils literal"><span class="pre">app_template_filter()</span></code></a> decorator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><strong>name</strong> &#8211; the optional name of the filter, otherwise the
function name will be used.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flask.Blueprint.add_app_template_global">
<code class="descname">add_app_template_global</code><span class="sig-paren">(</span><em>f</em>, <em>name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Blueprint.add_app_template_global" title="정의 주소">¶</a></dt>
<dd><p>Register a custom template global, available application wide.  Like
<a class="reference internal" href="index.html#flask.Flask.add_template_global" title="flask.Flask.add_template_global"><code class="xref py py-meth docutils literal"><span class="pre">Flask.add_template_global()</span></code></a> but for a blueprint.  Works exactly
like the <a class="reference internal" href="index.html#flask.Blueprint.app_template_global" title="flask.Blueprint.app_template_global"><code class="xref py py-meth docutils literal"><span class="pre">app_template_global()</span></code></a> decorator.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.10에 추가.</span></p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><strong>name</strong> &#8211; the optional name of the global, otherwise the
function name will be used.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flask.Blueprint.add_app_template_test">
<code class="descname">add_app_template_test</code><span class="sig-paren">(</span><em>f</em>, <em>name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Blueprint.add_app_template_test" title="정의 주소">¶</a></dt>
<dd><p>Register a custom template test, available application wide.  Like
<a class="reference internal" href="index.html#flask.Flask.add_template_test" title="flask.Flask.add_template_test"><code class="xref py py-meth docutils literal"><span class="pre">Flask.add_template_test()</span></code></a> but for a blueprint.  Works exactly
like the <a class="reference internal" href="index.html#flask.Blueprint.app_template_test" title="flask.Blueprint.app_template_test"><code class="xref py py-meth docutils literal"><span class="pre">app_template_test()</span></code></a> decorator.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.10에 추가.</span></p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><strong>name</strong> &#8211; the optional name of the test, otherwise the
function name will be used.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flask.Blueprint.add_url_rule">
<code class="descname">add_url_rule</code><span class="sig-paren">(</span><em>rule</em>, <em>endpoint=None</em>, <em>view_func=None</em>, <em>**options</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Blueprint.add_url_rule" title="정의 주소">¶</a></dt>
<dd><p>Like <a class="reference internal" href="index.html#flask.Flask.add_url_rule" title="flask.Flask.add_url_rule"><code class="xref py py-meth docutils literal"><span class="pre">Flask.add_url_rule()</span></code></a> but for a blueprint.  The endpoint for
the <a class="reference internal" href="index.html#flask.url_for" title="flask.url_for"><code class="xref py py-func docutils literal"><span class="pre">url_for()</span></code></a> function is prefixed with the name of the blueprint.</p>
</dd></dl>

<dl class="method">
<dt id="flask.Blueprint.after_app_request">
<code class="descname">after_app_request</code><span class="sig-paren">(</span><em>f</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Blueprint.after_app_request" title="정의 주소">¶</a></dt>
<dd><p>Like <a class="reference internal" href="index.html#flask.Flask.after_request" title="flask.Flask.after_request"><code class="xref py py-meth docutils literal"><span class="pre">Flask.after_request()</span></code></a> but for a blueprint.  Such a function
is executed after each request, even if outside of the blueprint.</p>
</dd></dl>

<dl class="method">
<dt id="flask.Blueprint.after_request">
<code class="descname">after_request</code><span class="sig-paren">(</span><em>f</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Blueprint.after_request" title="정의 주소">¶</a></dt>
<dd><p>Like <a class="reference internal" href="index.html#flask.Flask.after_request" title="flask.Flask.after_request"><code class="xref py py-meth docutils literal"><span class="pre">Flask.after_request()</span></code></a> but for a blueprint.  This function
is only executed after each request that is handled by a function of
that blueprint.</p>
</dd></dl>

<dl class="method">
<dt id="flask.Blueprint.app_context_processor">
<code class="descname">app_context_processor</code><span class="sig-paren">(</span><em>f</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Blueprint.app_context_processor" title="정의 주소">¶</a></dt>
<dd><p>Like <a class="reference internal" href="index.html#flask.Flask.context_processor" title="flask.Flask.context_processor"><code class="xref py py-meth docutils literal"><span class="pre">Flask.context_processor()</span></code></a> but for a blueprint.  Such a
function is executed each request, even if outside of the blueprint.</p>
</dd></dl>

<dl class="method">
<dt id="flask.Blueprint.app_errorhandler">
<code class="descname">app_errorhandler</code><span class="sig-paren">(</span><em>code</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Blueprint.app_errorhandler" title="정의 주소">¶</a></dt>
<dd><p>Like <a class="reference internal" href="index.html#flask.Flask.errorhandler" title="flask.Flask.errorhandler"><code class="xref py py-meth docutils literal"><span class="pre">Flask.errorhandler()</span></code></a> but for a blueprint.  This
handler is used for all requests, even if outside of the blueprint.</p>
</dd></dl>

<dl class="method">
<dt id="flask.Blueprint.app_template_filter">
<code class="descname">app_template_filter</code><span class="sig-paren">(</span><em>name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Blueprint.app_template_filter" title="정의 주소">¶</a></dt>
<dd><p>Register a custom template filter, available application wide.  Like
<a class="reference internal" href="index.html#flask.Flask.template_filter" title="flask.Flask.template_filter"><code class="xref py py-meth docutils literal"><span class="pre">Flask.template_filter()</span></code></a> but for a blueprint.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><strong>name</strong> &#8211; the optional name of the filter, otherwise the
function name will be used.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flask.Blueprint.app_template_global">
<code class="descname">app_template_global</code><span class="sig-paren">(</span><em>name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Blueprint.app_template_global" title="정의 주소">¶</a></dt>
<dd><p>Register a custom template global, available application wide.  Like
<a class="reference internal" href="index.html#flask.Flask.template_global" title="flask.Flask.template_global"><code class="xref py py-meth docutils literal"><span class="pre">Flask.template_global()</span></code></a> but for a blueprint.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.10에 추가.</span></p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><strong>name</strong> &#8211; the optional name of the global, otherwise the
function name will be used.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flask.Blueprint.app_template_test">
<code class="descname">app_template_test</code><span class="sig-paren">(</span><em>name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Blueprint.app_template_test" title="정의 주소">¶</a></dt>
<dd><p>Register a custom template test, available application wide.  Like
<a class="reference internal" href="index.html#flask.Flask.template_test" title="flask.Flask.template_test"><code class="xref py py-meth docutils literal"><span class="pre">Flask.template_test()</span></code></a> but for a blueprint.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.10에 추가.</span></p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><strong>name</strong> &#8211; the optional name of the test, otherwise the
function name will be used.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flask.Blueprint.app_url_defaults">
<code class="descname">app_url_defaults</code><span class="sig-paren">(</span><em>f</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Blueprint.app_url_defaults" title="정의 주소">¶</a></dt>
<dd><p>Same as <a class="reference internal" href="index.html#flask.Blueprint.url_defaults" title="flask.Blueprint.url_defaults"><code class="xref py py-meth docutils literal"><span class="pre">url_defaults()</span></code></a> but application wide.</p>
</dd></dl>

<dl class="method">
<dt id="flask.Blueprint.app_url_value_preprocessor">
<code class="descname">app_url_value_preprocessor</code><span class="sig-paren">(</span><em>f</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Blueprint.app_url_value_preprocessor" title="정의 주소">¶</a></dt>
<dd><p>Same as <a class="reference internal" href="index.html#flask.Blueprint.url_value_preprocessor" title="flask.Blueprint.url_value_preprocessor"><code class="xref py py-meth docutils literal"><span class="pre">url_value_preprocessor()</span></code></a> but application wide.</p>
</dd></dl>

<dl class="method">
<dt id="flask.Blueprint.before_app_first_request">
<code class="descname">before_app_first_request</code><span class="sig-paren">(</span><em>f</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Blueprint.before_app_first_request" title="정의 주소">¶</a></dt>
<dd><p>Like <a class="reference internal" href="index.html#flask.Flask.before_first_request" title="flask.Flask.before_first_request"><code class="xref py py-meth docutils literal"><span class="pre">Flask.before_first_request()</span></code></a>.  Such a function is
executed before the first request to the application.</p>
</dd></dl>

<dl class="method">
<dt id="flask.Blueprint.before_app_request">
<code class="descname">before_app_request</code><span class="sig-paren">(</span><em>f</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Blueprint.before_app_request" title="정의 주소">¶</a></dt>
<dd><p>Like <a class="reference internal" href="index.html#flask.Flask.before_request" title="flask.Flask.before_request"><code class="xref py py-meth docutils literal"><span class="pre">Flask.before_request()</span></code></a>.  Such a function is executed
before each request, even if outside of a blueprint.</p>
</dd></dl>

<dl class="method">
<dt id="flask.Blueprint.before_request">
<code class="descname">before_request</code><span class="sig-paren">(</span><em>f</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Blueprint.before_request" title="정의 주소">¶</a></dt>
<dd><p>Like <a class="reference internal" href="index.html#flask.Flask.before_request" title="flask.Flask.before_request"><code class="xref py py-meth docutils literal"><span class="pre">Flask.before_request()</span></code></a> but for a blueprint.  This function
is only executed before each request that is handled by a function of
that blueprint.</p>
</dd></dl>

<dl class="method">
<dt id="flask.Blueprint.context_processor">
<code class="descname">context_processor</code><span class="sig-paren">(</span><em>f</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Blueprint.context_processor" title="정의 주소">¶</a></dt>
<dd><p>Like <a class="reference internal" href="index.html#flask.Flask.context_processor" title="flask.Flask.context_processor"><code class="xref py py-meth docutils literal"><span class="pre">Flask.context_processor()</span></code></a> but for a blueprint.  This
function is only executed for requests handled by a blueprint.</p>
</dd></dl>

<dl class="method">
<dt id="flask.Blueprint.endpoint">
<code class="descname">endpoint</code><span class="sig-paren">(</span><em>endpoint</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Blueprint.endpoint" title="정의 주소">¶</a></dt>
<dd><p>Like <a class="reference internal" href="index.html#flask.Flask.endpoint" title="flask.Flask.endpoint"><code class="xref py py-meth docutils literal"><span class="pre">Flask.endpoint()</span></code></a> but for a blueprint.  This does not
prefix the endpoint with the blueprint name, this has to be done
explicitly by the user of this method.  If the endpoint is prefixed
with a <cite>.</cite> it will be registered to the current blueprint, otherwise
it&#8217;s an application independent endpoint.</p>
</dd></dl>

<dl class="method">
<dt id="flask.Blueprint.errorhandler">
<code class="descname">errorhandler</code><span class="sig-paren">(</span><em>code_or_exception</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Blueprint.errorhandler" title="정의 주소">¶</a></dt>
<dd><p>Registers an error handler that becomes active for this blueprint
only.  Please be aware that routing does not happen local to a
blueprint so an error handler for 404 usually is not handled by
a blueprint unless it is caused inside a view function.  Another
special case is the 500 internal server error which is always looked
up from the application.</p>
<p>Otherwise works as the <a class="reference internal" href="index.html#flask.Flask.errorhandler" title="flask.Flask.errorhandler"><code class="xref py py-meth docutils literal"><span class="pre">errorhandler()</span></code></a> decorator
of the <a class="reference internal" href="index.html#flask.Flask" title="flask.Flask"><code class="xref py py-class docutils literal"><span class="pre">Flask</span></code></a> object.</p>
</dd></dl>

<dl class="method">
<dt id="flask.Blueprint.get_send_file_max_age">
<code class="descname">get_send_file_max_age</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Blueprint.get_send_file_max_age" title="정의 주소">¶</a></dt>
<dd><p>Provides default cache_timeout for the <a class="reference internal" href="index.html#flask.send_file" title="flask.send_file"><code class="xref py py-func docutils literal"><span class="pre">send_file()</span></code></a> functions.</p>
<p>By default, this function returns <code class="docutils literal"><span class="pre">SEND_FILE_MAX_AGE_DEFAULT</span></code> from
the configuration of <a class="reference internal" href="index.html#flask.current_app" title="flask.current_app"><code class="xref py py-data docutils literal"><span class="pre">current_app</span></code></a>.</p>
<p>Static file functions such as <a class="reference internal" href="index.html#flask.send_from_directory" title="flask.send_from_directory"><code class="xref py py-func docutils literal"><span class="pre">send_from_directory()</span></code></a> use this
function, and <a class="reference internal" href="index.html#flask.send_file" title="flask.send_file"><code class="xref py py-func docutils literal"><span class="pre">send_file()</span></code></a> calls this function on
<a class="reference internal" href="index.html#flask.current_app" title="flask.current_app"><code class="xref py py-data docutils literal"><span class="pre">current_app</span></code></a> when the given cache_timeout is <cite>None</cite>. If a
cache_timeout is given in <a class="reference internal" href="index.html#flask.send_file" title="flask.send_file"><code class="xref py py-func docutils literal"><span class="pre">send_file()</span></code></a>, that timeout is used;
otherwise, this method is called.</p>
<p>This allows subclasses to change the behavior when sending files based
on the filename.  For example, to set the cache timeout for .js files
to 60 seconds:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MyFlask</span><span class="p">(</span><span class="n">flask</span><span class="o">.</span><span class="n">Flask</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get_send_file_max_age</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">&#39;.js&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">60</span>
        <span class="k">return</span> <span class="n">flask</span><span class="o">.</span><span class="n">Flask</span><span class="o">.</span><span class="n">get_send_file_max_age</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">버전 0.9에 추가.</span></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="flask.Blueprint.has_static_folder">
<code class="descname">has_static_folder</code><a class="headerlink" href="#flask.Blueprint.has_static_folder" title="정의 주소">¶</a></dt>
<dd><p>This is <cite>True</cite> if the package bound object&#8217;s container has a
folder named <code class="docutils literal"><span class="pre">'static'</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.5에 추가.</span></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="flask.Blueprint.jinja_loader">
<code class="descname">jinja_loader</code><a class="headerlink" href="#flask.Blueprint.jinja_loader" title="정의 주소">¶</a></dt>
<dd><p>The Jinja loader for this package bound object.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.5에 추가.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="flask.Blueprint.make_setup_state">
<code class="descname">make_setup_state</code><span class="sig-paren">(</span><em>app</em>, <em>options</em>, <em>first_registration=False</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Blueprint.make_setup_state" title="정의 주소">¶</a></dt>
<dd><p>Creates an instance of <a class="reference internal" href="index.html#flask.blueprints.BlueprintSetupState" title="flask.blueprints.BlueprintSetupState"><code class="xref py py-meth docutils literal"><span class="pre">BlueprintSetupState()</span></code></a>
object that is later passed to the register callback functions.
Subclasses can override this to return a subclass of the setup state.</p>
</dd></dl>

<dl class="method">
<dt id="flask.Blueprint.open_resource">
<code class="descname">open_resource</code><span class="sig-paren">(</span><em>resource</em>, <em>mode='rb'</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Blueprint.open_resource" title="정의 주소">¶</a></dt>
<dd><p>Opens a resource from the application&#8217;s resource folder.  To see
how this works, consider the following folder structure:</p>
<div class="highlight-python"><div class="highlight"><pre>/myapplication.py
/schema.sql
/static
    /style.css
/templates
    /layout.html
    /index.html
</pre></div>
</div>
<p>If you want to open the <cite>schema.sql</cite> file you would do the
following:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">with</span> <span class="n">app</span><span class="o">.</span><span class="n">open_resource</span><span class="p">(</span><span class="s">&#39;schema.sql&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">contents</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">do_something_with</span><span class="p">(</span><span class="n">contents</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><ul class="first last simple">
<li><strong>resource</strong> &#8211; the name of the resource.  To access resources within
subfolders use forward slashes as separator.</li>
<li><strong>mode</strong> &#8211; resource file opening mode, default is &#8216;rb&#8217;.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flask.Blueprint.record">
<code class="descname">record</code><span class="sig-paren">(</span><em>func</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Blueprint.record" title="정의 주소">¶</a></dt>
<dd><p>Registers a function that is called when the blueprint is
registered on the application.  This function is called with the
state as argument as returned by the <a class="reference internal" href="index.html#flask.Blueprint.make_setup_state" title="flask.Blueprint.make_setup_state"><code class="xref py py-meth docutils literal"><span class="pre">make_setup_state()</span></code></a>
method.</p>
</dd></dl>

<dl class="method">
<dt id="flask.Blueprint.record_once">
<code class="descname">record_once</code><span class="sig-paren">(</span><em>func</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Blueprint.record_once" title="정의 주소">¶</a></dt>
<dd><p>Works like <a class="reference internal" href="index.html#flask.Blueprint.record" title="flask.Blueprint.record"><code class="xref py py-meth docutils literal"><span class="pre">record()</span></code></a> but wraps the function in another
function that will ensure the function is only called once.  If the
blueprint is registered a second time on the application, the
function passed is not called.</p>
</dd></dl>

<dl class="method">
<dt id="flask.Blueprint.register">
<code class="descname">register</code><span class="sig-paren">(</span><em>app</em>, <em>options</em>, <em>first_registration=False</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Blueprint.register" title="정의 주소">¶</a></dt>
<dd><p>Called by <a class="reference internal" href="index.html#flask.Flask.register_blueprint" title="flask.Flask.register_blueprint"><code class="xref py py-meth docutils literal"><span class="pre">Flask.register_blueprint()</span></code></a> to register a blueprint
on the application.  This can be overridden to customize the register
behavior.  Keyword arguments from
<a class="reference internal" href="index.html#flask.Flask.register_blueprint" title="flask.Flask.register_blueprint"><code class="xref py py-func docutils literal"><span class="pre">register_blueprint()</span></code></a> are directly forwarded to this
method in the <cite>options</cite> dictionary.</p>
</dd></dl>

<dl class="method">
<dt id="flask.Blueprint.route">
<code class="descname">route</code><span class="sig-paren">(</span><em>rule</em>, <em>**options</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Blueprint.route" title="정의 주소">¶</a></dt>
<dd><p>Like <a class="reference internal" href="index.html#flask.Flask.route" title="flask.Flask.route"><code class="xref py py-meth docutils literal"><span class="pre">Flask.route()</span></code></a> but for a blueprint.  The endpoint for the
<a class="reference internal" href="index.html#flask.url_for" title="flask.url_for"><code class="xref py py-func docutils literal"><span class="pre">url_for()</span></code></a> function is prefixed with the name of the blueprint.</p>
</dd></dl>

<dl class="method">
<dt id="flask.Blueprint.send_static_file">
<code class="descname">send_static_file</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Blueprint.send_static_file" title="정의 주소">¶</a></dt>
<dd><p>Function used internally to send static files from the static
folder to the browser.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.5에 추가.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="flask.Blueprint.teardown_app_request">
<code class="descname">teardown_app_request</code><span class="sig-paren">(</span><em>f</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Blueprint.teardown_app_request" title="정의 주소">¶</a></dt>
<dd><p>Like <a class="reference internal" href="index.html#flask.Flask.teardown_request" title="flask.Flask.teardown_request"><code class="xref py py-meth docutils literal"><span class="pre">Flask.teardown_request()</span></code></a> but for a blueprint.  Such a
function is executed when tearing down each request, even if outside of
the blueprint.</p>
</dd></dl>

<dl class="method">
<dt id="flask.Blueprint.teardown_request">
<code class="descname">teardown_request</code><span class="sig-paren">(</span><em>f</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Blueprint.teardown_request" title="정의 주소">¶</a></dt>
<dd><p>Like <a class="reference internal" href="index.html#flask.Flask.teardown_request" title="flask.Flask.teardown_request"><code class="xref py py-meth docutils literal"><span class="pre">Flask.teardown_request()</span></code></a> but for a blueprint.  This
function is only executed when tearing down requests handled by a
function of that blueprint.  Teardown request functions are executed
when the request context is popped, even when no actual request was
performed.</p>
</dd></dl>

<dl class="method">
<dt id="flask.Blueprint.url_defaults">
<code class="descname">url_defaults</code><span class="sig-paren">(</span><em>f</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Blueprint.url_defaults" title="정의 주소">¶</a></dt>
<dd><p>Callback function for URL defaults for this blueprint.  It&#8217;s called
with the endpoint and values and should update the values passed
in place.</p>
</dd></dl>

<dl class="method">
<dt id="flask.Blueprint.url_value_preprocessor">
<code class="descname">url_value_preprocessor</code><span class="sig-paren">(</span><em>f</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Blueprint.url_value_preprocessor" title="정의 주소">¶</a></dt>
<dd><p>Registers a function as URL value preprocessor for this
blueprint.  It&#8217;s called before the view functions are called and
can modify the url values provided.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="incoming-request-data">
<h4>유입되는 요청 데이터(Incoming Request Data)<a class="headerlink" href="#incoming-request-data" title="제목 주소">¶</a></h4>
<dl class="class">
<dt id="flask.Request">
<em class="property">class </em><code class="descclassname">flask.</code><code class="descname">Request</code><span class="sig-paren">(</span><em>environ</em>, <em>populate_request=True</em>, <em>shallow=False</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Request" title="정의 주소">¶</a></dt>
<dd><p>The request object used by default in Flask.  Remembers the
matched endpoint and view arguments.</p>
<p>It is what ends up as <a class="reference internal" href="index.html#flask.request" title="flask.request"><code class="xref py py-class docutils literal"><span class="pre">request</span></code></a>.  If you want to replace
the request object used you can subclass this and set
<a class="reference internal" href="index.html#flask.Flask.request_class" title="flask.Flask.request_class"><code class="xref py py-attr docutils literal"><span class="pre">request_class</span></code></a> to your subclass.</p>
<p>The request object is a <a class="reference external" href="http://werkzeug.pocoo.org/docs/wrappers/#werkzeug.wrappers.Request" title="(in Werkzeug v0.11-dev)"><code class="xref py py-class docutils literal"><span class="pre">Request</span></code></a> subclass and
provides all of the attributes Werkzeug defines plus a few Flask
specific ones.</p>
<dl class="attribute">
<dt id="flask.Request.form">
<code class="descname">form</code><a class="headerlink" href="#flask.Request.form" title="정의 주소">¶</a></dt>
<dd><p><cite>POST</cite> 또는 <cite>PUT</cite> 요청으로 부터 파싱된 폼 데이터를 갖는 A <a class="reference external" href="http://werkzeug.pocoo.org/docs/datastructures/#werkzeug.datastructures.MultiDict" title="(in Werkzeug v0.11-dev)"><code class="xref py py-class docutils literal"><span class="pre">MultiDict</span></code></a> .
파일 업로드는 이 속성이 아닌 <a class="reference internal" href="index.html#flask.Request.files" title="flask.Request.files"><code class="xref py py-attr docutils literal"><span class="pre">files</span></code></a> 속성에서 처리되는 것을 명심해야한다.</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.Request.args">
<code class="descname">args</code><a class="headerlink" href="#flask.Request.args" title="정의 주소">¶</a></dt>
<dd><p>질의문의 파싱된 내용을 갖는 <a class="reference external" href="http://werkzeug.pocoo.org/docs/datastructures/#werkzeug.datastructures.MultiDict" title="(in Werkzeug v0.11-dev)"><code class="xref py py-class docutils literal"><span class="pre">MultiDict</span></code></a>
(URL에서 물음표 뒤에 있는 부분).</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.Request.values">
<code class="descname">values</code><a class="headerlink" href="#flask.Request.values" title="정의 주소">¶</a></dt>
<dd><p><a class="reference internal" href="index.html#flask.Request.form" title="flask.Request.form"><code class="xref py py-attr docutils literal"><span class="pre">form</span></code></a> 과 <a class="reference internal" href="index.html#flask.Request.args" title="flask.Request.args"><code class="xref py py-attr docutils literal"><span class="pre">args</span></code></a> 의 내용을 갖는 <a class="reference external" href="http://werkzeug.pocoo.org/docs/datastructures/#werkzeug.datastructures.CombinedMultiDict" title="(in Werkzeug v0.11-dev)"><code class="xref py py-class docutils literal"><span class="pre">CombinedMultiDict</span></code></a> .</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.Request.cookies">
<code class="descname">cookies</code><a class="headerlink" href="#flask.Request.cookies" title="정의 주소">¶</a></dt>
<dd><p>요청과 같이 전송되는 모든 쿠키의 내용을 갖는 <a class="reference external" href="http://docs.python.org/dev/library/stdtypes.html#dict" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">dict</span></code></a> .</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.Request.stream">
<code class="descname">stream</code><a class="headerlink" href="#flask.Request.stream" title="정의 주소">¶</a></dt>
<dd><p>유입되는 폼 데이터가 알려진 마임타입(MimeType)으로 인코딩되지 않았다면
그 데이터는 변경되지 않은 상태로 이 스트림에 저장된다. 대부분의 경우
문자로 이 데이터를 제공하는 <a class="reference internal" href="index.html#flask.Request.data" title="flask.Request.data"><code class="xref py py-attr docutils literal"><span class="pre">data</span></code></a> 를 사용하는게 나은 방식이다.
스트림은 오직 한번 데이터를 반환한다.</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.Request.headers">
<code class="descname">headers</code><a class="headerlink" href="#flask.Request.headers" title="정의 주소">¶</a></dt>
<dd><p>딕셔너리 객체로 된 유입 요청 헤더.</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.Request.data">
<code class="descname">data</code><a class="headerlink" href="#flask.Request.data" title="정의 주소">¶</a></dt>
<dd><p>유입 요청 데이터가 플라스크가 다루지 않는 마임타입인 경우의 데이터.</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.Request.files">
<code class="descname">files</code><a class="headerlink" href="#flask.Request.files" title="정의 주소">¶</a></dt>
<dd><p><cite>POST</cite> 또는 <cite>PUT</cite> 요청의 부분으로 파일 업로드를 갖는 <a class="reference external" href="http://werkzeug.pocoo.org/docs/datastructures/#werkzeug.datastructures.MultiDict" title="(in Werkzeug v0.11-dev)"><code class="xref py py-class docutils literal"><span class="pre">MultiDict</span></code></a> .
각 파일은 <a class="reference external" href="http://werkzeug.pocoo.org/docs/datastructures/#werkzeug.datastructures.FileStorage" title="(in Werkzeug v0.11-dev)"><code class="xref py py-class docutils literal"><span class="pre">FileStorage</span></code></a> 객체로 저장된다.  기본적으로 파이썬에서
사용하는 표준 파일 객체처럼 동작하는데, 차이점은 이 객체는 파일 시스템에 파일을 저장할 수 있는
<a class="reference external" href="http://werkzeug.pocoo.org/docs/datastructures/#werkzeug.datastructures.FileStorage.save" title="(in Werkzeug v0.11-dev)"><code class="xref py py-meth docutils literal"><span class="pre">save()</span></code></a> 함수가 있다.</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.Request.environ">
<code class="descname">environ</code><a class="headerlink" href="#flask.Request.environ" title="정의 주소">¶</a></dt>
<dd><p>기반이 되는 WSGI 환경.</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.Request.method">
<code class="descname">method</code><a class="headerlink" href="#flask.Request.method" title="정의 주소">¶</a></dt>
<dd><p>현재 요청에 대한 HTTP 메소드(<code class="docutils literal"><span class="pre">POST</span></code>, <code class="docutils literal"><span class="pre">GET</span></code> etc.)</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.Request.path">
<code class="descname">path</code><a class="headerlink" href="#flask.Request.path" title="정의 주소">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="flask.Request.script_root">
<code class="descname">script_root</code><a class="headerlink" href="#flask.Request.script_root" title="정의 주소">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="flask.Request.url">
<code class="descname">url</code><a class="headerlink" href="#flask.Request.url" title="정의 주소">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="flask.Request.base_url">
<code class="descname">base_url</code><a class="headerlink" href="#flask.Request.base_url" title="정의 주소">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="flask.Request.url_root">
<code class="descname">url_root</code><a class="headerlink" href="#flask.Request.url_root" title="정의 주소">¶</a></dt>
<dd><p>현재 URL을 바라보는 여러 방식을 제공한다.  아래와 같은 URL을 제공하는
어플리케이션을 생각해보자:</p>
<div class="highlight-python"><div class="highlight"><pre>http://www.example.com/myapplication
</pre></div>
</div>
<p>그리고 사용자는 아래와 같은 URL을 요청했다고 하자:</p>
<div class="highlight-python"><div class="highlight"><pre>http://www.example.com/myapplication/page.html?x=y
</pre></div>
</div>
<p>이 경우 위에서 언급한 속성값은 아래와 같이 될 것이다:</p>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="81%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><cite>path</cite></td>
<td><code class="docutils literal"><span class="pre">/page.html</span></code></td>
</tr>
<tr class="row-even"><td><cite>script_root</cite></td>
<td><code class="docutils literal"><span class="pre">/myapplication</span></code></td>
</tr>
<tr class="row-odd"><td><cite>base_url</cite></td>
<td><code class="docutils literal"><span class="pre">http://www.example.com/myapplication/page.html</span></code></td>
</tr>
<tr class="row-even"><td><cite>url</cite></td>
<td><code class="docutils literal"><span class="pre">http://www.example.com/myapplication/page.html?x=y</span></code></td>
</tr>
<tr class="row-odd"><td><cite>url_root</cite></td>
<td><code class="docutils literal"><span class="pre">http://www.example.com/myapplication/</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="flask.Request.is_xhr">
<code class="descname">is_xhr</code><a class="headerlink" href="#flask.Request.is_xhr" title="정의 주소">¶</a></dt>
<dd><p>요청이 자바스크립트 <cite>XMLHttpRequest</cite> 으로 요청됐다면 <cite>True</cite> .
이 속성은 <code class="docutils literal"><span class="pre">X-Requested-With</span></code> 헤더를 지원하고 <cite>XMLHttpRequest</cite> 에
그것을 설정하는 라이브러리와만 동작한다. prototype, jQuery 그리고
Mochikit 등이 그런 라이브러리다.</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.Request.blueprint">
<code class="descname">blueprint</code><a class="headerlink" href="#flask.Request.blueprint" title="정의 주소">¶</a></dt>
<dd><p>The name of the current blueprint</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.Request.endpoint">
<code class="descname">endpoint</code><a class="headerlink" href="#flask.Request.endpoint" title="정의 주소">¶</a></dt>
<dd><p>The endpoint that matched the request.  This in combination with
<a class="reference internal" href="index.html#flask.Request.view_args" title="flask.Request.view_args"><code class="xref py py-attr docutils literal"><span class="pre">view_args</span></code></a> can be used to reconstruct the same or a
modified URL.  If an exception happened when matching, this will
be <cite>None</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="flask.Request.get_json">
<code class="descname">get_json</code><span class="sig-paren">(</span><em>force=False</em>, <em>silent=False</em>, <em>cache=True</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Request.get_json" title="정의 주소">¶</a></dt>
<dd><p>Parses the incoming JSON request data and returns it.  If
parsing fails the <a class="reference internal" href="index.html#flask.Request.on_json_loading_failed" title="flask.Request.on_json_loading_failed"><code class="xref py py-meth docutils literal"><span class="pre">on_json_loading_failed()</span></code></a> method on the
request object will be invoked.  By default this function will
only load the json data if the mimetype is <code class="docutils literal"><span class="pre">application/json</span></code>
but this can be overriden by the <cite>force</cite> parameter.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><ul class="first last simple">
<li><strong>force</strong> &#8211; if set to <cite>True</cite> the mimetype is ignored.</li>
<li><strong>silent</strong> &#8211; if set to <cite>False</cite> this method will fail silently
and return <cite>False</cite>.</li>
<li><strong>cache</strong> &#8211; if set to <cite>True</cite> the parsed JSON data is remembered
on the request.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="flask.Request.json">
<code class="descname">json</code><a class="headerlink" href="#flask.Request.json" title="정의 주소">¶</a></dt>
<dd><p>If the mimetype is <cite>application/json</cite> this will contain the
parsed JSON data.  Otherwise this will be <cite>None</cite>.</p>
<p>The <a class="reference internal" href="index.html#flask.Request.get_json" title="flask.Request.get_json"><code class="xref py py-meth docutils literal"><span class="pre">get_json()</span></code></a> method should be used instead.</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.Request.max_content_length">
<code class="descname">max_content_length</code><a class="headerlink" href="#flask.Request.max_content_length" title="정의 주소">¶</a></dt>
<dd><p>Read-only view of the <cite>MAX_CONTENT_LENGTH</cite> config key.</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.Request.module">
<code class="descname">module</code><a class="headerlink" href="#flask.Request.module" title="정의 주소">¶</a></dt>
<dd><p>The name of the current module if the request was dispatched
to an actual module.  This is deprecated functionality, use blueprints
instead.</p>
</dd></dl>

<dl class="method">
<dt id="flask.Request.on_json_loading_failed">
<code class="descname">on_json_loading_failed</code><span class="sig-paren">(</span><em>e</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Request.on_json_loading_failed" title="정의 주소">¶</a></dt>
<dd><p>Called if decoding of the JSON data failed.  The return value of
this method is used by <a class="reference internal" href="index.html#flask.Request.get_json" title="flask.Request.get_json"><code class="xref py py-meth docutils literal"><span class="pre">get_json()</span></code></a> when an error occurred.  The
default implementation just raises a <code class="xref py py-class docutils literal"><span class="pre">BadRequest</span></code> exception.</p>
<div class="versionchanged">
<p><span class="versionmodified">버전 0.10으로 변경: </span>Removed buggy previous behavior of generating a random JSON
response.  If you want that behavior back you can trivially
add it by subclassing.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified">버전 0.8에 추가.</span></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="flask.Request.routing_exception">
<code class="descname">routing_exception</code><em class="property"> = None</em><a class="headerlink" href="#flask.Request.routing_exception" title="정의 주소">¶</a></dt>
<dd><p>if matching the URL failed, this is the exception that will be
raised / was raised as part of the request handling.  This is
usually a <a class="reference external" href="http://werkzeug.pocoo.org/docs/exceptions/#werkzeug.exceptions.NotFound" title="(in Werkzeug v0.11-dev)"><code class="xref py py-exc docutils literal"><span class="pre">NotFound</span></code></a> exception or
something similar.</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.Request.url_rule">
<code class="descname">url_rule</code><em class="property"> = None</em><a class="headerlink" href="#flask.Request.url_rule" title="정의 주소">¶</a></dt>
<dd><p>the internal URL rule that matched the request.  This can be
useful to inspect which methods are allowed for the URL from
a before/after handler (<code class="docutils literal"><span class="pre">request.url_rule.methods</span></code>) etc.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.6에 추가.</span></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="flask.Request.view_args">
<code class="descname">view_args</code><em class="property"> = None</em><a class="headerlink" href="#flask.Request.view_args" title="정의 주소">¶</a></dt>
<dd><p>a dict of view arguments that matched the request.  If an exception
happened when matching, this will be <cite>None</cite>.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="flask.request">
<em class="property">class </em><code class="descclassname">flask.</code><code class="descname">request</code><a class="headerlink" href="#flask.request" title="정의 주소">¶</a></dt>
<dd><p>유입 요청 데이터에 접근하기 위해서, 여러분은 전역 <cite>request</cite> 객체를 사용할 수 있다.
플라스크는 유입 요청 데이터를 파싱해서 전역 객체로 그 데이터에 접근하게 해준다.
내부적으로 플라스크는 여러분이 다중 쓰레드 환경에 있더라도 활성화된 요청 쓰레드에
대해 올바른 데이터를 얻는 것을 보장한다.</p>
<p>이것은 일종의 프록시다.  더 많은 정보는 <a class="reference internal" href="index.html#notes-on-proxies"><span>프록시에서 주의할 점</span></a> 를 살펴봐라.</p>
<p>이 요청 객체는 <a class="reference external" href="http://werkzeug.pocoo.org/docs/wrappers/#werkzeug.wrappers.Request" title="(in Werkzeug v0.11-dev)"><code class="xref py py-class docutils literal"><span class="pre">Request</span></code></a> 하위 클래스의 인스턴스이고 벡자이크가
정의한 모든 속성을 제공한다.  이 객체는 가장 중요한 객체에 대한 빠른 개요를 보여준다.</p>
</dd></dl>

</div>
<div class="section" id="response-objects">
<h4>응답 객체(Response Objects)<a class="headerlink" href="#response-objects" title="제목 주소">¶</a></h4>
<dl class="class">
<dt id="flask.Response">
<em class="property">class </em><code class="descclassname">flask.</code><code class="descname">Response</code><span class="sig-paren">(</span><em>response=None</em>, <em>status=None</em>, <em>headers=None</em>, <em>mimetype=None</em>, <em>content_type=None</em>, <em>direct_passthrough=False</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Response" title="정의 주소">¶</a></dt>
<dd><p>The response object that is used by default in Flask.  Works like the
response object from Werkzeug but is set to have an HTML mimetype by
default.  Quite often you don&#8217;t have to create this object yourself because
<a class="reference internal" href="index.html#flask.Flask.make_response" title="flask.Flask.make_response"><code class="xref py py-meth docutils literal"><span class="pre">make_response()</span></code></a> will take care of that for you.</p>
<p>If you want to replace the response object used you can subclass this and
set <a class="reference internal" href="index.html#flask.Flask.response_class" title="flask.Flask.response_class"><code class="xref py py-attr docutils literal"><span class="pre">response_class</span></code></a> to your subclass.</p>
<dl class="attribute">
<dt id="flask.Response.headers">
<code class="descname">headers</code><a class="headerlink" href="#flask.Response.headers" title="정의 주소">¶</a></dt>
<dd><p>응답 헤더를 나타내는 <code class="xref py py-class docutils literal"><span class="pre">Headers</span></code> 객체.</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.Response.status">
<code class="descname">status</code><a class="headerlink" href="#flask.Response.status" title="정의 주소">¶</a></dt>
<dd><p>응답 상태를 갖는 문자열.</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.Response.status_code">
<code class="descname">status_code</code><a class="headerlink" href="#flask.Response.status_code" title="정의 주소">¶</a></dt>
<dd><p>정수형의 응답 상태코드.</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.Response.data">
<code class="descname">data</code><a class="headerlink" href="#flask.Response.data" title="정의 주소">¶</a></dt>
<dd><p>A descriptor that calls <code class="xref py py-meth docutils literal"><span class="pre">get_data()</span></code> and <code class="xref py py-meth docutils literal"><span class="pre">set_data()</span></code>.  This
should not be used and will eventually get deprecated.</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.Response.mimetype">
<code class="descname">mimetype</code><a class="headerlink" href="#flask.Response.mimetype" title="정의 주소">¶</a></dt>
<dd><p>The mimetype (content type without charset etc.)</p>
</dd></dl>

<dl class="method">
<dt id="flask.Response.set_cookie">
<code class="descname">set_cookie</code><span class="sig-paren">(</span><em>key</em>, <em>value=''</em>, <em>max_age=None</em>, <em>expires=None</em>, <em>path='/'</em>, <em>domain=None</em>, <em>secure=None</em>, <em>httponly=False</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Response.set_cookie" title="정의 주소">¶</a></dt>
<dd><p>Sets a cookie. The parameters are the same as in the cookie <cite>Morsel</cite>
object in the Python standard library but it accepts unicode data, too.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><ul class="first last simple">
<li><strong>key</strong> &#8211; the key (name) of the cookie to be set.</li>
<li><strong>value</strong> &#8211; the value of the cookie.</li>
<li><strong>max_age</strong> &#8211; should be a number of seconds, or <cite>None</cite> (default) if
the cookie should last only as long as the client&#8217;s
browser session.</li>
<li><strong>expires</strong> &#8211; should be a <cite>datetime</cite> object or UNIX timestamp.</li>
<li><strong>domain</strong> &#8211; if you want to set a cross-domain cookie.  For example,
<code class="docutils literal"><span class="pre">domain=&quot;.example.com&quot;</span></code> will set a cookie that is
readable by the domain <code class="docutils literal"><span class="pre">www.example.com</span></code>,
<code class="docutils literal"><span class="pre">foo.example.com</span></code> etc.  Otherwise, a cookie will only
be readable by the domain that set it.</li>
<li><strong>path</strong> &#8211; limits the cookie to a given path, per default it will
span the whole domain.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="sessions">
<h4>세션(Sessions)<a class="headerlink" href="#sessions" title="제목 주소">¶</a></h4>
<p>여러분이 <a class="reference internal" href="index.html#flask.Flask.secret_key" title="flask.Flask.secret_key"><code class="xref py py-attr docutils literal"><span class="pre">Flask.secret_key</span></code></a> 속성을 설정한다면 플라스크 어플리케이션에
있는 세션을 사용할 수 있다.  세션은 기본적으로 하나의 요청 정보를 다른 요청에서
기억하게 해준다.  플라스크에서는 서명된 쿠기(singed cookie)를 이용한다.
그래서 사용자가 세션 내용을 볼 수는 있으나 비밀키를 모른다면 그 내용을 수정할
수 없기 때문에 그 키를 복잡하고 추측할 수 없게 설정해도록 해야한다.</p>
<p>현재 세션에 접근하기 위해서 <a class="reference internal" href="index.html#flask.session" title="flask.session"><code class="xref py py-class docutils literal"><span class="pre">session</span></code></a> 객체를 사용한다:</p>
<dl class="class">
<dt id="flask.session">
<em class="property">class </em><code class="descclassname">flask.</code><code class="descname">session</code><a class="headerlink" href="#flask.session" title="정의 주소">¶</a></dt>
<dd><p>세션 객체는 보통 딕셔너리 객체와 상당히 비슷하게 동작하는데
차이점은 수정사항을 유지한다는 것이다.
The session object works pretty much like an ordinary dict, with the
difference that it keeps track on modifications.</p>
<p>This is a proxy.  See <a class="reference internal" href="index.html#notes-on-proxies"><span>프록시에서 주의할 점</span></a> for more information.</p>
<p>The following attributes are interesting:</p>
<dl class="attribute">
<dt id="flask.session.new">
<code class="descname">new</code><a class="headerlink" href="#flask.session.new" title="정의 주소">¶</a></dt>
<dd><p><cite>True</cite> if the session is new, <cite>False</cite> otherwise.</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.session.modified">
<code class="descname">modified</code><a class="headerlink" href="#flask.session.modified" title="정의 주소">¶</a></dt>
<dd><p><cite>True</cite> if the session object detected a modification.  Be advised
that modifications on mutable structures are not picked up
automatically, in that situation you have to explicitly set the
attribute to <cite>True</cite> yourself.  Here an example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># this change is not picked up because a mutable object (here</span>
<span class="c"># a list) is changed.</span>
<span class="n">session</span><span class="p">[</span><span class="s">&#39;objects&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="c"># so mark it as modified yourself</span>
<span class="n">session</span><span class="o">.</span><span class="n">modified</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="flask.session.permanent">
<code class="descname">permanent</code><a class="headerlink" href="#flask.session.permanent" title="정의 주소">¶</a></dt>
<dd><p>If set to <cite>True</cite> the session lives for
<a class="reference internal" href="index.html#flask.Flask.permanent_session_lifetime" title="flask.Flask.permanent_session_lifetime"><code class="xref py py-attr docutils literal"><span class="pre">permanent_session_lifetime</span></code></a> seconds.  The
default is 31 days.  If set to <cite>False</cite> (which is the default) the
session will be deleted when the user closes the browser.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="session-interface">
<h4>Session Interface<a class="headerlink" href="#session-interface" title="제목 주소">¶</a></h4>
<div class="versionadded">
<p><span class="versionmodified">버전 0.8에 추가.</span></p>
</div>
<p>The session interface provides a simple way to replace the session
implementation that Flask is using.</p>
<dl class="class">
<dt id="flask.sessions.SessionInterface">
<em class="property">class </em><code class="descclassname">flask.sessions.</code><code class="descname">SessionInterface</code><a class="headerlink" href="#flask.sessions.SessionInterface" title="정의 주소">¶</a></dt>
<dd><p>The basic interface you have to implement in order to replace the
default session interface which uses werkzeug&#8217;s securecookie
implementation.  The only methods you have to implement are
<a class="reference internal" href="index.html#flask.sessions.SessionInterface.open_session" title="flask.sessions.SessionInterface.open_session"><code class="xref py py-meth docutils literal"><span class="pre">open_session()</span></code></a> and <a class="reference internal" href="index.html#flask.sessions.SessionInterface.save_session" title="flask.sessions.SessionInterface.save_session"><code class="xref py py-meth docutils literal"><span class="pre">save_session()</span></code></a>, the others have
useful defaults which you don&#8217;t need to change.</p>
<p>The session object returned by the <a class="reference internal" href="index.html#flask.sessions.SessionInterface.open_session" title="flask.sessions.SessionInterface.open_session"><code class="xref py py-meth docutils literal"><span class="pre">open_session()</span></code></a> method has to
provide a dictionary like interface plus the properties and methods
from the <a class="reference internal" href="index.html#flask.sessions.SessionMixin" title="flask.sessions.SessionMixin"><code class="xref py py-class docutils literal"><span class="pre">SessionMixin</span></code></a>.  We recommend just subclassing a dict
and adding that mixin:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Session</span><span class="p">(</span><span class="nb">dict</span><span class="p">,</span> <span class="n">SessionMixin</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>If <a class="reference internal" href="index.html#flask.sessions.SessionInterface.open_session" title="flask.sessions.SessionInterface.open_session"><code class="xref py py-meth docutils literal"><span class="pre">open_session()</span></code></a> returns <cite>None</cite> Flask will call into
<a class="reference internal" href="index.html#flask.sessions.SessionInterface.make_null_session" title="flask.sessions.SessionInterface.make_null_session"><code class="xref py py-meth docutils literal"><span class="pre">make_null_session()</span></code></a> to create a session that acts as replacement
if the session support cannot work because some requirement is not
fulfilled.  The default <a class="reference internal" href="index.html#flask.sessions.NullSession" title="flask.sessions.NullSession"><code class="xref py py-class docutils literal"><span class="pre">NullSession</span></code></a> class that is created
will complain that the secret key was not set.</p>
<p>To replace the session interface on an application all you have to do
is to assign <a class="reference internal" href="index.html#flask.Flask.session_interface" title="flask.Flask.session_interface"><code class="xref py py-attr docutils literal"><span class="pre">flask.Flask.session_interface</span></code></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">session_interface</span> <span class="o">=</span> <span class="n">MySessionInterface</span><span class="p">()</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">버전 0.8에 추가.</span></p>
</div>
<dl class="method">
<dt id="flask.sessions.SessionInterface.get_cookie_domain">
<code class="descname">get_cookie_domain</code><span class="sig-paren">(</span><em>app</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.sessions.SessionInterface.get_cookie_domain" title="정의 주소">¶</a></dt>
<dd><p>Helpful helper method that returns the cookie domain that should
be used for the session cookie if session cookies are used.</p>
</dd></dl>

<dl class="method">
<dt id="flask.sessions.SessionInterface.get_cookie_httponly">
<code class="descname">get_cookie_httponly</code><span class="sig-paren">(</span><em>app</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.sessions.SessionInterface.get_cookie_httponly" title="정의 주소">¶</a></dt>
<dd><p>Returns True if the session cookie should be httponly.  This
currently just returns the value of the <code class="docutils literal"><span class="pre">SESSION_COOKIE_HTTPONLY</span></code>
config var.</p>
</dd></dl>

<dl class="method">
<dt id="flask.sessions.SessionInterface.get_cookie_path">
<code class="descname">get_cookie_path</code><span class="sig-paren">(</span><em>app</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.sessions.SessionInterface.get_cookie_path" title="정의 주소">¶</a></dt>
<dd><p>Returns the path for which the cookie should be valid.  The
default implementation uses the value from the SESSION_COOKIE_PATH``
config var if it&#8217;s set, and falls back to <code class="docutils literal"><span class="pre">APPLICATION_ROOT</span></code> or
uses <code class="docutils literal"><span class="pre">/</span></code> if it&#8217;s <cite>None</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="flask.sessions.SessionInterface.get_cookie_secure">
<code class="descname">get_cookie_secure</code><span class="sig-paren">(</span><em>app</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.sessions.SessionInterface.get_cookie_secure" title="정의 주소">¶</a></dt>
<dd><p>Returns True if the cookie should be secure.  This currently
just returns the value of the <code class="docutils literal"><span class="pre">SESSION_COOKIE_SECURE</span></code> setting.</p>
</dd></dl>

<dl class="method">
<dt id="flask.sessions.SessionInterface.get_expiration_time">
<code class="descname">get_expiration_time</code><span class="sig-paren">(</span><em>app</em>, <em>session</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.sessions.SessionInterface.get_expiration_time" title="정의 주소">¶</a></dt>
<dd><p>A helper method that returns an expiration date for the session
or <cite>None</cite> if the session is linked to the browser session.  The
default implementation returns now + the permanent session
lifetime configured on the application.</p>
</dd></dl>

<dl class="method">
<dt id="flask.sessions.SessionInterface.is_null_session">
<code class="descname">is_null_session</code><span class="sig-paren">(</span><em>obj</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.sessions.SessionInterface.is_null_session" title="정의 주소">¶</a></dt>
<dd><p>Checks if a given object is a null session.  Null sessions are
not asked to be saved.</p>
<p>This checks if the object is an instance of <a class="reference internal" href="index.html#flask.sessions.SessionInterface.null_session_class" title="flask.sessions.SessionInterface.null_session_class"><code class="xref py py-attr docutils literal"><span class="pre">null_session_class</span></code></a>
by default.</p>
</dd></dl>

<dl class="method">
<dt id="flask.sessions.SessionInterface.make_null_session">
<code class="descname">make_null_session</code><span class="sig-paren">(</span><em>app</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.sessions.SessionInterface.make_null_session" title="정의 주소">¶</a></dt>
<dd><p>Creates a null session which acts as a replacement object if the
real session support could not be loaded due to a configuration
error.  This mainly aids the user experience because the job of the
null session is to still support lookup without complaining but
modifications are answered with a helpful error message of what
failed.</p>
<p>This creates an instance of <a class="reference internal" href="index.html#flask.sessions.SessionInterface.null_session_class" title="flask.sessions.SessionInterface.null_session_class"><code class="xref py py-attr docutils literal"><span class="pre">null_session_class</span></code></a> by default.</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.sessions.SessionInterface.null_session_class">
<code class="descname">null_session_class</code><a class="headerlink" href="#flask.sessions.SessionInterface.null_session_class" title="정의 주소">¶</a></dt>
<dd><p><a class="reference internal" href="index.html#flask.sessions.SessionInterface.make_null_session" title="flask.sessions.SessionInterface.make_null_session"><code class="xref py py-meth docutils literal"><span class="pre">make_null_session()</span></code></a> will look here for the class that should
be created when a null session is requested.  Likewise the
<a class="reference internal" href="index.html#flask.sessions.SessionInterface.is_null_session" title="flask.sessions.SessionInterface.is_null_session"><code class="xref py py-meth docutils literal"><span class="pre">is_null_session()</span></code></a> method will perform a typecheck against
this type.</p>
<p>alias of <a class="reference internal" href="index.html#flask.sessions.NullSession" title="flask.sessions.NullSession"><code class="xref py py-class docutils literal"><span class="pre">NullSession</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="flask.sessions.SessionInterface.open_session">
<code class="descname">open_session</code><span class="sig-paren">(</span><em>app</em>, <em>request</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.sessions.SessionInterface.open_session" title="정의 주소">¶</a></dt>
<dd><p>This method has to be implemented and must either return <cite>None</cite>
in case the loading failed because of a configuration error or an
instance of a session object which implements a dictionary like
interface + the methods and attributes on <a class="reference internal" href="index.html#flask.sessions.SessionMixin" title="flask.sessions.SessionMixin"><code class="xref py py-class docutils literal"><span class="pre">SessionMixin</span></code></a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.sessions.SessionInterface.pickle_based">
<code class="descname">pickle_based</code><em class="property"> = False</em><a class="headerlink" href="#flask.sessions.SessionInterface.pickle_based" title="정의 주소">¶</a></dt>
<dd><p>A flag that indicates if the session interface is pickle based.
This can be used by flask extensions to make a decision in regards
to how to deal with the session object.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.10에 추가.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="flask.sessions.SessionInterface.save_session">
<code class="descname">save_session</code><span class="sig-paren">(</span><em>app</em>, <em>session</em>, <em>response</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.sessions.SessionInterface.save_session" title="정의 주소">¶</a></dt>
<dd><p>This is called for actual sessions returned by <a class="reference internal" href="index.html#flask.sessions.SessionInterface.open_session" title="flask.sessions.SessionInterface.open_session"><code class="xref py py-meth docutils literal"><span class="pre">open_session()</span></code></a>
at the end of the request.  This is still called during a request
context so if you absolutely need access to the request you can do
that.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="flask.sessions.SecureCookieSessionInterface">
<em class="property">class </em><code class="descclassname">flask.sessions.</code><code class="descname">SecureCookieSessionInterface</code><a class="headerlink" href="#flask.sessions.SecureCookieSessionInterface" title="정의 주소">¶</a></dt>
<dd><p>The default session interface that stores sessions in signed cookies
through the <code class="xref py py-mod docutils literal"><span class="pre">itsdangerous</span></code> module.</p>
<dl class="staticmethod">
<dt id="flask.sessions.SecureCookieSessionInterface.digest_method">
<em class="property">static </em><code class="descname">digest_method</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flask.sessions.SecureCookieSessionInterface.digest_method" title="정의 주소">¶</a></dt>
<dd><p>the hash function to use for the signature.  The default is sha1</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.sessions.SecureCookieSessionInterface.key_derivation">
<code class="descname">key_derivation</code><em class="property"> = 'hmac'</em><a class="headerlink" href="#flask.sessions.SecureCookieSessionInterface.key_derivation" title="정의 주소">¶</a></dt>
<dd><p>the name of the itsdangerous supported key derivation.  The default
is hmac.</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.sessions.SecureCookieSessionInterface.salt">
<code class="descname">salt</code><em class="property"> = 'cookie-session'</em><a class="headerlink" href="#flask.sessions.SecureCookieSessionInterface.salt" title="정의 주소">¶</a></dt>
<dd><p>the salt that should be applied on top of the secret key for the
signing of cookie based sessions.</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.sessions.SecureCookieSessionInterface.serializer">
<code class="descname">serializer</code><em class="property"> = &lt;flask.sessions.TaggedJSONSerializer object&gt;</em><a class="headerlink" href="#flask.sessions.SecureCookieSessionInterface.serializer" title="정의 주소">¶</a></dt>
<dd><p>A python serializer for the payload.  The default is a compact
JSON derived serializer with support for some extra Python types
such as datetime objects or tuples.</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.sessions.SecureCookieSessionInterface.session_class">
<code class="descname">session_class</code><a class="headerlink" href="#flask.sessions.SecureCookieSessionInterface.session_class" title="정의 주소">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="index.html#flask.sessions.SecureCookieSession" title="flask.sessions.SecureCookieSession"><code class="xref py py-class docutils literal"><span class="pre">SecureCookieSession</span></code></a></p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="flask.sessions.SecureCookieSession">
<em class="property">class </em><code class="descclassname">flask.sessions.</code><code class="descname">SecureCookieSession</code><span class="sig-paren">(</span><em>initial=None</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.sessions.SecureCookieSession" title="정의 주소">¶</a></dt>
<dd><p>Baseclass for sessions based on signed cookies.</p>
</dd></dl>

<dl class="class">
<dt id="flask.sessions.NullSession">
<em class="property">class </em><code class="descclassname">flask.sessions.</code><code class="descname">NullSession</code><span class="sig-paren">(</span><em>initial=None</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.sessions.NullSession" title="정의 주소">¶</a></dt>
<dd><p>Class used to generate nicer error messages if sessions are not
available.  Will still allow read-only access to the empty session
but fail on setting.</p>
</dd></dl>

<dl class="class">
<dt id="flask.sessions.SessionMixin">
<em class="property">class </em><code class="descclassname">flask.sessions.</code><code class="descname">SessionMixin</code><a class="headerlink" href="#flask.sessions.SessionMixin" title="정의 주소">¶</a></dt>
<dd><p>Expands a basic dictionary with an accessors that are expected
by Flask extensions and users for the session.</p>
<dl class="attribute">
<dt id="flask.sessions.SessionMixin.modified">
<code class="descname">modified</code><em class="property"> = True</em><a class="headerlink" href="#flask.sessions.SessionMixin.modified" title="정의 주소">¶</a></dt>
<dd><p>for some backends this will always be <cite>True</cite>, but some backends will
default this to false and detect changes in the dictionary for as
long as changes do not happen on mutable structures in the session.
The default mixin implementation just hardcodes <cite>True</cite> in.</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.sessions.SessionMixin.new">
<code class="descname">new</code><em class="property"> = False</em><a class="headerlink" href="#flask.sessions.SessionMixin.new" title="정의 주소">¶</a></dt>
<dd><p>some session backends can tell you if a session is new, but that is
not necessarily guaranteed.  Use with caution.  The default mixin
implementation just hardcodes <cite>False</cite> in.</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.sessions.SessionMixin.permanent">
<code class="descname">permanent</code><a class="headerlink" href="#flask.sessions.SessionMixin.permanent" title="정의 주소">¶</a></dt>
<dd><p>this reflects the <code class="docutils literal"><span class="pre">'_permanent'</span></code> key in the dict.</p>
</dd></dl>

</dd></dl>

<div class="admonition-notice admonition">
<p class="first admonition-title">Notice</p>
<p class="last">The <code class="docutils literal"><span class="pre">PERMANENT_SESSION_LIFETIME</span></code> config key can also be an integer
starting with Flask 0.8.  Either catch this down yourself or use
the <a class="reference internal" href="index.html#flask.Flask.permanent_session_lifetime" title="flask.Flask.permanent_session_lifetime"><code class="xref py py-attr docutils literal"><span class="pre">permanent_session_lifetime</span></code></a> attribute on the
app which converts the result to an integer automatically.</p>
</div>
</div>
<div class="section" id="test-client">
<h4>Test Client<a class="headerlink" href="#test-client" title="제목 주소">¶</a></h4>
<dl class="class">
<dt id="flask.testing.FlaskClient">
<em class="property">class </em><code class="descclassname">flask.testing.</code><code class="descname">FlaskClient</code><span class="sig-paren">(</span><em>application</em>, <em>response_wrapper=None</em>, <em>use_cookies=True</em>, <em>allow_subdomain_redirects=False</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.testing.FlaskClient" title="정의 주소">¶</a></dt>
<dd><p>Works like a regular Werkzeug test client but has some knowledge about
how Flask works to defer the cleanup of the request context stack to the
end of a with body when used in a with statement.  For general information
about how to use this class refer to <a class="reference external" href="http://werkzeug.pocoo.org/docs/test/#werkzeug.test.Client" title="(in Werkzeug v0.11-dev)"><code class="xref py py-class docutils literal"><span class="pre">werkzeug.test.Client</span></code></a>.</p>
<p>Basic usage is outlined in the <a class="reference internal" href="index.html#testing"><span>Flask 어플리케이션 테스트하기</span></a> chapter.</p>
<dl class="method">
<dt id="flask.testing.FlaskClient.session_transaction">
<code class="descname">session_transaction</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.testing.FlaskClient.session_transaction" title="정의 주소">¶</a></dt>
<dd><p>When used in combination with a with statement this opens a
session transaction.  This can be used to modify the session that
the test client uses.  Once the with block is left the session is
stored back.</p>
<blockquote>
<div><dl class="docutils">
<dt>with client.session_transaction() as session:</dt>
<dd>session[&#8216;value&#8217;] = 42</dd>
</dl>
</div></blockquote>
<p>Internally this is implemented by going through a temporary test
request context and since session handling could depend on
request variables this function accepts the same arguments as
<a class="reference internal" href="index.html#flask.Flask.test_request_context" title="flask.Flask.test_request_context"><code class="xref py py-meth docutils literal"><span class="pre">test_request_context()</span></code></a> which are directly
passed through.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="application-globals">
<h4>Application Globals<a class="headerlink" href="#application-globals" title="제목 주소">¶</a></h4>
<p>To share data that is valid for one request only from one function to
another, a global variable is not good enough because it would break in
threaded environments.  Flask provides you with a special object that
ensures it is only valid for the active request and that will return
different values for each request.  In a nutshell: it does the right
thing, like it does for <a class="reference internal" href="index.html#flask.request" title="flask.request"><code class="xref py py-class docutils literal"><span class="pre">request</span></code></a> and <a class="reference internal" href="index.html#flask.session" title="flask.session"><code class="xref py py-class docutils literal"><span class="pre">session</span></code></a>.</p>
<dl class="data">
<dt id="flask.g">
<code class="descclassname">flask.</code><code class="descname">g</code><a class="headerlink" href="#flask.g" title="정의 주소">¶</a></dt>
<dd><p>Just store on this whatever you want.  For example a database
connection or the user that is currently logged in.</p>
<p>This is a proxy.  See <a class="reference internal" href="index.html#notes-on-proxies"><span>프록시에서 주의할 점</span></a> for more information.</p>
</dd></dl>

</div>
<div class="section" id="useful-functions-and-classes">
<h4>Useful Functions and Classes<a class="headerlink" href="#useful-functions-and-classes" title="제목 주소">¶</a></h4>
<dl class="data">
<dt id="flask.current_app">
<code class="descclassname">flask.</code><code class="descname">current_app</code><a class="headerlink" href="#flask.current_app" title="정의 주소">¶</a></dt>
<dd><p>Points to the application handling the request.  This is useful for
extensions that want to support multiple applications running side
by side.  This is powered by the application context and not by the
request context, so you can change the value of this proxy by
using the <a class="reference internal" href="index.html#flask.Flask.app_context" title="flask.Flask.app_context"><code class="xref py py-meth docutils literal"><span class="pre">app_context()</span></code></a> method.</p>
<p>This is a proxy.  See <a class="reference internal" href="index.html#notes-on-proxies"><span>프록시에서 주의할 점</span></a> for more information.</p>
</dd></dl>

<dl class="function">
<dt id="flask.has_request_context">
<code class="descclassname">flask.</code><code class="descname">has_request_context</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flask.has_request_context" title="정의 주소">¶</a></dt>
<dd><p>If you have code that wants to test if a request context is there or
not this function can be used.  For instance, you may want to take advantage
of request information if the request object is available, but fail
silently if it is unavailable.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">remote_addr</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">username</span> <span class="o">=</span> <span class="n">username</span>
        <span class="k">if</span> <span class="n">remote_addr</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">has_request_context</span><span class="p">():</span>
            <span class="n">remote_addr</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">remote_addr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remote_addr</span> <span class="o">=</span> <span class="n">remote_addr</span>
</pre></div>
</div>
<p>Alternatively you can also just test any of the context bound objects
(such as <a class="reference internal" href="index.html#flask.request" title="flask.request"><code class="xref py py-class docutils literal"><span class="pre">request</span></code></a> or <a class="reference internal" href="index.html#flask.g" title="flask.g"><code class="xref py py-class docutils literal"><span class="pre">g</span></code></a> for truthness):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">remote_addr</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">username</span> <span class="o">=</span> <span class="n">username</span>
        <span class="k">if</span> <span class="n">remote_addr</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">request</span><span class="p">:</span>
            <span class="n">remote_addr</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">remote_addr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remote_addr</span> <span class="o">=</span> <span class="n">remote_addr</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">버전 0.7에 추가.</span></p>
</div>
</dd></dl>

<dl class="function">
<dt id="flask.has_app_context">
<code class="descclassname">flask.</code><code class="descname">has_app_context</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flask.has_app_context" title="정의 주소">¶</a></dt>
<dd><p>Works like <a class="reference internal" href="index.html#flask.has_request_context" title="flask.has_request_context"><code class="xref py py-func docutils literal"><span class="pre">has_request_context()</span></code></a> but for the application
context.  You can also just do a boolean check on the
<a class="reference internal" href="index.html#flask.current_app" title="flask.current_app"><code class="xref py py-data docutils literal"><span class="pre">current_app</span></code></a> object instead.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.9에 추가.</span></p>
</div>
</dd></dl>

<dl class="function">
<dt id="flask.url_for">
<code class="descclassname">flask.</code><code class="descname">url_for</code><span class="sig-paren">(</span><em>endpoint</em>, <em>**values</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.url_for" title="정의 주소">¶</a></dt>
<dd><p>Generates a URL to the given endpoint with the method provided.</p>
<p>Variable arguments that are unknown to the target endpoint are appended
to the generated URL as query arguments.  If the value of a query argument
is <cite>None</cite>, the whole pair is skipped.  In case blueprints are active
you can shortcut references to the same blueprint by prefixing the
local endpoint with a dot (<code class="docutils literal"><span class="pre">.</span></code>).</p>
<p>This will reference the index function local to the current blueprint:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">url_for</span><span class="p">(</span><span class="s">&#39;.index&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>For more information, head over to the <a class="reference internal" href="index.html#url-building"><span>Quickstart</span></a>.</p>
<p>To integrate applications, <a class="reference internal" href="index.html#flask.Flask" title="flask.Flask"><code class="xref py py-class docutils literal"><span class="pre">Flask</span></code></a> has a hook to intercept URL build
errors through <code class="xref py py-attr docutils literal"><span class="pre">Flask.build_error_handler</span></code>.  The <cite>url_for</cite> function
results in a <code class="xref py py-exc docutils literal"><span class="pre">BuildError</span></code> when the current app does
not have a URL for the given endpoint and values.  When it does, the
<a class="reference internal" href="index.html#flask.current_app" title="flask.current_app"><code class="xref py py-data docutils literal"><span class="pre">current_app</span></code></a> calls its <code class="xref py py-attr docutils literal"><span class="pre">build_error_handler</span></code> if
it is not <cite>None</cite>, which can return a string to use as the result of
<cite>url_for</cite> (instead of <cite>url_for</cite>&#8216;s default to raise the
<code class="xref py py-exc docutils literal"><span class="pre">BuildError</span></code> exception) or re-raise the exception.
An example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">external_url_handler</span><span class="p">(</span><span class="n">error</span><span class="p">,</span> <span class="n">endpoint</span><span class="p">,</span> <span class="o">**</span><span class="n">values</span><span class="p">):</span>
    <span class="s">&quot;Looks up an external URL when `url_for` cannot build a URL.&quot;</span>
    <span class="c"># This is an example of hooking the build_error_handler.</span>
    <span class="c"># Here, lookup_url is some utility function you&#39;ve built</span>
    <span class="c"># which looks up the endpoint in some external URL registry.</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">lookup_url</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="o">**</span><span class="n">values</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">url</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="c"># External lookup did not have a URL.</span>
        <span class="c"># Re-raise the BuildError, in context of original traceback.</span>
        <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_value</span><span class="p">,</span> <span class="n">tb</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">exc_value</span> <span class="ow">is</span> <span class="n">error</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_value</span><span class="p">,</span> <span class="n">tb</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">error</span>
    <span class="c"># url_for will use this result, instead of raising BuildError.</span>
    <span class="k">return</span> <span class="n">url</span>

<span class="n">app</span><span class="o">.</span><span class="n">build_error_handler</span> <span class="o">=</span> <span class="n">external_url_handler</span>
</pre></div>
</div>
<p>Here, <cite>error</cite> is the instance of <code class="xref py py-exc docutils literal"><span class="pre">BuildError</span></code>, and
<cite>endpoint</cite> and <cite>**values</cite> are the arguments passed into <cite>url_for</cite>.  Note
that this is for building URLs outside the current application, and not for
handling 404 NotFound errors.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.10에 추가: </span>The <cite>_scheme</cite> parameter was added.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified">버전 0.9에 추가: </span>The <cite>_anchor</cite> and <cite>_method</cite> parameters were added.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified">버전 0.9에 추가: </span>Calls <code class="xref py py-meth docutils literal"><span class="pre">Flask.handle_build_error()</span></code> on
<code class="xref py py-exc docutils literal"><span class="pre">BuildError</span></code>.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><ul class="first last simple">
<li><strong>endpoint</strong> &#8211; the endpoint of the URL (name of the function)</li>
<li><strong>values</strong> &#8211; the variable arguments of the URL rule</li>
<li><strong>_external</strong> &#8211; if set to <cite>True</cite>, an absolute URL is generated. Server
address can be changed via <cite>SERVER_NAME</cite> configuration variable which
defaults to <cite>localhost</cite>.</li>
<li><strong>_scheme</strong> &#8211; a string specifying the desired URL scheme. The <cite>_external</cite>
parameter must be set to <cite>True</cite> or a <cite>ValueError</cite> is raised.</li>
<li><strong>_anchor</strong> &#8211; if provided this is added as anchor to the URL.</li>
<li><strong>_method</strong> &#8211; if provided this explicitly specifies an HTTP method.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="flask.abort">
<code class="descclassname">flask.</code><code class="descname">abort</code><span class="sig-paren">(</span><em>code</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.abort" title="정의 주소">¶</a></dt>
<dd><p>Raises an <a class="reference external" href="http://werkzeug.pocoo.org/docs/exceptions/#werkzeug.exceptions.HTTPException" title="(in Werkzeug v0.11-dev)"><code class="xref py py-exc docutils literal"><span class="pre">HTTPException</span></code></a> for the given
status code.  For example to abort request handling with a page not
found exception, you would call <code class="docutils literal"><span class="pre">abort(404)</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><strong>code</strong> &#8211; the HTTP error code.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="flask.redirect">
<code class="descclassname">flask.</code><code class="descname">redirect</code><span class="sig-paren">(</span><em>location</em>, <em>code=302</em>, <em>Response=None</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.redirect" title="정의 주소">¶</a></dt>
<dd><p>Returns a response object (a WSGI application) that, if called,
redirects the client to the target location.  Supported codes are 301,
302, 303, 305, and 307.  300 is not supported because it&#8217;s not a real
redirect and 304 because it&#8217;s the answer for a request with a request
with defined If-Modified-Since headers.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.6에 추가: </span>The location can now be a unicode string that is encoded using
the <code class="xref py py-func docutils literal"><span class="pre">iri_to_uri()</span></code> function.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified">버전 0.10에 추가: </span>The class used for the Response object can now be passed in.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><ul class="first last simple">
<li><strong>location</strong> &#8211; the location the response should redirect to.</li>
<li><strong>code</strong> &#8211; the redirect status code. defaults to 302.</li>
<li><strong>Response</strong> (<em>class</em>) &#8211; a Response class to use when instantiating a
response. The default is <a class="reference external" href="http://werkzeug.pocoo.org/docs/wrappers/#werkzeug.wrappers.Response" title="(in Werkzeug v0.11-dev)"><code class="xref py py-class docutils literal"><span class="pre">werkzeug.wrappers.Response</span></code></a> if
unspecified.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="flask.make_response">
<code class="descclassname">flask.</code><code class="descname">make_response</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.make_response" title="정의 주소">¶</a></dt>
<dd><p>Sometimes it is necessary to set additional headers in a view.  Because
views do not have to return response objects but can return a value that
is converted into a response object by Flask itself, it becomes tricky to
add headers to it.  This function can be called instead of using a return
and you will get a response object which you can use to attach headers.</p>
<p>If view looked like this and you want to add a new header:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">&#39;index.html&#39;</span><span class="p">,</span> <span class="n">foo</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
<p>You can now do something like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">make_response</span><span class="p">(</span><span class="n">render_template</span><span class="p">(</span><span class="s">&#39;index.html&#39;</span><span class="p">,</span> <span class="n">foo</span><span class="o">=</span><span class="mi">42</span><span class="p">))</span>
    <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s">&#39;X-Parachutes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;parachutes are cool&#39;</span>
    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
<p>This function accepts the very same arguments you can return from a
view function.  This for example creates a response with a 404 error
code:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">response</span> <span class="o">=</span> <span class="n">make_response</span><span class="p">(</span><span class="n">render_template</span><span class="p">(</span><span class="s">&#39;not_found.html&#39;</span><span class="p">),</span> <span class="mi">404</span><span class="p">)</span>
</pre></div>
</div>
<p>The other use case of this function is to force the return value of a
view function into a response which is helpful with view
decorators:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">response</span> <span class="o">=</span> <span class="n">make_response</span><span class="p">(</span><span class="n">view_function</span><span class="p">())</span>
<span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s">&#39;X-Parachutes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;parachutes are cool&#39;</span>
</pre></div>
</div>
<p>Internally this function does the following things:</p>
<ul class="simple">
<li>if no arguments are passed, it creates a new response argument</li>
<li>if one argument is passed, <a class="reference internal" href="index.html#flask.Flask.make_response" title="flask.Flask.make_response"><code class="xref py py-meth docutils literal"><span class="pre">flask.Flask.make_response()</span></code></a>
is invoked with it.</li>
<li>if more than one argument is passed, the arguments are passed
to the <a class="reference internal" href="index.html#flask.Flask.make_response" title="flask.Flask.make_response"><code class="xref py py-meth docutils literal"><span class="pre">flask.Flask.make_response()</span></code></a> function as tuple.</li>
</ul>
<div class="versionadded">
<p><span class="versionmodified">버전 0.6에 추가.</span></p>
</div>
</dd></dl>

<dl class="function">
<dt id="flask.after_this_request">
<code class="descclassname">flask.</code><code class="descname">after_this_request</code><span class="sig-paren">(</span><em>f</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.after_this_request" title="정의 주소">¶</a></dt>
<dd><p>Executes a function after this request.  This is useful to modify
response objects.  The function is passed the response object and has
to return the same or a new one.</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="nd">@after_this_request</span>
    <span class="k">def</span> <span class="nf">add_header</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
        <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s">&#39;X-Foo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;Parachute&#39;</span>
        <span class="k">return</span> <span class="n">response</span>
    <span class="k">return</span> <span class="s">&#39;Hello World!&#39;</span>
</pre></div>
</div>
<p>This is more useful if a function other than the view function wants to
modify a response.  For instance think of a decorator that wants to add
some headers without converting the return value into a response object.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.9에 추가.</span></p>
</div>
</dd></dl>

<dl class="function">
<dt id="flask.send_file">
<code class="descclassname">flask.</code><code class="descname">send_file</code><span class="sig-paren">(</span><em>filename_or_fp</em>, <em>mimetype=None</em>, <em>as_attachment=False</em>, <em>attachment_filename=None</em>, <em>add_etags=True</em>, <em>cache_timeout=None</em>, <em>conditional=False</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.send_file" title="정의 주소">¶</a></dt>
<dd><p>Sends the contents of a file to the client.  This will use the
most efficient method available and configured.  By default it will
try to use the WSGI server&#8217;s file_wrapper support.  Alternatively
you can set the application&#8217;s <a class="reference internal" href="index.html#flask.Flask.use_x_sendfile" title="flask.Flask.use_x_sendfile"><code class="xref py py-attr docutils literal"><span class="pre">use_x_sendfile</span></code></a> attribute
to <code class="docutils literal"><span class="pre">True</span></code> to directly emit an <cite>X-Sendfile</cite> header.  This however
requires support of the underlying webserver for <cite>X-Sendfile</cite>.</p>
<p>By default it will try to guess the mimetype for you, but you can
also explicitly provide one.  For extra security you probably want
to send certain files as attachment (HTML for instance).  The mimetype
guessing requires a <cite>filename</cite> or an <cite>attachment_filename</cite> to be
provided.</p>
<p>Please never pass filenames to this function from user sources without
checking them first.  Something like this is usually sufficient to
avoid security problems:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">if</span> <span class="s">&#39;..&#39;</span> <span class="ow">in</span> <span class="n">filename</span> <span class="ow">or</span> <span class="n">filename</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">):</span>
    <span class="n">abort</span><span class="p">(</span><span class="mi">404</span><span class="p">)</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">버전 0.2에 추가.</span></p>
</div>
<div class="versionadded">
<p><span class="versionmodified">버전 0.5에 추가: </span>The <cite>add_etags</cite>, <cite>cache_timeout</cite> and <cite>conditional</cite> parameters were
added.  The default behavior is now to attach etags.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">버전 0.7으로 변경: </span>mimetype guessing and etag support for file objects was
deprecated because it was unreliable.  Pass a filename if you are
able to, otherwise attach an etag yourself.  This functionality
will be removed in Flask 1.0</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">버전 0.9으로 변경: </span>cache_timeout pulls its default from application config, when None.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename_or_fp</strong> &#8211; the filename of the file to send.  This is
relative to the <code class="xref py py-attr docutils literal"><span class="pre">root_path</span></code> if a
relative path is specified.
Alternatively a file object might be provided
in which case <cite>X-Sendfile</cite> might not work and
fall back to the traditional method.  Make sure
that the file pointer is positioned at the start
of data to send before calling <a class="reference internal" href="index.html#flask.send_file" title="flask.send_file"><code class="xref py py-func docutils literal"><span class="pre">send_file()</span></code></a>.</li>
<li><strong>mimetype</strong> &#8211; the mimetype of the file if provided, otherwise
auto detection happens.</li>
<li><strong>as_attachment</strong> &#8211; set to <cite>True</cite> if you want to send this file with
a <code class="docutils literal"><span class="pre">Content-Disposition:</span> <span class="pre">attachment</span></code> header.</li>
<li><strong>attachment_filename</strong> &#8211; the filename for the attachment if it
differs from the file&#8217;s filename.</li>
<li><strong>add_etags</strong> &#8211; set to <cite>False</cite> to disable attaching of etags.</li>
<li><strong>conditional</strong> &#8211; set to <cite>True</cite> to enable conditional responses.</li>
<li><strong>cache_timeout</strong> &#8211; the timeout in seconds for the headers. When <cite>None</cite>
(default), this value is set by
<a class="reference internal" href="index.html#flask.Flask.get_send_file_max_age" title="flask.Flask.get_send_file_max_age"><code class="xref py py-meth docutils literal"><span class="pre">get_send_file_max_age()</span></code></a> of
<a class="reference internal" href="index.html#flask.current_app" title="flask.current_app"><code class="xref py py-data docutils literal"><span class="pre">current_app</span></code></a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="flask.send_from_directory">
<code class="descclassname">flask.</code><code class="descname">send_from_directory</code><span class="sig-paren">(</span><em>directory</em>, <em>filename</em>, <em>**options</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.send_from_directory" title="정의 주소">¶</a></dt>
<dd><p>Send a file from a given directory with <a class="reference internal" href="index.html#flask.send_file" title="flask.send_file"><code class="xref py py-func docutils literal"><span class="pre">send_file()</span></code></a>.  This
is a secure way to quickly expose static files from an upload folder
or something similar.</p>
<p>Example usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/uploads/&lt;path:filename&gt;&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">download_file</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">send_from_directory</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&#39;UPLOAD_FOLDER&#39;</span><span class="p">],</span>
                               <span class="n">filename</span><span class="p">,</span> <span class="n">as_attachment</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition-sending-files-and-performance admonition">
<p class="first admonition-title">Sending files and Performance</p>
<p class="last">It is strongly recommended to activate either <cite>X-Sendfile</cite> support in
your webserver or (if no authentication happens) to tell the webserver
to serve files for the given path on its own without calling into the
web application for improved performance.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified">버전 0.5에 추가.</span></p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><ul class="first last simple">
<li><strong>directory</strong> &#8211; the directory where all the files are stored.</li>
<li><strong>filename</strong> &#8211; the filename relative to that directory to
download.</li>
<li><strong>options</strong> &#8211; optional keyword arguments that are directly
forwarded to <a class="reference internal" href="index.html#flask.send_file" title="flask.send_file"><code class="xref py py-func docutils literal"><span class="pre">send_file()</span></code></a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="flask.safe_join">
<code class="descclassname">flask.</code><code class="descname">safe_join</code><span class="sig-paren">(</span><em>directory</em>, <em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.safe_join" title="정의 주소">¶</a></dt>
<dd><p>Safely join <cite>directory</cite> and <cite>filename</cite>.</p>
<p>Example usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/wiki/&lt;path:filename&gt;&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">wiki_page</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">safe_join</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&#39;WIKI_FOLDER&#39;</span><span class="p">],</span> <span class="n">filename</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fd</span><span class="p">:</span>
        <span class="n">content</span> <span class="o">=</span> <span class="n">fd</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c"># Read and process the file content...</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><ul class="first simple">
<li><strong>directory</strong> &#8211; the base directory.</li>
<li><strong>filename</strong> &#8211; the untrusted filename relative to that directory.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><a class="reference external" href="http://werkzeug.pocoo.org/docs/exceptions/#werkzeug.exceptions.NotFound" title="(in Werkzeug v0.11-dev)"><code class="xref py py-class docutils literal"><span class="pre">NotFound</span></code></a> if the resulting path
would fall out of <cite>directory</cite>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="flask.escape">
<code class="descclassname">flask.</code><code class="descname">escape</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span> &rarr; markup<a class="headerlink" href="#flask.escape" title="정의 주소">¶</a></dt>
<dd><p>Convert the characters &amp;, &lt;, &gt;, &#8216;, and &#8221; in string s to HTML-safe
sequences.  Use this if you need to display text that might contain
such characters in HTML.  Marks return value as markup string.</p>
</dd></dl>

<dl class="class">
<dt id="flask.Markup">
<em class="property">class </em><code class="descclassname">flask.</code><code class="descname">Markup</code><a class="headerlink" href="#flask.Markup" title="정의 주소">¶</a></dt>
<dd><p>Marks a string as being safe for inclusion in HTML/XML output without
needing to be escaped.  This implements the <cite>__html__</cite> interface a couple
of frameworks and web applications use.  <a class="reference internal" href="index.html#flask.Markup" title="flask.Markup"><code class="xref py py-class docutils literal"><span class="pre">Markup</span></code></a> is a direct
subclass of <cite>unicode</cite> and provides all the methods of <cite>unicode</cite> just that
it escapes arguments passed and always returns <cite>Markup</cite>.</p>
<p>The <cite>escape</cite> function returns markup objects so that double escaping can&#8217;t
happen.</p>
<p>The constructor of the <a class="reference internal" href="index.html#flask.Markup" title="flask.Markup"><code class="xref py py-class docutils literal"><span class="pre">Markup</span></code></a> class can be used for three
different things:  When passed an unicode object it&#8217;s assumed to be safe,
when passed an object with an HTML representation (has an <cite>__html__</cite>
method) that representation is used, otherwise the object passed is
converted into a unicode string and then assumed to be safe:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">Markup</span><span class="p">(</span><span class="s">&quot;Hello &lt;em&gt;World&lt;/em&gt;!&quot;</span><span class="p">)</span>
<span class="go">Markup(u&#39;Hello &lt;em&gt;World&lt;/em&gt;!&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Foo</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">... </span> <span class="k">def</span> <span class="nf">__html__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>  <span class="k">return</span> <span class="s">&#39;&lt;a href=&quot;#&quot;&gt;foo&lt;/a&gt;&#39;</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Markup</span><span class="p">(</span><span class="n">Foo</span><span class="p">())</span>
<span class="go">Markup(u&#39;&lt;a href=&quot;#&quot;&gt;foo&lt;/a&gt;&#39;)</span>
</pre></div>
</div>
<p>If you want object passed being always treated as unsafe you can use the
<a class="reference internal" href="index.html#flask.escape" title="flask.escape"><code class="xref py py-meth docutils literal"><span class="pre">escape()</span></code></a> classmethod to create a <a class="reference internal" href="index.html#flask.Markup" title="flask.Markup"><code class="xref py py-class docutils literal"><span class="pre">Markup</span></code></a> object:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">Markup</span><span class="o">.</span><span class="n">escape</span><span class="p">(</span><span class="s">&quot;Hello &lt;em&gt;World&lt;/em&gt;!&quot;</span><span class="p">)</span>
<span class="go">Markup(u&#39;Hello &amp;lt;em&amp;gt;World&amp;lt;/em&amp;gt;!&#39;)</span>
</pre></div>
</div>
<p>Operations on a markup string are markup aware which means that all
arguments are passed through the <a class="reference internal" href="index.html#flask.escape" title="flask.escape"><code class="xref py py-func docutils literal"><span class="pre">escape()</span></code></a> function:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">em</span> <span class="o">=</span> <span class="n">Markup</span><span class="p">(</span><span class="s">&quot;&lt;em&gt;</span><span class="si">%s</span><span class="s">&lt;/em&gt;&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">em</span> <span class="o">%</span> <span class="s">&quot;foo &amp; bar&quot;</span>
<span class="go">Markup(u&#39;&lt;em&gt;foo &amp;amp; bar&lt;/em&gt;&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">strong</span> <span class="o">=</span> <span class="n">Markup</span><span class="p">(</span><span class="s">&quot;&lt;strong&gt;</span><span class="si">%(text)s</span><span class="s">&lt;/strong&gt;&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">strong</span> <span class="o">%</span> <span class="p">{</span><span class="s">&#39;text&#39;</span><span class="p">:</span> <span class="s">&#39;&lt;blink&gt;hacker here&lt;/blink&gt;&#39;</span><span class="p">}</span>
<span class="go">Markup(u&#39;&lt;strong&gt;&amp;lt;blink&amp;gt;hacker here&amp;lt;/blink&amp;gt;&lt;/strong&gt;&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Markup</span><span class="p">(</span><span class="s">&quot;&lt;em&gt;Hello&lt;/em&gt; &quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;&lt;foo&gt;&quot;</span>
<span class="go">Markup(u&#39;&lt;em&gt;Hello&lt;/em&gt; &amp;lt;foo&amp;gt;&#39;)</span>
</pre></div>
</div>
<dl class="classmethod">
<dt id="flask.Markup.escape">
<em class="property">classmethod </em><code class="descname">escape</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Markup.escape" title="정의 주소">¶</a></dt>
<dd><p>Escape the string.  Works like <a class="reference internal" href="index.html#flask.escape" title="flask.escape"><code class="xref py py-func docutils literal"><span class="pre">escape()</span></code></a> with the difference
that for subclasses of <a class="reference internal" href="index.html#flask.Markup" title="flask.Markup"><code class="xref py py-class docutils literal"><span class="pre">Markup</span></code></a> this function would return the
correct subclass.</p>
</dd></dl>

<dl class="method">
<dt id="flask.Markup.striptags">
<code class="descname">striptags</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flask.Markup.striptags" title="정의 주소">¶</a></dt>
<dd><p>Unescape markup into an text_type string and strip all tags.  This
also resolves known HTML4 and XHTML entities.  Whitespace is
normalized to one:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">Markup</span><span class="p">(</span><span class="s">&quot;Main &amp;raquo;  &lt;em&gt;About&lt;/em&gt;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">striptags</span><span class="p">()</span>
<span class="go">u&#39;Main \xbb About&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="flask.Markup.unescape">
<code class="descname">unescape</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flask.Markup.unescape" title="정의 주소">¶</a></dt>
<dd><p>Unescape markup again into an text_type string.  This also resolves
known HTML4 and XHTML entities:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">Markup</span><span class="p">(</span><span class="s">&quot;Main &amp;raquo; &lt;em&gt;About&lt;/em&gt;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">unescape</span><span class="p">()</span>
<span class="go">u&#39;Main \xbb &lt;em&gt;About&lt;/em&gt;&#39;</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="message-flashing">
<h4>Message Flashing<a class="headerlink" href="#message-flashing" title="제목 주소">¶</a></h4>
<dl class="function">
<dt id="flask.flash">
<code class="descclassname">flask.</code><code class="descname">flash</code><span class="sig-paren">(</span><em>message</em>, <em>category='message'</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.flash" title="정의 주소">¶</a></dt>
<dd><p>Flashes a message to the next request.  In order to remove the
flashed message from the session and to display it to the user,
the template has to call <a class="reference internal" href="index.html#flask.get_flashed_messages" title="flask.get_flashed_messages"><code class="xref py py-func docutils literal"><span class="pre">get_flashed_messages()</span></code></a>.</p>
<div class="versionchanged">
<p><span class="versionmodified">버전 0.3으로 변경: </span><cite>category</cite> parameter added.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><ul class="first last simple">
<li><strong>message</strong> &#8211; the message to be flashed.</li>
<li><strong>category</strong> &#8211; the category for the message.  The following values
are recommended: <code class="docutils literal"><span class="pre">'message'</span></code> for any kind of message,
<code class="docutils literal"><span class="pre">'error'</span></code> for errors, <code class="docutils literal"><span class="pre">'info'</span></code> for information
messages and <code class="docutils literal"><span class="pre">'warning'</span></code> for warnings.  However any
kind of string can be used as category.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="flask.get_flashed_messages">
<code class="descclassname">flask.</code><code class="descname">get_flashed_messages</code><span class="sig-paren">(</span><em>with_categories=False</em>, <em>category_filter=[]</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.get_flashed_messages" title="정의 주소">¶</a></dt>
<dd><p>Pulls all flashed messages from the session and returns them.
Further calls in the same request to the function will return
the same messages.  By default just the messages are returned,
but when <cite>with_categories</cite> is set to <cite>True</cite>, the return value will
be a list of tuples in the form <code class="docutils literal"><span class="pre">(category,</span> <span class="pre">message)</span></code> instead.</p>
<p>Filter the flashed messages to one or more categories by providing those
categories in <cite>category_filter</cite>.  This allows rendering categories in
separate html blocks.  The <cite>with_categories</cite> and <cite>category_filter</cite>
arguments are distinct:</p>
<ul class="simple">
<li><cite>with_categories</cite> controls whether categories are returned with message
text (<cite>True</cite> gives a tuple, where <cite>False</cite> gives just the message text).</li>
<li><cite>category_filter</cite> filters the messages down to only those matching the
provided categories.</li>
</ul>
<p>See <a class="reference internal" href="index.html#message-flashing-pattern"><span>메시지 플래싱(Message Flashing)</span></a> for examples.</p>
<div class="versionchanged">
<p><span class="versionmodified">버전 0.3으로 변경: </span><cite>with_categories</cite> parameter added.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">버전 0.9으로 변경: </span><cite>category_filter</cite> parameter added.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><ul class="first last simple">
<li><strong>with_categories</strong> &#8211; set to <cite>True</cite> to also receive categories.</li>
<li><strong>category_filter</strong> &#8211; whitelist of categories to limit return values</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-flask.json">
<span id="json-support"></span><h4>JSON Support<a class="headerlink" href="#module-flask.json" title="제목 주소">¶</a></h4>
<p>Flask uses <code class="docutils literal"><span class="pre">simplejson</span></code> for the JSON implementation.  Since simplejson
is provided both by the standard library as well as extension Flask will
try simplejson first and then fall back to the stdlib json module.  On top
of that it will delegate access to the current application&#8217;s JSOn encoders
and decoders for easier customization.</p>
<p>So for starters instead of doing:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">simplejson</span> <span class="kn">as</span> <span class="nn">json</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">json</span>
</pre></div>
</div>
<p>You can instead just do this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">json</span>
</pre></div>
</div>
<p>For usage examples, read the <a class="reference external" href="http://docs.python.org/dev/library/json.html#module-json" title="(in Python v3.6)"><code class="xref py py-mod docutils literal"><span class="pre">json</span></code></a> documentation in the standard
lirbary.  The following extensions are by default applied to the stdlib&#8217;s
JSON module:</p>
<ol class="arabic simple">
<li><code class="docutils literal"><span class="pre">datetime</span></code> objects are serialized as <span class="target" id="index-0"></span><a class="rfc reference external" href="https://tools.ietf.org/html/rfc822.html"><strong>RFC 822</strong></a> strings.</li>
<li>Any object with an <code class="docutils literal"><span class="pre">__html__</span></code> method (like <a class="reference internal" href="index.html#flask.Markup" title="flask.Markup"><code class="xref py py-class docutils literal"><span class="pre">Markup</span></code></a>)
will ahve that method called and then the return value is serialized
as string.</li>
</ol>
<p>The <code class="xref py py-func docutils literal"><span class="pre">htmlsafe_dumps()</span></code> function of this json module is also available
as filter called <code class="docutils literal"><span class="pre">|tojson</span></code> in Jinja2.  Note that inside <cite>script</cite>
tags no escaping must take place, so make sure to disable escaping
with <code class="docutils literal"><span class="pre">|safe</span></code> if you intend to use it inside <cite>script</cite> tags:</p>
<div class="highlight-html+jinja"><div class="highlight"><pre><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">text/javascript</span><span class="nt">&gt;</span>
    <span class="nx">doSomethingWith</span><span class="p">(</span><span class="cp">{{</span> <span class="nv">user.username</span><span class="o">|</span><span class="nf">tojson</span><span class="o">|</span><span class="nf">safe</span> <span class="cp">}}</span><span class="p">);</span>
<span class="nt">&lt;/script&gt;</span>
</pre></div>
</div>
<p>Note that the <code class="docutils literal"><span class="pre">|tojson</span></code> filter escapes forward slashes properly.</p>
<dl class="function">
<dt id="flask.json.jsonify">
<code class="descclassname">flask.json.</code><code class="descname">jsonify</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.json.jsonify" title="정의 주소">¶</a></dt>
<dd><p>Creates a <a class="reference internal" href="index.html#flask.Response" title="flask.Response"><code class="xref py py-class docutils literal"><span class="pre">Response</span></code></a> with the JSON representation of
the given arguments with an <cite>application/json</cite> mimetype.  The arguments
to this function are the same as to the <a class="reference external" href="http://docs.python.org/dev/library/stdtypes.html#dict" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">dict</span></code></a> constructor.</p>
<p>Example usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">jsonify</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/_get_current_user&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">get_current_user</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">jsonify</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">username</span><span class="p">,</span>
                   <span class="n">email</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">email</span><span class="p">,</span>
                   <span class="nb">id</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</pre></div>
</div>
<p>This will send a JSON response like this to the browser:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;username&quot;</span><span class="p">:</span> <span class="s">&quot;admin&quot;</span><span class="p">,</span>
    <span class="s">&quot;email&quot;</span><span class="p">:</span> <span class="s">&quot;admin@localhost&quot;</span><span class="p">,</span>
    <span class="s">&quot;id&quot;</span><span class="p">:</span> <span class="mi">42</span>
<span class="p">}</span>
</pre></div>
</div>
<p>For security reasons only objects are supported toplevel.  For more
information about this, have a look at <a class="reference internal" href="index.html#json-security"><span>JSON Security</span></a>.</p>
<p>This function&#8217;s response will be pretty printed if it was not requested
with <code class="docutils literal"><span class="pre">X-Requested-With:</span> <span class="pre">XMLHttpRequest</span></code> to simplify debugging unless
the <code class="docutils literal"><span class="pre">JSONIFY_PRETTYPRINT_REGULAR</span></code> config parameter is set to false.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.2에 추가.</span></p>
</div>
</dd></dl>

<dl class="function">
<dt id="flask.json.dumps">
<code class="descclassname">flask.json.</code><code class="descname">dumps</code><span class="sig-paren">(</span><em>obj</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.json.dumps" title="정의 주소">¶</a></dt>
<dd><p>Serialize <code class="docutils literal"><span class="pre">obj</span></code> to a JSON formatted <code class="docutils literal"><span class="pre">str</span></code> by using the application&#8217;s
configured encoder (<a class="reference internal" href="index.html#flask.Flask.json_encoder" title="flask.Flask.json_encoder"><code class="xref py py-attr docutils literal"><span class="pre">json_encoder</span></code></a>) if there is an
application on the stack.</p>
<p>This function can return <code class="docutils literal"><span class="pre">unicode</span></code> strings or ascii-only bytestrings by
default which coerce into unicode strings automatically.  That behavior by
default is controlled by the <code class="docutils literal"><span class="pre">JSON_AS_ASCII</span></code> configuration variable
and can be overriden by the simplejson <code class="docutils literal"><span class="pre">ensure_ascii</span></code> parameter.</p>
</dd></dl>

<dl class="function">
<dt id="flask.json.dump">
<code class="descclassname">flask.json.</code><code class="descname">dump</code><span class="sig-paren">(</span><em>obj</em>, <em>fp</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.json.dump" title="정의 주소">¶</a></dt>
<dd><p>Like <a class="reference internal" href="index.html#flask.json.dumps" title="flask.json.dumps"><code class="xref py py-func docutils literal"><span class="pre">dumps()</span></code></a> but writes into a file object.</p>
</dd></dl>

<dl class="function">
<dt id="flask.json.loads">
<code class="descclassname">flask.json.</code><code class="descname">loads</code><span class="sig-paren">(</span><em>s</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.json.loads" title="정의 주소">¶</a></dt>
<dd><p>Unserialize a JSON object from a string <code class="docutils literal"><span class="pre">s</span></code> by using the application&#8217;s
configured decoder (<a class="reference internal" href="index.html#flask.Flask.json_decoder" title="flask.Flask.json_decoder"><code class="xref py py-attr docutils literal"><span class="pre">json_decoder</span></code></a>) if there is an
application on the stack.</p>
</dd></dl>

<dl class="function">
<dt id="flask.json.load">
<code class="descclassname">flask.json.</code><code class="descname">load</code><span class="sig-paren">(</span><em>fp</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.json.load" title="정의 주소">¶</a></dt>
<dd><p>Like <a class="reference internal" href="index.html#flask.json.loads" title="flask.json.loads"><code class="xref py py-func docutils literal"><span class="pre">loads()</span></code></a> but reads from a file object.</p>
</dd></dl>

<dl class="class">
<dt id="flask.json.JSONEncoder">
<em class="property">class </em><code class="descclassname">flask.json.</code><code class="descname">JSONEncoder</code><span class="sig-paren">(</span><em>skipkeys=False</em>, <em>ensure_ascii=True</em>, <em>check_circular=True</em>, <em>allow_nan=True</em>, <em>sort_keys=False</em>, <em>indent=None</em>, <em>separators=None</em>, <em>encoding='utf-8'</em>, <em>default=None</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.json.JSONEncoder" title="정의 주소">¶</a></dt>
<dd><p>The default Flask JSON encoder.  This one extends the default simplejson
encoder by also supporting <code class="docutils literal"><span class="pre">datetime</span></code> objects, <code class="docutils literal"><span class="pre">UUID</span></code> as well as
<code class="docutils literal"><span class="pre">Markup</span></code> objects which are serialized as RFC 822 datetime strings (same
as the HTTP date format).  In order to support more data types override the
<a class="reference internal" href="index.html#flask.json.JSONEncoder.default" title="flask.json.JSONEncoder.default"><code class="xref py py-meth docutils literal"><span class="pre">default()</span></code></a> method.</p>
<dl class="method">
<dt id="flask.json.JSONEncoder.default">
<code class="descname">default</code><span class="sig-paren">(</span><em>o</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.json.JSONEncoder.default" title="정의 주소">¶</a></dt>
<dd><p>Implement this method in a subclass such that it returns a
serializable object for <code class="docutils literal"><span class="pre">o</span></code>, or calls the base implementation (to
raise a <code class="docutils literal"><span class="pre">TypeError</span></code>).</p>
<p>For example, to support arbitrary iterators, you could implement
default like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">o</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">iterable</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">iterable</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">JSONEncoder</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">o</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="flask.json.JSONDecoder">
<em class="property">class </em><code class="descclassname">flask.json.</code><code class="descname">JSONDecoder</code><span class="sig-paren">(</span><em>encoding=None</em>, <em>object_hook=None</em>, <em>parse_float=None</em>, <em>parse_int=None</em>, <em>parse_constant=None</em>, <em>strict=True</em>, <em>object_pairs_hook=None</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.json.JSONDecoder" title="정의 주소">¶</a></dt>
<dd><p>The default JSON decoder.  This one does not change the behavior from
the default simplejson encoder.  Consult the <a class="reference external" href="http://docs.python.org/dev/library/json.html#module-json" title="(in Python v3.6)"><code class="xref py py-mod docutils literal"><span class="pre">json</span></code></a> documentation
for more information.  This decoder is not only used for the load
functions of this module but also <a class="reference internal" href="index.html#flask.Request" title="flask.Request"><code class="xref py py-attr docutils literal"><span class="pre">Request</span></code></a>.</p>
</dd></dl>

</div>
<div class="section" id="template-rendering">
<h4>Template Rendering<a class="headerlink" href="#template-rendering" title="제목 주소">¶</a></h4>
<dl class="function">
<dt id="flask.render_template">
<code class="descclassname">flask.</code><code class="descname">render_template</code><span class="sig-paren">(</span><em>template_name_or_list</em>, <em>**context</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.render_template" title="정의 주소">¶</a></dt>
<dd><p>Renders a template from the template folder with the given
context.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><ul class="first last simple">
<li><strong>template_name_or_list</strong> &#8211; the name of the template to be
rendered, or an iterable with template names
the first one existing will be rendered</li>
<li><strong>context</strong> &#8211; the variables that should be available in the
context of the template.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="flask.render_template_string">
<code class="descclassname">flask.</code><code class="descname">render_template_string</code><span class="sig-paren">(</span><em>source</em>, <em>**context</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.render_template_string" title="정의 주소">¶</a></dt>
<dd><p>Renders a template from the given template source string
with the given context.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><ul class="first last simple">
<li><strong>source</strong> &#8211; the sourcecode of the template to be
rendered</li>
<li><strong>context</strong> &#8211; the variables that should be available in the
context of the template.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="flask.get_template_attribute">
<code class="descclassname">flask.</code><code class="descname">get_template_attribute</code><span class="sig-paren">(</span><em>template_name</em>, <em>attribute</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.get_template_attribute" title="정의 주소">¶</a></dt>
<dd><p>Loads a macro (or variable) a template exports.  This can be used to
invoke a macro from within Python code.  If you for example have a
template named <cite>_cider.html</cite> with the following contents:</p>
<div class="highlight-html+jinja"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">macro</span> <span class="nv">hello</span><span class="o">(</span><span class="nv">name</span><span class="o">)</span> <span class="cp">%}</span>Hello <span class="cp">{{</span> <span class="nv">name</span> <span class="cp">}}</span>!<span class="cp">{%</span> <span class="k">endmacro</span> <span class="cp">%}</span>
</pre></div>
</div>
<p>You can access this from Python code like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">hello</span> <span class="o">=</span> <span class="n">get_template_attribute</span><span class="p">(</span><span class="s">&#39;_cider.html&#39;</span><span class="p">,</span> <span class="s">&#39;hello&#39;</span><span class="p">)</span>
<span class="k">return</span> <span class="n">hello</span><span class="p">(</span><span class="s">&#39;World&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">버전 0.2에 추가.</span></p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><ul class="first last simple">
<li><strong>template_name</strong> &#8211; the name of the template</li>
<li><strong>attribute</strong> &#8211; the name of the variable of macro to access</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="configuration">
<h4>Configuration<a class="headerlink" href="#configuration" title="제목 주소">¶</a></h4>
<dl class="class">
<dt id="flask.Config">
<em class="property">class </em><code class="descclassname">flask.</code><code class="descname">Config</code><span class="sig-paren">(</span><em>root_path</em>, <em>defaults=None</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Config" title="정의 주소">¶</a></dt>
<dd><p>Works exactly like a dict but provides ways to fill it from files
or special dictionaries.  There are two common patterns to populate the
config.</p>
<p>Either you can fill the config from a config file:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">from_pyfile</span><span class="p">(</span><span class="s">&#39;yourconfig.cfg&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Or alternatively you can define the configuration options in the
module that calls <a class="reference internal" href="index.html#flask.Config.from_object" title="flask.Config.from_object"><code class="xref py py-meth docutils literal"><span class="pre">from_object()</span></code></a> or provide an import path to
a module that should be loaded.  It is also possible to tell it to
use the same module and with that provide the configuration values
just before the call:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">DEBUG</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">&#39;development key&#39;</span>
<span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">from_object</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
</pre></div>
</div>
<p>In both cases (loading from any Python file or loading from modules),
only uppercase keys are added to the config.  This makes it possible to use
lowercase values in the config file for temporary values that are not added
to the config or to define the config keys in the same file that implements
the application.</p>
<p>Probably the most interesting way to load configurations is from an
environment variable pointing to a file:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">from_envvar</span><span class="p">(</span><span class="s">&#39;YOURAPPLICATION_SETTINGS&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>In this case before launching the application you have to set this
environment variable to the file you want to use.  On Linux and OS X
use the export statement:</p>
<div class="highlight-python"><div class="highlight"><pre>export YOURAPPLICATION_SETTINGS=&#39;/path/to/config/file&#39;
</pre></div>
</div>
<p>On windows use <cite>set</cite> instead.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><ul class="first last simple">
<li><strong>root_path</strong> &#8211; path to which files are read relative from.  When the
config object is created by the application, this is
the application&#8217;s <code class="xref py py-attr docutils literal"><span class="pre">root_path</span></code>.</li>
<li><strong>defaults</strong> &#8211; an optional dictionary of default values</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="flask.Config.from_envvar">
<code class="descname">from_envvar</code><span class="sig-paren">(</span><em>variable_name</em>, <em>silent=False</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Config.from_envvar" title="정의 주소">¶</a></dt>
<dd><p>Loads a configuration from an environment variable pointing to
a configuration file.  This is basically just a shortcut with nicer
error messages for this line of code:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">from_pyfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s">&#39;YOURAPPLICATION_SETTINGS&#39;</span><span class="p">])</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><ul class="first simple">
<li><strong>variable_name</strong> &#8211; name of the environment variable</li>
<li><strong>silent</strong> &#8211; set to <cite>True</cite> if you want silent failure for missing
files.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">반환:</th><td class="field-body"><p class="first last">bool. <cite>True</cite> if able to load config, <cite>False</cite> otherwise.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flask.Config.from_object">
<code class="descname">from_object</code><span class="sig-paren">(</span><em>obj</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Config.from_object" title="정의 주소">¶</a></dt>
<dd><p>Updates the values from the given object.  An object can be of one
of the following two types:</p>
<ul class="simple">
<li>a string: in this case the object with that name will be imported</li>
<li>an actual object reference: that object is used directly</li>
</ul>
<p>Objects are usually either modules or classes.</p>
<p>Just the uppercase variables in that object are stored in the config.
Example usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">from_object</span><span class="p">(</span><span class="s">&#39;yourapplication.default_config&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">yourapplication</span> <span class="kn">import</span> <span class="n">default_config</span>
<span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">from_object</span><span class="p">(</span><span class="n">default_config</span><span class="p">)</span>
</pre></div>
</div>
<p>You should not use this function to load the actual configuration but
rather configuration defaults.  The actual config should be loaded
with <a class="reference internal" href="index.html#flask.Config.from_pyfile" title="flask.Config.from_pyfile"><code class="xref py py-meth docutils literal"><span class="pre">from_pyfile()</span></code></a> and ideally from a location not within the
package because the package might be installed system wide.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><strong>obj</strong> &#8211; an import name or object</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flask.Config.from_pyfile">
<code class="descname">from_pyfile</code><span class="sig-paren">(</span><em>filename</em>, <em>silent=False</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.Config.from_pyfile" title="정의 주소">¶</a></dt>
<dd><p>Updates the values in the config from a Python file.  This function
behaves as if the file was imported as module with the
<a class="reference internal" href="index.html#flask.Config.from_object" title="flask.Config.from_object"><code class="xref py py-meth docutils literal"><span class="pre">from_object()</span></code></a> function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">매개 변수:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> &#8211; the filename of the config.  This can either be an
absolute filename or a filename relative to the
root path.</li>
<li><strong>silent</strong> &#8211; set to <cite>True</cite> if you want silent failure for missing
files.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="versionadded">
<p><span class="versionmodified">버전 0.7에 추가: </span><cite>silent</cite> parameter.</p>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="extensions">
<h4>Extensions<a class="headerlink" href="#extensions" title="제목 주소">¶</a></h4>
<dl class="data">
<dt id="flask.flask.ext">
<code class="descclassname">flask.</code><code class="descname">ext</code><a class="headerlink" href="#flask.flask.ext" title="정의 주소">¶</a></dt>
<dd><p>This module acts as redirect import module to Flask extensions.  It was
added in 0.8 as the canonical way to import Flask extensions and makes
it possible for us to have more flexibility in how we distribute
extensions.</p>
<p>If you want to use an extension named “Flask-Foo” you would import it
from <a class="reference internal" href="index.html#flask.flask.ext" title="flask.flask.ext"><code class="xref py py-data docutils literal"><span class="pre">ext</span></code></a> as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask.ext</span> <span class="kn">import</span> <span class="n">foo</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">버전 0.8에 추가.</span></p>
</div>
</dd></dl>

</div>
<div class="section" id="stream-helpers">
<h4>Stream Helpers<a class="headerlink" href="#stream-helpers" title="제목 주소">¶</a></h4>
<dl class="function">
<dt id="flask.stream_with_context">
<code class="descclassname">flask.</code><code class="descname">stream_with_context</code><span class="sig-paren">(</span><em>generator_or_function</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.stream_with_context" title="정의 주소">¶</a></dt>
<dd><p>Request contexts disappear when the response is started on the server.
This is done for efficiency reasons and to make it less likely to encounter
memory leaks with badly written WSGI middlewares.  The downside is that if
you are using streamed responses, the generator cannot access request bound
information any more.</p>
<p>This function however can help you keep the context around for longer:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">stream_with_context</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">Response</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/stream&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">streamed_response</span><span class="p">():</span>
    <span class="nd">@stream_with_context</span>
    <span class="k">def</span> <span class="nf">generate</span><span class="p">():</span>
        <span class="k">yield</span> <span class="s">&#39;Hello &#39;</span>
        <span class="k">yield</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">]</span>
        <span class="k">yield</span> <span class="s">&#39;!&#39;</span>
    <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="n">generate</span><span class="p">())</span>
</pre></div>
</div>
<p>Alternatively it can also be used around a specific generator:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">stream_with_context</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">Response</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/stream&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">streamed_response</span><span class="p">():</span>
    <span class="k">def</span> <span class="nf">generate</span><span class="p">():</span>
        <span class="k">yield</span> <span class="s">&#39;Hello &#39;</span>
        <span class="k">yield</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">]</span>
        <span class="k">yield</span> <span class="s">&#39;!&#39;</span>
    <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="n">stream_with_context</span><span class="p">(</span><span class="n">generate</span><span class="p">()))</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">버전 0.9에 추가.</span></p>
</div>
</dd></dl>

</div>
<div class="section" id="useful-internals">
<h4>Useful Internals<a class="headerlink" href="#useful-internals" title="제목 주소">¶</a></h4>
<dl class="class">
<dt id="flask.ctx.RequestContext">
<em class="property">class </em><code class="descclassname">flask.ctx.</code><code class="descname">RequestContext</code><span class="sig-paren">(</span><em>app</em>, <em>environ</em>, <em>request=None</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.ctx.RequestContext" title="정의 주소">¶</a></dt>
<dd><p>The request context contains all request relevant information.  It is
created at the beginning of the request and pushed to the
<cite>_request_ctx_stack</cite> and removed at the end of it.  It will create the
URL adapter and request object for the WSGI environment provided.</p>
<p>Do not attempt to use this class directly, instead use
<a class="reference internal" href="index.html#flask.Flask.test_request_context" title="flask.Flask.test_request_context"><code class="xref py py-meth docutils literal"><span class="pre">test_request_context()</span></code></a> and
<a class="reference internal" href="index.html#flask.Flask.request_context" title="flask.Flask.request_context"><code class="xref py py-meth docutils literal"><span class="pre">request_context()</span></code></a> to create this object.</p>
<p>When the request context is popped, it will evaluate all the
functions registered on the application for teardown execution
(<a class="reference internal" href="index.html#flask.Flask.teardown_request" title="flask.Flask.teardown_request"><code class="xref py py-meth docutils literal"><span class="pre">teardown_request()</span></code></a>).</p>
<p>The request context is automatically popped at the end of the request
for you.  In debug mode the request context is kept around if
exceptions happen so that interactive debuggers have a chance to
introspect the data.  With 0.4 this can also be forced for requests
that did not fail and outside of <cite>DEBUG</cite> mode.  By setting
<code class="docutils literal"><span class="pre">'flask._preserve_context'</span></code> to <cite>True</cite> on the WSGI environment the
context will not pop itself at the end of the request.  This is used by
the <a class="reference internal" href="index.html#flask.Flask.test_client" title="flask.Flask.test_client"><code class="xref py py-meth docutils literal"><span class="pre">test_client()</span></code></a> for example to implement the
deferred cleanup functionality.</p>
<p>You might find this helpful for unittests where you need the
information from the context local around for a little longer.  Make
sure to properly <code class="xref py py-meth docutils literal"><span class="pre">pop()</span></code> the stack yourself in
that situation, otherwise your unittests will leak memory.</p>
<dl class="method">
<dt id="flask.ctx.RequestContext.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flask.ctx.RequestContext.copy" title="정의 주소">¶</a></dt>
<dd><p>Creates a copy of this request context with the same request object.
This can be used to move a request context to a different greenlet.
Because the actual request object is the same this cannot be used to
move a request context to a different thread unless access to the
request object is locked.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.10에 추가.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="flask.ctx.RequestContext.match_request">
<code class="descname">match_request</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flask.ctx.RequestContext.match_request" title="정의 주소">¶</a></dt>
<dd><p>Can be overridden by a subclass to hook into the matching
of the request.</p>
</dd></dl>

<dl class="method">
<dt id="flask.ctx.RequestContext.pop">
<code class="descname">pop</code><span class="sig-paren">(</span><em>exc=None</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.ctx.RequestContext.pop" title="정의 주소">¶</a></dt>
<dd><p>Pops the request context and unbinds it by doing that.  This will
also trigger the execution of functions registered by the
<a class="reference internal" href="index.html#flask.Flask.teardown_request" title="flask.Flask.teardown_request"><code class="xref py py-meth docutils literal"><span class="pre">teardown_request()</span></code></a> decorator.</p>
<div class="versionchanged">
<p><span class="versionmodified">버전 0.9으로 변경: </span>Added the <cite>exc</cite> argument.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="flask.ctx.RequestContext.push">
<code class="descname">push</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flask.ctx.RequestContext.push" title="정의 주소">¶</a></dt>
<dd><p>Binds the request context to the current context.</p>
</dd></dl>

</dd></dl>

<dl class="data">
<dt id="flask._request_ctx_stack">
<code class="descclassname">flask.</code><code class="descname">_request_ctx_stack</code><a class="headerlink" href="#flask._request_ctx_stack" title="정의 주소">¶</a></dt>
<dd><p>The internal <a class="reference external" href="http://werkzeug.pocoo.org/docs/local/#werkzeug.local.LocalStack" title="(in Werkzeug v0.11-dev)"><code class="xref py py-class docutils literal"><span class="pre">LocalStack</span></code></a> that is used to implement
all the context local objects used in Flask.  This is a documented
instance and can be used by extensions and application code but the
use is discouraged in general.</p>
<p>The following attributes are always present on each layer of the
stack:</p>
<dl class="docutils">
<dt><cite>app</cite></dt>
<dd>the active Flask application.</dd>
<dt><cite>url_adapter</cite></dt>
<dd>the URL adapter that was used to match the request.</dd>
<dt><cite>request</cite></dt>
<dd>the current request object.</dd>
<dt><cite>session</cite></dt>
<dd>the active session object.</dd>
<dt><cite>g</cite></dt>
<dd>an object with all the attributes of the <a class="reference internal" href="index.html#flask.g" title="flask.g"><code class="xref py py-data docutils literal"><span class="pre">flask.g</span></code></a> object.</dd>
<dt><cite>flashes</cite></dt>
<dd>an internal cache for the flashed messages.</dd>
</dl>
<p>Example usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">_request_ctx_stack</span>

<span class="k">def</span> <span class="nf">get_session</span><span class="p">():</span>
    <span class="n">ctx</span> <span class="o">=</span> <span class="n">_request_ctx_stack</span><span class="o">.</span><span class="n">top</span>
    <span class="k">if</span> <span class="n">ctx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ctx</span><span class="o">.</span><span class="n">session</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="flask.ctx.AppContext">
<em class="property">class </em><code class="descclassname">flask.ctx.</code><code class="descname">AppContext</code><span class="sig-paren">(</span><em>app</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.ctx.AppContext" title="정의 주소">¶</a></dt>
<dd><p>The application context binds an application object implicitly
to the current thread or greenlet, similar to how the
<code class="xref py py-class docutils literal"><span class="pre">RequestContext</span></code> binds request information.  The application
context is also implicitly created if a request context is created
but the application is not on top of the individual application
context.</p>
<dl class="method">
<dt id="flask.ctx.AppContext.pop">
<code class="descname">pop</code><span class="sig-paren">(</span><em>exc=None</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.ctx.AppContext.pop" title="정의 주소">¶</a></dt>
<dd><p>Pops the app context.</p>
</dd></dl>

<dl class="method">
<dt id="flask.ctx.AppContext.push">
<code class="descname">push</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flask.ctx.AppContext.push" title="정의 주소">¶</a></dt>
<dd><p>Binds the app context to the current context.</p>
</dd></dl>

</dd></dl>

<dl class="data">
<dt id="flask._app_ctx_stack">
<code class="descclassname">flask.</code><code class="descname">_app_ctx_stack</code><a class="headerlink" href="#flask._app_ctx_stack" title="정의 주소">¶</a></dt>
<dd><p>Works similar to the request context but only binds the application.
This is mainly there for extensions to store data.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.9에 추가.</span></p>
</div>
</dd></dl>

<dl class="class">
<dt id="flask.blueprints.BlueprintSetupState">
<em class="property">class </em><code class="descclassname">flask.blueprints.</code><code class="descname">BlueprintSetupState</code><span class="sig-paren">(</span><em>blueprint</em>, <em>app</em>, <em>options</em>, <em>first_registration</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.blueprints.BlueprintSetupState" title="정의 주소">¶</a></dt>
<dd><p>Temporary holder object for registering a blueprint with the
application.  An instance of this class is created by the
<a class="reference internal" href="index.html#flask.Blueprint.make_setup_state" title="flask.Blueprint.make_setup_state"><code class="xref py py-meth docutils literal"><span class="pre">make_setup_state()</span></code></a> method and later passed
to all register callback functions.</p>
<dl class="method">
<dt id="flask.blueprints.BlueprintSetupState.add_url_rule">
<code class="descname">add_url_rule</code><span class="sig-paren">(</span><em>rule</em>, <em>endpoint=None</em>, <em>view_func=None</em>, <em>**options</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.blueprints.BlueprintSetupState.add_url_rule" title="정의 주소">¶</a></dt>
<dd><p>A helper method to register a rule (and optionally a view function)
to the application.  The endpoint is automatically prefixed with the
blueprint&#8217;s name.</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.blueprints.BlueprintSetupState.app">
<code class="descname">app</code><em class="property"> = None</em><a class="headerlink" href="#flask.blueprints.BlueprintSetupState.app" title="정의 주소">¶</a></dt>
<dd><p>a reference to the current application</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.blueprints.BlueprintSetupState.blueprint">
<code class="descname">blueprint</code><em class="property"> = None</em><a class="headerlink" href="#flask.blueprints.BlueprintSetupState.blueprint" title="정의 주소">¶</a></dt>
<dd><p>a reference to the blueprint that created this setup state.</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.blueprints.BlueprintSetupState.first_registration">
<code class="descname">first_registration</code><em class="property"> = None</em><a class="headerlink" href="#flask.blueprints.BlueprintSetupState.first_registration" title="정의 주소">¶</a></dt>
<dd><p>as blueprints can be registered multiple times with the
application and not everything wants to be registered
multiple times on it, this attribute can be used to figure
out if the blueprint was registered in the past already.</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.blueprints.BlueprintSetupState.options">
<code class="descname">options</code><em class="property"> = None</em><a class="headerlink" href="#flask.blueprints.BlueprintSetupState.options" title="정의 주소">¶</a></dt>
<dd><p>a dictionary with all options that were passed to the
<a class="reference internal" href="index.html#flask.Flask.register_blueprint" title="flask.Flask.register_blueprint"><code class="xref py py-meth docutils literal"><span class="pre">register_blueprint()</span></code></a> method.</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.blueprints.BlueprintSetupState.subdomain">
<code class="descname">subdomain</code><em class="property"> = None</em><a class="headerlink" href="#flask.blueprints.BlueprintSetupState.subdomain" title="정의 주소">¶</a></dt>
<dd><p>The subdomain that the blueprint should be active for, <cite>None</cite>
otherwise.</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.blueprints.BlueprintSetupState.url_defaults">
<code class="descname">url_defaults</code><em class="property"> = None</em><a class="headerlink" href="#flask.blueprints.BlueprintSetupState.url_defaults" title="정의 주소">¶</a></dt>
<dd><p>A dictionary with URL defaults that is added to each and every
URL that was defined with the blueprint.</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.blueprints.BlueprintSetupState.url_prefix">
<code class="descname">url_prefix</code><em class="property"> = None</em><a class="headerlink" href="#flask.blueprints.BlueprintSetupState.url_prefix" title="정의 주소">¶</a></dt>
<dd><p>The prefix that should be used for all URLs defined on the
blueprint.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="signals">
<h4>Signals<a class="headerlink" href="#signals" title="제목 주소">¶</a></h4>
<div class="versionadded">
<p><span class="versionmodified">버전 0.6에 추가.</span></p>
</div>
<dl class="data">
<dt id="flask.signals_available">
<code class="descclassname">flask.</code><code class="descname">signals_available</code><a class="headerlink" href="#flask.signals_available" title="정의 주소">¶</a></dt>
<dd><p><cite>True</cite> if the signalling system is available.  This is the case
when <a class="reference external" href="http://pypi.python.org/pypi/blinker">blinker</a> is installed.</p>
</dd></dl>

<dl class="data">
<dt id="flask.template_rendered">
<code class="descclassname">flask.</code><code class="descname">template_rendered</code><a class="headerlink" href="#flask.template_rendered" title="정의 주소">¶</a></dt>
<dd><p>This signal is sent when a template was successfully rendered.  The
signal is invoked with the instance of the template as <cite>template</cite>
and the context as dictionary (named <cite>context</cite>).</p>
</dd></dl>

<dl class="data">
<dt id="flask.request_started">
<code class="descclassname">flask.</code><code class="descname">request_started</code><a class="headerlink" href="#flask.request_started" title="정의 주소">¶</a></dt>
<dd><p>This signal is sent before any request processing started but when the
request context was set up.  Because the request context is already
bound, the subscriber can access the request with the standard global
proxies such as <a class="reference internal" href="index.html#flask.request" title="flask.request"><code class="xref py py-class docutils literal"><span class="pre">request</span></code></a>.</p>
</dd></dl>

<dl class="data">
<dt id="flask.request_finished">
<code class="descclassname">flask.</code><code class="descname">request_finished</code><a class="headerlink" href="#flask.request_finished" title="정의 주소">¶</a></dt>
<dd><p>This signal is sent right before the response is sent to the client.
It is passed the response to be sent named <cite>response</cite>.</p>
</dd></dl>

<dl class="data">
<dt id="flask.got_request_exception">
<code class="descclassname">flask.</code><code class="descname">got_request_exception</code><a class="headerlink" href="#flask.got_request_exception" title="정의 주소">¶</a></dt>
<dd><p>This signal is sent when an exception happens during request processing.
It is sent <em>before</em> the standard exception handling kicks in and even
in debug mode, where no exception handling happens.  The exception
itself is passed to the subscriber as <cite>exception</cite>.</p>
</dd></dl>

<dl class="data">
<dt id="flask.request_tearing_down">
<code class="descclassname">flask.</code><code class="descname">request_tearing_down</code><a class="headerlink" href="#flask.request_tearing_down" title="정의 주소">¶</a></dt>
<dd><p>This signal is sent when the application is tearing down the request.
This is always called, even if an error happened.  An <cite>exc</cite> keyword
argument is passed with the exception that caused the teardown.</p>
<div class="versionchanged">
<p><span class="versionmodified">버전 0.9으로 변경: </span>The <cite>exc</cite> parameter was added.</p>
</div>
</dd></dl>

<dl class="data">
<dt id="flask.appcontext_tearing_down">
<code class="descclassname">flask.</code><code class="descname">appcontext_tearing_down</code><a class="headerlink" href="#flask.appcontext_tearing_down" title="정의 주소">¶</a></dt>
<dd><p>This signal is sent when the application is tearing down the
application context.  This is always called, even if an error happened.
An <cite>exc</cite> keyword argument is passed with the exception that caused the
teardown.</p>
</dd></dl>

<dl class="class">
<dt id="flask.signals.Namespace">
<em class="property">class </em><code class="descclassname">flask.signals.</code><code class="descname">Namespace</code><a class="headerlink" href="#flask.signals.Namespace" title="정의 주소">¶</a></dt>
<dd><p>An alias for <a class="reference external" href="http://discorporate.us/projects/Blinker/docs/1.1/api.html#blinker.base.Namespace" title="(in Blinker v1.1)"><code class="xref py py-class docutils literal"><span class="pre">blinker.base.Namespace</span></code></a> if blinker is available,
otherwise a dummy class that creates fake signals.  This class is
available for Flask extensions that want to provide the same fallback
system as Flask itself.</p>
<dl class="method">
<dt id="flask.signals.Namespace.signal">
<code class="descname">signal</code><span class="sig-paren">(</span><em>name</em>, <em>doc=None</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.signals.Namespace.signal" title="정의 주소">¶</a></dt>
<dd><p>Creates a new signal for this namespace if blinker is available,
otherwise returns a fake signal that has a send method that will
do nothing but will fail with a <a class="reference external" href="http://docs.python.org/dev/library/exceptions.html#RuntimeError" title="(in Python v3.6)"><code class="xref py py-exc docutils literal"><span class="pre">RuntimeError</span></code></a> for all other
operations, including connecting.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="class-based-views">
<h4>Class-Based Views<a class="headerlink" href="#class-based-views" title="제목 주소">¶</a></h4>
<div class="versionadded">
<p><span class="versionmodified">버전 0.7에 추가.</span></p>
</div>
<dl class="class">
<dt id="flask.views.View">
<em class="property">class </em><code class="descclassname">flask.views.</code><code class="descname">View</code><a class="headerlink" href="#flask.views.View" title="정의 주소">¶</a></dt>
<dd><p>Alternative way to use view functions.  A subclass has to implement
<code class="xref py py-meth docutils literal"><span class="pre">dispatch_request()</span></code> which is called with the view arguments from
the URL routing system.  If <code class="xref py py-attr docutils literal"><span class="pre">methods</span></code> is provided the methods
do not have to be passed to the <a class="reference internal" href="index.html#flask.Flask.add_url_rule" title="flask.Flask.add_url_rule"><code class="xref py py-meth docutils literal"><span class="pre">add_url_rule()</span></code></a>
method explicitly:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MyView</span><span class="p">(</span><span class="n">View</span><span class="p">):</span>
    <span class="n">methods</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">dispatch_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&#39;Hello </span><span class="si">%s</span><span class="s">!&#39;</span> <span class="o">%</span> <span class="n">name</span>

<span class="n">app</span><span class="o">.</span><span class="n">add_url_rule</span><span class="p">(</span><span class="s">&#39;/hello/&lt;name&gt;&#39;</span><span class="p">,</span> <span class="n">view_func</span><span class="o">=</span><span class="n">MyView</span><span class="o">.</span><span class="n">as_view</span><span class="p">(</span><span class="s">&#39;myview&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>When you want to decorate a pluggable view you will have to either do that
when the view function is created (by wrapping the return value of
<code class="xref py py-meth docutils literal"><span class="pre">as_view()</span></code>) or you can use the <code class="xref py py-attr docutils literal"><span class="pre">decorators</span></code> attribute:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">SecretView</span><span class="p">(</span><span class="n">View</span><span class="p">):</span>
    <span class="n">methods</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">]</span>
    <span class="n">decorators</span> <span class="o">=</span> <span class="p">[</span><span class="n">superuser_required</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">dispatch_request</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="o">...</span>
</pre></div>
</div>
<p>The decorators stored in the decorators list are applied one after another
when the view function is created.  Note that you can <em>not</em> use the class
based decorators since those would decorate the view class and not the
generated view function!</p>
<dl class="classmethod">
<dt id="flask.views.View.as_view">
<em class="property">classmethod </em><code class="descname">as_view</code><span class="sig-paren">(</span><em>name</em>, <em>*class_args</em>, <em>**class_kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#flask.views.View.as_view" title="정의 주소">¶</a></dt>
<dd><p>Converts the class into an actual view function that can be used
with the routing system.  Internally this generates a function on the
fly which will instantiate the <code class="xref py py-class docutils literal"><span class="pre">View</span></code> on each request and call
the <code class="xref py py-meth docutils literal"><span class="pre">dispatch_request()</span></code> method on it.</p>
<p>The arguments passed to <code class="xref py py-meth docutils literal"><span class="pre">as_view()</span></code> are forwarded to the
constructor of the class.</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.views.View.decorators">
<code class="descname">decorators</code><em class="property"> = []</em><a class="headerlink" href="#flask.views.View.decorators" title="정의 주소">¶</a></dt>
<dd><p>The canonical way to decorate class-based views is to decorate the
return value of as_view().  However since this moves parts of the
logic from the class declaration to the place where it&#8217;s hooked
into the routing system.</p>
<p>You can place one or more decorators in this list and whenever the
view function is created the result is automatically decorated.</p>
<div class="versionadded">
<p><span class="versionmodified">버전 0.8에 추가.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="flask.views.View.dispatch_request">
<code class="descname">dispatch_request</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flask.views.View.dispatch_request" title="정의 주소">¶</a></dt>
<dd><p>Subclasses have to override this method to implement the
actual view function code.  This method is called with all
the arguments from the URL rule.</p>
</dd></dl>

<dl class="attribute">
<dt id="flask.views.View.methods">
<code class="descname">methods</code><em class="property"> = None</em><a class="headerlink" href="#flask.views.View.methods" title="정의 주소">¶</a></dt>
<dd><p>A for which methods this pluggable view can handle.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="flask.views.MethodView">
<em class="property">class </em><code class="descclassname">flask.views.</code><code class="descname">MethodView</code><a class="headerlink" href="#flask.views.MethodView" title="정의 주소">¶</a></dt>
<dd><p>Like a regular class-based view but that dispatches requests to
particular methods.  For instance if you implement a method called
<code class="xref py py-meth docutils literal"><span class="pre">get()</span></code> it means you will response to <code class="docutils literal"><span class="pre">'GET'</span></code> requests and
the <code class="xref py py-meth docutils literal"><span class="pre">dispatch_request()</span></code> implementation will automatically
forward your request to that.  Also <code class="xref py py-attr docutils literal"><span class="pre">options</span></code> is set for you
automatically:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">CounterAPI</span><span class="p">(</span><span class="n">MethodView</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;counter&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">post</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">session</span><span class="p">[</span><span class="s">&#39;counter&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;counter&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="s">&#39;OK&#39;</span>

<span class="n">app</span><span class="o">.</span><span class="n">add_url_rule</span><span class="p">(</span><span class="s">&#39;/counter&#39;</span><span class="p">,</span> <span class="n">view_func</span><span class="o">=</span><span class="n">CounterAPI</span><span class="o">.</span><span class="n">as_view</span><span class="p">(</span><span class="s">&#39;counter&#39;</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="url-route-registrations">
<span id="id2"></span><h4>URL Route Registrations<a class="headerlink" href="#url-route-registrations" title="제목 주소">¶</a></h4>
<p>Generally there are three ways to define rules for the routing system:</p>
<ol class="arabic simple">
<li>You can use the <a class="reference internal" href="index.html#flask.Flask.route" title="flask.Flask.route"><code class="xref py py-meth docutils literal"><span class="pre">flask.Flask.route()</span></code></a> decorator.</li>
<li>You can use the <a class="reference internal" href="index.html#flask.Flask.add_url_rule" title="flask.Flask.add_url_rule"><code class="xref py py-meth docutils literal"><span class="pre">flask.Flask.add_url_rule()</span></code></a> function.</li>
<li>You can directly access the underlying Werkzeug routing system
which is exposed as <a class="reference internal" href="index.html#flask.Flask.url_map" title="flask.Flask.url_map"><code class="xref py py-attr docutils literal"><span class="pre">flask.Flask.url_map</span></code></a>.</li>
</ol>
<p>Variable parts in the route can be specified with angular brackets
(<code class="docutils literal"><span class="pre">/user/&lt;username&gt;</span></code>).  By default a variable part in the URL accepts any
string without a slash however a different converter can be specified as
well by using <code class="docutils literal"><span class="pre">&lt;converter:name&gt;</span></code>.</p>
<p>Variable parts are passed to the view function as keyword arguments.</p>
<p>The following converters are available:</p>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="81%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><cite>string</cite></td>
<td>accepts any text without a slash (the default)</td>
</tr>
<tr class="row-even"><td><cite>int</cite></td>
<td>accepts integers</td>
</tr>
<tr class="row-odd"><td><cite>float</cite></td>
<td>like <cite>int</cite> but for floating point values</td>
</tr>
<tr class="row-even"><td><cite>path</cite></td>
<td>like the default but also accepts slashes</td>
</tr>
</tbody>
</table>
<p>Here are some examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">pass</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/&lt;username&gt;&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">show_user</span><span class="p">(</span><span class="n">username</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/post/&lt;int:post_id&gt;&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">show_post</span><span class="p">(</span><span class="n">post_id</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>An important detail to keep in mind is how Flask deals with trailing
slashes.  The idea is to keep each URL unique so the following rules
apply:</p>
<ol class="arabic simple">
<li>If a rule ends with a slash and is requested without a slash by the
user, the user is automatically redirected to the same page with a
trailing slash attached.</li>
<li>If a rule does not end with a trailing slash and the user requests the
page with a trailing slash, a 404 not found is raised.</li>
</ol>
<p>This is consistent with how web servers deal with static files.  This
also makes it possible to use relative link targets safely.</p>
<p>You can also define multiple rules for the same function.  They have to be
unique however.  Defaults can also be specified.  Here for example is a
definition for a URL that accepts an optional page:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/users/&#39;</span><span class="p">,</span> <span class="n">defaults</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;page&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/users/page/&lt;int:page&gt;&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">show_users</span><span class="p">(</span><span class="n">page</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>This specifies that <code class="docutils literal"><span class="pre">/users/</span></code> will be the URL for page one and
<code class="docutils literal"><span class="pre">/users/page/N</span></code> will be the URL for page <cite>N</cite>.</p>
<p>Here are the parameters that <a class="reference internal" href="index.html#flask.Flask.route" title="flask.Flask.route"><code class="xref py py-meth docutils literal"><span class="pre">route()</span></code></a> and
<a class="reference internal" href="index.html#flask.Flask.add_url_rule" title="flask.Flask.add_url_rule"><code class="xref py py-meth docutils literal"><span class="pre">add_url_rule()</span></code></a> accept.  The only difference is that
with the route parameter the view function is defined with the decorator
instead of the <cite>view_func</cite> parameter.</p>
<table border="1" class="docutils">
<colgroup>
<col width="21%" />
<col width="79%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><cite>rule</cite></td>
<td>the URL rule as string</td>
</tr>
<tr class="row-even"><td><cite>endpoint</cite></td>
<td>the endpoint for the registered URL rule.  Flask itself
assumes that the name of the view function is the name
of the endpoint if not explicitly stated.</td>
</tr>
<tr class="row-odd"><td><cite>view_func</cite></td>
<td>the function to call when serving a request to the
provided endpoint.  If this is not provided one can
specify the function later by storing it in the
<a class="reference internal" href="index.html#flask.Flask.view_functions" title="flask.Flask.view_functions"><code class="xref py py-attr docutils literal"><span class="pre">view_functions</span></code></a> dictionary with the
endpoint as key.</td>
</tr>
<tr class="row-even"><td><cite>defaults</cite></td>
<td>A dictionary with defaults for this rule.  See the
example above for how defaults work.</td>
</tr>
<tr class="row-odd"><td><cite>subdomain</cite></td>
<td>specifies the rule for the subdomain in case subdomain
matching is in use.  If not specified the default
subdomain is assumed.</td>
</tr>
<tr class="row-even"><td><cite>**options</cite></td>
<td>the options to be forwarded to the underlying
<a class="reference external" href="http://werkzeug.pocoo.org/docs/routing/#werkzeug.routing.Rule" title="(in Werkzeug v0.11-dev)"><code class="xref py py-class docutils literal"><span class="pre">Rule</span></code></a> object.  A change to
Werkzeug is handling of method options.  methods is a list
of methods this rule should be limited to (<cite>GET</cite>, <cite>POST</cite>
etc.).  By default a rule just listens for <cite>GET</cite> (and
implicitly <cite>HEAD</cite>).  Starting with Flask 0.6, <cite>OPTIONS</cite> is
implicitly added and handled by the standard request
handling.  They have to be specified as keyword arguments.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="view-function-options">
<span id="view-func-options"></span><h4>View Function Options<a class="headerlink" href="#view-function-options" title="제목 주소">¶</a></h4>
<p>For internal usage the view functions can have some attributes attached to
customize behavior the view function would normally not have control over.
The following attributes can be provided optionally to either override
some defaults to <a class="reference internal" href="index.html#flask.Flask.add_url_rule" title="flask.Flask.add_url_rule"><code class="xref py py-meth docutils literal"><span class="pre">add_url_rule()</span></code></a> or general behavior:</p>
<ul class="simple">
<li><cite>__name__</cite>: The name of a function is by default used as endpoint.  If
endpoint is provided explicitly this value is used.  Additionally this
will be prefixed with the name of the blueprint by default which
cannot be customized from the function itself.</li>
<li><cite>methods</cite>: If methods are not provided when the URL rule is added,
Flask will look on the view function object itself is an <cite>methods</cite>
attribute exists.  If it does, it will pull the information for the
methods from there.</li>
<li><cite>provide_automatic_options</cite>: if this attribute is set Flask will
either force enable or disable the automatic implementation of the
HTTP <cite>OPTIONS</cite> response.  This can be useful when working with
decorators that want to customize the <cite>OPTIONS</cite> response on a per-view
basis.</li>
<li><cite>required_methods</cite>: if this attribute is set, Flask will always add
these methods when registering a URL rule even if the methods were
explicitly overriden in the <code class="docutils literal"><span class="pre">route()</span></code> call.</li>
</ul>
<p>Full example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s">&#39;OPTIONS&#39;</span><span class="p">:</span>
        <span class="c"># custom options handling here</span>
        <span class="o">...</span>
    <span class="k">return</span> <span class="s">&#39;Hello World!&#39;</span>
<span class="n">index</span><span class="o">.</span><span class="n">provide_automatic_options</span> <span class="o">=</span> <span class="bp">False</span>
<span class="n">index</span><span class="o">.</span><span class="n">methods</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">,</span> <span class="s">&#39;OPTIONS&#39;</span><span class="p">]</span>

<span class="n">app</span><span class="o">.</span><span class="n">add_url_rule</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">버전 0.8에 추가: </span>The <cite>provide_automatic_options</cite> functionality was added.</p>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="id2">
<h2>추가적인 참고사항<a class="headerlink" href="#id2" title="제목 주소">¶</a></h2>
<p>Flask의 디자인 노트, 법률 정보 변경 로그에 대한 관심있는 내용은 이곳에 있습니다.</p>
<div class="toctree-wrapper compound">
<span id="document-design"></span><div class="section" id="design-decisions-in-flask">
<span id="design"></span><h3>Design Decisions in Flask<a class="headerlink" href="#design-decisions-in-flask" title="제목 주소">¶</a></h3>
<p>If you are curious why Flask does certain things the way it does and not
differently, this section is for you.  This should give you an idea about
some of the design decisions that may appear arbitrary and surprising at
first, especially in direct comparison with other frameworks.</p>
<div class="section" id="the-explicit-application-object">
<h4>The Explicit Application Object<a class="headerlink" href="#the-explicit-application-object" title="제목 주소">¶</a></h4>
<p>A Python web application based on WSGI has to have one central callable
object that implements the actual application.  In Flask this is an
instance of the <a class="reference internal" href="index.html#flask.Flask" title="flask.Flask"><code class="xref py py-class docutils literal"><span class="pre">Flask</span></code></a> class.  Each Flask application has
to create an instance of this class itself and pass it the name of the
module, but why can&#8217;t Flask do that itself?</p>
<p>Without such an explicit application object the following code:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">return</span> <span class="s">&#39;Hello World!&#39;</span>
</pre></div>
</div>
<p>Would look like this instead:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">hypothetical_flask</span> <span class="kn">import</span> <span class="n">route</span>

<span class="nd">@route</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">return</span> <span class="s">&#39;Hello World!&#39;</span>
</pre></div>
</div>
<p>There are three major reasons for this.  The most important one is that
implicit application objects require that there may only be one instance at
the time.  There are ways to fake multiple applications with a single
application object, like maintaining a stack of applications, but this
causes some problems I won&#8217;t outline here in detail.  Now the question is:
when does a microframework need more than one application at the same
time?  A good example for this is unittesting.  When you want to test
something it can be very helpful to create a minimal application to test
specific behavior.  When the application object is deleted everything it
allocated will be freed again.</p>
<p>Another thing that becomes possible when you have an explicit object lying
around in your code is that you can subclass the base class
(<a class="reference internal" href="index.html#flask.Flask" title="flask.Flask"><code class="xref py py-class docutils literal"><span class="pre">Flask</span></code></a>) to alter specific behavior.  This would not be
possible without hacks if the object were created ahead of time for you
based on a class that is not exposed to you.</p>
<p>But there is another very important reason why Flask depends on an
explicit instantiation of that class: the package name.  Whenever you
create a Flask instance you usually pass it <cite>__name__</cite> as package name.
Flask depends on that information to properly load resources relative
to your module.  With Python&#8217;s outstanding support for reflection it can
then access the package to figure out where the templates and static files
are stored (see <a class="reference internal" href="index.html#flask.Flask.open_resource" title="flask.Flask.open_resource"><code class="xref py py-meth docutils literal"><span class="pre">open_resource()</span></code></a>).  Now obviously there
are frameworks around that do not need any configuration and will still be
able to load templates relative to your application module.  But they have
to use the current working directory for that, which is a very unreliable
way to determine where the application is.  The current working directory
is process-wide and if you are running multiple applications in one
process (which could happen in a webserver without you knowing) the paths
will be off.  Worse: many webservers do not set the working directory to
the directory of your application but to the document root which does not
have to be the same folder.</p>
<p>The third reason is &#8220;explicit is better than implicit&#8221;.  That object is
your WSGI application, you don&#8217;t have to remember anything else.  If you
want to apply a WSGI middleware, just wrap it and you&#8217;re done (though
there are better ways to do that so that you do not lose the reference
to the application object <a class="reference internal" href="index.html#flask.Flask.wsgi_app" title="flask.Flask.wsgi_app"><code class="xref py py-meth docutils literal"><span class="pre">wsgi_app()</span></code></a>).</p>
<p>Furthermore this design makes it possible to use a factory function to
create the application which is very helpful for unittesting and similar
things (<a class="reference internal" href="index.html#app-factories"><span>어플리케이션 팩토리</span></a>).</p>
</div>
<div class="section" id="the-routing-system">
<h4>The Routing System<a class="headerlink" href="#the-routing-system" title="제목 주소">¶</a></h4>
<p>Flask uses the Werkzeug routing system which has was designed to
automatically order routes by complexity.  This means that you can declare
routes in arbitrary order and they will still work as expected.  This is a
requirement if you want to properly implement decorator based routing
since decorators could be fired in undefined order when the application is
split into multiple modules.</p>
<p>Another design decision with the Werkzeug routing system is that routes
in Werkzeug try to ensure that URLs are unique.  Werkzeug will go quite far
with that in that it will automatically redirect to a canonical URL if a route
is ambiguous.</p>
</div>
<div class="section" id="one-template-engine">
<h4>One Template Engine<a class="headerlink" href="#one-template-engine" title="제목 주소">¶</a></h4>
<p>Flask decides on one template engine: Jinja2.  Why doesn&#8217;t Flask have a
pluggable template engine interface?  You can obviously use a different
template engine, but Flask will still configure Jinja2 for you.  While
that limitation that Jinja2 is <em>always</em> configured will probably go away,
the decision to bundle one template engine and use that will not.</p>
<p>Template engines are like programming languages and each of those engines
has a certain understanding about how things work.  On the surface they
all work the same: you tell the engine to evaluate a template with a set
of variables and take the return value as string.</p>
<p>But that&#8217;s about where similarities end.  Jinja2 for example has an
extensive filter system, a certain way to do template inheritance, support
for reusable blocks (macros) that can be used from inside templates and
also from Python code, uses Unicode for all operations, supports
iterative template rendering, configurable syntax and more.  On the other
hand an engine like Genshi is based on XML stream evaluation, template
inheritance by taking the availability of XPath into account and more.
Mako on the other hand treats templates similar to Python modules.</p>
<p>When it comes to connecting a template engine with an application or
framework there is more than just rendering templates.  For instance,
Flask uses Jinja2&#8217;s extensive autoescaping support.  Also it provides
ways to access macros from Jinja2 templates.</p>
<p>A template abstraction layer that would not take the unique features of
the template engines away is a science on its own and a too large
undertaking for a microframework like Flask.</p>
<p>Furthermore extensions can then easily depend on one template language
being present.  You can easily use your own templating language, but an
extension could still depend on Jinja itself.</p>
</div>
<div class="section" id="micro-with-dependencies">
<h4>Micro with Dependencies<a class="headerlink" href="#micro-with-dependencies" title="제목 주소">¶</a></h4>
<p>Why does Flask call itself a microframework and yet it depends on two
libraries (namely Werkzeug and Jinja2).  Why shouldn&#8217;t it?  If we look
over to the Ruby side of web development there we have a protocol very
similar to WSGI.  Just that it&#8217;s called Rack there, but besides that it
looks very much like a WSGI rendition for Ruby.  But nearly all
applications in Ruby land do not work with Rack directly, but on top of a
library with the same name.  This Rack library has two equivalents in
Python: WebOb (formerly Paste) and Werkzeug.  Paste is still around but
from my understanding it&#8217;s sort of deprecated in favour of WebOb.  The
development of WebOb and Werkzeug started side by side with similar ideas
in mind: be a good implementation of WSGI for other applications to take
advantage.</p>
<p>Flask is a framework that takes advantage of the work already done by
Werkzeug to properly interface WSGI (which can be a complex task at
times).  Thanks to recent developments in the Python package
infrastructure, packages with dependencies are no longer an issue and
there are very few reasons against having libraries that depend on others.</p>
</div>
<div class="section" id="thread-locals">
<h4>Thread Locals<a class="headerlink" href="#thread-locals" title="제목 주소">¶</a></h4>
<p>Flask uses thread local objects (context local objects in fact, they
support greenlet contexts as well) for request, session and an extra
object you can put your own things on (<a class="reference internal" href="index.html#flask.g" title="flask.g"><code class="xref py py-data docutils literal"><span class="pre">g</span></code></a>).  Why is that and
isn&#8217;t that a bad idea?</p>
<p>Yes it is usually not such a bright idea to use thread locals.  They cause
troubles for servers that are not based on the concept of threads and make
large applications harder to maintain.  However Flask is just not designed
for large applications or asynchronous servers.  Flask wants to make it
quick and easy to write a traditional web application.</p>
<p>Also see the <a class="reference internal" href="index.html#becomingbig"><span>크게 만들기</span></a> section of the documentation for some
inspiration for larger applications based on Flask.</p>
</div>
<div class="section" id="what-flask-is-what-flask-is-not">
<h4>What Flask is, What Flask is Not<a class="headerlink" href="#what-flask-is-what-flask-is-not" title="제목 주소">¶</a></h4>
<p>Flask will never have a database layer.  It will not have a form library
or anything else in that direction.  Flask itself just bridges to Werkzeug
to implement a proper WSGI application and to Jinja2 to handle templating.
It also binds to a few common standard library packages such as logging.
Everything else is up for extensions.</p>
<p>Why is this the case?  Because people have different preferences and
requirements and Flask could not meet those if it would force any of this
into the core.  The majority of web applications will need a template
engine in some sort.  However not every application needs a SQL database.</p>
<p>The idea of Flask is to build a good foundation for all applications.
Everything else is up to you or extensions.</p>
</div>
</div>
<span id="document-htmlfaq"></span><div class="section" id="html-xhtml-faq">
<h3>HTML/XHTML FAQ<a class="headerlink" href="#html-xhtml-faq" title="제목 주소">¶</a></h3>
<p>The Flask documentation and example applications are using HTML5.  You
may notice that in many situations, when end tags are optional they are
not used, so that the HTML is cleaner and faster to load.  Because there
is much confusion about HTML and XHTML among developers, this document tries
to answer some of the major questions.</p>
<div class="section" id="history-of-xhtml">
<h4>History of XHTML<a class="headerlink" href="#history-of-xhtml" title="제목 주소">¶</a></h4>
<p>For a while, it appeared that HTML was about to be replaced by XHTML.
However, barely any websites on the Internet are actual XHTML (which is
HTML processed using XML rules).  There are a couple of major reasons
why this is the case.  One of them is Internet Explorer&#8217;s lack of proper
XHTML support. The XHTML spec states that XHTML must be served with the MIME
type <cite>application/xhtml+xml</cite>, but Internet Explorer refuses to read files
with that MIME type.
While it is relatively easy to configure Web servers to serve XHTML properly,
few people do.  This is likely because properly using XHTML can be quite
painful.</p>
<p>One of the most important causes of pain is XML&#8217;s draconian (strict and
ruthless) error handling.  When an XML parsing error is encountered,
the browser is supposed to show the user an ugly error message, instead
of attempting to recover from the error and display what it can.  Most of
the (X)HTML generation on the web is based on non-XML template engines
(such as Jinja, the one used in Flask) which do not protect you from
accidentally creating invalid XHTML.  There are XML based template engines,
such as Kid and the popular Genshi, but they often come with a larger
runtime overhead and, are not as straightforward to use because they have
to obey XML rules.</p>
<p>The majority of users, however, assumed they were properly using XHTML.
They wrote an XHTML doctype at the top of the document and self-closed all
the necessary tags (<code class="docutils literal"><span class="pre">&lt;br&gt;</span></code> becomes <code class="docutils literal"><span class="pre">&lt;br/&gt;</span></code> or <code class="docutils literal"><span class="pre">&lt;br&gt;&lt;/br&gt;</span></code> in XHTML).
However, even if the document properly validates as XHTML, what really
determines XHTML/HTML processing in browsers is the MIME type, which as
said before is often not set properly. So the valid XHTML was being treated
as invalid HTML.</p>
<p>XHTML also changed the way JavaScript is used. To properly work with XHTML,
programmers have to use the namespaced DOM interface with the XHTML
namespace to query for HTML elements.</p>
</div>
<div class="section" id="history-of-html5">
<h4>History of HTML5<a class="headerlink" href="#history-of-html5" title="제목 주소">¶</a></h4>
<p>Development of the HTML5 specification was started in 2004 under the name
&#8220;Web Applications 1.0&#8221; by the Web Hypertext Application Technology Working
Group, or WHATWG (which was formed by the major browser vendors Apple,
Mozilla, and Opera) with the goal of writing a new and improved HTML
specification, based on existing browser behavior instead of unrealistic
and backwards-incompatible specifications.</p>
<p>For example, in HTML4 <code class="docutils literal"><span class="pre">&lt;title/Hello/</span></code> theoretically parses exactly the
same as <code class="docutils literal"><span class="pre">&lt;title&gt;Hello&lt;/title&gt;</span></code>.  However, since people were using
XHTML-like tags along the lines of <code class="docutils literal"><span class="pre">&lt;link</span> <span class="pre">/&gt;</span></code>, browser vendors implemented
the XHTML syntax over the syntax defined by the specification.</p>
<p>In 2007, the specification was adopted as the basis of a new HTML
specification under the umbrella of the W3C, known as HTML5.  Currently,
it appears that XHTML is losing traction, as the XHTML 2 working group has
been disbanded and HTML5 is being implemented by all major browser vendors.</p>
</div>
<div class="section" id="html-versus-xhtml">
<h4>HTML versus XHTML<a class="headerlink" href="#html-versus-xhtml" title="제목 주소">¶</a></h4>
<p>The following table gives you a quick overview of features available in
HTML 4.01, XHTML 1.1 and HTML5. (XHTML 1.0 is not included, as it was
superseded by XHTML 1.1 and the barely-used XHTML5.)</p>
<table border="1" class="docutils">
<colgroup>
<col width="58%" />
<col width="14%" />
<col width="14%" />
<col width="14%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">&nbsp;</th>
<th class="head">HTML4.01</th>
<th class="head">XHTML1.1</th>
<th class="head">HTML5</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">&lt;tag/value/</span></code> == <code class="docutils literal"><span class="pre">&lt;tag&gt;value&lt;/tag&gt;</span></code></td>
<td><img alt="Yes" src="_images/yes1.png" /> <a class="footnote-reference" href="#id4" id="id1">[1]</a></td>
<td><img alt="No" src="_images/no1.png" /></td>
<td><img alt="No" src="_images/no1.png" /></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">&lt;br/&gt;</span></code> supported</td>
<td><img alt="No" src="_images/no1.png" /></td>
<td><img alt="Yes" src="_images/yes1.png" /></td>
<td><img alt="Yes" src="_images/yes1.png" /> <a class="footnote-reference" href="#id5" id="id2">[2]</a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">&lt;script/&gt;</span></code> supported</td>
<td><img alt="No" src="_images/no1.png" /></td>
<td><img alt="Yes" src="_images/yes1.png" /></td>
<td><img alt="No" src="_images/no1.png" /></td>
</tr>
<tr class="row-odd"><td>should be served as <cite>text/html</cite></td>
<td><img alt="Yes" src="_images/yes1.png" /></td>
<td><img alt="No" src="_images/no1.png" /> <a class="footnote-reference" href="#id6" id="id3">[3]</a></td>
<td><img alt="Yes" src="_images/yes1.png" /></td>
</tr>
<tr class="row-even"><td>should be served as
<cite>application/xhtml+xml</cite></td>
<td><img alt="No" src="_images/no1.png" /></td>
<td><img alt="Yes" src="_images/yes1.png" /></td>
<td><img alt="No" src="_images/no1.png" /></td>
</tr>
<tr class="row-odd"><td>strict error handling</td>
<td><img alt="No" src="_images/no1.png" /></td>
<td><img alt="Yes" src="_images/yes1.png" /></td>
<td><img alt="No" src="_images/no1.png" /></td>
</tr>
<tr class="row-even"><td>inline SVG</td>
<td><img alt="No" src="_images/no1.png" /></td>
<td><img alt="Yes" src="_images/yes1.png" /></td>
<td><img alt="Yes" src="_images/yes1.png" /></td>
</tr>
<tr class="row-odd"><td>inline MathML</td>
<td><img alt="No" src="_images/no1.png" /></td>
<td><img alt="Yes" src="_images/yes1.png" /></td>
<td><img alt="Yes" src="_images/yes1.png" /></td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">&lt;video&gt;</span></code> tag</td>
<td><img alt="No" src="_images/no1.png" /></td>
<td><img alt="No" src="_images/no1.png" /></td>
<td><img alt="Yes" src="_images/yes1.png" /></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">&lt;audio&gt;</span></code> tag</td>
<td><img alt="No" src="_images/no1.png" /></td>
<td><img alt="No" src="_images/no1.png" /></td>
<td><img alt="Yes" src="_images/yes1.png" /></td>
</tr>
<tr class="row-even"><td>New semantic tags like <code class="docutils literal"><span class="pre">&lt;article&gt;</span></code></td>
<td><img alt="No" src="_images/no1.png" /></td>
<td><img alt="No" src="_images/no1.png" /></td>
<td><img alt="Yes" src="_images/yes1.png" /></td>
</tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id4" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>This is an obscure feature inherited from SGML. It is usually not
supported by browsers, for reasons detailed above.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id5" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[2]</a></td><td>This is for compatibility with server code that generates XHTML for
tags such as <code class="docutils literal"><span class="pre">&lt;br&gt;</span></code>.  It should not be used in new code.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id6" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[3]</a></td><td>XHTML 1.0 is the last XHTML standard that allows to be served
as <cite>text/html</cite> for backwards compatibility reasons.</td></tr>
</tbody>
</table>
</div>
<div class="section" id="what-does-strict-mean">
<h4>What does &#8220;strict&#8221; mean?<a class="headerlink" href="#what-does-strict-mean" title="제목 주소">¶</a></h4>
<p>HTML5 has strictly defined parsing rules, but it also specifies exactly
how a browser should react to parsing errors - unlike XHTML, which simply
states parsing should abort. Some people are confused by apparently
invalid syntax that still generates the expected results (for example,
missing end tags or unquoted attribute values).</p>
<p>Some of these work because of the lenient error handling most browsers use
when they encounter a markup error, others are actually specified.  The
following constructs are optional in HTML5 by standard, but have to be
supported by browsers:</p>
<ul class="simple">
<li>Wrapping the document in an <code class="docutils literal"><span class="pre">&lt;html&gt;</span></code> tag</li>
<li>Wrapping header elements in <code class="docutils literal"><span class="pre">&lt;head&gt;</span></code> or the body elements in
<code class="docutils literal"><span class="pre">&lt;body&gt;</span></code></li>
<li>Closing the <code class="docutils literal"><span class="pre">&lt;p&gt;</span></code>, <code class="docutils literal"><span class="pre">&lt;li&gt;</span></code>, <code class="docutils literal"><span class="pre">&lt;dt&gt;</span></code>, <code class="docutils literal"><span class="pre">&lt;dd&gt;</span></code>, <code class="docutils literal"><span class="pre">&lt;tr&gt;</span></code>,
<code class="docutils literal"><span class="pre">&lt;td&gt;</span></code>, <code class="docutils literal"><span class="pre">&lt;th&gt;</span></code>, <code class="docutils literal"><span class="pre">&lt;tbody&gt;</span></code>, <code class="docutils literal"><span class="pre">&lt;thead&gt;</span></code>, or <code class="docutils literal"><span class="pre">&lt;tfoot&gt;</span></code> tags.</li>
<li>Quoting attributes, so long as they contain no whitespace or
special characters (like <code class="docutils literal"><span class="pre">&lt;</span></code>, <code class="docutils literal"><span class="pre">&gt;</span></code>, <code class="docutils literal"><span class="pre">'</span></code>, or <code class="docutils literal"><span class="pre">&quot;</span></code>).</li>
<li>Requiring boolean attributes to have a value.</li>
</ul>
<p>This means the following page in HTML5 is perfectly valid:</p>
<div class="highlight-html"><div class="highlight"><pre><span class="cp">&lt;!doctype html&gt;</span>
<span class="nt">&lt;title&gt;</span>Hello HTML5<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">header</span><span class="nt">&gt;</span>
  <span class="nt">&lt;h1&gt;</span>Hello HTML5<span class="nt">&lt;/h1&gt;</span>
  <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">tagline</span><span class="nt">&gt;</span>HTML5 is awesome
<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">nav</span><span class="nt">&gt;</span>
  <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">/index</span><span class="nt">&gt;</span>Index<span class="nt">&lt;/a&gt;</span>
  <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">/downloads</span><span class="nt">&gt;</span>Downloads<span class="nt">&lt;/a&gt;</span>
  <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">/about</span><span class="nt">&gt;</span>About<span class="nt">&lt;/a&gt;</span>
<span class="nt">&lt;/ul&gt;</span>
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">body</span><span class="nt">&gt;</span>
  <span class="nt">&lt;h2&gt;</span>HTML5 is probably the future<span class="nt">&lt;/h2&gt;</span>
  <span class="nt">&lt;p&gt;</span>
    There might be some other things around but in terms of
    browser vendor support, HTML5 is hard to beat.
  <span class="nt">&lt;dl&gt;</span>
    <span class="nt">&lt;dt&gt;</span>Key 1
    <span class="nt">&lt;dd&gt;</span>Value 1
    <span class="nt">&lt;dt&gt;</span>Key 2
    <span class="nt">&lt;dd&gt;</span>Value 2
  <span class="nt">&lt;/dl&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="new-technologies-in-html5">
<h4>New technologies in HTML5<a class="headerlink" href="#new-technologies-in-html5" title="제목 주소">¶</a></h4>
<p>HTML5 adds many new features that make Web applications easier to write
and to use.</p>
<ul class="simple">
<li>The <code class="docutils literal"><span class="pre">&lt;audio&gt;</span></code> and <code class="docutils literal"><span class="pre">&lt;video&gt;</span></code> tags provide a way to embed audio and
video without complicated add-ons like QuickTime or Flash.</li>
<li>Semantic elements like <code class="docutils literal"><span class="pre">&lt;article&gt;</span></code>, <code class="docutils literal"><span class="pre">&lt;header&gt;</span></code>, <code class="docutils literal"><span class="pre">&lt;nav&gt;</span></code>, and
<code class="docutils literal"><span class="pre">&lt;time&gt;</span></code> that make content easier to understand.</li>
<li>The <code class="docutils literal"><span class="pre">&lt;canvas&gt;</span></code> tag, which supports a powerful drawing API, reducing
the need for server-generated images to present data graphically.</li>
<li>New form control types like <code class="docutils literal"><span class="pre">&lt;input</span> <span class="pre">type=&quot;date&quot;&gt;</span></code> that allow user
agents to make entering and validating values easier.</li>
<li>Advanced JavaScript APIs like Web Storage, Web Workers, Web Sockets,
geolocation, and offline applications.</li>
</ul>
<p>Many other features have been added, as well. A good guide to new features
in HTML5 is Mark Pilgrim&#8217;s soon-to-be-published book, <a class="reference external" href="http://www.diveintohtml5.org/">Dive Into HTML5</a>.
Not all of them are supported in browsers yet, however, so use caution.</p>
</div>
<div class="section" id="what-should-be-used">
<h4>What should be used?<a class="headerlink" href="#what-should-be-used" title="제목 주소">¶</a></h4>
<p>Currently, the answer is HTML5.  There are very few reasons to use XHTML
considering the latest developments in Web browsers.  To summarize the
reasons given above:</p>
<ul class="simple">
<li>Internet Explorer (which, sadly, currently leads in market share)
has poor support for XHTML.</li>
<li>Many JavaScript libraries also do not support XHTML, due to the more
complicated namespacing API it requires.</li>
<li>HTML5 adds several new features, including semantic tags and the
long-awaited <code class="docutils literal"><span class="pre">&lt;audio&gt;</span></code> and <code class="docutils literal"><span class="pre">&lt;video&gt;</span></code> tags.</li>
<li>It has the support of most browser vendors behind it.</li>
<li>It is much easier to write, and more compact.</li>
</ul>
<p>For most applications, it is undoubtedly better to use HTML5 than XHTML.</p>
</div>
</div>
<span id="document-security"></span><div class="section" id="security-considerations">
<h3>Security Considerations<a class="headerlink" href="#security-considerations" title="제목 주소">¶</a></h3>
<p>Web applications usually face all kinds of security problems and it&#8217;s very
hard to get everything right.  Flask tries to solve a few of these things
for you, but there are a couple more you have to take care of yourself.</p>
<div class="section" id="cross-site-scripting-xss">
<span id="xss"></span><h4>Cross-Site Scripting (XSS)<a class="headerlink" href="#cross-site-scripting-xss" title="제목 주소">¶</a></h4>
<p>Cross site scripting is the concept of injecting arbitrary HTML (and with
it JavaScript) into the context of a website.  To remedy this, developers
have to properly escape text so that it cannot include arbitrary HTML
tags.  For more information on that have a look at the Wikipedia article
on <a class="reference external" href="http://en.wikipedia.org/wiki/Cross-site_scripting">Cross-Site Scripting</a>.</p>
<p>Flask configures Jinja2 to automatically escape all values unless
explicitly told otherwise.  This should rule out all XSS problems caused
in templates, but there are still other places where you have to be
careful:</p>
<ul class="simple">
<li>generating HTML without the help of Jinja2</li>
<li>calling <a class="reference internal" href="index.html#flask.Markup" title="flask.Markup"><code class="xref py py-class docutils literal"><span class="pre">Markup</span></code></a> on data submitted by users</li>
<li>sending out HTML from uploaded files, never do that, use the
<cite>Content-Disposition: attachment</cite> header to prevent that problem.</li>
<li>sending out textfiles from uploaded files.  Some browsers are using
content-type guessing based on the first few bytes so users could
trick a browser to execute HTML.</li>
</ul>
<p>Another thing that is very important are unquoted attributes.  While
Jinja2 can protect you from XSS issues by escaping HTML, there is one
thing it cannot protect you from: XSS by attribute injection.  To counter
this possible attack vector, be sure to always quote your attributes with
either double or single quotes when using Jinja expressions in them:</p>
<div class="highlight-html+jinja"><div class="highlight"><pre><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">href</span> <span class="cp">}}</span><span class="s">&quot;</span><span class="nt">&gt;</span>the text<span class="nt">&lt;/a&gt;</span>
</pre></div>
</div>
<p>Why is this necessary?  Because if you would not be doing that, an
attacker could easily inject custom JavaScript handlers.  For example an
attacker could inject this piece of HTML+JavaScript:</p>
<div class="highlight-html"><div class="highlight"><pre>onmouseover=alert(document.cookie)
</pre></div>
</div>
<p>When the user would then move with the mouse over the link, the cookie
would be presented to the user in an alert window.  But instead of showing
the cookie to the user, a good attacker might also execute any other
JavaScript code.  In combination with CSS injections the attacker might
even make the element fill out the entire page so that the user would
just have to have the mouse anywhere on the page to trigger the attack.</p>
</div>
<div class="section" id="cross-site-request-forgery-csrf">
<h4>Cross-Site Request Forgery (CSRF)<a class="headerlink" href="#cross-site-request-forgery-csrf" title="제목 주소">¶</a></h4>
<p>Another big problem is CSRF.  This is a very complex topic and I won&#8217;t
outline it here in detail just mention what it is and how to theoretically
prevent it.</p>
<p>If your authentication information is stored in cookies, you have implicit
state management.  The state of &#8220;being logged in&#8221; is controlled by a
cookie, and that cookie is sent with each request to a page.
Unfortunately that includes requests triggered by 3rd party sites.  If you
don&#8217;t keep that in mind, some people might be able to trick your
application&#8217;s users with social engineering to do stupid things without
them knowing.</p>
<p>Say you have a specific URL that, when you sent <cite>POST</cite> requests to will
delete a user&#8217;s profile (say <cite>http://example.com/user/delete</cite>).  If an
attacker now creates a page that sends a post request to that page with
some JavaScript they just has to trick some users to load that page and
their profiles will end up being deleted.</p>
<p>Imagine you were to run Facebook with millions of concurrent users and
someone would send out links to images of little kittens.  When users
would go to that page, their profiles would get deleted while they are
looking at images of fluffy cats.</p>
<p>How can you prevent that?  Basically for each request that modifies
content on the server you would have to either use a one-time token and
store that in the cookie <strong>and</strong> also transmit it with the form data.
After receiving the data on the server again, you would then have to
compare the two tokens and ensure they are equal.</p>
<p>Why does Flask not do that for you?  The ideal place for this to happen is
the form validation framework, which does not exist in Flask.</p>
</div>
<div class="section" id="json-security">
<span id="id1"></span><h4>JSON Security<a class="headerlink" href="#json-security" title="제목 주소">¶</a></h4>
<div class="admonition-ecmascript-5-changes admonition">
<p class="first admonition-title">ECMAScript 5 Changes</p>
<p class="last">Starting with ECMAScript 5 the behavior of literals changed.  Now they
are not constructed with the constructor of <code class="docutils literal"><span class="pre">Array</span></code> and others, but
with the builtin constructor of <code class="docutils literal"><span class="pre">Array</span></code> which closes this particular
attack vector.</p>
</div>
<p>JSON itself is a high-level serialization format, so there is barely
anything that could cause security problems, right?  You can&#8217;t declare
recursive structures that could cause problems and the only thing that
could possibly break are very large responses that can cause some kind of
denial of service at the receiver&#8217;s side.</p>
<p>However there is a catch.  Due to how browsers work the CSRF issue comes
up with JSON unfortunately.  Fortunately there is also a weird part of the
JavaScript specification that can be used to solve that problem easily and
Flask is kinda doing that for you by preventing you from doing dangerous
stuff.  Unfortunately that protection is only there for
<code class="xref py py-func docutils literal"><span class="pre">jsonify()</span></code> so you are still at risk when using other ways to
generate JSON.</p>
<p>So what is the issue and how to avoid it?  The problem are arrays at
top-level in JSON.  Imagine you send the following data out in a JSON
request.  Say that&#8217;s exporting the names and email addresses of all your
friends for a part of the user interface that is written in JavaScript.
Not very uncommon:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">[</span>
    <span class="p">{</span><span class="s2">&quot;username&quot;</span><span class="o">:</span> <span class="s2">&quot;admin&quot;</span><span class="p">,</span>
     <span class="s2">&quot;email&quot;</span><span class="o">:</span> <span class="s2">&quot;admin@localhost&quot;</span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>And it is doing that of course only as long as you are logged in and only
for you.  And it is doing that for all <cite>GET</cite> requests to a certain URL,
say the URL for that request is
<code class="docutils literal"><span class="pre">http://example.com/api/get_friends.json</span></code>.</p>
<p>So now what happens if a clever hacker is embedding this to his website
and social engineers a victim to visiting his site:</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">text/javascript</span><span class="nt">&gt;</span>
<span class="kd">var</span> <span class="nx">captured</span> <span class="o">=</span> <span class="p">[];</span>
<span class="kd">var</span> <span class="nx">oldArray</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">;</span>
<span class="kd">function</span> <span class="nb">Array</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="k">this</span><span class="p">,</span> <span class="nx">id</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">capture</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">obj</span><span class="p">.</span><span class="nx">__defineSetter__</span><span class="p">(</span><span class="nx">id</span><span class="o">++</span><span class="p">,</span> <span class="nx">capture</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">value</span><span class="p">)</span>
      <span class="nx">captured</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
  <span class="p">};</span>
  <span class="nx">capture</span><span class="p">();</span>
<span class="p">}</span>
<span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">text/javascript</span>
  <span class="na">src=</span><span class="s">http://example.com/api/get_friends.json</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">text/javascript</span><span class="nt">&gt;</span>
<span class="nb">Array</span> <span class="o">=</span> <span class="nx">oldArray</span><span class="p">;</span>
<span class="c1">// now we have all the data in the captured array.</span>
<span class="nt">&lt;/script&gt;</span>
</pre></div>
</div>
<p>If you know a bit of JavaScript internals you might know that it&#8217;s
possible to patch constructors and register callbacks for setters.  An
attacker can use this (like above) to get all the data you exported in
your JSON file.  The browser will totally ignore the <code class="docutils literal"><span class="pre">application/json</span></code>
mimetype if <code class="docutils literal"><span class="pre">text/javascript</span></code> is defined as content type in the script
tag and evaluate that as JavaScript.  Because top-level array elements are
allowed (albeit useless) and we hooked in our own constructor, after that
page loaded the data from the JSON response is in the <cite>captured</cite> array.</p>
<p>Because it is a syntax error in JavaScript to have an object literal
(<code class="docutils literal"><span class="pre">{...}</span></code>) toplevel an attacker could not just do a request to an
external URL with the script tag to load up the data.  So what Flask does
is to only allow objects as toplevel elements when using
<code class="xref py py-func docutils literal"><span class="pre">jsonify()</span></code>.  Make sure to do the same when using an ordinary
JSON generate function.</p>
</div>
</div>
<span id="document-unicode"></span><div class="section" id="unicode-in-flask">
<h3>Unicode in Flask<a class="headerlink" href="#unicode-in-flask" title="제목 주소">¶</a></h3>
<p>Flask like Jinja2 and Werkzeug is totally Unicode based when it comes to
text.  Not only these libraries, also the majority of web related Python
libraries that deal with text.  If you don&#8217;t know Unicode so far, you
should probably read <a class="reference external" href="http://www.joelonsoftware.com/articles/Unicode.html">The Absolute Minimum Every Software Developer
Absolutely, Positively Must Know About Unicode and Character Sets</a>.  This part of the
documentation just tries to cover the very basics so that you have a
pleasant experience with Unicode related things.</p>
<div class="section" id="automatic-conversion">
<h4>Automatic Conversion<a class="headerlink" href="#automatic-conversion" title="제목 주소">¶</a></h4>
<p>Flask has a few assumptions about your application (which you can change
of course) that give you basic and painless Unicode support:</p>
<ul class="simple">
<li>the encoding for text on your website is UTF-8</li>
<li>internally you will always use Unicode exclusively for text except
for literal strings with only ASCII character points.</li>
<li>encoding and decoding happens whenever you are talking over a protocol
that requires bytes to be transmitted.</li>
</ul>
<p>So what does this mean to you?</p>
<p>HTTP is based on bytes.  Not only the protocol, also the system used to
address documents on servers (so called URIs or URLs).  However HTML which
is usually transmitted on top of HTTP supports a large variety of
character sets and which ones are used, are transmitted in an HTTP header.
To not make this too complex Flask just assumes that if you are sending
Unicode out you want it to be UTF-8 encoded.  Flask will do the encoding
and setting of the appropriate headers for you.</p>
<p>The same is true if you are talking to databases with the help of
SQLAlchemy or a similar ORM system.  Some databases have a protocol that
already transmits Unicode and if they do not, SQLAlchemy or your other ORM
should take care of that.</p>
</div>
<div class="section" id="the-golden-rule">
<h4>The Golden Rule<a class="headerlink" href="#the-golden-rule" title="제목 주소">¶</a></h4>
<p>So the rule of thumb: if you are not dealing with binary data, work with
Unicode.  What does working with Unicode in Python 2.x mean?</p>
<ul class="simple">
<li>as long as you are using ASCII charpoints only (basically numbers,
some special characters of latin letters without umlauts or anything
fancy) you can use regular string literals (<code class="docutils literal"><span class="pre">'Hello</span> <span class="pre">World'</span></code>).</li>
<li>if you need anything else than ASCII in a string you have to mark
this string as Unicode string by prefixing it with a lowercase <cite>u</cite>.
(like <code class="docutils literal"><span class="pre">u'Hänsel</span> <span class="pre">und</span> <span class="pre">Gretel'</span></code>)</li>
<li>if you are using non-Unicode characters in your Python files you have
to tell Python which encoding your file uses.  Again, I recommend
UTF-8 for this purpose.  To tell the interpreter your encoding you can
put the <code class="docutils literal"><span class="pre">#</span> <span class="pre">-*-</span> <span class="pre">coding:</span> <span class="pre">utf-8</span> <span class="pre">-*-</span></code> into the first or second line of
your Python source file.</li>
<li>Jinja is configured to decode the template files from UTF-8.  So make
sure to tell your editor to save the file as UTF-8 there as well.</li>
</ul>
</div>
<div class="section" id="encoding-and-decoding-yourself">
<h4>Encoding and Decoding Yourself<a class="headerlink" href="#encoding-and-decoding-yourself" title="제목 주소">¶</a></h4>
<p>If you are talking with a filesystem or something that is not really based
on Unicode you will have to ensure that you decode properly when working
with Unicode interface.  So for example if you want to load a file on the
filesystem and embed it into a Jinja2 template you will have to decode it
from the encoding of that file.  Here the old problem that text files do
not specify their encoding comes into play.  So do yourself a favour and
limit yourself to UTF-8 for text files as well.</p>
<p>Anyways.  To load such a file with Unicode you can use the built-in
<code class="xref py py-meth docutils literal"><span class="pre">str.decode()</span></code> method:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">read_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">charset</span><span class="o">=</span><span class="s">&#39;utf-8&#39;</span><span class="p">):</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">charset</span><span class="p">)</span>
</pre></div>
</div>
<p>To go from Unicode into a specific charset such as UTF-8 you can use the
<code class="xref py py-meth docutils literal"><span class="pre">unicode.encode()</span></code> method:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">write_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">contents</span><span class="p">,</span> <span class="n">charset</span><span class="o">=</span><span class="s">&#39;utf-8&#39;</span><span class="p">):</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">contents</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">charset</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="configuring-editors">
<h4>Configuring Editors<a class="headerlink" href="#configuring-editors" title="제목 주소">¶</a></h4>
<p>Most editors save as UTF-8 by default nowadays but in case your editor is
not configured to do this you have to change it.  Here some common ways to
set your editor to store as UTF-8:</p>
<ul>
<li><p class="first">Vim: put <code class="docutils literal"><span class="pre">set</span> <span class="pre">enc=utf-8</span></code> to your <code class="docutils literal"><span class="pre">.vimrc</span></code> file.</p>
</li>
<li><p class="first">Emacs: either use an encoding cookie or put this into your <code class="docutils literal"><span class="pre">.emacs</span></code>
file:</p>
<div class="highlight-python"><div class="highlight"><pre>(prefer-coding-system &#39;utf-8)
(setq default-buffer-file-coding-system &#39;utf-8)
</pre></div>
</div>
</li>
<li><p class="first">Notepad++:</p>
<ol class="arabic simple">
<li>Go to <em>Settings -&gt; Preferences ...</em></li>
<li>Select the &#8220;New Document/Default Directory&#8221; tab</li>
<li>Select &#8220;UTF-8 without BOM&#8221; as encoding</li>
</ol>
<p>It is also recommended to use the Unix newline format, you can select
it in the same panel but this is not a requirement.</p>
</li>
</ul>
</div>
</div>
<span id="document-extensiondev"></span><div class="section" id="flask-extension-development">
<span id="extension-dev"></span><h3>Flask Extension Development<a class="headerlink" href="#flask-extension-development" title="제목 주소">¶</a></h3>
<p>Flask, being a microframework, often requires some repetitive steps to get
a third party library working.  Because very often these steps could be
abstracted to support multiple projects the <a class="reference external" href="http://flask.pocoo.org/extensions/">Flask Extension Registry</a>
was created.</p>
<p>If you want to create your own Flask extension for something that does not
exist yet, this guide to extension development will help you get your
extension running in no time and to feel like users would expect your
extension to behave.</p>
<div class="section" id="anatomy-of-an-extension">
<h4>Anatomy of an Extension<a class="headerlink" href="#anatomy-of-an-extension" title="제목 주소">¶</a></h4>
<p>Extensions are all located in a package called <code class="docutils literal"><span class="pre">flask_something</span></code>
where &#8220;something&#8221; is the name of the library you want to bridge.  So for
example if you plan to add support for a library named <cite>simplexml</cite> to
Flask, you would name your extension&#8217;s package <code class="docutils literal"><span class="pre">flask_simplexml</span></code>.</p>
<p>The name of the actual extension (the human readable name) however would
be something like &#8220;Flask-SimpleXML&#8221;.  Make sure to include the name
&#8220;Flask&#8221; somewhere in that name and that you check the capitalization.
This is how users can then register dependencies to your extension in
their <cite>setup.py</cite> files.</p>
<p>Flask sets up a redirect package called <code class="xref py py-data docutils literal"><span class="pre">flask.ext</span></code> where users
should import the extensions from.  If you for instance have a package
called <code class="docutils literal"><span class="pre">flask_something</span></code> users would import it as
<code class="docutils literal"><span class="pre">flask.ext.something</span></code>.  This is done to transition from the old
namespace packages.  See <a class="reference internal" href="index.html#ext-import-transition"><span>Extension Import Transition</span></a> for more details.</p>
<p>But how do extensions look like themselves?  An extension has to ensure
that it works with multiple Flask application instances at once.  This is
a requirement because many people will use patterns like the
<a class="reference internal" href="index.html#app-factories"><span>어플리케이션 팩토리</span></a> pattern to create their application as needed to aid
unittests and to support multiple configurations.  Because of that it is
crucial that your application supports that kind of behavior.</p>
<p>Most importantly the extension must be shipped with a <cite>setup.py</cite> file and
registered on PyPI.  Also the development checkout link should work so
that people can easily install the development version into their
virtualenv without having to download the library by hand.</p>
<p>Flask extensions must be licensed under a BSD, MIT or more liberal license
to be able to be enlisted in the Flask Extension Registry.  Keep in mind
that the Flask Extension Registry is a moderated place and libraries will
be reviewed upfront if they behave as required.</p>
</div>
<div class="section" id="hello-flaskext">
<h4>&#8220;Hello Flaskext!&#8221;<a class="headerlink" href="#hello-flaskext" title="제목 주소">¶</a></h4>
<p>So let&#8217;s get started with creating such a Flask extension.  The extension
we want to create here will provide very basic support for SQLite3.</p>
<p>First we create the following folder structure:</p>
<div class="highlight-python"><div class="highlight"><pre>flask-sqlite3/
    flask_sqlite3.py
    LICENSE
    README
</pre></div>
</div>
<p>Here&#8217;s the contents of the most important files:</p>
<div class="section" id="setup-py">
<h5>setup.py<a class="headerlink" href="#setup-py" title="제목 주소">¶</a></h5>
<p>The next file that is absolutely required is the <cite>setup.py</cite> file which is
used to install your Flask extension.  The following contents are
something you can work with:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Flask-SQLite3</span>
<span class="sd">-------------</span>

<span class="sd">This is the description for that library</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">setuptools</span> <span class="kn">import</span> <span class="n">setup</span>


<span class="n">setup</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s">&#39;Flask-SQLite3&#39;</span><span class="p">,</span>
    <span class="n">version</span><span class="o">=</span><span class="s">&#39;1.0&#39;</span><span class="p">,</span>
    <span class="n">url</span><span class="o">=</span><span class="s">&#39;http://example.com/flask-sqlite3/&#39;</span><span class="p">,</span>
    <span class="n">license</span><span class="o">=</span><span class="s">&#39;BSD&#39;</span><span class="p">,</span>
    <span class="n">author</span><span class="o">=</span><span class="s">&#39;Your Name&#39;</span><span class="p">,</span>
    <span class="n">author_email</span><span class="o">=</span><span class="s">&#39;your-email@example.com&#39;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s">&#39;Very short description&#39;</span><span class="p">,</span>
    <span class="n">long_description</span><span class="o">=</span><span class="n">__doc__</span><span class="p">,</span>
    <span class="n">py_modules</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;flask_sqlite3&#39;</span><span class="p">],</span>
    <span class="c"># if you would be using a package instead use packages instead</span>
    <span class="c"># of py_modules:</span>
    <span class="c"># packages=[&#39;flask_sqlite3&#39;],</span>
    <span class="n">zip_safe</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">include_package_data</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">platforms</span><span class="o">=</span><span class="s">&#39;any&#39;</span><span class="p">,</span>
    <span class="n">install_requires</span><span class="o">=</span><span class="p">[</span>
        <span class="s">&#39;Flask&#39;</span>
    <span class="p">],</span>
    <span class="n">classifiers</span><span class="o">=</span><span class="p">[</span>
        <span class="s">&#39;Environment :: Web Environment&#39;</span><span class="p">,</span>
        <span class="s">&#39;Intended Audience :: Developers&#39;</span><span class="p">,</span>
        <span class="s">&#39;License :: OSI Approved :: BSD License&#39;</span><span class="p">,</span>
        <span class="s">&#39;Operating System :: OS Independent&#39;</span><span class="p">,</span>
        <span class="s">&#39;Programming Language :: Python&#39;</span><span class="p">,</span>
        <span class="s">&#39;Topic :: Internet :: WWW/HTTP :: Dynamic Content&#39;</span><span class="p">,</span>
        <span class="s">&#39;Topic :: Software Development :: Libraries :: Python Modules&#39;</span>
    <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<p>That&#8217;s a lot of code but you can really just copy/paste that from existing
extensions and adapt.</p>
</div>
<div class="section" id="flask-sqlite3-py">
<h5>flask_sqlite3.py<a class="headerlink" href="#flask-sqlite3-py" title="제목 주소">¶</a></h5>
<p>Now this is where your extension code goes.  But how exactly should such
an extension look like?  What are the best practices?  Continue reading
for some insight.</p>
</div>
</div>
<div class="section" id="initializing-extensions">
<h4>Initializing Extensions<a class="headerlink" href="#initializing-extensions" title="제목 주소">¶</a></h4>
<p>Many extensions will need some kind of initialization step.  For example,
consider an application that&#8217;s currently connecting to SQLite like the
documentation suggests (<a class="reference internal" href="index.html#sqlite3"><span>Flask에서 SQLite 3 사용하기</span></a>).  So how does the extension
know the name of the application object?</p>
<p>Quite simple: you pass it to it.</p>
<p>There are two recommended ways for an extension to initialize:</p>
<p>initialization functions:</p>
<blockquote>
<div>If your extension is called <cite>helloworld</cite> you might have a function
called <code class="docutils literal"><span class="pre">init_helloworld(app[,</span> <span class="pre">extra_args])</span></code> that initializes the
extension for that application.  It could attach before / after
handlers etc.</div></blockquote>
<p>classes:</p>
<blockquote>
<div>Classes work mostly like initialization functions but can later be
used to further change the behavior.  For an example look at how the
<a class="reference external" href="http://packages.python.org/Flask-OAuth/">OAuth extension</a> works: there is an <cite>OAuth</cite> object that provides
some helper functions like <cite>OAuth.remote_app</cite> to create a reference to
a remote application that uses OAuth.</div></blockquote>
<p>What to use depends on what you have in mind.  For the SQLite 3 extension
we will use the class-based approach because it will provide users with an
object that handles opening and closing database connections.</p>
<p>What&#8217;s important about classes is that they encourage to be shared around
on module level.  In that case, the object itself must not under any
circumstances store any application specific state and must be shareable
between different application.</p>
</div>
<div class="section" id="the-extension-code">
<h4>The Extension Code<a class="headerlink" href="#the-extension-code" title="제목 주소">¶</a></h4>
<p>Here&#8217;s the contents of the <cite>flask_sqlite3.py</cite> for copy/paste:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">sqlite3</span>

<span class="c"># Find the stack on which we want to store the database connection.</span>
<span class="c"># Starting with Flask 0.9, the _app_ctx_stack is the correct one,</span>
<span class="c"># before that we need to use the _request_ctx_stack.</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">_app_ctx_stack</span> <span class="k">as</span> <span class="n">stack</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">_request_ctx_stack</span> <span class="k">as</span> <span class="n">stack</span>


<span class="k">class</span> <span class="nc">SQLite3</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">app</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">app</span> <span class="o">=</span> <span class="n">app</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">init_app</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">app</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">init_app</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app</span><span class="p">):</span>
        <span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s">&#39;SQLITE3_DATABASE&#39;</span><span class="p">,</span> <span class="s">&#39;:memory:&#39;</span><span class="p">)</span>
        <span class="c"># Use the newstyle teardown_appcontext if it&#39;s available,</span>
        <span class="c"># otherwise fall back to the request context</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="s">&#39;teardown_appcontext&#39;</span><span class="p">):</span>
            <span class="n">app</span><span class="o">.</span><span class="n">teardown_appcontext</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">teardown</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">app</span><span class="o">.</span><span class="n">teardown_request</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">teardown</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&#39;SQLITE3_DATABASE&#39;</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">teardown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exception</span><span class="p">):</span>
        <span class="n">ctx</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">top</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="s">&#39;sqlite3_db&#39;</span><span class="p">):</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">sqlite3_db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">connection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ctx</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">top</span>
        <span class="k">if</span> <span class="n">ctx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="s">&#39;sqlite3_db&#39;</span><span class="p">):</span>
                <span class="n">ctx</span><span class="o">.</span><span class="n">sqlite3_db</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">ctx</span><span class="o">.</span><span class="n">sqlite3_db</span>
</pre></div>
</div>
<p>So here&#8217;s what these lines of code do:</p>
<ol class="arabic">
<li><p class="first">The <code class="docutils literal"><span class="pre">__init__</span></code> method takes an optional app object and, if supplied, will
call <code class="docutils literal"><span class="pre">init_app</span></code>.</p>
</li>
<li><p class="first">The <code class="docutils literal"><span class="pre">init_app</span></code> method exists so that the <code class="docutils literal"><span class="pre">SQLite3</span></code> object can be
instantiated without requiring an app object.  This method supports the
factory pattern for creating applications.  The <code class="docutils literal"><span class="pre">init_app</span></code> will set the
configuration for the database, defaulting to an in memory database if
no configuration is supplied.  In addition, the <code class="docutils literal"><span class="pre">init_app</span></code> method attaches
the <code class="docutils literal"><span class="pre">teardown</span></code> handler.  It will try to use the newstyle app context
handler and if it does not exist, falls back to the request context
one.</p>
</li>
<li><p class="first">Next, we define a <code class="docutils literal"><span class="pre">connect</span></code> method that opens a database connection.</p>
</li>
<li><p class="first">Finally, we add a <code class="docutils literal"><span class="pre">connection</span></code> property that on first access opens
the database connection and stores it on the context.  This is also
the recommended way to handling resources: fetch resources lazily the
first time they are used.</p>
<p>Note here that we&#8217;re attaching our database connection to the top
application context via <code class="docutils literal"><span class="pre">_app_ctx_stack.top</span></code>. Extensions should use
the top context for storing their own information with a sufficiently
complex name.  Note that we&#8217;re falling back to the
<code class="docutils literal"><span class="pre">_request_ctx_stack.top</span></code> if the application is using an older
version of Flask that does not support it.</p>
</li>
</ol>
<p>So why did we decide on a class-based approach here?  Because using our
extension looks something like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
<span class="kn">from</span> <span class="nn">flask_sqlite3</span> <span class="kn">import</span> <span class="n">SQLite3</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">from_pyfile</span><span class="p">(</span><span class="s">&#39;the-config.cfg&#39;</span><span class="p">)</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">SQLite3</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
</pre></div>
</div>
<p>You can then use the database from views like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">show_all</span><span class="p">():</span>
    <span class="n">cur</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>Likewise if you are outside of a request but you are using Flask 0.9 or
later with the app context support, you can use the database in the same
way:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">with</span> <span class="n">app</span><span class="o">.</span><span class="n">app_context</span><span class="p">():</span>
    <span class="n">cur</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>At the end of the <cite>with</cite> block the teardown handles will be executed
automatically.</p>
<p>Additionally, the <code class="docutils literal"><span class="pre">init_app</span></code> method is used to support the factory pattern
for creating apps:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">db</span> <span class="o">=</span> <span class="n">Sqlite3</span><span class="p">()</span>
<span class="c"># Then later on.</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">create_app</span><span class="p">(</span><span class="s">&#39;the-config.cfg&#39;</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">init_app</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
</pre></div>
</div>
<p>Keep in mind that supporting this factory pattern for creating apps is required
for approved flask extensions (described below).</p>
<div class="admonition-note-on-init-app admonition">
<p class="first admonition-title">Note on <code class="docutils literal"><span class="pre">init_app</span></code></p>
<p>As you noticed, <code class="docutils literal"><span class="pre">init_app</span></code> does not assign <code class="docutils literal"><span class="pre">app</span></code> to <code class="docutils literal"><span class="pre">self</span></code>.  This
is intentional!  Class based Flask extensions must only store the
application on the object when the application was passed to the
constructor.  This tells the extension: I am not interested in using
multiple applications.</p>
<p class="last">When the extension needs to find the current application and it does
not have a reference to it, it must either use the
<a class="reference internal" href="index.html#flask.current_app" title="flask.current_app"><code class="xref py py-data docutils literal"><span class="pre">current_app</span></code></a> context local or change the API in a way
that you can pass the application explicitly.</p>
</div>
</div>
<div class="section" id="using-app-ctx-stack">
<h4>Using _app_ctx_stack<a class="headerlink" href="#using-app-ctx-stack" title="제목 주소">¶</a></h4>
<p>In the example above, before every request, a <code class="docutils literal"><span class="pre">sqlite3_db</span></code> variable is
assigned to <code class="docutils literal"><span class="pre">_app_ctx_stack.top</span></code>.  In a view function, this variable is
accessible using the <code class="docutils literal"><span class="pre">connection</span></code> property of <code class="docutils literal"><span class="pre">SQLite3</span></code>.  During the
teardown of a request, the <code class="docutils literal"><span class="pre">sqlite3_db</span></code> connection is closed.  By using
this pattern, the <em>same</em> connection to the sqlite3 database is accessible
to anything that needs it for the duration of the request.</p>
<p>If the <a class="reference internal" href="index.html#flask._app_ctx_stack" title="flask._app_ctx_stack"><code class="xref py py-data docutils literal"><span class="pre">_app_ctx_stack</span></code></a> does not exist because the user uses
an old version of Flask, it is recommended to fall back to
<a class="reference internal" href="index.html#flask._request_ctx_stack" title="flask._request_ctx_stack"><code class="xref py py-data docutils literal"><span class="pre">_request_ctx_stack</span></code></a> which is bound to a request.</p>
</div>
<div class="section" id="teardown-behavior">
<h4>Teardown Behavior<a class="headerlink" href="#teardown-behavior" title="제목 주소">¶</a></h4>
<p><em>This is only relevant if you want to support Flask 0.6 and older</em></p>
<p>Due to the change in Flask 0.7 regarding functions that are run at the end
of the request your extension will have to be extra careful there if it
wants to continue to support older versions of Flask.  The following
pattern is a good way to support both:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">close_connection</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
    <span class="n">ctx</span> <span class="o">=</span> <span class="n">_request_ctx_stack</span><span class="o">.</span><span class="n">top</span>
    <span class="n">ctx</span><span class="o">.</span><span class="n">sqlite3_db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">response</span>

<span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="s">&#39;teardown_request&#39;</span><span class="p">):</span>
    <span class="n">app</span><span class="o">.</span><span class="n">teardown_request</span><span class="p">(</span><span class="n">close_connection</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">after_request</span><span class="p">(</span><span class="n">close_connection</span><span class="p">)</span>
</pre></div>
</div>
<p>Strictly speaking the above code is wrong, because teardown functions are
passed the exception and typically don&#8217;t return anything.  However because
the return value is discarded this will just work assuming that the code
in between does not touch the passed parameter.</p>
</div>
<div class="section" id="learn-from-others">
<h4>Learn from Others<a class="headerlink" href="#learn-from-others" title="제목 주소">¶</a></h4>
<p>This documentation only touches the bare minimum for extension
development.  If you want to learn more, it&#8217;s a very good idea to check
out existing extensions on the <a class="reference external" href="http://flask.pocoo.org/extensions/">Flask Extension Registry</a>.  If you feel
lost there is still the <a class="reference external" href="http://flask.pocoo.org/mailinglist/">mailinglist</a> and the <a class="reference external" href="http://flask.pocoo.org/community/irc/">IRC channel</a> to get some
ideas for nice looking APIs.  Especially if you do something nobody before
you did, it might be a very good idea to get some more input.  This not
only to get an idea about what people might want to have from an
extension, but also to avoid having multiple developers working on pretty
much the same side by side.</p>
<p>Remember: good API design is hard, so introduce your project on the
mailinglist, and let other developers give you a helping hand with
designing the API.</p>
<p>The best Flask extensions are extensions that share common idioms for the
API.  And this can only work if collaboration happens early.</p>
</div>
<div class="section" id="approved-extensions">
<h4>Approved Extensions<a class="headerlink" href="#approved-extensions" title="제목 주소">¶</a></h4>
<p>Flask also has the concept of approved extensions.  Approved extensions
are tested as part of Flask itself to ensure extensions do not break on
new releases.  These approved extensions are listed on the <a class="reference external" href="http://flask.pocoo.org/extensions/">Flask
Extension Registry</a> and marked appropriately.  If you want your own
extension to be approved you have to follow these guidelines:</p>
<ol class="arabic simple" start="0">
<li>An approved Flask extension requires a maintainer. In the event an
extension author would like to move beyond the project, the project should
find a new maintainer including full source hosting transition and PyPI
access.  If no maintainer is available, give access to the Flask core team.</li>
<li>An approved Flask extension must provide exactly one package or module
named <code class="docutils literal"><span class="pre">flask_extensionname</span></code>.  They might also reside inside a
<code class="docutils literal"><span class="pre">flaskext</span></code> namespace packages though this is discouraged now.</li>
<li>It must ship a testing suite that can either be invoked with <code class="docutils literal"><span class="pre">make</span> <span class="pre">test</span></code>
or <code class="docutils literal"><span class="pre">python</span> <span class="pre">setup.py</span> <span class="pre">test</span></code>.  For test suites invoked with <code class="docutils literal"><span class="pre">make</span>
<span class="pre">test</span></code> the extension has to ensure that all dependencies for the test
are installed automatically.  If tests are invoked with <code class="docutils literal"><span class="pre">python</span> <span class="pre">setup.py</span>
<span class="pre">test</span></code>, test dependencies can be specified in the <cite>setup.py</cite> file.  The
test suite also has to be part of the distribution.</li>
<li>APIs of approved extensions will be checked for the following
characteristics:<ul>
<li>an approved extension has to support multiple applications
running in the same Python process.</li>
<li>it must be possible to use the factory pattern for creating
applications.</li>
</ul>
</li>
<li>The license must be BSD/MIT/WTFPL licensed.</li>
<li>The naming scheme for official extensions is <em>Flask-ExtensionName</em> or
<em>ExtensionName-Flask</em>.</li>
<li>Approved extensions must define all their dependencies in the
<cite>setup.py</cite> file unless a dependency cannot be met because it is not
available on PyPI.</li>
<li>The extension must have documentation that uses one of the two Flask
themes for Sphinx documentation.</li>
<li>The setup.py description (and thus the PyPI description) has to
link to the documentation, website (if there is one) and there
must be a link to automatically install the development version
(<code class="docutils literal"><span class="pre">PackageName==dev</span></code>).</li>
<li>The <code class="docutils literal"><span class="pre">zip_safe</span></code> flag in the setup script must be set to <code class="docutils literal"><span class="pre">False</span></code>,
even if the extension would be safe for zipping.</li>
<li>An extension currently has to support Python 2.5, 2.6 as well as
Python 2.7</li>
</ol>
</div>
<div class="section" id="extension-import-transition">
<span id="ext-import-transition"></span><h4>Extension Import Transition<a class="headerlink" href="#extension-import-transition" title="제목 주소">¶</a></h4>
<p>For a while we recommended using namespace packages for Flask extensions.
This turned out to be problematic in practice because many different
competing namespace package systems exist and pip would automatically
switch between different systems and this caused a lot of problems for
users.</p>
<p>Instead we now recommend naming packages <code class="docutils literal"><span class="pre">flask_foo</span></code> instead of the now
deprecated <code class="docutils literal"><span class="pre">flaskext.foo</span></code>.  Flask 0.8 introduces a redirect import
system that lets uses import from <code class="docutils literal"><span class="pre">flask.ext.foo</span></code> and it will try
<code class="docutils literal"><span class="pre">flask_foo</span></code> first and if that fails <code class="docutils literal"><span class="pre">flaskext.foo</span></code>.</p>
<p>Flask extensions should urge users to import from <code class="docutils literal"><span class="pre">flask.ext.foo</span></code>
instead of <code class="docutils literal"><span class="pre">flask_foo</span></code> or <code class="docutils literal"><span class="pre">flaskext_foo</span></code> so that extensions can
transition to the new package name without affecting users.</p>
</div>
</div>
<span id="document-styleguide"></span><div class="section" id="pocoo-styleguide">
<h3>Pocoo Styleguide<a class="headerlink" href="#pocoo-styleguide" title="제목 주소">¶</a></h3>
<p>The Pocoo styleguide is the styleguide for all Pocoo Projects, including
Flask.  This styleguide is a requirement for Patches to Flask and a
recommendation for Flask extensions.</p>
<p>In general the Pocoo Styleguide closely follows <span class="target" id="index-0"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0008"><strong>PEP 8</strong></a> with some small
differences and extensions.</p>
<div class="section" id="general-layout">
<h4>General Layout<a class="headerlink" href="#general-layout" title="제목 주소">¶</a></h4>
<dl class="docutils">
<dt>Indentation:</dt>
<dd>4 real spaces.  No tabs, no exceptions.</dd>
<dt>Maximum line length:</dt>
<dd>79 characters with a soft limit for 84 if absolutely necessary.  Try
to avoid too nested code by cleverly placing <cite>break</cite>, <cite>continue</cite> and
<cite>return</cite> statements.</dd>
<dt>Continuing long statements:</dt>
<dd><p class="first">To continue a statement you can use backslashes in which case you should
align the next line with the last dot or equal sign, or indent four
spaces:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">this_is_a_very_long</span><span class="p">(</span><span class="n">function_call</span><span class="p">,</span> <span class="s">&#39;with many parameters&#39;</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">that_returns_an_object_with_an_attribute</span>

<span class="n">MyModel</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">MyModel</span><span class="o">.</span><span class="n">scalar</span> <span class="o">&gt;</span> <span class="mi">120</span><span class="p">)</span> \
             <span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="n">MyModel</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">desc</span><span class="p">())</span> \
             <span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>If you break in a statement with parentheses or braces, align to the
braces:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">this_is_a_very_long</span><span class="p">(</span><span class="n">function_call</span><span class="p">,</span> <span class="s">&#39;with many parameters&#39;</span><span class="p">,</span>
                    <span class="mi">23</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="s">&#39;and even more&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>For lists or tuples with many items, break immediately after the
opening brace:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="n">items</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s">&#39;this is the first&#39;</span><span class="p">,</span> <span class="s">&#39;set of items&#39;</span><span class="p">,</span> <span class="s">&#39;with more items&#39;</span><span class="p">,</span>
    <span class="s">&#39;to come in this line&#39;</span><span class="p">,</span> <span class="s">&#39;like this&#39;</span>
<span class="p">]</span>
</pre></div>
</div>
</dd>
<dt>Blank lines:</dt>
<dd><p class="first">Top level functions and classes are separated by two lines, everything
else by one.  Do not use too many blank lines to separate logical
segments in code.  Example:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">hello</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="k">print</span> <span class="s">&#39;Hello </span><span class="si">%s</span><span class="s">!&#39;</span> <span class="o">%</span> <span class="n">name</span>


<span class="k">def</span> <span class="nf">goodbye</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="k">print</span> <span class="s">&#39;See you </span><span class="si">%s</span><span class="s">.&#39;</span> <span class="o">%</span> <span class="n">name</span>


<span class="k">class</span> <span class="nc">MyClass</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This is a simple docstring&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

    <span class="k">def</span> <span class="nf">get_annoying_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s">&#39;!!!!111&#39;</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="expressions-and-statements">
<h4>Expressions and Statements<a class="headerlink" href="#expressions-and-statements" title="제목 주소">¶</a></h4>
<dl class="docutils">
<dt>General whitespace rules:</dt>
<dd><ul class="first simple">
<li>No whitespace for unary operators that are not words
(e.g.: <code class="docutils literal"><span class="pre">-</span></code>, <code class="docutils literal"><span class="pre">~</span></code> etc.) as well on the inner side of parentheses.</li>
<li>Whitespace is placed between binary operators.</li>
</ul>
<p>Good:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">exp</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.05</span>
<span class="n">value</span> <span class="o">=</span> <span class="p">(</span><span class="n">item_value</span> <span class="o">/</span> <span class="n">item_count</span><span class="p">)</span> <span class="o">*</span> <span class="n">offset</span> <span class="o">/</span> <span class="n">exp</span>
<span class="n">value</span> <span class="o">=</span> <span class="n">my_list</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
<span class="n">value</span> <span class="o">=</span> <span class="n">my_dict</span><span class="p">[</span><span class="s">&#39;key&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Bad:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="n">exp</span> <span class="o">=</span> <span class="o">-</span> <span class="mf">1.05</span>
<span class="n">value</span> <span class="o">=</span> <span class="p">(</span> <span class="n">item_value</span> <span class="o">/</span> <span class="n">item_count</span> <span class="p">)</span> <span class="o">*</span> <span class="n">offset</span> <span class="o">/</span> <span class="n">exp</span>
<span class="n">value</span> <span class="o">=</span> <span class="p">(</span><span class="n">item_value</span><span class="o">/</span><span class="n">item_count</span><span class="p">)</span><span class="o">*</span><span class="n">offset</span><span class="o">/</span><span class="n">exp</span>
<span class="n">value</span><span class="o">=</span><span class="p">(</span> <span class="n">item_value</span><span class="o">/</span><span class="n">item_count</span> <span class="p">)</span> <span class="o">*</span> <span class="n">offset</span><span class="o">/</span><span class="n">exp</span>
<span class="n">value</span> <span class="o">=</span> <span class="n">my_list</span><span class="p">[</span> <span class="n">index</span> <span class="p">]</span>
<span class="n">value</span> <span class="o">=</span> <span class="n">my_dict</span> <span class="p">[</span><span class="s">&#39;key&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd>
<dt>Yoda statements are a no-go:</dt>
<dd><p class="first">Never compare constant with variable, always variable with constant:</p>
<p>Good:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s">&#39;md5&#39;</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>Bad:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="k">if</span> <span class="s">&#39;md5&#39;</span> <span class="o">==</span> <span class="n">method</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>
</div>
</dd>
<dt>Comparisons:</dt>
<dd><ul class="first last simple">
<li>against arbitrary types: <code class="docutils literal"><span class="pre">==</span></code> and <code class="docutils literal"><span class="pre">!=</span></code></li>
<li>against singletons with <code class="docutils literal"><span class="pre">is</span></code> and <code class="docutils literal"><span class="pre">is</span> <span class="pre">not</span></code> (eg: <code class="docutils literal"><span class="pre">foo</span> <span class="pre">is</span> <span class="pre">not</span>
<span class="pre">None</span></code>)</li>
<li>never compare something with <cite>True</cite> or <cite>False</cite> (for example never
do <code class="docutils literal"><span class="pre">foo</span> <span class="pre">==</span> <span class="pre">False</span></code>, do <code class="docutils literal"><span class="pre">not</span> <span class="pre">foo</span></code> instead)</li>
</ul>
</dd>
<dt>Negated containment checks:</dt>
<dd>use <code class="docutils literal"><span class="pre">foo</span> <span class="pre">not</span> <span class="pre">in</span> <span class="pre">bar</span></code> instead of <code class="docutils literal"><span class="pre">not</span> <span class="pre">foo</span> <span class="pre">in</span> <span class="pre">bar</span></code></dd>
<dt>Instance checks:</dt>
<dd><code class="docutils literal"><span class="pre">isinstance(a,</span> <span class="pre">C)</span></code> instead of <code class="docutils literal"><span class="pre">type(A)</span> <span class="pre">is</span> <span class="pre">C</span></code>, but try to avoid
instance checks in general.  Check for features.</dd>
</dl>
</div>
<div class="section" id="naming-conventions">
<h4>Naming Conventions<a class="headerlink" href="#naming-conventions" title="제목 주소">¶</a></h4>
<ul class="simple">
<li>Class names: <code class="docutils literal"><span class="pre">CamelCase</span></code>, with acronyms kept uppercase (<code class="docutils literal"><span class="pre">HTTPWriter</span></code>
and not <code class="docutils literal"><span class="pre">HttpWriter</span></code>)</li>
<li>Variable names: <code class="docutils literal"><span class="pre">lowercase_with_underscores</span></code></li>
<li>Method and function names: <code class="docutils literal"><span class="pre">lowercase_with_underscores</span></code></li>
<li>Constants: <code class="docutils literal"><span class="pre">UPPERCASE_WITH_UNDERSCORES</span></code></li>
<li>precompiled regular expressions: <code class="docutils literal"><span class="pre">name_re</span></code></li>
</ul>
<p>Protected members are prefixed with a single underscore.  Double
underscores are reserved for mixin classes.</p>
<p>On classes with keywords, trailing underscores are appended.  Clashes with
builtins are allowed and <strong>must not</strong> be resolved by appending an
underline to the variable name.  If the function needs to access a
shadowed builtin, rebind the builtin to a different name instead.</p>
<dl class="docutils">
<dt>Function and method arguments:</dt>
<dd><ul class="first last simple">
<li>class methods: <code class="docutils literal"><span class="pre">cls</span></code> as first parameter</li>
<li>instance methods: <code class="docutils literal"><span class="pre">self</span></code> as first parameter</li>
<li>lambdas for properties might have the first parameter replaced
with <code class="docutils literal"><span class="pre">x</span></code> like in <code class="docutils literal"><span class="pre">display_name</span> <span class="pre">=</span> <span class="pre">property(lambda</span> <span class="pre">x:</span> <span class="pre">x.real_name</span>
<span class="pre">or</span> <span class="pre">x.username)</span></code></li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="docstrings">
<h4>Docstrings<a class="headerlink" href="#docstrings" title="제목 주소">¶</a></h4>
<dl class="docutils">
<dt>Docstring conventions:</dt>
<dd><p class="first">All docstrings are formatted with reStructuredText as understood by
Sphinx.  Depending on the number of lines in the docstring, they are
laid out differently.  If it&#8217;s just one line, the closing triple
quote is on the same line as the opening, otherwise the text is on
the same line as the opening quote and the triple quote that closes
the string on its own line:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">foo</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;This is a simple docstring&quot;&quot;&quot;</span>


<span class="k">def</span> <span class="nf">bar</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;This is a longer docstring with so much information in there</span>
<span class="sd">    that it spans three lines.  In this case the closing triple quote</span>
<span class="sd">    is on its own line.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>
</div>
</dd>
<dt>Module header:</dt>
<dd><p class="first">The module header consists of an utf-8 encoding declaration (if non
ASCII letters are used, but it is recommended all the time) and a
standard docstring:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    package.module</span>
<span class="sd">    ~~~~~~~~~~~~~~</span>

<span class="sd">    A brief description goes here.</span>

<span class="sd">    :copyright: (c) YEAR by AUTHOR.</span>
<span class="sd">    :license: LICENSE_NAME, see LICENSE_FILE for more details.</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>
</div>
<p class="last">Please keep in mind that proper copyrights and license files are a
requirement for approved Flask extensions.</p>
</dd>
</dl>
</div>
<div class="section" id="comments">
<h4>Comments<a class="headerlink" href="#comments" title="제목 주소">¶</a></h4>
<p>Rules for comments are similar to docstrings.  Both are formatted with
reStructuredText.  If a comment is used to document an attribute, put a
colon after the opening pound sign (<code class="docutils literal"><span class="pre">#</span></code>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="c">#: the name of the user as unicode string</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">)</span>
    <span class="c">#: the sha1 hash of the password + inline salt</span>
    <span class="n">pw_hash</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<span id="document-upgrading"></span><div class="section" id="upgrading-to-newer-releases">
<h3>Upgrading to Newer Releases<a class="headerlink" href="#upgrading-to-newer-releases" title="제목 주소">¶</a></h3>
<p>Flask itself is changing like any software is changing over time.  Most of
the changes are the nice kind, the kind where you don&#8217;t have to change
anything in your code to profit from a new release.</p>
<p>However every once in a while there are changes that do require some
changes in your code or there are changes that make it possible for you to
improve your own code quality by taking advantage of new features in
Flask.</p>
<p>This section of the documentation enumerates all the changes in Flask from
release to release and how you can change your code to have a painless
updating experience.</p>
<p>If you want to use the <cite>easy_install</cite> command to upgrade your Flask
installation, make sure to pass it the <code class="docutils literal"><span class="pre">-U</span></code> parameter:</p>
<div class="highlight-python"><div class="highlight"><pre>$ easy_install -U Flask
</pre></div>
</div>
<div class="section" id="version-0-10">
<span id="upgrading-to-010"></span><h4>Version 0.10<a class="headerlink" href="#version-0-10" title="제목 주소">¶</a></h4>
<p>The biggest change going from 0.9 to 0.10 is that the cookie serialization
format changed from pickle to a specialized JSON format.  This change has
been done in order to avoid the damage an attacker can do if the secret
key is leaked.  When you upgrade you will notice two major changes: all
sessions that were issued before the upgrade are invalidated and you can
only store a limited amount of types in the session.  The new sessions are
by design much more restricted to only allow JSON with a few small
extensions for tuples and strings with HTML markup.</p>
<p>In order to not break people&#8217;s sessions it is possible to continue using
the old session system by using the <cite>Flask-OldSessions_</cite> extension.</p>
</div>
<div class="section" id="version-0-9">
<h4>Version 0.9<a class="headerlink" href="#version-0-9" title="제목 주소">¶</a></h4>
<p>The behavior of returning tuples from a function was simplified.  If you
return a tuple it no longer defines the arguments for the response object
you&#8217;re creating, it&#8217;s now always a tuple in the form <code class="docutils literal"><span class="pre">(response,</span> <span class="pre">status,</span>
<span class="pre">headers)</span></code> where at least one item has to be provided.  If you depend on
the old behavior, you can add it easily by subclassing Flask:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">TraditionalFlask</span><span class="p">(</span><span class="n">Flask</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">make_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rv</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rv</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_class</span><span class="p">(</span><span class="o">*</span><span class="n">rv</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Flask</span><span class="o">.</span><span class="n">make_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rv</span><span class="p">)</span>
</pre></div>
</div>
<p>If you maintain an extension that was using <a class="reference internal" href="index.html#flask._request_ctx_stack" title="flask._request_ctx_stack"><code class="xref py py-data docutils literal"><span class="pre">_request_ctx_stack</span></code></a>
before, please consider changing to <a class="reference internal" href="index.html#flask._app_ctx_stack" title="flask._app_ctx_stack"><code class="xref py py-data docutils literal"><span class="pre">_app_ctx_stack</span></code></a> if it makes
sense for your extension.  For instance, the app context stack makes sense for
extensions which connect to databases.  Using the app context stack instead of
the request stack will make extensions more readily handle use cases outside of
requests.</p>
</div>
<div class="section" id="version-0-8">
<h4>Version 0.8<a class="headerlink" href="#version-0-8" title="제목 주소">¶</a></h4>
<p>Flask introduced a new session interface system.  We also noticed that
there was a naming collision between <cite>flask.session</cite> the module that
implements sessions and <a class="reference internal" href="index.html#flask.session" title="flask.session"><code class="xref py py-data docutils literal"><span class="pre">flask.session</span></code></a> which is the global session
object.  With that introduction we moved the implementation details for
the session system into a new module called <code class="xref py py-mod docutils literal"><span class="pre">flask.sessions</span></code>.  If you
used the previously undocumented session support we urge you to upgrade.</p>
<p>If invalid JSON data was submitted Flask will now raise a
<a class="reference external" href="http://werkzeug.pocoo.org/docs/exceptions/#werkzeug.exceptions.BadRequest" title="(in Werkzeug v0.11-dev)"><code class="xref py py-exc docutils literal"><span class="pre">BadRequest</span></code></a> exception instead of letting the
default <a class="reference external" href="http://docs.python.org/dev/library/exceptions.html#ValueError" title="(in Python v3.6)"><code class="xref py py-exc docutils literal"><span class="pre">ValueError</span></code></a> bubble up.  This has the advantage that you no
longer have to handle that error to avoid an internal server error showing
up for the user.  If you were catching this down explicitly in the past
as <cite>ValueError</cite> you will need to change this.</p>
<p>Due to a bug in the test client Flask 0.7 did not trigger teardown
handlers when the test client was used in a with statement.  This was
since fixed but might require some changes in your testsuites if you
relied on this behavior.</p>
</div>
<div class="section" id="version-0-7">
<h4>Version 0.7<a class="headerlink" href="#version-0-7" title="제목 주소">¶</a></h4>
<p>In Flask 0.7 we cleaned up the code base internally a lot and did some
backwards incompatible changes that make it easier to implement larger
applications with Flask.  Because we want to make upgrading as easy as
possible we tried to counter the problems arising from these changes by
providing a script that can ease the transition.</p>
<p>The script scans your whole application and generates an unified diff with
changes it assumes are safe to apply.  However as this is an automated
tool it won&#8217;t be able to find all use cases and it might miss some.  We
internally spread a lot of deprecation warnings all over the place to make
it easy to find pieces of code that it was unable to upgrade.</p>
<p>We strongly recommend that you hand review the generated patchfile and
only apply the chunks that look good.</p>
<p>If you are using git as version control system for your project we
recommend applying the patch with <code class="docutils literal"><span class="pre">path</span> <span class="pre">-p1</span> <span class="pre">&lt;</span> <span class="pre">patchfile.diff</span></code> and then
using the interactive commit feature to only apply the chunks that look
good.</p>
<p>To apply the upgrade script do the following:</p>
<ol class="arabic">
<li><p class="first">Download the script: <a class="reference external" href="https://raw.github.com/mitsuhiko/flask/master/scripts/flask-07-upgrade.py">flask-07-upgrade.py</a></p>
</li>
<li><p class="first">Run it in the directory of your application:</p>
<div class="highlight-python"><div class="highlight"><pre>python flask-07-upgrade.py &gt; patchfile.diff
</pre></div>
</div>
</li>
<li><p class="first">Review the generated patchfile.</p>
</li>
<li><p class="first">Apply the patch:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">patch</span> <span class="o">-</span><span class="n">p1</span> <span class="o">&lt;</span> <span class="n">patchfile</span><span class="o">.</span><span class="n">diff</span>
</pre></div>
</div>
</li>
<li><p class="first">If you were using per-module template folders you need to move some
templates around.  Previously if you had a folder named <code class="docutils literal"><span class="pre">templates</span></code>
next to a blueprint named <code class="docutils literal"><span class="pre">admin</span></code> the implicit template path
automatically was <code class="docutils literal"><span class="pre">admin/index.html</span></code> for a template file called
<code class="docutils literal"><span class="pre">templates/index.html</span></code>.  This no longer is the case.  Now you need
to name the template <code class="docutils literal"><span class="pre">templates/admin/index.html</span></code>.  The tool will
not detect this so you will have to do that on your own.</p>
</li>
</ol>
<p>Please note that deprecation warnings are disabled by default starting
with Python 2.7.  In order to see the deprecation warnings that might be
emitted you have to enabled them with the <a class="reference external" href="http://docs.python.org/dev/library/warnings.html#module-warnings" title="(in Python v3.6)"><code class="xref py py-mod docutils literal"><span class="pre">warnings</span></code></a> module.</p>
<p>If you are working with windows and you lack the <cite>patch</cite> command line
utility you can get it as part of various Unix runtime environments for
windows including cygwin, msysgit or ming32.  Also source control systems
like svn, hg or git have builtin support for applying unified diffs as
generated by the tool.  Check the manual of your version control system
for more information.</p>
<div class="section" id="bug-in-request-locals">
<h5>Bug in Request Locals<a class="headerlink" href="#bug-in-request-locals" title="제목 주소">¶</a></h5>
<p>Due to a bug in earlier implementations the request local proxies now
raise a <a class="reference external" href="http://docs.python.org/dev/library/exceptions.html#RuntimeError" title="(in Python v3.6)"><code class="xref py py-exc docutils literal"><span class="pre">RuntimeError</span></code></a> instead of an <a class="reference external" href="http://docs.python.org/dev/library/exceptions.html#AttributeError" title="(in Python v3.6)"><code class="xref py py-exc docutils literal"><span class="pre">AttributeError</span></code></a> when they
are unbound.  If you caught these exceptions with <a class="reference external" href="http://docs.python.org/dev/library/exceptions.html#AttributeError" title="(in Python v3.6)"><code class="xref py py-exc docutils literal"><span class="pre">AttributeError</span></code></a>
before, you should catch them with <a class="reference external" href="http://docs.python.org/dev/library/exceptions.html#RuntimeError" title="(in Python v3.6)"><code class="xref py py-exc docutils literal"><span class="pre">RuntimeError</span></code></a> now.</p>
<p>Additionally the <a class="reference internal" href="index.html#flask.send_file" title="flask.send_file"><code class="xref py py-func docutils literal"><span class="pre">send_file()</span></code></a> function is now issuing
deprecation warnings if you depend on functionality that will be removed
in Flask 1.0.  Previously it was possible to use etags and mimetypes
when file objects were passed.  This was unreliable and caused issues
for a few setups.  If you get a deprecation warning, make sure to
update your application to work with either filenames there or disable
etag attaching and attach them yourself.</p>
<p>Old code:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">return</span> <span class="n">send_file</span><span class="p">(</span><span class="n">my_file_object</span><span class="p">)</span>
<span class="k">return</span> <span class="n">send_file</span><span class="p">(</span><span class="n">my_file_object</span><span class="p">)</span>
</pre></div>
</div>
<p>New code:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">return</span> <span class="n">send_file</span><span class="p">(</span><span class="n">my_file_object</span><span class="p">,</span> <span class="n">add_etags</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="upgrading-to-new-teardown-handling">
<span id="id1"></span><h5>Upgrading to new Teardown Handling<a class="headerlink" href="#upgrading-to-new-teardown-handling" title="제목 주소">¶</a></h5>
<p>We streamlined the behavior of the callbacks for request handling.  For
things that modify the response the <a class="reference internal" href="index.html#flask.Flask.after_request" title="flask.Flask.after_request"><code class="xref py py-meth docutils literal"><span class="pre">after_request()</span></code></a>
decorators continue to work as expected, but for things that absolutely
must happen at the end of request we introduced the new
<a class="reference internal" href="index.html#flask.Flask.teardown_request" title="flask.Flask.teardown_request"><code class="xref py py-meth docutils literal"><span class="pre">teardown_request()</span></code></a> decorator.  Unfortunately that
change also made after-request work differently under error conditions.
It&#8217;s not consistently skipped if exceptions happen whereas previously it
might have been called twice to ensure it is executed at the end of the
request.</p>
<p>If you have database connection code that looks like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.after_request</span>
<span class="k">def</span> <span class="nf">after_request</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
    <span class="n">g</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
<p>You are now encouraged to use this instead:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.teardown_request</span>
<span class="k">def</span> <span class="nf">after_request</span><span class="p">(</span><span class="n">exception</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="s">&#39;db&#39;</span><span class="p">):</span>
        <span class="n">g</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>On the upside this change greatly improves the internal code flow and
makes it easier to customize the dispatching and error handling.  This
makes it now a lot easier to write unit tests as you can prevent closing
down of database connections for a while.  You can take advantage of the
fact that the teardown callbacks are called when the response context is
removed from the stack so a test can query the database after request
handling:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">with</span> <span class="n">app</span><span class="o">.</span><span class="n">test_client</span><span class="p">()</span> <span class="k">as</span> <span class="n">client</span><span class="p">:</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)</span>
    <span class="c"># g.db is still bound if there is such a thing</span>

<span class="c"># and here it&#39;s gone</span>
</pre></div>
</div>
</div>
<div class="section" id="manual-error-handler-attaching">
<h5>Manual Error Handler Attaching<a class="headerlink" href="#manual-error-handler-attaching" title="제목 주소">¶</a></h5>
<p>While it is still possible to attach error handlers to
<code class="xref py py-attr docutils literal"><span class="pre">Flask.error_handlers</span></code> it&#8217;s discouraged to do so and in fact
deprecated.  In general we no longer recommend custom error handler
attaching via assignments to the underlying dictionary due to the more
complex internal handling to support arbitrary exception classes and
blueprints.  See <code class="xref py py-meth docutils literal"><span class="pre">Flask.errorhandler()</span></code> for more information.</p>
<p>The proper upgrade is to change this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">app</span><span class="o">.</span><span class="n">error_handlers</span><span class="p">[</span><span class="mi">403</span><span class="p">]</span> <span class="o">=</span> <span class="n">handle_error</span>
</pre></div>
</div>
<p>Into this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">app</span><span class="o">.</span><span class="n">register_error_handler</span><span class="p">(</span><span class="mi">403</span><span class="p">,</span> <span class="n">handle_error</span><span class="p">)</span>
</pre></div>
</div>
<p>Alternatively you should just attach the function with a decorator:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.errorhandler</span><span class="p">(</span><span class="mi">403</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">handle_error</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>(Note that <code class="xref py py-meth docutils literal"><span class="pre">register_error_handler()</span></code> is new in Flask 0.7)</p>
</div>
<div class="section" id="blueprint-support">
<h5>Blueprint Support<a class="headerlink" href="#blueprint-support" title="제목 주소">¶</a></h5>
<p>Blueprints replace the previous concept of “Modules” in Flask.  They
provide better semantics for various features and work better with large
applications.  The update script provided should be able to upgrade your
applications automatically, but there might be some cases where it fails
to upgrade.  What changed?</p>
<ul class="simple">
<li>Blueprints need explicit names.  Modules had an automatic name
guesssing scheme where the shortname for the module was taken from the
last part of the import module.  The upgrade script tries to guess
that name but it might fail as this information could change at
runtime.</li>
<li>Blueprints have an inverse behavior for <code class="xref py py-meth docutils literal"><span class="pre">url_for()</span></code>.  Previously
<code class="docutils literal"><span class="pre">.foo</span></code> told <code class="xref py py-meth docutils literal"><span class="pre">url_for()</span></code> that it should look for the endpoint
<cite>foo</cite> on the application.  Now it means “relative to current module”.
The script will inverse all calls to <code class="xref py py-meth docutils literal"><span class="pre">url_for()</span></code> automatically for
you.  It will do this in a very eager way so you might end up with
some unnecessary leading dots in your code if you&#8217;re not using
modules.</li>
<li>Blueprints do not automatically provide static folders.  They will
also no longer automatically export templates from a folder called
<cite>templates</cite> next to their location however but it can be enabled from
the constructor.  Same with static files: if you want to continue
serving static files you need to tell the constructor explicitly the
path to the static folder (which can be relative to the blueprint&#8217;s
module path).</li>
<li>Rendering templates was simplified.  Now the blueprints can provide
template folders which are added to a general template searchpath.
This means that you need to add another subfolder with the blueprint&#8217;s
name into that folder if you want <code class="docutils literal"><span class="pre">blueprintname/template.html</span></code> as
the template name.</li>
</ul>
<p>If you continue to use the <cite>Module</cite> object which is deprecated, Flask will
restore the previous behavior as good as possible.  However we strongly
recommend upgrading to the new blueprints as they provide a lot of useful
improvement such as the ability to attach a blueprint multiple times,
blueprint specific error handlers and a lot more.</p>
</div>
</div>
<div class="section" id="version-0-6">
<h4>Version 0.6<a class="headerlink" href="#version-0-6" title="제목 주소">¶</a></h4>
<p>Flask 0.6 comes with a backwards incompatible change which affects the
order of after-request handlers.  Previously they were called in the order
of the registration, now they are called in reverse order.  This change
was made so that Flask behaves more like people expected it to work and
how other systems handle request pre- and postprocessing.  If you
depend on the order of execution of post-request functions, be sure to
change the order.</p>
<p>Another change that breaks backwards compatibility is that context
processors will no longer override values passed directly to the template
rendering function.  If for example <cite>request</cite> is as variable passed
directly to the template, the default context processor will not override
it with the current request object.  This makes it easier to extend
context processors later to inject additional variables without breaking
existing template not expecting them.</p>
</div>
<div class="section" id="version-0-5">
<h4>Version 0.5<a class="headerlink" href="#version-0-5" title="제목 주소">¶</a></h4>
<p>Flask 0.5 is the first release that comes as a Python package instead of a
single module.  There were a couple of internal refactoring so if you
depend on undocumented internal details you probably have to adapt the
imports.</p>
<p>The following changes may be relevant to your application:</p>
<ul class="simple">
<li>autoescaping no longer happens for all templates.  Instead it is
configured to only happen on files ending with <code class="docutils literal"><span class="pre">.html</span></code>, <code class="docutils literal"><span class="pre">.htm</span></code>,
<code class="docutils literal"><span class="pre">.xml</span></code> and <code class="docutils literal"><span class="pre">.xhtml</span></code>.  If you have templates with different
extensions you should override the
<a class="reference internal" href="index.html#flask.Flask.select_jinja_autoescape" title="flask.Flask.select_jinja_autoescape"><code class="xref py py-meth docutils literal"><span class="pre">select_jinja_autoescape()</span></code></a> method.</li>
<li>Flask no longer supports zipped applications in this release.  This
functionality might come back in future releases if there is demand
for this feature.  Removing support for this makes the Flask internal
code easier to understand and fixes a couple of small issues that make
debugging harder than necessary.</li>
<li>The <cite>create_jinja_loader</cite> function is gone.  If you want to customize
the Jinja loader now, use the
<a class="reference internal" href="index.html#flask.Flask.create_jinja_environment" title="flask.Flask.create_jinja_environment"><code class="xref py py-meth docutils literal"><span class="pre">create_jinja_environment()</span></code></a> method instead.</li>
</ul>
</div>
<div class="section" id="version-0-4">
<h4>Version 0.4<a class="headerlink" href="#version-0-4" title="제목 주소">¶</a></h4>
<p>For application developers there are no changes that require changes in
your code.  In case you are developing on a Flask extension however, and
that extension has a unittest-mode you might want to link the activation
of that mode to the new <code class="docutils literal"><span class="pre">TESTING</span></code> flag.</p>
</div>
<div class="section" id="version-0-3">
<h4>Version 0.3<a class="headerlink" href="#version-0-3" title="제목 주소">¶</a></h4>
<p>Flask 0.3 introduces configuration support and logging as well as
categories for flashing messages.  All these are features that are 100%
backwards compatible but you might want to take advantage of them.</p>
<div class="section" id="configuration-support">
<h5>Configuration Support<a class="headerlink" href="#configuration-support" title="제목 주소">¶</a></h5>
<p>The configuration support makes it easier to write any kind of application
that requires some sort of configuration.  (Which most likely is the case
for any application out there).</p>
<p>If you previously had code like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">app</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">DEBUG</span>
<span class="n">app</span><span class="o">.</span><span class="n">secret_key</span> <span class="o">=</span> <span class="n">SECRET_KEY</span>
</pre></div>
</div>
<p>You no longer have to do that, instead you can just load a configuration
into the config object.  How this works is outlined in <a class="reference internal" href="index.html#config"><span>설정 다루기</span></a>.</p>
</div>
<div class="section" id="logging-integration">
<h5>Logging Integration<a class="headerlink" href="#logging-integration" title="제목 주소">¶</a></h5>
<p>Flask now configures a logger for you with some basic and useful defaults.
If you run your application in production and want to profit from
automatic error logging, you might be interested in attaching a proper log
handler.  Also you can start logging warnings and errors into the logger
when appropriately.  For more information on that, read
<a class="reference internal" href="index.html#application-errors"><span>어플리케이션 에러 로깅하기</span></a>.</p>
</div>
<div class="section" id="categories-for-flash-messages">
<h5>Categories for Flash Messages<a class="headerlink" href="#categories-for-flash-messages" title="제목 주소">¶</a></h5>
<p>Flash messages can now have categories attached.  This makes it possible
to render errors, warnings or regular messages differently for example.
This is an opt-in feature because it requires some rethinking in the code.</p>
<p>Read all about that in the <a class="reference internal" href="index.html#message-flashing-pattern"><span>메시지 플래싱(Message Flashing)</span></a> pattern.</p>
</div>
</div>
</div>
<span id="document-changelog"></span><span id="document-license"></span><div class="section" id="license">
<h3>License<a class="headerlink" href="#license" title="제목 주소">¶</a></h3>
<p>Flask is licensed under a three clause BSD License.  It basically means:
do whatever you want with it as long as the copyright in Flask sticks
around, the conditions are not modified and the disclaimer is present.
Furthermore you must not use the names of the authors to promote derivatives
of the software without written consent.</p>
<p>The full license text can be found below (<a class="reference internal" href="#flask-license"><span>Flask License</span></a>).  For the
documentation and artwork different licenses apply.</p>
<div class="section" id="authors">
<span id="id1"></span><h4>Authors<a class="headerlink" href="#authors" title="제목 주소">¶</a></h4>
</div>
<div class="section" id="general-license-definitions">
<h4>General License Definitions<a class="headerlink" href="#general-license-definitions" title="제목 주소">¶</a></h4>
<p>The following section contains the full license texts for Flask and the
documentation.</p>
<ul class="simple">
<li>&#8220;AUTHORS&#8221; hereby refers to all the authors listed in the
<a class="reference internal" href="#authors"><span>Authors</span></a> section.</li>
<li>The &#8220;<a class="reference internal" href="#flask-license"><span>Flask License</span></a>&#8221; applies to all the sourcecode shipped as
part of Flask (Flask itself as well as the examples and the unittests)
as well as documentation.</li>
<li>The &#8220;<a class="reference internal" href="#artwork-license"><span>Flask Artwork License</span></a>&#8221; applies to the project&#8217;s Horn-Logo.</li>
</ul>
</div>
<div class="section" id="flask-license">
<span id="id2"></span><h4>Flask License<a class="headerlink" href="#flask-license" title="제목 주소">¶</a></h4>
</div>
<div class="section" id="flask-artwork-license">
<span id="artwork-license"></span><h4>Flask Artwork License<a class="headerlink" href="#flask-artwork-license" title="제목 주소">¶</a></h4>
</div>
</div>
</div>
</div>
</div>


          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2012, Armin Ronacher.
    </p>
  </div>

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Read the Docs</span>
      v: latest
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Versions</dt>
        
          <dd><a href="/ko/latest/">latest</a></dd>
        
          <dd><a href="/ko/stable/">stable</a></dd>
        
      </dl>
      <dl>
        <dt>Downloads</dt>
        
          <dd><a href="//readthedocs.org/projects/flask-docs-kr/downloads/pdf/latest/">pdf</a></dd>
        
          <dd><a href="//readthedocs.org/projects/flask-docs-kr/downloads/htmlzip/latest/">htmlzip</a></dd>
        
          <dd><a href="//readthedocs.org/projects/flask-docs-kr/downloads/epub/latest/">epub</a></dd>
        
      </dl>
      <dl>
        <dt>On Read the Docs</dt>
          <dd>
            <a href="//https://readthedocs.org/projects/flask-docs-kr/?fromdocs=flask-docs-kr">Project Home</a>
          </dd>
          <dd>
            <a href="//https://readthedocs.org/builds/flask-docs-kr/?fromdocs=flask-docs-kr">Builds</a>
          </dd>
      </dl>
      <hr/>
      Free document hosting provided by <a href="http://www.readthedocs.org">Read the Docs</a>.

    </div>
  </div>



  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.11-dev',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="https://cdnmedia.readthedocs.org/javascript/jquery/jquery-2.0.3.min.js"></script>
      <script type="text/javascript" src="https://cdnmedia.readthedocs.org/javascript/jquery/jquery-migrate-1.2.1.min.js"></script>
      <script type="text/javascript" src="https://cdnmedia.readthedocs.org/javascript/underscore.js"></script>
      <script type="text/javascript" src="https://cdnmedia.readthedocs.org/javascript/doctools.js"></script>
      <script type="text/javascript" src="_static/translations.js"></script>
      <script type="text/javascript" src="https://cdnmedia.readthedocs.org/javascript/readthedocs-doc-embed.js"></script>

  

  
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>